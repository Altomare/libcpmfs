ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	SDSPY
	MOV	B,H
	MVI	C,DDSPY
	INP	A
	STA	CHAR
	MOV	A,E	
	ANI	0DFH
	OUT	SDSPY
	ANI	1FH
	MOV	L,A
	INP	A
	RET
;
INCOL:	LHLD	COLЉ	INR	L
	MOV	A,L
	CPI	24
	JRNZ	..L2
	MVI	L,0
..L2:	XRA	A
	MOV	H,A
	SHLD	COL	;FALL	IN
	RET
;
CHKLIN:	MVI	B,80		;CHECK FOR EMPTY LINE
	LXI	H,DSPBUF
..L3:	MOV	A,M
	CPI	20H
	RNZ	
	INX	H
	DJNZ	..L3	
	RET
;
SETLIN:	CALL	HIRES
	LXI	H,DSPBUF
	LXI	D,ATTBUF
	MVI	B,80
	RET
;
;			
FINDCR:	LXI	H,CHRTBL
	MOV	E,A
	MVI	D,0
	MVI	B,10
..L1:	DAD	D
	DJNZ	..L1
	LXI	B,10
	LXI	D,BYTES
	LDIR
	RET
;
;
CVRT20:	CALL	CVERT2
	JMP	PUTIN
;
CVRT21:	CALL	CVERT2
	JMP	IN3	
;
CVRT22:	CALL	CVERT2
	JMP	IN2
;
CVRT23:	CALL	CVERT2
	JMP	IN1
;
DOSIX:	MOV	A,M
	CALL	CVERT	
	CALL	PUTIN
	MVI	B,1	
	CALL	CVRT20
	MVI	B,2	
	CALL	CVRT20	
	MVI	B,3	
	CALL	CVRT20	
	INX	H	
	LDED	PRNPNT	
	MOV	A,M	
	CALL	CVERT	
	CALL	IN3	
	MVI	B,1	
	CALL	CVRT21	
	MVI	B,2
	CALL	CVRT21
	MVI	B,3
	CALL	CVRT21
	INX	H
	LDED	PRNPNT
	MOV	A,M
	CALL	CVERT
	CALL	IN2
	MVI	B,1	
	CALL	CVRT22
	MVI	B,2Љ	CALL	CVRT22
	MVI	B,3
	JMP	CVRT22
;
MAKE8:	CALL	ZROPRN
	LXI	D,PRNBYT
	LXI	H,BYTES+1
	CALL	DOSIX
	LXI	H,BYTES+8
	LDED	PRNPNT
	JMP	MAC2
;
MAKE88:	CALL	DOSIX
	LXI	H,BYTES+9
	LDED	PRNPNT
	JMP	MAC2
;
MAKE:	CALL	ZROPRN	
	LXI	D,PRNBYT
	LXI	H,BYTES	
MAKE99:	CALL 	DOSIX
	INX	H
	LDED	PRNPNT
MAC2:	MOV	A,M
	CALL	CVERT
	CALL	IN1
	MVI	B,1
	CALL	CVRT23
	MVI	B,2
	CALL	CVRT23
	MVI	B,3
	JMP	CVRT23
;
GETCHR:	CALL	FINDCR
	POP	H
	XTHL
	MOV	A,M
	ANI	0FEH
	XTHL
	PUSH	H
	RZ		;FALL INTO ATTFIX IF NEEDED
;
;
	.PAGE
;###########################################
;PRINTER DEPENDANT CODE
;ATTFIX DEPENDS ON THE CHRGRF TABLE
;USED. THIS IS FOR CHRGRF.TAB
;			
ATTFIX:	MOV	C,A
	BIT	4,A
	CNZ	DUBFIX
	MOV	A,C
	BIT	3,A
	CNZ	BLDFAC
	MOV	A,C
	BIT	5,A	;UNDERLINE
	CNZ	UNDLIN
	MOV	A,C
	BIT	6,A
	JRZ	..L1
	BIT	7,A
	JRNZ	STRKTH
	CALL	SUPSCR	;SUPERSCRIPTЉ	JMPR	REVRS
..L1:	BIT	7,A
	CNZ	SUBSCR	;SUBSCRIPT
	JMPR	REVRS
STRKTH:	LXI	H,BYTES+2	;STRIKE THROUGH
	CALL	FF
	LXI	H,BYTES+6
	CALL	FF
REVRS:	MOV	A,C
	BIT	1,A	;REVERSE VIDEO
	JRNZ	REVID	
	RET
;
;				FALL IN
REVID:	MVI	B,10
	LXI	H,BYTES
..L1:	MOV	A,M
	CMA
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
BLDFAC:	LXI	H,BYTES
	MVI	B,10
..L1:	MOV	A,M
	ANI	77H	
	RAL
	ORA	M
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
;
UNDLIN:	LXI	H,BYTES+9
	CALL	FF
	DCX	H
FF:	MVI	A,0F0H	
	ORA	M
	MOV	M,A
	RET
;
SUPSCR:	PUSH	D
	LXI	H,BYTES
	MVI	B,3	
..L1:	CALL	SHIFT
	DJNZ	..L1
	LXI	H,BYTES+8Љ	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+3	
	CALL	SHFLFT
	ORA	D
	MOV	M,A
	INX	H
	MVI	B,3
..L2:	CALL	SHIFT
	DJNZ	..L2
	LXI	H,BYTES+9
	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7
	CALL	SHFLFT
	ORA	D
	JMPR	SCRDON
;	
SHFLFT:	MOV	A,M
FOURHI:	RAL
	RAL
	RAL
	RAL
	ANI	0F0H
	RET
;
SHFRGT:	MOV	A,M
FOURLO:	RAR
	RAR
	RAR
	RAR
	ANI	0FH
	RET
;
SHIFT:	CALL	SHFLFT
	INX	H
	MOV	D,A
	CALL	SHFRGT
	ORA	D
	DCX	H
	MOV	M,A
	INX	H
	RET
;
SUBSCR:	PUSH	D
	LXI	H,BYTES+3
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+8
	CALL	SHFRGT
	ORA	D
	MOV	M,AЉ	MVI	B,3
	LXI	H,BYTES+3
..L1:	CALL	SHIFT1
	DJNZ	..L1
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+9
	ORA	D
	MOV	M,A
	MVI	B,3
	LXI	H,BYTES+7	
..L2:	CALL	SHIFT1
	DJNZ	..L2
	XRA	A
SCRDON:	MOV	M,A
	POP	D
	RET
;
SHIFT1:	CALL	SHFRGT
	MOV	D,A
	DCX	H
	CALL	SHFLFT
	INX	H
	ORA	D
	MOV	M,A
	DCX	H
	RET
;
DUBFIX:	PUSH	B
	PUSH	D
	PUSH	H
	LDA	DUBFLG
	ORA	A
	JRZ	HALF1
HALF2:	XRA	A
	STA	DUBFLG
	LXI	D,BYTES
	LXI	H,BYTES+4
	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+9
	LXI	D,BYTES+8
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1Љ	JMPR	HFDON
;
HALF1:	CMA	
	STA	DUBFLG
	LXI	D,BYTES+4
	LXI	H,BYTES
	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+8
	LXI	D,BYTES+9
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
HFDON:	ORA	C
	ORA	B
	MOV	M,A
	POP	H
	POP	D
	POP	B
	RET
;
STRCH:	MOV	A,M
	MOV	C,A
	ANI	44H
	RRC
	RRC
	MOV	B,A
	RLC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	88H
	RRC
	MOV	C,A
	RLC
	RET
;
STRCH1:	MOV	A,M
	MOV	C,A
	ANI	22H
	RLC
	RLC
	MOV	B,A
	RRC
	ORA	B
	MOV	B,AЉ	MOV	A,C
	ANI	11H
	RLC
	MOV	C,A
	RRC
	RET
;
SHFT:	ORA	C
	ORA	B
	XCHG
	MOV	M,A
	XCHG
	RET
;
;
	.PAGE
;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
;
IN1:	RRC	;THIS CODE IS DEPENDANT ON
	RRC	;THE LAYOUT OF THE HEAD.
IN2:	RRC	;THIS CODE IS FOR A HEAD
	RRC	;WITH BIT 7 ON THE TOP.
IN3:	RRC
	RRC
PUTIN:	XCHG
	ORA	M
	MOV	M,A
	INX	H
	XCHG
	RET
;
CVERT2:	MOV	A,M
..L1:	RLC
	DJNZ	..L1
CVERT:	ANI	88H
	MOV	B,A
	RLC
	RLC
	RLC
	ORA	B
	ANI	0C0H
	RET
;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
	.PAGE
;
;THE FOLLOWING CODE IS DEPENDANT ON
;THE ACTUAL ESCAPE CODES USED
;
;DELY:	LXI	H,0FFFFH
;..L2:	DCX	H
;	CALL	CONST
;	JRZ	..L3
;	CALL	CONIN
;	CPI	ESC
;	JZ	RETURN
;..L3:	MOV	A,L	
;	ORA	H
;	JRNZ	..L2
;	RET

;
SETPRN:	MVI	B,'A'	;SET FOR 8 DOееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееT
	CALL	ESCOD	;SCROLL
	MVI	C,8
	CALL	LIST
;
;
SCRLL:	MVI	C,LF
	JMP	LST2
;
HIRES:	LXI	H,SCRSTR
SNDSTR:	MOV	B,M
	INX	H
SND1:	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	SND1
	RET
;
SCRSTR:	.BYTE	4,ESC,'L',128,2
;	
RETURN:	MVI	D,'6'
	CALL	ESCOUT
	LXI	H,RETSTR
	CALL	SNDSTR
	JMP	RETVAL
;
RETSTR:	.BYTE	3,ESC,'2',LF
;
;END OF PRINTER DEPENDANT CODE
;############################################
	.PAGE
;	
;	PUT UP PRINTER NAME ON MENU
;
DUMPMS:	.BYTE	HOM,ESC,"S","1",ESC,"U",HLBOLD
	.ASCII	"   EPSON    "
	.BYTE	ESC,"S","0",ESC,"=",23+20H,80+0A0H
;
;
PRNPNT:	.BLKW	1
DUBFLG:	.BYTE	0					
CHAR:	.BLKB	1
COL:	.BLKW	1
GRFY:	.BYTE	239
BYTES:	.BLKB	4
TEXBYT:	.BLKB	6
PRNBYT:	.BLKB	8
;
	.LOC	BASE+1800H+5FFH	;CHARACTER GENERATOR TABLE START
;	
CHRTBL:	.BLKB	2560	;CHARACTER GENERATOR ROM IMAGE
;
LSTBYT	=	.
;
	.LOC	BASE+1800H-320
;
GRFBUF:	.BLKB	80
	.BLKB	80
ATTBUF:	.BLKB	80
DSPBUF:	.BLKB	80
;
	.END
M
61520 REM	SCREEN - 5 - BAR GRAPH DEMO
61530 REM
61540 DATA 0 : REM 0 LINES
61550 REM LINE 1
61600 REM
61610 REM
61620 REM	SCREEN - 6 - LINE GRAPH DEMO
61630 REM
61640 DATA 0 : REM 0 LINES
61650 REM LINE 1
61700 REM
61710 REM
61720 REM	SCREEN - 7 - TWIL DEMO
61730 REM
61740 DATA 0 : REM 0 LINES
61750 REM LINE 1
61800 REM
61810 REM
61820 REM	SCREEN - 8 - WP DEMO
61830 REM
61840 DATA 13 : REM 13 LINES
61850 DATA 1,2,7,0,1,36,1,1
61851 DATA "A T T A C H E  with WORDSTAR-PLUS"
61852 DATA 1,1,33,0,0,64,0,0
61853 DATA "tm"
61854 DATA 1,1,73,0,0,64,0,0
61855 DATA "tm"
61856 DATA 1,6,21,0,0,32,0,0
61857 DATA "WORDSTAR-PLUS - EASY TO LEARN AND PERFORMS"
61858 DATA 1,8,21,0,0,32,0,0
61859 DATA "ALL OF YOUR  'WORD PROCESSINGS'  FUNCTIONS"
61860 DATA 1,12,15,0,0,34,0,0
61861 DATA           "A:ATTACHE  PAGE  5 LINE 22 COL 45"
61862 DATA 1,13,10,0,0,34,0,0
61863 DATA "L----!----!----!----!----!----!----!----!----!----!----!----!---R"
61866 DATA 1,14,10,0,0,32,0,0
61867 DATA "ATTACHE fe;-----------------------------------------------|
;|						|
;|        VALET EXECUTIVE MODULE                |
;|		(VALET.ASM)			|
;|						|
;|----------------------------------------------|
;
; S.GRAY	     09/29/83
; R.WINTER
;
	.PABS
	.PHEX
	.XSYM
;
;|----------------------|
;|	CONSTANTS	|
;|----------------------|
;
;	DISPLAY DRIVER CONSTANTS
;
BS	=	08H
SPC	=	20H
HOM	=	1EH
RVLF	=	0BH
CR	=	0DH
LF	=	0AH
ESC	=	1BH
HL	=	22H
HLBOLD	=	26H
;
;	CCP, BDOS, & BIOS ADDRESSES
;
CCP	=	0C400H
BDOS	=	5
WATADR	=	0DAA6H
;
;	CRT CHIP PORTS
;	
DDSPY	=	0FEH	; CRT DATA
SDSPY	=	0EEH	; CRT STATUS
;
;
;|----------------------|
;|	LIST CONTROL	|
;|----------------------|
;
	.PRNTX	"LIST CONTROL (0=OFF, 1=ON)"
;
LSTINT	=	\"  INTERFACE       MODULE   "
LSTEXC	=	\"  EXECUTIVE       MODULE   "
LSTETB	=	\"  EXEC. TABLES    MODULE   "
LSTALM	=	\"  ALARM MASTER    MODULE   "
LSTPRM	=	\"  ALARM FUNCTION  MODULE   "
LSTSND	=	\"  ALARM ROUTINES  MODULE   "
LSTATB	=	\"  ALARM TABLES    MODULE   "
;
	.PAGE
BASE	=	2000H
;
	.LOC	BASE
BEGIN	=	.
;
	.IFE	LSTINT,[
	.XLIST
]
	JMP	START
;------------------------------------------------
;|	JUMP VECTORS FOR MODULE INTERFACE       |
;------------------------------------------------
PUTVAL:	JMP	0
VALDSP:	JMP	0
CONIN:	JMP	0
RETRN:	JMP	MSGOUT
RWVL:	JMP	RWVAL
RWVL1:	JMP	RWVAL1
OPFIL:	JMP	0
MVFCB:	JMP	0
DISK:	JMP	0
SOUND:	JMP	0
LINDSP:	JMP	0
MESSAG:	JMP	VALMSG
CLNVAL:	JMP	0
	JMP	WRTVAL
	JMP	0
CONOUT:	JMP	CONOUT
TIMFLG:	.WORD	0
ERRRRR:	.WORD	FATERR
;
BADKEY:	.BYTE	8,0C9H,23H,5,0C2H,0CAH,0,11H,0F8H,0FFH,19H,0D1H,13H,13,0C2H
FCBEXT:	.WORD	FCB
;
;------------------------------------------------
;|   VARIABLE STORAGE FOR MODULE INTERFACE	|
;------------------------------------------------
VALNAM:	.BYTE	0
	.ASCII	"VALET   VL2"
;
MODCNT:	.BLKB	1	; # OF MODULES LOADED
MODBEG:	.BYTE	0	; BEGINNING RECORD OF OVERLAY
MODADR:	.BLKB	2	; BEGINNING ADDR. OF OVERLAY
COMBUF:	.BLKB	2
COMLEN:	.BLKB	2
CCPLOC:	.BLKB	2
SAVDON:	.BYTE	0
FCBNUM:	.BYTE	0
NUMADR:	.BLKW	1
MEMADR:	.WORD	MEM1
DUMPMS:	.WORD	DUMPMN
HILIT:	JMP	FIELD
LENTBL:	.WORD	TSTLEN
ADRTBL:	.WORD	TSTADR
LINOFS:	.BLKB	1
SAVMOD:	.BYTE	0
SDMPS:	JMP	DMPSEL
OUTBLK:	JMP	0
FOWARD:	JMP	FWD
BAKWAD:	JMP	BKK
CONST:	JMP	0
BNKFLG:	.WORD	0	;FLAG FOR BANKED OR UNBANKED SYSTEM
;				0 = UNBANKED
SAVAUS:	.WORD	0	;ALLOCATION UNIT TABLE ADDRESS
AUS:	.WORD	0
EXM:	.BLKB	1
SECCNT:	.BLKB	1
RWON:	JMP	RWONE
SPLCNT:	.WORD	0	;SPOOL BUFFER COUNTER ADDRESS
;
	.ASCII	"REV. 1.2"
	.LIST
	.IFE	LSTEXC,[
	.XLIST
]
	.PAGE
;	
START:	DI
	STA	EXM	; STORE EXTENT MASK PASSED FROM BIOS
	SHLD	SAVAUS	; ALLOCATION UNIT TABLE
	SSPD	STKSTR	; STORE OLD STACK POINTER
	LXI	SP,BEGIN+1800H-320	; LOAD NEW STACK POINTER
	EI
;
	LHLD	1	; CALCULATE ADDRESSES FOR MODULE INTERFACE
	LXI	D,3	;  AND STORE WHERE NEEDED
	DAD	D
	SHLD	CONST+1
	DAD	D
	SHLD	CONIN+1
	LXI	D,3
	DAD	D
	SHLD	CONOUT+1
	LXI	D,5CH	
	DAD	D
	SHLD	DISK+1
	LXI	D,3
	DAD	D
	SHLD	VALDSP+1
	LXI	D,12
	DAD	D
	SHLD	SOUND+1
	LXееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееI	D,3	
	DAD	D
	SHLD	PUTVAL+1
	DAD	D
	SHLD	LINDSP+1
	LXI	D,9	
	DAD	D
	SHLD	VALCMD+1
	INX	H
	INX	H
	SHLD	OUTBLK+1
	LXI	D,3	
	DAD	D
	SHLD	CLNVAL+1
	LXI	D,9
	DAD	D
	SHLD	WBOOT+1
	INX	H
	INX	H
	INX	H
	SHLD	GOCPM+1
	LXI	D,17	
	DAD	D
	SHLD	BNKFLG
	LXI	D,6
	DAD	D
	SHLD	TIMFLG
	INX	H
	SHLD	NUMADR
	LXI	D,38
	DAD	D
	SHLD	SPLCNT
	CALL	LINDSP
	MOV	A,B
	STA	LINOFS
;
;
VALCD1:	CALL	FNDNXT	;PUT EARLIEST ALARM IN CMOS RAM
	LXI	H,TSTMSG
	CALL	VALMSG
VALCMD:	LXI	H,0	; ADDRESS OF VALCMD (FILLED IN AT INIT)
	MOV	A,M
	MVI	M,0
	CPI	'!'
	JZ	GOTALM
	MVI	L,0
	CPI	'A'	;IF A LETTER THEN TEST IT
	JRNC	CMDW
MSGOUT:	LXI	SP,BASE+16C0H
	LHLD	BNKFLG	;IF BANKED SYSTEM
	MOV	A,M	;RESTORE SPOOL COUNTER
	ORA	A	; AFTER SCREEN DUMP
	JRZ	LZ
	LDED	SAVSPL	; SEE IF SPOOLER
	MOV	A,D	; WAS ON
	ORA	E
	JRZ	LZ	; RESTORE IF NEEDED
	DI
	LHLD	SPLCNT
	MOV	M,D
	INX	H
	MOV	M,E
	LXI	H,0
	SHLD	SAVSPL
	EI
LZ:	LXI	H,TSTLEN
	SHLD	LENTBL
	LXI	H,TSTADR
	SHLD	ADRTBL
	LXI	H,TSTMSG; ELSE PUT UP MENU
	CALL	VALMSG		
	LDA	SAVMOD
	MOV	L,A
GLP:	MVI	E,6H	;REVERSE BOLDFACE
	PUSH	H
	CALL	FIELD
	CALL	CONIN	; AND GET NEW COMMAND
	POP	H
	CPI	ESC
	JZ	RETURN
	CPI	CR
	JZ	GOTT
	MVI	E,0CH	;BOLD HILITE
	PUSH	H
	PUSH	PSW
	CALL	FIELD
	POP	PSW
	POP	H
	CPI	8
	JZ	KBK
	CPI	12
	JZ	WDF
CMDW:	ANI	0DFH
	MVI	B,0
	CPI	'C'
	JZ	GOT1	
	INR	B
	CPI	'S'
	JZ	GOT1
	INR	B
	CPI	'A'
	JZ	GOT1
	INR	B
	CPI	'I'
	JZ	GOT1
	PUSH	H
	CALL	INVALD
	POP	H
	JMPR	GLP
;	
KBK:	MVI	D,4	
	CALL	BKK
	JMP	GLP
;
WDF:	MVI	D,4
	CALL	FWD
	JMP	GLP
;
GOT1:	MOV	L,B
GOTT:	MOV	A,L
	STA	SAVMOD
	ORA	A
	JZ	CALC	
	DCR	A
	JZ	DUMP
	DCR	A
	JZ	ALARM
	DCR	A
	JZ	INSTALL
	JMP	RETURN
;
FIELD:	MVI	B,0
	MOV	C,L
	LHLD	LENTBL
	DAD	B
	MOV	D,M	;LENGTH OF NAME
	INR	D	;ADD 2 FOR BOUNDRY
	INR	D
	LHLD	ADRTBL	;CURSOR ADDRESS
	DAD	B
	DAD	B
	LDA	LINOFS
	ADD	M
	CPI	24
	JRC	.LO
	SUI	24
.LO:	ORI	0C0H
	OUT	SDSPY
	INX	H
	MOV	B,M
	DCR	B	;START 1 COLUMN BEFORE 
	MVI	C,DDSPY
J2:	INP	A
	MOV	H,A	;SAVE DOUBLE SIZE BIT
	ANI	0F0H
	MOV	L,A
	MOV	A,H
	ORA	E
	ANA	E
	ORA	L
	OUTP	A
	DCR	D
	RZ	
	INR	B
	JMPR	J2
;
FWD:	MOV	A,L
	CMP	D
	JRNZ	..LS
	MVI	L,0FFH
..LS:	INR	L
	RET
;	
BKK:	MOV	A,L
	ORA	A
	JRNZ	..LK
	MOV	L,D	
	INR	L
..LK:	DCR	L
	RET
;
DMPSEL:	LHLD	BNKFLG
	MOV	A,M
	ORA	A
	JRZ	NN1
	DI
	LHLD	SPLCNT
	MOV	D,M	;STOP SPOOLING
	MOV	A,M
	INX	H	;FOR A SCREEN DUMP
	MOV	E,M
	ORA	E
	JRZ	NN1	;IF SAVED ALREADY OR 0
	SDED	SAVSPL	; DON'T DO IT
	MVI	M,0
	DCX	H
	MVI	M,0
	EI
NN1:	LXI	H,DMPLEN
	SHLD	LENTBL
	LXI	H,DMPADR
	SHLD	ADRTBL
	MVI	L,0
NN2:	MVI	E,6
	PUSH	H
	CALL	FIELD
	CALL	CONIN
	POP	H
	CPI	ESC
	RZ
	CPI	LF
	RZ
	CPI	CR
	JRZ	OK1
	PUSH	H
	PUSH	PSW
	MVI	E,0CH
	CALL	FIELD
	POP	PSW
	POP	H
	CPI	8
	JZ	KBB
	CPI	12
	JZ	DWF
	ANI	0DFH
	MVI	B,0	
	CPI	"Q"
	JRZ	OK
	INR	B
	CPI	"T"
	JRZ	OK
	INR	B
	CPI	"G"
	JZ	OK
	INR	B
	CPI	"E"
	JRZ	OK
	PUSH	H
	CALL	INVALD
	POP	H
	JMPR	NN2
;	
OK:	MOV	L,B
OK1:	MOV	A,L
	PUSH	PSW
	XRA	A
	CALL	OUTBLK
	POP	PSW
	RET
;
KBB:	MVI	D,4	
	CALL	BKK
	JMP	NN2
;
DWF:	MVI	D,4	
	CALL	FWD
	JMP	NN2
;
	.PAGE
;
;|----------------------------------------------|
;|    SAVE 4K OF TPA AREA AND LOAD SELECTED	|
;|      MODULE INTO IT, THEN GOTO MODULE	|
;|----------------------------------------------|
;
INSTALL:LXI	B,0C02H	
	JMPR	DUMP1
;
CALC:	LXI	B,0A02H
	JMPR	DUMP1
;	
DUMP:	LXI	B,0802H
;	
DUMP1:	LXI	H,MODBEG; B=STARTING A.U. OF MODULE
	MOV	A,M
	CMP	B
	JRZ	GOMOD
	MOV	M,B
	MOV	A,C	; C=NUMBER OF A.U.'S TO R/W
	STA	MODCNT
;
	LXI	H,SAVDON; IF TPA ALREADY SAVED
	MOV	A,M
	MVI	M,0FFH	;    SET TPA SAVED FLAG
	ORA	A
	JRNZ	..J1	; THEN DON'T DO AGAIN
;
	LHLD	BNKFLG	;IF BANKED SYSTEM THEN 
	MOV	A,M	;LOAD MODULE WITHOUT
	ORA	A	;SAVING TPA
	JRNZ	..J1
	LXI	B,602H	; WRITE 2 A.U.'S STARTING AT
	MVI	A,2	;  A.U. 6  A REG.=2=WRITE OP
	CALL	RWVAL
	JRNZ	RETRN2	; UNSUCCESSFUL IF Z BIT CLEAR
;
..J1:	LDA	MODBEG	; SET UP A,B,C REGS. TO READ MODULE
	MOV	B,A
	LDA	MODCNT
	MOV	C,A
	MVI	A,3	
;
	CALL	RWVAL	; READ MODULE
GOMOD:	JZ	BASE+1800H	; JUMP TO MODULE BEGINNING
	LXI	H,OKERR
	CALL	VALMSG
;	
;|--------------------------------------|
;|  RESTORE OVERWRITTEN AREA OF TPA	|
;|	AND EXIT EXEC MODULE		|
;|--------------------------------------|
;
RETURN:	LDA	SAVDON
	ORA	A	; IF NO OVERLAY, THEN
	JRZ	RETRN1	;  THEN RN1
;
	LHLD	BNKFLG	;IF BANKED SYSTEM DON'T
	MOV	A,M	;RESTORE TPA
	ORA	A	
	JRNZ	RETRN1
;
	LXI	B,602H	; ELSE RESTORE TPA
	MVI	A,3
	CALL	RWVAL
	JRZ	RETRN1	; IF OK, THEN RETRN1
;
RETRNB:	LXI	H,FATERR; ELSE FATAL ERROR
	CALL	VALMSG
	CALL	CONIN
	LSPD	STKSTR	;RESTORE STACK
	LXI	H,0	;RETURN ADDRESS FOR
	PUSH	H	;CLNVAL
	JMP	CLNVAL	;CLNVAL RESTORES BANKS
;
RETRN2:	LXI	H,OKERR	; PUT UP ERROR MSSG.
	CALL	VALMSG	
;	
RETRN1:	LSPD	STKSTR	; RESTORE STACK POINTER
	JMP	PUTVAL	; EXIT MODULE
;
;
	.PAGE
;
;-----------------------------------------------|
;|  READ/WRITE C # OF A.U.'S STARTING AT A.U. B |
;-----------------------------------------------|
;
RWVAL:	LHLD	SAVAUS
	SHLD	AUS	;VALET.VL2 ALLOCATION UNITS
	LXI	H,BASE+1 -BIOS                           ANADEX  ASM   R           ATTACHE BAS  6	
     AXIOM   ASM   R           BIOS225 LBR  Ђ !"#$%&'() BIOS225 LBR  Ђ*+,-./0123456789 BIOS225 LBR  Ђ:;<=>?@ABCDEFGHI BIOS225 LBR  cJKLMNOP          BOXES   BAS   Q                CITOH   ASM   ZRSTUVW           D       COM   X                DATE    BAS   Y                EPSON   ASM   XZ[\]^_           VALET   ASM  Ђ`abcd’“”•–—™ Ўў VALET   ASM  gЈ¤ҐЇ°±І          GRAPH-N BAS   e                GRFLIB  MAC   sfghijklm         GRFTST  BAS   n                MANNS   ASM   Wopqrst           MAP     BAS   uv               MONX    ASM  Ђwxyz{|}~ЂЃ‚ѓ„…† MONX    ASM  ‡€‰Љ‹ЊЌЋЏ        MX100   BAS   ђ‘               Z80LIB  MCR   і                OKI83   ASM   Uљ›њќћџ           PORTS   BAS   ¦§               TIME    BAS   	Ё                TIMESET ASM   \©Є«¬­®          ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;************************************************
;Є                                              *
;*           GRAPHIC PRINTING ROUTINE           *
;*                ANADEX PRINTER                *
;************************************************
;
	.PABS
	.PHEX
	.XSYM
BASE	=	2000H
;
	.LOC	BASE+1800H
;
	JMP	DUMPS
;
HOM	=	1EH
HL	=	22H
HLBOLD	=	26H
SPC	=	20H
ESC	=	1BH
CR	=	0DH
LF	=	0AH
SPRTR	=	0F3H
DPRTR	=	0F2H
SDSPY	=	0EEH
DDSPY	=	0FEH
CONIN	=	BASE+9
CONOUT	=	BASE+6
VALDSP	=	BASE+6
DUMPMN	=	BASE+64H
LINOFS	=	BASE+6DH
LINDSP	=	BASE+21H
VALMSG	=	BASE+24H
RETVAL	=	BASE+0CH
BADKEY	=	BASE+37H
SOUND	=	BASE+1EH
GETDMP	=	BASE+6FH
CONST	=	BASE+7BH
;
;
DUMPS:	MVI	A,239
	STA	GRFY
	CALL	LINDSP
	MOV	A,B
	STA	LINOFS
	XRA	A
	STA	DUBFLG
	MOV	H,A
	MOV	L,B
	SHLD	COL
;
DUMPS1:	LHLD	DUMPMN
	CALL	VALMSG
	LXI	H,DUMPMS
	CALL	VALMSG
	CALL	GETDMP
	CPI	LF
	JRNZ	NLF
	CALL	LIST
	JMPR	DUMPS1
NLF:	CPI	ESC
	JZ	RETVAL
	ORA	A
	JZ	QIKTEX
	CPI	4
	JZ	RETVAL
	PUSH	PSW
	CALL	SET800H	; ADDRESS OF NEW MODULE
RWVAL1:	STA	VALOP	; STORE OPERATION (READ OR WRITE)
	MOV	A,C	; NUMBER OF A.U.'S TO R/W
	STA	VALCNT
;
..RELD:	PUSH	B
	PUSH	H
	CALL	GTRKSC	; XLATE A.U. TO PHYSICAL TRACK & SECTOR
	POP	H
	JRNZ	..REL1
	POP	B
	ORA	A
	RET
;
..REL1:	PUSH	H
	MVI	A,4	; READ 4 PHYSICAL SECTORS (=1 A.U.)
	STA	SECCNT
	MVI	A,10	; DO 10 RETRIES
	STA	RECNT
	LXI	B,100H	; R/W FROM DRIVE 0 ONE SECTOR AT A TIME
	LDA	VALOP
	CALL	RWONE	;  DO R/W
	POP	H
	POP	B
	ORA	A	; IF A <> 0
	RNZ		;  THEN RETURN UNSUCCESSFULLY
	INR	B	; ELSE INCR. A.U. #
	XCHG
	LXI	H,VALCNT 
	DCR	M	; DECREMENT A.U. COUNTER
	RZ		; RETURN IF ALL A.U.'S R/W
	XCHG
	LXI	D,800H	; INCREASE R/W ADDRESS BY 1 A.U. (2K)
	DAD	D
	JMPR	..RELD	; R/W NEXT A.U.
;
;|--------------------------------------|
;|     READ/WRITE PHYSICAL SECTORS	|
;|--------------------------------------|
;	
;	A	= OPERATION (2=WRITE, 3=READ)
;	B	= 1 ALWAYS 
;	C	= DRIVE NUMBER
;	D	= TRACK NUMBER (BIT 7 = SIDE)
;	E	= SECTOR NUMBER
;	HL 	= ADDRESS TO READ/WRITE TO/FROM
;	SECCNT 	= NUMBER OF SECTORS TO R/W
;
RWONE:	PUSH 	PSW	; SAVE LOAD DATA
	PUSH	B	;	'
	PUSH	D	;	'
;
	PUSH	PSW
	LDA	EXM
	ORA	A
	MOV	A,D
	JRZ	..J2
	CPI	28H
	JRC	..J1
	SUI	0A8H
	MOV	D,A
	JMPR	..J1
..J2:	CPI	50H
	JRC	..J1
	SUI	0D0H
	MOV	D,A
;
..J1:	POP	PSW
	PUSH	H	;	'
	CALL	DISK 	; LOAD SECTOR
RWL1:	XRA 	A	
	CALL	DISK
  	ORA	A	; IF DSKCYC = 0
	JRZ	RWOK	;  THEN TRACK LOADED OK
	ANI	0E0H	;   ELSE SEE IF DISK OP DONE OR ERROR
	JRZ 	RWL1	;    IF DISK OP NOT DONE, THEN LOOP TO WAIT
	LXI	H,RECNT	;     ELSE TRY AGAIN
	DCR	M	; DECREMENT RETRY COUNTER
	POP	H	; RESTORE DISK COMMAND DATA
	POP	D
	POP	B
	JRZ	RWNFG	; IF 10 RETRYS, THEN ERROR
	POP	PSW
	JMPR	RWONE	; TRY AGAIN
;
RWOK:	LXI	H,SECCNT; DECREMENT SECTOR COUNTER
	DCR	M
	POP	H	; RESTORE DISK COMMAND DATA
	POP	D	
	POP     B
	JRZ	RWDONE	; IF SECTOR = 0 THEN GOTO CCP
	MVI	A,10	; ELSE SET RETRY COUNTER
	STA	RECNT
	INR	H	; INCREMENT LOAD POINTER BY
	INR	H	;  BY 200H (PHYSICAL SECTOR LENGTH)
	MOV	A,E
	CPI100 REM ***********************************************************************
110 REM *                                                                     *
120 REM * Name: GRAPH-N                                                       *
130 REM * Rev.: 1.0                                                           *
140 REM * Date: May 10, 1982                                                  *
150 REM *                                                                     *
160 REM * Desc: Display block fill patterns                                   *
170 REM *                                                                     *
180 REM *                                                                     *
190 REM ***********************************************************************
200 GRAPH
210 PATTERN = 0
220 GRAPH L(1,22): PRINT "GRAPH N( ) BLOCK FILL PATTERNS"
230 FOR I = 2 TO 22 STEP 6
240 FOR J = 10 TO 62 STEP 12
250 GRAPH L(I,J)
260 PRINT PATTERN
270 PATTERN = PATTERN + 1
280 NEXT J
290 NEXT I
300 GRAPH L(1,1)
310 X=20:Y=210:XX=60:YY=180
320 FOR PATTERN = 0 TO 19
330 PLOT B(X,Y) (XX,YY)
340 GRAPH N(PATTERN)
350 IF PATTERN = 0 THEN 370
360 PLOT F(X,Y)(XX,YY)
370 X=X+50:XX=XX+50:IF XX>=300 THEN X=20:XX=60:Y=Y-60:YY=YY-60
380 NEXT
390 FOR I = 1 TO 15000: NEXT
400 GRAPH
410 INPUT "DO YOU WANT TO SEE 'GRAPH-N' AGAIN (Y/N) ";A$
420 IF A$ = "Y" OR A$ = "y" THEN 200
430 SYSTEM
440 END
00 GRAPH
410 INPUT "DO YOU WANT TO SEE 'GRAPH-N' AGAIN (Y/N) ";A$
420 IF A$ = "Y" OR;"S1SOUTHWESTERN SALES"
440 PRINT"         REGION";CHR$(27);"S0"
450 L=23:C=0:GOSUB 560
460 FOR PAUSE = 1 TO 12000 : NEXT
470 GRAPH A:GRAPH F:REM CLEAR TEXT & GR
480 INPUT "DISPLAY MAP AGAIN (Y/N) ";A$
490 IF A$ = "Y" OR A$ = "y" THEN 260
500 SYSTEM
510 REM  *** GRAPHICS DRIVER ***
520 IF P$ = "0" THEN PLOT (X,Y)
530 IF P$ = "1" THEN PLOT TO (X,Y)
540 RETURN
550 REM *** DIRECT CHARACTER POSITION ***
560 GRAPH L(L+1,C+1)
570 RETURN
580 REM ********************************
590 REM
600 REM TAB;
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;START POINT OF FILL. A SEED IS GIVEN IN BEGX &    ~
;BEGY.  THE FIRST STEP IS TO FIND THE LEFT EDGE    ~
;OF THE POLYGON.  FROM THERE IT MOVES RIGHT UNTIL  ~
;IT HITS ANOTHER SIDE.  THEN IT MOVES ONE LINE     ~
;DOWN AND REPEATS THE PROCESS UNTIL THE BOTTOM     ~
;IS FOUND. IT THEN RETURNS TO THE STARTING POINT   ~
;AND MOVES UP.                                     ~
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;
	INCLUDE		Z80LIB.MCR
;
SDSPY	EQU	0EEH
DDSPY	EQU	0FEH
LINDSP:	JMP	0
CONOUT:	JMP	0
;
PUBLIC	INITF,PFILL,MASK,POINT,LIN,BLOCK,BFILL,SNAME,SDIR
;
ESC	EQU	1BH
BDOS	EQU	5
SFIRST	EQU	17
;
INITF:	LHLD	1	;INITIALIZE CODE
	LXI	D,9
	DAD	D
	SHLD	CONOUT+1
	LXI	D,71H
	DAD	D
	SHLD	LINDSP+1
	RET
;
SDIR:	PUSH	H	;SEARCH DIRECTORY
	CALL	ZERO	;FOR FILE ENTRY
DOSRC:	LXI	D,FCB
	MVI	C,SFIRST
	CALL	BDOS
	INR	A
	POP	H
	MOV	M,A	;RETURN VALUE
	RET
;
ZERO:	LXI	H,FCBNAM
	MVI	B,8	;SET UP FCB
KL:	MVI	M,'?'
	INX	H
	DJNZ	KLPRN
	POP	PSW
	DCR	A
	JZ	DUMPTX
	DCR	A
	JZ	DUMPGR
	JMP	DUMPAL
;
;
ESCOUT:	MVI	C,ESC
	CALL	CONOUT
	MOV	C,D
	JMP	CONOUT
;
LIST:	MOV	C,A
	PUSH	B
	CALL	CONST
	POP	B
	JRZ	LST2
	PUSH	B
	CALL	CONIN
	POP	B
	CPI	ESC
	JZ	RETURN
LST2:	MVI	A,10H
	OUT	SPRTR
	IN	SPRTR
	ANI	24H
	CPI	24H
	JRNZ	LST2
	MOV	A,C
	OUT	DPRTR
	RET
;
;
QIKLIN:	MVI	B,80
	LXI	H,DSPBUF
..L1:	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	..L1
	RET
;
;
QIKTEX:	MVI	B,24
..Z1:	PUSH	B
	LXI	H,DSPBUF
..L1:	PUSH	H
	CALL	REDTEX
..L2:	PUSH	PSW
	LDA	CHAR
	CPI	7FH
	JRNC	..N2
	CPI	20H
	JRNC	..N1
..N2:	MVI	A,"*"
	STA	CHAR
..N1:	POP	PSW
	BIT	4,A	;DOUBLE WIDTH
	JRZ	..NODB	
	INR	H
	XTHL
	MVI	M,20H	;REPLACE 1ST CHAR
	INX	H	;WITH A SPACE
	XTHL
..NODB:	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A
	INX	H
	MOV	A,B	
	CPI	80
	JRC	..L1
	CALL	INCOL	;RETURNS ZERO IF BLANK 
 	CALL	QIKLIN	;LINE
	MVI	C,CR
	CALL	LST2	
	MVI	C,LF
	CALL	LST2
	CALL	CONST
	JRZ	..NN1
	CALL	CONIN
	POP	B
	CPI	ESC
	JRZ	ETX
	PUSH	B
..NN1:	POP	B
	DJNZ	..Z1
ETX:	MVI	C,LF
	CALL	LST2
	JMP	RETVAL
;
;
GRFLIN:	LDA	GRFY
	MOV	D,A
	XRA	A
	MOV	B,A
	MVI	C,DDSPY
	LXI	H,GRFBUF
..L2:	MVI	E,3	
..L1:	MOV	A,D
	PUSH	H
	PUSH	B
	CALL	LINDSP
	POP	B
	POP	H
	OUT	SDSPY
	INP	A
	MOV	M,A
	INX	H
	DCR	D
	DCR	D
	DCR	E
	JRNZ	..L1
	INR	B
	MOV	A,B
	CPI	80	
	JRZ	RETG
	MOV	A,D
	ADI	6
	MOV	D,A
	JMPR	..L2
RETG:	MOV	A,D
	STA	GRFY	;FALL	IN
;
PRNGRF:	CALL	HIRES
	LXI	H,GRFBUF
	MVI	B,80
..L1:	LXI	D,BYTES
	PUSH	B
	LXI	B,3	
	LDIR
	PUSH	H
	CALL	OUT4
	POP	H
	POP	B
	DJNZ	..L1
DON:	MVI	C,CR
	JMP	LST2
;
;
;
OUT4:	PUSH	D
	CALL	MAKE
	LXI	H,PRNBYT
	MVI	B,4
..L1:	MOV	A,M
	RRC
	RRC
	SET	6,A	
	MOV	C,A
	CALL	LST2
	CALL	LST2
	INX	H
	DJNZ	..L1
	POP	D
	RET
;
;
OUT42:	MVI	B,8	
	LXI	H,PRNBYT
..L1:	MOV	A,M	
	RRC
	RRC
	SET	6,A
	MOV	C,A
;INX	H
;DCR	B
;MOV	A,M
;RRC
;RRC
;SET	6,A
;ORA	C
;MOV	C,A
	CALL	LST2
	INX	H
	DJNZ	..L1
	RET	
;
;
ZROPRN:	LXI	H,PRNBYT
	SHLD	PRNPNT
	XRA	A
	MVI	B,8	
..L1:	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
ESCOD:	MVI	C,1BH
	CALL	LST2
	MOV	C,B
	JMP	LST2
;
;
GETTEX:	LXI	H,DSPBUF
	LXI	D,ATTBUF
..L1:	PUSH	H
	PUSH	D
	CALL	REDTEX
	POP	D	;SAVE ATTRIBUTE
	XCHG
	MOV	M,A
	XCHG
	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A	
	INX	H
	INX	D
..L4:	MOV	A,B
	CPI	80	
	JRC	..L1
	RET
;
TEX6:	CALL	GETTEX
	JMPR	DOLIN
;
TEX4:	LHLD	COL
	MVI	H,0
	SHLD	COL
	CALL	GETTEX
	CALL	INCOL
	JMPR	LIN2
;
TEXLIN:	CALL	TEX6
	CALL	SCRL6
	JMPR	TEX4
;
REDTEX:	LHLD	COL
	MOV	A,L
	ORI	0E0H
	MOV	E,A
	OUT	SDSPY
	MOV	B,H
	MVI	C,DDSPY
	INP	A
	STA	CHAR
	MOV	A,E	
	ANI	0DFH
	OUT	SDSPY
	ANI	1FH
	MOV	L,A
	INP	A
	RET
;
;
INCOL:	LHLD	COL
	INR	L
	MOV	A,L
	CPI	24
	JRNZ	..L2
	MVI	L,0
..L2:	XRA	A
	MOV	H,A
	SHLD	COL	
	RET
;
;
SETLIN:	CALL	HIRES
	LXI	H,DSPBUF
	LXI	D,ATTBUF
	MVI	B,80
	RET
;
DOLIN:	CALL	SETLIN
..L1:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR	
	CALL	MAKE
	SDED	PRNPNT
	INX	H
	CALL	MAK9	
	CALL	OUT42
	POP	D
	POP	H
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	JMP	DON
;
LIN2:	CALL	SETLIN
..L2:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE2
	SDED	PRNPNT
	INX	H
	CALL	MAC4+9
	CALL	OUT42
	POP	D
	POP	H
	INX	D
	INX	H
	POP	B
	DJNZ	..L2
	JMP	DON
;
;
FINDCR:	LXI	H,CHRTBL
	MOV	E,A
	MVI	D,0
	MVI	B,10
..L1:	DAD	D
	DJNZ	..L1
	LXI	B,10
	LXI	D,BYTES
	LDIR
	RET
;
MAKE2:	CALL	ZROPRN
	LXI	H,BYTES+6	
	LXI	D,PRNBYT
	JMP	MAC4+9
;
GETCHR:	CALL	FINDCR
	POP	H
	XTHL
	MOV	A,M
	ANI	0FEH
	XTHL
	PUSH	H
	RZ		;FALL IN
;
	.PAGE
;###################################
;	START OF PRINTER CODE
;
;ATTFIX DEPENDS ON THE CHRGRF TABLE USED
;
;THIS CODE IS FOR CHRGRF2.TAB
;
;
ATTFIX:	MOV	C,A
	BIT	4,A
	CNZ	DUBFIX
	MOV	A,C
	BIT	3,A
	CNZ	BLDFAC
	MOV	A,C
	BIT	5,A	;UNDERLINE
	CNZ	UNDLIN
	MOV	A,C
	BIT	6,A
	JRZ	..L1
	BIT	7,A
	JRNZ	STRKTH
	CALL	SUPSCR	;SUPERSCRIPT
	JMPR	REVRS
..L1:	BIT	7,A
	CNZ	SUBSCR	;SUBSCRIPT
	JMPR	REVRS
STRKTH:	LXI	H,BYTES+2	;STRIKE THROUGH
	CALL	FF
	LXI	H,BYTES+5
	CALL	FF
REVRS:	MOV	A,C
	BIT	1,A	;REVERSE VIDEO
	JRNZ	REVID	
	RET
;
REVID:	MVI	B,10
	LXI	H,BYTES
..L1:	MOV	A,M
	CMA
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
BLDFAC:	LXI	H,BYTES
	MVI	B,10
..L1:	MOV	A,M
	ANI	77H	;CHANGED FROM 07H
	RAL
	ORA	M
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
;
UNDLIN:	LXI	H,BYTES+9
	CALL	FF
	DCX	H
	DCX	H
FF:	MVI	A,0F0H	
	ORA	M
	MOV	M,A
	RET
;
SUPSCR:	PUSH	D
	LXI	H,BYTES
	MVI	B,2	
..L1:	CALL	SHIFT
	DJNZ	..L1
	LXI	H,BYTES+6
	PUSH	H
	CALL	SHFRGT
	MOV	D,A
	LXI	H,BYTES+2	
	CALL	SHFLFT
	ORA	D
	MOV	M,A
	POP	H
	CALL	SHIFT
	XRA	A
	MOV	M,A
	LXI	H,BYTES+3
	MVI	B,2	
..L2:	CALL	SHIFT
	DJNZ	..L2
	LXI	H,BYTES+8
	PUSH	H
	CALL	SHFRGT
	MOV	D,A
	LXI	H,BYTES+5
	CALL	SHFLFT
	ORA	D
	MOV	M,A
	POP	H
	CALL	SHIFT
	JMPR	SCRDON
;
SHFLFT:	MOV	A,M
	RAL
	RAL
	RAL
	RAL
	ANI	0F0H
	RET
;
SHFRGT:	MOV	A,M
	RAR
	RAR
	RAR
	RAR
	ANI	0FH
	RET
;
SHIFT:	CALL	SHFLFT
	INX	H
	MOV	D,A
	CALL	SHFRGT
	ORA	D
	DCX	H
	MOV	M,A
	INX	H
	RET
;
SUBSCR:	PUSH	D
	LXI	H,BYTES+7
	CALL	SHIFT1
	LXI	H,B
ZER2:	LXI	H,FCBEX
	MVI	B,21
KLL:	MVI	M,0
	INX	H
	DJNZ	KLL
	RET
;
SNAME:	XCHG	;NAME IN {DE}
	PUSH	D	;SAVE RESULT FLAG
	INX	H
	MOV	E,M	;ADDRESS OF STRING
	INX	H
	MOV	D,M
	CALL	ZER2
	XCHG
	LXI	D,FCB
	INX	H	;CHECK FOR DRIVE INDICATOR
	MOV	A,M
	CPI	':'
	DCX	H
	JRNZ	NODRV
	MOV	A,M
	SUI	'A'-1
	XCHG	
	MOV	M,A
	XCHG
	INX	H
	INX	H
NODRV:	LXI	D,FCBNAM
	MVI	B,8
LOPP:	MOV	A,M
	CPI	'.'
	JZ	DONN
	XCHG
	MOV	M,A
	XCHG
	INX	H
	INX	D
	DJNZ	LOPP
	JMP	DOSRC
DONN:	XCHG	
SLL:	MVI	M,20H
	INX	H
	DCR	B
	JZ	DOSRC
	JMPR	SLL
;
MASK:	PUSH	H
	MVI	C,1BH	;SET MASKS FOR
	CALL	CONOUT	;BLOCK FILL
	MVI	C,"5"
	CALL	CONOUT
	POP	H
	MOV	B,M
	LXI	H,MSKTAB
	LXI	D,2
	DCR	B
	JRZ	HAV
AZ1:	DAD	D
	DJNZ	AZ1
HAV:	MOV	C,M
	PUSH	H
	CALL	CONOUT
	POP	H
	INX	H
	MOV	C,M
	CALL	CONOUT
	RET
;
GETPT:	MOV	A,M	;READ X AND Y
	STA	SEEDX	;COORDINATES
	INX	H
	MOV	A,M
	STA	SEEDX+1
	XCHG
	MOV	A,M
	STA	SEEDY
	INX	H
	MOV	A,M
	STA	SEEDY+1
MAK64:	LDED	SEEDX	;CONVERT SEEDX
	CALL	DIV64
	SDED	SEEDX	
XRET:	LDED	SEEDY
	CALL	DIV64	
	SDED	SEEDY
	RET
;
DIV64:	MVI	A,0FEH
	ANA	D
	RNZ		;RETURN IF NEGATIVE
	.Z80
	RLC	D
	RLC	D
	.8080
	MOV	A,E
	.Z80
	RLCA
	RLCA
	.8080
	ANI	03
	ORA	D	;PUT HIGHER 2 BITS OF E
	MOV	H,A	;IN LOWER 2 BITS OF D
	MOV	A,E
	ANI	3FH	;WIPE HIGH 2 BITS OF E
	MOV	D,A	;LO BYTE IN D
	MOV	E,H	;HI BYTE IN E	
	XRA	A	
	RET
;
POINT:	CALL	GETPT	;GET A POINT
	LXI	H,SEEDX
	MVI	D,4	;SEND IT
	MVI	E,"0"
SNDCOD:	MVI	C,ESC
	CALL	COUT
	MOV	C,E
	CALL	COUT
SLPQ:	MOV	C,M
	INX	H
	CALL	COUT
	DCR	D
	JNZ	SLPQ
	RET
;
COUT:	PUSH	H
	PUSH	D
	CALL	CONOUT
	POP	D
	POP	H
	RET
;
SND8:	PUSH	H
	PUSH	D
	LXI	H,SEEDX
	MVI	D,4	
	MOV	E,B	;BLOCK,OR FILL
	CALL	SNDCOD
	POP	D
	POP	H
	CALL	GETPT
	LXI	H,SEEDX
	MVI	D,4
	JMP	SLPQ	;SEND SECOND POINT
;
LIN:	CALL	GETPT
	LXI	H,SEEDX
	MVI	E,"1"	;VECTOR
	MVI	D,4
	JMP	SNDCOD
;
BLOCK:	MVI	B,"2"	;BLOCK
	JMP	SND8
;
BFILL:	MVI	B,"4"	;BLOCK FILL
	JMP	SND8
;
PFILL:	PUSH	H	;POLYGON FILL
	XCHG
	MOV	A,M
	STA	SEEDX
	INX	H
	MOV	A,M
	STA	SEEDX+1
	PUSH	B
	POP	H
	MOV	A,M
	STA	SEEDY
	INX	H
	MOV	A,M
	STA	SEEDY+1
	POP	H
	MOV	B,M
	LXI	H,MSKTAB
	LXI	D,2
	DCR	B
	JRZ	GOT
ZA1:	DAD	D
	DJNZ	ZA1
GOT:	MOV	A,M
	STA	MSK
	INX	H
	MOV	A,M
	STA	MSK+1
;
FILL:	CALL	FNDLFT	;FIND THE LEFT EDGE FROM 
	MVI	A,0FFH	;THE SEED
	STA	BITFND	
	CALL	CHKABV
	LDA	BITFND
	STA	NXTBIT
	LHLD	NXTSTX
	SHLD	BEGX
	LHLD	LSTX
	SHLD	TEMX
	LDA	NXTY
	STA	BEGY
	MVI	A,0FFH
	STA	BITFND
	STA	FNDBIT
	LDA	LSTONE
	STA	NOABV
..X1:	CALL	CHKBLW
	LHLD	LSTX
	SHLD	TEMX
	CALL	FTORGT
	LDA	BITFND
	STA	FNDBIT
	LDA	LSTONE
	ORA	A
	JRNZ	..NXT
	CALL	RESET
	JMPR	..X1
..NXT:	LHLD	BEGX	;GO BACK TO START COORDS.
	SHLD	TEMX
	LDA	NXTBIT
	STA	FNDBIT
	STA	BITFND
	LDA	BEGY
	STA	TEMY
	LDA	NOABV
	ORA	A
	JRNZ	FINITO
..X2:	CALL	CHKABV
	LHLD	LSTX
	SHLD	TEMX
	CALL	FTORGT
	LDA	BITFND
	STA	FNDBIT
	LDA	LSTONE
	ORA	A
	JRNZ	FINITO
	CALL	RESET
	JMPR	..X2
FINITO:	RET
;
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;     FIND THE ADJACENT BIT IN THE NEXT LINE    ~
;        ABOVE OR BELOW  THE CURRENT LINE       ~
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;
CHKBLW:	CALL	DECTYM	;CHECK THE LINE
	JЪ	NOBIФ	;BELOЧ THЕ CURRENФ ONE
	STA	CHKY	;FOR ADJACENT PIXELS
	STA	NXTY	;NEXT Y STARTING COORD
	CALL	INCTYM	;RESTORE CURRENT LINE COORD
	JMPR	CHK1
;
CHKABV:	CALL	INCTYM	;CHECK THE LINE ABOVE
	JZ	NOBIT	;FOR ADJACENT PIXELS
	STA	CHKY
	STA	NXTY	;NEXT Y START COORD
	CALL	DECTYM	;RESTORE CURRENT Y COORD
CHK1:	LHLD	TEMX
	SHLD	LSTX	;STARTING POINT TO FILL
	SHLD	CHKX	;THIS LINE AND TO CHECK
	CALL	REDBYT	;LINE ABOVE OR BELOW
	MOV	B,A
	CALL	PUTHAF	;GET THIS LINE IN E
	JZ	NOBIT	;IF ZERO THEN NO ADJACENT
	MOV	E,A	;BITS 
	LDA	BITFND
	CPI	0FFH
	CNZ	ANDBIT
	MOV	A,E
	CALL	RGTBIT	;FIND THE RIGHT MOST BITS
;
;	CHECK LOOKS AT THE RIGHT MOST BITS OF THE LOWER 
;NIBBLE OF E.  WHEN IT FINDS A BIT THAT IS ON IT CHECKS THE
;POSSIBLE ADJACENT BITS FROM RIGHT TO LEFT. 
;IT RETURNS WITH THE X-COORDINATE IN NXTSTX AND
;LSTONE SET TO 0FFH IF NO MATCH WAS FOUND.
;
CHECK:	CALL	SNBSIX	;GET SIX POSSIBLE ADJACENT
	JZ	BYTOVR	
	MVI	B,0	;BITS
	.Z80
..U1:	BIT	0,E	;CHECK RIGHTMOST 
	.8080
	JRNZ	.U3
	CALL	ROTAT
	MOV	A,B
	CPI	4
	JZ	NOBIT
	JMPR	..U1
.U3:	MVI	C,0	;COUNTER FOR BITS CHECKED
	MOV	A,D	;GET 6 POSSIBLE BITS TO TEST
..U2:	INR	C	;CHECK 3 POSSIBLE ADJACENT
	RAR		;BITS
	JC	GOTBIT	;FOUND ONE	
	MOV	H,A	;SAVE BITS TO CHECK
	MOV	A,C	;CHECK COUNTER FOR MAX
	CPI	3	;OF THREE 
	MOV	A,H	;GET BITS BACK
	JRNZ	..U2	;DO IT AGAIN
	MOV	A,B	;GET COUNTER  
	CPI	3	;IF = 3 
	JZ	BYTOVR	;WE MOVE OVER ONE BYTE
	CALL	ROTAT	;OTHERWISE WE MOVE I PIXEL
	.Z80
	BIT	0,E	;IF IT IS NOT ON
	.8080
	JRNZ	..U1	;THEN NO MATCH WAS FOUND
	JMP	NOBIT
;
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;      MOVE TO THE LEFT TO FOLLOW THE EDGE      ~
;THIS ROUTINE IS JUMPED TO AND EXITS BY JUMPING ~
;BACK TO CHECK OR TO NOBIT                      ~
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;
BYTOVR:	LDED	CHKX	;BYTE
	CALL	DEC
	JZ	NOBIT	;IF AT LIMIT THEN YTES+2
	PUSH	H
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+6
	CALL	SHFRGT
	ORA	D
	MOV	M,A
	POP	H
	MVI	B,2	
..L1:	CALL	SHIFT1
	DJNZ	..L1
	XRA	A
	MOV	M,A
	LXI	H,BYTES+9
	CALL	SHIFT1
	LXI	H,BYTES+5
	PUSH	H
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+8	
	CALL	SHFRGT
	ORA	D
	MOV	M,A
	MVI	B,2
	POP	H	
..L2:	CALL	SHIFT1
	DJNZ	..L2
SCRDON:	XRA	A
	MOV	M,A
	POP	D
	RET
;
SHIFT1:	CALL	SHFRGT
	MOV	D,A
	DCX	H
	CALL	SHFLFT
	INX	H
	ORA	D
	MOV	M,A
	DCX	H
	RET
;
DUBFIX:	PUSH	B
	PUSH	D
	PUSH	H
	LDA	DUBFLG
	ORA	A
	JRZ	HALF1
HALF2:	XRA	A
	STA	DUBFLG
	LXI	D,BYTES
	LXI	H,BYTES+3
	MVI	B,3	
	CALL	HALFDO
	XCHG		;D=BYTES+6
	LXI	H,BYTES+8
	MVI	B,2
	CALL	HALFDO
	JMPR	HFDON
;
HALFDO:	PUSH	B
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	HALFDO
	RET

HALF1:	CMA	
	STA	DUBFLG
	LXI	D,BYTES+3
	LXI	H,BYTES
	MVI	B,3	
	CALL	DOHALF
	XCHG		;H=BYTES+6
	LXI	D,BYTES+8
	MVI	B,2
	CALL	DOHALF
HFDON:	POP	H
	POP	D
	POP	B
	RET
;
DOHALF:	PUSH	B
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	DOHALF
	RET
;
STRCH:	MOV	A,M
	MOV	C,A
	ANI	44H
	RRC
	RRC
	MOV	B,A
	RLC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	88H
	RRC
	MOV	C,A
	RLC
	RET
;
STRCH1:	MOV	A,M
	MOV	C,A
	ANI	22H
	RLC
	RLC
	MOV	B,A
	RRC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	11H
	RLC
	MOV	C,A
	RRC
	RET
;
SHFT:	ORA	C
	ORA	B
	XCHG
	MOV	M,A
	XCHG
	RET
;
;THE FOLLOWING CODE IS DEPENDANT ON THE
;ACTUAL ESCAPE CODE AND ARRANGEMENT OF
;BITS ON THE PRINT HEAD
;
SETPRN:	MVI	B,"4"
	CALL	ESCOD
	LXI	H,LEN
CODE:	MVI	B,3
..L1:	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	..L1
	RET
;
LEN:	.BYTE	30H,36H,36H
;
DUMPAL:	MVI	D,"7"
	CALL	ESCOUT
	MVI	B,8
..L1:	PUSH	B
	CALL	TEX6
	CALL	SCRL0
	CALL	GRFLIN
	CALL	SCRL6	
	CALL	TEX4
	CALL	SCRL0
	CALL	GRFLIN
	CALL	SCRL4
	CALL	TEX6
	CALL	SCRL2
	CALL	GRFLIN
	CALL	SCRL4	
	CALL	TEX4
	CALL	SCRL2	
	CALL	GRFLIN
	CALL	SCRL2
	CALL	TEX6
	CALL	SCRL4
	CALL	GRFLIN
	CALL	SCRL2
	CALL	TEX4
	CALL	SCRL4
	POP	B
	DJNZ	..L1
	MVI	A,LF
	CALL	LIST	
	JMP	RETURN
;
DUMPTX:	MVI	B,24
..L1:	PUSH	B
	CALL	TEXLIN
	CALL	SCRL4	
	POP	B
	DJNZ	..L1
	JMP	RETURN
;
;
DUMPGR:	MVI	D,"7"
	CALL	ESCOUT
	MVI	A,239	;DUMP GRAPHICS ONLY
	STA	GRFY
	MVI	B,40	
..L1:	PUSH	B
	CALL	GRFLIN
	CALL	SCRL6
	POP	B
	DJNZ	..L1
	JMP	RETURN
;
SCRL0:	MVI	B,30H
	JMPR	SCRLL
;
SCRL2:	MVI	B,32H
	JMPR	SCRLL
;
SCRL4:	MVI	B,34H
	JMPR	SCRLL
;			
SCRL6:	MVI	B,36H
;
SCRLL:	MOV	C,B
	CALL	LST2
	MVI	C,29
	CALL	LST2
	CALL	SETPRN
	MVI	A,CR
	JMP	LIST
;
MAK9:	CALL	MAC4+9
	JMPR	MAKE1
;
MAKE:	CALL	MAC4
	JMPR	MAKE1
;
;
MAC4:	CALL	ZROPRN
	LXI	D,PRNBYT
	LXI	H,BYTES
	MOV	A,M
	CALL	CVERT
	CALL	PUTIN
	MVI	B,1
	CALL	CVRT20
	MVI	B,2
	CALL	CVRT20
	MVI	B,3
	CALL	CVRT20
	INX	H
	LDED	PRNPNT	
	MOV	A,M
	CALL	CVERT
	CALL	IN3
	MVI	B,1
	CALL	CVRT21
	MVI	B,2
	CALL	CVRT21
	MVI	B,3
	JMPR	CVRT21
;
MAKE1:	INX	H
	LDED	PRNPNT
	MOV	A,M
	CALL	CVERT
	CALL	IN2
	MVI	B,1
	CALL	CVRT22
	MVI	B,2
	CALL	CVRT22
	MVI	B,3
	CALL	CVRT22
	RET
;
CVRT20:	CALL	CVERT2	
	JMPR	PUTIN
;
;
IN1:	RRC	;THIS CODE IS DEPENDANT ON
	RRC	;THE LAYOUT OF THE HEAD.
IN2:	RRC	;THIS CODE IS FOR A HEAD
	RRC	;WITH BIT 7 ON THE TOP.
IN3:	RRC
	RRC
PUTIN:	XCHG
	ORA	M
	MOV	M,A
	INX	H
	XCHG
	RET
;
CVERT2:	MOV	A,M
..L1:	RLC
	DJNZ	..L1
CVERT:	ANI	88H
	MOV	B,A
	RLC
	RLC
	RLC
	ORA	B
	ANI	0C0H
	RET
;
CVRT21:	CALL	CVERT2
	JMPR	IN3	
;
CVRT22:	CALL	CVERT2
	JMPR	IN2
;
;
HIRES:	MVI	C,28	;GRAPHICS MODE
	JMP	LST2
;
RETURN:	MVI	D,"6"
	CALL	ESCOUT
	LXI	H,RESETP
	MVI	B,11
..L1:	MOV	C,M
	INX	H
	CALL	LST2
	DJNZ	..L1
	MVI	C,LF
	CALL	LST2
	JMP	RETVAL
;
RESETP:	.BYTE	1BH,"H",1BH,"4","0","6","6",1BH,"%","0","4"
;
;
;END OF PRINTER DEPENDANT CODE
;###########################################
;
;	PUT UP PRINTER NAME ON MENU
;
DUMPMS:	.BYTE	HOM,ESC,"S","1",ESC,"U",HLBOLD
	.ASCII	"   ANADEX   "
	.BYTE	ESC,"S","0",ESC,"=",23+20H,80+0A0H
;
;
GRFY:	.BYTE	239
DUBFLG:	.BYTE	0
;
	.LOC	BASE+1800H+5FFH	;TABLE START
;
CHRTBL:	.BLKB	2560	;CHARACTER GENERATOR ROM IMAGE
;
LSTBYT	=	.
;
	.LOC	BASE+1800H-320
;
GRFBUF:	.BLKB	80
ATTBUF:	.BLKB	80
DSPBUF:	.BLKB	80
PRNPNT:	.BLKW	1
CHAR:	.BLKB	1
COL:	.BLKW	1
BYTES:	.BLKB	4
TEXBYT:	.BLKB	6
PRNBYT:	.BLKB	8
;
	.END
Ѓ‚ѓ„…яя‡€‰Љ‹ЊяяЋЏђ‘’яя”•–—яяяя›ќћџ ЎўЈ¤Ґяя§Ё©яя«¬­®Ї°±яяіґµ¶·ё№є»яяяяѕїАБВГДЕЖЗИяяКЛМНяяПяяСТУФХЦЧШЩЪЫяяЭЮЯабяягдежзийклмнопрстуфяяцчшяяъыьэяяя Дќ+с2А+Н{+И·А>uЙ:NO Я+*л<		ЕН‚8БЧ+*л<x±К‚86 #Г)+ЕХе*Ґ+\ $ НЦ:ГЮ<л*Ґ+лЙе*ь+DMбЙ*,НЛ;",Й*,Н+1",ЙхХ*ш+л*р<НВ:"ь+СсЙНЅ+ИЕХе*Ґ+л!$ ь+ Н_<*¶+~2№+ГЮ<хЕХеНЅ+  !$ л!ь+ Н_<!  6 ГЧ<Ее> ·КР+O :N№ТХ+—>BГх+·!  +	"¶+!  ++		"ъ+НИ<"Ґ+4 	"ш+бБЙ                    ЕХе! "?,!Ђ Нs2бСХеНb,КЮ<Н22\,Г3,ХН<СюяК·2O!  +"?,}ґВ1,y‡‡‡‡‡!Ђ O 	#Нb,> <Г·2ЕеХ:к<2Y->
2к<2п<—20-НХ22S-Хе! л> НА;б Н_<ле>:НХ;КУ,6 #геН}4Кё,|·Вё,:Rg}јТё,2S-б~·КУ,Н6#К№,Ц@O:Q№Ъ$-yГЦ,НЭ1бС~#ю*Ко,ю.Кэ,Н-ГЬ,?yН->ёКЬ,Гр,xюTHIS IS IT
	SHLD	CHKX
	CALL	SWAP	;SWAP TEMX &Y AND CHKX &Y
	CALL	CHKSID	;CHECK FOR AN BITS ON
	CALL	SWAP	;SWAP BACK
	JZ	BYTOVR	;NO BITS ON = NO MATCH
	CALL	DECTEM	;MOVE LEFT ONE BYTE
	CALL	REDBYT	;READ FROM SCREEN
	MOV	B,A	;AND OFF OTHER NIBBLE
	CALL	PUTHAF
	MOV	E,A
	JZ	NOBIT
	CALL	RGTBIT	;FIND RIGHT MOST BITS
	JMP	CHECK	;CHECK MORE
;
;BYTRGT IS CALLED BY GOTBIT TO FOLLOW THE BITS TO
;THE RIGHT.  IT JUMPS BACK ON ITSELF AND EXITS
;WITH A RETURN WHEN FINISHED
;
BYTRGT:	CALL	REDBYT
	MOV	B,A
	CALL	PUTHAF
	CALL	FSTRGT
	LDA	CHKBIT	
	SUB	B
	JRNZ	WALL
BYT2:	CALL	INCTEM	;MOVE ONE BYTE RIGHT
	JRZ	WALL
	CALL	REDBYT
	MOV	B,A
	CALL	PUTHAF
	JRNZ	FOUND2	;NOT ZERO = LSTONE
	CALL	SWAP
	CALL	INCTEM
	CALL	REDHAF
	JRZ	FOUND1
	MOV	E,A
	CALL	SWAP
	CALL	LFTBIT
	MOV	E,B	
	JRZ	BYT2
FOUND:	XRA	A
	RET
;
FOUND1:	CALL	DECTEM
FOUND3:	CALL	SWAP
	MVI	E,1
	JMPR	FOUND
;
FOUND2:	CALL	FSTLFT
	PUSH	B
	CALL	SWAP
	MOV	A,B
	CPI	4
	JRZ	..FN
	CALL	INCTEM
..FN:	CALL	REDHAF
	POP	B
	MOV	E,A
	JRZ	FOUND1
	CALL	SWAP
	PUSH	B
	CALL	LFTBIT
	MOV	E,B
	MOV	A,B
	POP	B
	SUB	B
	JRC	WALL
	JRZ	WALL
	CPI	1
	JRZ	WALL
	JMPR	FOUND	
;
WALL:	XRA	A
	INR	A
	RET
;
REDHAF:	CALL	REDBYT
	MOV	B,A
	JMP	PUTHAF


;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;    EXIT POINTS FOR THE EDGE CHECK ROUTINE     ~
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;
NOBIT:	MVI	A,0FFH
	STA	LSTONE
	STA	BITFND
	RET
;
GOTBIT:	MOV	A,B
	INR	A
	STA	CHKBIT
	MOV	A,C
	ADD	B
	STA	CHKBT2
	CPI	6
	JRNZ	..A1
	LDED	CHKX
	CALL	DEC
	MVI	A,1
	JMPR	EXT
..A1:	CPI	5
	JRNZ	..A2
	DCR	A	;A=4
	LHLD	CHKX
	JMPR	EXT
..A2:	DCR	C
	JRNZ	A3
	MOV	C,A
	MOV	A,B
	ORA	A
	JRZ	..RGT
	LDA	CHKBYT+1
	RLC
	RLC
	MOV	E,A
	MVI	A,6	
	SUB	C
	MOV	B,A
	MOV	A,E
..A4:	RLC
	DJNZ	..A4
	MOV	B,C
..A5:	RLC
	JRNC	..A6
	DJNZ	..A5
..A6:	MOV	A,B
	ORA	A
	JRZ	..RGT
	INR	B
	JMPR	A8
..RGT:	CALL	BYTRGT
	JNZ	NOBIT
	MOV	A,E
A7:	LHLD	CHKX
EXT:	STA	BITFND
	SHLD	NXTSTX
	XRA	A
	STA	LSTONE
	RET
ETX:	MOV	A,C
A3:	DCR	A
	JMPR	A7
A8:	MOV	A,B
	CPI	2
	JRNZ	..FM
	PUSH	B
	CALL	SWAP
	CALL	SNBSIX
	POP	B
	CALL	SWAP
	MOV	A,C
	CPI	2
	JRZ	BIT2
	CPI	3
	JRZ	BIT4
	JMPR	BITCHK
..FM:	PUSH	B
	CALL	REDHAF
	POP	B
	MOV	D,A
	MOV	A,B
	CPI	3
	JRNZ	..NO3
	MOV	A,C
	CPI	3
	JRZ	BIT2
	JMPR	BIT4
	.Z80
..NO3:	BIT	1,D
	JR	BIT3
BITCHK:	BIT	2,D
	JP	NZ,NOBIT
BIT4:	BIT	1,D
	JP	NZ,NOBIT
BIT2:	BIT	0,D
	.8080
BIT3:	JNZ	NOBIT
	DCR	B
	MOV	A,B
	JMPR	A7
;
;
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;
ANDBIT:	ORA	A	;REMOVE BITS
	RZ		;TO THE RIGHT OF THE 
	DCR	A	 
	RZ
	MOV	B,A	;LAST ADJACENT POINT
	MOV	C,A	;FOUND
	MOV	A,E
..E1:	RRC
	DJNZ	..E1
	ANI	0FH
	MOV	B,C
..E2:	RLC
	DJNZ	..E2
	MOV	E,A	
	RET
FTORGT:	LDA	FNDBIT	
	CPI	0FFH
	JRZ	..Q1
	MOV	E,A
	CALL	REDHAF
	MOV	B,E
..F1:	RRC
	JRC	..NO
	DJNZ	..F1
	JMPR	..Q1
..NO:	DCR	B
	JRZ	..Q1
	CALL	SETFIX
	MVI	B,9	
	STC
	CMC
..G5:	JRC	..G2
	RAR	
	DJNZ	..G5	
..G2:	JRNC	..G3
	RAR
	DJNZ	..G2
..G3:	JRC	..G4
	STC
	RAR
	DJNZ	..G3
..G4:	RAR
	DJNZ	..G4
	JMPR	S2+3
..Q1:	CALL	FIXLFT	;FIX THE LEFT EDGE	
	JMPR	..V2	
..V1:	CALL	FNDODD	;FIND WHICH NIBBLE
..V2:	CALL	WRTBYT	;WRITE THE BYTE
	CALL	INCTEM	;NEXT NIBBLE
	JRZ	S2	;HIT LIMIT?
	CALL	CHKSID	;CHECK FOR EDGE
	JRZ	..V1	;NO EDGE
S2є	CALМ	FIXRGФ	;DП THЕ LAST
	CALL	WRTBYT	;BYTE
	RET
;
FSTRGT:	ORA	A
	RZ
	MVI	B,0
..T2:	INR	B
	RRC
	JRNC	..T2
	RET
;
FSTLFT:	ORA	A
	RZ
	MVI	B,5
	RLC
	RLC
	RLC
	RLC
..T1:	DCR	B
	RLC	
	JRNC	..T1
	RET
;
ROTAT:	PUSH	PSW	;SAVE PSW
	INR	B	;INCREMENT BIT COUNTER
	.Z80
	SRL	D	;MOVE ONE PIXEL LEFT
	SRL	E	;BY SHIFTING RIGHT
	.8080
	POP	PSW	;GET PSW
	RET
;
;
SWAP:	LHLD	TEMX	;SWAP TEMX AND TEMY
	PUSH	H	;WITH CHKX AND CHKY
	LHLD	CHKX	;DO NOT CHANGE PSW
	SHLD	TEMX
	POP	H
	SHLD	CHKX
	LDA	TEMY
	PUSH	PSW
	LDA	CHKY
	STA	TEMY
	POP	PSW
	STA	CHKY
	RET
;
SNBSIX:	PUSH	D
	CALL	SWAP	;GET 6 POSSIBLE ADJACENT BITS
	CALL	REDHAF
	RLC		;MOVE 1 BIT LEFT
	MOV	C,A
	CALL	INCTEM	;AND GET THE NEXT BIT
	JRNZ	W1	;OVER
	.Z80
	RES	0,C
	.8080
	JMPR	W2
W1:	PUSH	B
	CALL	REDBYT	;READ THE NEXT BYTE
	POP	B
	MOV	B,A	
	CALL	PUTHAF	;PUT IN LOW NIBBLE
	.Z80
	RES	0,C	;GET THE LEFT MOST
	BIT	3,A	;BIT
	.8080
	JRZ	..A9
	.Z80
	SET	0,C
	.8080
..A9:	CALL	DECTEM	;GO 1 BYTE LEFT OF
W2:	CALL	DECTEM	;START POINT
	JRZ	NODEC
	PUSH	B
	CALL	REDBYT	;AND GET 1 MORE BIT
	POP	B
	MOV	B,A
	CALL	PUTHAF
	.Z80
	RES	5,C	;GET RIGHT MOST BIT
	BIT	0,A
	.8080
	JRZ	..A10
	.Z80
	SET	5,C
	.8080
..A10:	CALL	INCTEM	;GO BACK TO START
AZ:	CALL	SWAP	;SWAP TEMX & Y AND CHKX &Y
	POP	D
	MOV	D,C	;PUT 6 BITS TO CHECK
	SDED	CHKBYT	;IN D & SAVE [DE]
	MOV	A,C
	ANI	3FH
	RET
;
	.Z80
NODEC:	RES	5,C
	.8080
	JMPR	AZ
;
PUTHAF:	CALL	FNDODD	;PUT 4 BITS IN LOWER
	CPI	0FH	;NIBBLE IF NOT
	JRZ	..A11	;ALREADY THERE
	CMA
	.Z80
	RRC	B
	RRC	B
	RRC	B
	RRC	B
	.8080
..A11:	ANA	B
	RET
;	
RGTBIT:	ORA	A
	RZ
	MVI	B,0	;FIND THE RIGHTMOST
..A12:	INR	B	;ON BITS OF E
	RAR		;FIND A BIT THAT IS
	JRNC	..A12	;NOT ON
	MOV	D,A	;SAVE A
	ЪЬ, Гр,·К+-ю?В-2п<Ц К-20-АxГ+-—>IбГ,-=бСх> ·ВC->?bk#НА;y2п<! > НА;!# > w> 2к<сбНы7#БЙН°<юPВ›-НИ1Кй1Н13File exists-delete it? Нч2И>PНD1ИГй1юKК’-2©-Нъ1Ах> юMК±-сЙсГй1хе!ц<Нб-Н(5бсЙ—ГЙ-> ех!ц<Нб->:НХ;#с·ДР5Н(5бЙЕХехН2:к<х>
2к<еНХ2o& г·МЭ1Ж@w#лгНк4лНD<	6:#Сл Нx<л6.#л Нx<л6 с2к<сГ·2ЕХ# >.Н_<лСБЙ            ЕХе~>2z.#х~ю?Кh.ю?Вg.2z.~с=ВT.#PY Нx<> ю?ГЮ<ЕХе#~ю?К’.–ВЮ<В….ГЮ<хЕе`i—|g}oТ«.#В ."н<бБсЙНИ1ИН2ЕХХ#Н<б# 	—ѕЪХ.+V+^л<СБГЅ2ЕХеНН<vяНё:В /2t/22/лНН<"±/!  "a/лц<Н“7	НН<Нё:Т$/л"Њ/СГ/бСБЙ—Г/—>tГ/ЕХе!]/е> ·К>/=22/> ЙНm/юђВY/Нm/·ВP/>ђЙ==22/:</Й2</ЙO !  	"a/—<yГЮ<  > O> ·В„/ХН  СКѕ/O>=2t/yO!  Т“/##^#VzжЂКs/y2q/zююК­/{/Й*a/  НВ:>Кѕ/>JїббГЮ<ЕХеНЭ1Ж@2Я/Ц@Н@0КЮ<Н13Drive  : Total  е*ї=]T*»=#—zW{_Т 0+Вх/:ё=ЦК0)=Г	0НFН13k, Used  СНВ:НFлН13k, Free  НFН13k <ГЮ<ЕХ:.=ю1Ъ{0*р<е*л<еНs2НЭ1=_.Н<Dб^#VбНs2<Вq0—xГx0л>Н–:<СБЙНє0Н<л*»=#  ХСХЪ—0W+|µК¦0КЊ0zГ’0`i:ё=ЦКµ0)=В°0С<Гx0хЕХеН<НЙ0ГЧ<¶= Нx<:.=ю1И—л+w+wЙН2*н<|µКЅ2+"н<ХН<С·ВЅ2Нg2Гв0Н10 REM ***********************************************************************
11 REM *                                                                     *
12 REM * Name: ATTACHE                                                       *
13 REM * Rev.: 1.0                                                           *
14 REM * Date: May 14, 1982                                                  *
15 REM *                                                                     *
16 REM * Desc: Free-running demonstration of ATTACHE capabilities            *
17 REM *                                                                     *
18 REM *                                                                     *
19 REM ***********************************************************************
100 REM
101 REM		MAINLINE FOR DEMO PROGRAM
102 REM
110 GOSUB 60000:REM INITIALIZE
111 REM
120 WHILE DEMO = 1
130      FOR SCREEN = 1 TO NMSCRN
140          ON SCREEN GOSUB 11000,12000,13000,14000,15000,16000,
                 17000,18000,19000,20000
150          GOSUB 1000: REM PAUSE
160      NEXT SCREEN
170 WEND
180 GRAPH A: GRAPH F: REM CLEAR TEXT & GR
190 SYSTEM
1000 REM
1010 REM
1020 REM	PAUSE ROUTINE
1030 REM
1040 PAUSE = DELAY(SCREEN)
1050 FOR I = 1 TO PAUSE
1060 A$ = INKEY$: IF LEN(A$) = 0 THEN 1080
1070 IF ASC(A$) = 24 THEN DEMO = 0
1075 IF ASC(A$) = 32 THEN GOTO 1090
1080 NEXT I
1090 RETURN
2000 REM
2010 REM
2020 REM	SCREEN CONTROL SECTION
2030 REM
2100 REM ***************************************************************
2110 REM
2120 REM	CURSOR POSITIONING TEXT
2130 REM
2135 PRINT
2140 GRAPH L(SCRN%(SCREEN,LYNE,2)+1,SCRN%(SCREEN,LYNE,3)+1)
2150 RETURN
2200 REM
2210 REM
2220 REM	CHARACTER SET
2230 REM
2240 PRINT CHR$(ESC);"T";MID$(STR$(SCRN%(SCREEN,LYNE,4)),2);
2250 RETURN
2300 REM
2310 REM
2320 REM	CHARACTER SIZE
2330 REM
2340 PRINT CHR$(ESC);"S";MID$(STR$(SCRN%(SCREEN,LYNE,5)),2);
2350 RETURN
2400 REM
2410 REM
2420 REM	SCREEN ATTRIBUTE
2430 REM
2440 PRINT CHR$(ESC);"U";CHR$(SCRN%(SCREEN,LYNE,6));
2450 RETURN
2500 REM
2510 REM
2520 REM	CLEAR SCREEN
2530 REM
2540 PRINT CHR$(26)
2550 RETURN
2600 REM
2610 REM
2620 REM	RESET SCREEN ATTRIBUTES
2630 REM
2640 PRINT CHR$(ESC);"Z"
2650 RETURN
2700 REM
2710 REM
2720 REM	CLEAR GRAPHICS
2730 REM
2740 GRAPH F
2750 RETURN
2800 REM
2810 REM
2820 REM	GRAPHICS DRIVER
2830 REM
2840 IF P$ = "0" THEN PLOT (X,Y)
2850 IF P$ = "1" THEN PLOT TO (X,Y)
2860 RETURN
2900 REM
2910 REM
2920 REM	DIRECT CURSOR POSITIONING
2930 REM	FOR IMBEDDED PROGRAMS
2940 REM
2950 GRAPH L(L+1,C+1)
2960 RETURN
3000 REM
3010 REM
3020 REM	SCREEN PRINT ROUTINES
3030 REM
3100 REM
3110 REM
3120 REM	STANDARD TEXT
3130 REM
3140 IF SCRN%(SCREEN,1,7) > 0 THEN GOSUB 2500 : REM CLR SCRN
3145 IF SCRN%(SCREEN,1,8) > 0 THEN GOSUB 2700 : REM CLR GRPH
3150 FOR LYNE = 1 TO SCRN%(SCREEN,0,0)
3160    IF SCRN%(SCREEN,LYNE,1) > 0 THEN GOSUB 2100 : REM CUR POS
3165	GOSUB 2200 : REM CHAR SET
3170	GOSUB 2300 : REM CHAR SIZE
3175	IF SCRN%(SCREEN,LYNE,6) > 0 THEN GOSUB 2400 : REM ATTRIB
3180	PRINT SCREEN$(SCREEN,LYNE)
3185    GOSUB 2600: REM RESET SCREEN
3190 NEXT LYNE
3195 RETURN
3200 REM
3205 REM
3210 REM		TIME ACCESS PROGRAM
3215 REM
3220 PRINT CHR$(27);">"
3225 SEC$ = INKEY$
3230 TSEC$ = INKEY$
3235 MIN$ = INKEY$
3240 TMIN$ = INKEY$
3245 HRS$ = INKEY$
3250 THRS$ = INKEY$
3255 TIME$ = THRS$ + HRS$ + ":" + TMIN$ + MIN$
3260 RETURN
3300 REM
3305 REM
3310 REM		DATE ACCESS PROGRAM
3315 REM
3320 PRINT CHR$(27);":"
3325 WKDAY$ = INKEY$
3330 DAY$ = INKEY$
3335 TDAY$ = INKEY$
3340 MO$ = INKEY$
3345 TMO$ = INKEY$
3350 YR$ = INKEY$
3355 TYR$ = INKEY$
3360 DATE$ = TMO$ + MO$ + "/" + TDAY$ + DAY$ + "/" + TYR$ + YR$
3365 IF WKDAY$ = "1" THEN DAYNAME$ = "Sunday"
3370 IF WKDAY$ = "2" THEN DAYNAME$ = "Monday"
3375 IF WKDAY$ = "3" THEN DAYNAME$ = "Tuesday"
3380 IF WKDAY$ = "4" THEN DAYNAME$ = "Wednesday"
3385 IF WKDAY$ = "5" THEN DAYNAME$ = "Thursday"
3390 IF WKDAY$ = "6" THEN DAYNAME$ = "Friday"
3395 IF WKDAY$ = "7" THEN DAYNAMEMOV	A,B
	CPI	4
	JRNC	..OKI	;IF B = 4 WE LOOKED AT
	MOV	A,D	;ALL BITS IN THIS NIBBLE
..A13:	INR	B
	RAR		;FIND THE FIRST OFF BIT
	JRNC	..OKI	
	MOV	D,A
	MOV	A,B	;CHECK B SO WE DON'T
	CPI	4	;GO TOO FAR
	JRZ	..OKI
	MOV	A,D
	JMPR	..A13
..OKI:	MVI	A,4	;MAKE E = TO THE
	SUB	B	;RIGHT MOST ON BITS
	RZ	
	MOV	B,A
	MVI	A,0FH
..A14:	RRC
	DJNZ	..A14
	ANA	E
	MOV	E,A
	RET
;
;
LFTBIT:	MVI	B,5	
	MOV	A,E	;FIND THE LEFT MOST ON
	RLC		;BITS
	RLC
	RLC
	RLC
..A15:	DCR	B
	RLC
	JRC	..A15
	RET
;
DECTEM:	LDED	TEMX
	CALL	DEC
	RZ
	SHLD	TEMX
	RET
;
INCTEM:	LDED	TEMX	;INCREMENT THE X COORD.
	CALL	INC
	RZ
	SHLD	TEMX
	RET
;
FNDLFT:	LHLD	SEEDX
	SHLD	TEMX
	LDA	SEEDY
	STA	BEGY
	STA	TEMY
	CALL	CHKSID	
	JRNZ	..GG1
..FF:	CALL	CHKSID
	JRNZ	..GG5
..GG7:	CALL	DECTEM
	JRNZ	..FF
..GG5:	MVI	A,0FFH
..GG3:	STA	BITFND
	LHLD	TEMX
	SHLD	BEGX
	RET
..GG1:	LDA	TEMX
	CMA
	ANI	3
	CPI	3
	JRZ	..GG7
	MOV	D,A
	CALL	REDHAF
	MOV	E,A
	MOV	A,D
	ORA	A
	JRZ	CHKALL
	DCR	A
	JRZ	CHK32
	JMPR	CHK3
	.Z80
CHKALL:	BIT	1,E
	.8080
	MVI	A,2
	JRNZ	..GG3
	.Z80
CHK32:	BIT	2,E
	.8080
	MVI	A,3
	JRNZ	..GG3
	.Z80
CHK3:	BIT	3,E
	.8080
	MVI	A,4
	JRZ	..GG7
	JMPR	..GG3
;
CHKSID:	CALL	REDBYT
	MOV	B,A
	CALL	FNDODD
	ANA	B
	RET
;
DEC:	LXI	H,3
	XRA	A
	.Z80
	SBC	HL,DE	
	.8080
	JRNC	END	
	XCHG
	LXI	D,4
	XRA	A
	.Z80
	SBC	HL,DE	
	.8080
END2:	MVI	A,0FFH
	ORA	A
	RET
END:	XRA	A
	RET
;
INC:	LXI	H,315	;DE = VALUE TO BE
	XRA	A	;TO BE INCREMENTED
	.Z80
	SBC	HL,DE	
	.8080
	JRC	END
	XCHG
	LXI	D,4
	DAD	D
	JMPR	END2
;
DECTYM:	LDA	TEMY
	ORA	A
	RZ
	DCR	A
	STA	TEMY
	MOV	B,A	;UNSET ZERO FLAG
	INR	B
	RET
;
INCTYM:	LDA	TEMY
	MOV	B,A
	MVI	A,239
	SUB	B
	RZ
	INR	B
	MOV	A,B
	STA	TEMY
	RET
;	
SETBYT:	LDA	TEMY
	CALL	LINDSP
	DI		;STOP VALET
	OUT	SDSPY
	LHLD	TEMX
	MOV	A,L
	ANI	0FCH
	ORA	H
	RRC
	RRC
	MOV	B,A
	MVI	C,DDSPY
	RET
;
REDBYT:	PUSH	D
	CALL	SETBYT
	.Z80
	IN	A,(C)
	.8080
	POP	D
	EI		;ENABLE VALET
	RET
;
WRTBYTє	MOV	D,A
	CALL	FNDODD
	ANA	D
	MOV	D,A
	LDA	TEMY
	MOV	E,A
	LDA	MSK
	.Z80
	BIT	1,E
	.8080
	JRNZ	B1
	LDA	MSK+1
B1:	ANA	D
	MOЦ	D,A
	PUSH	D
	CALL	SETBYT
	POP	D
	.Z80
	IN	A,(C)
	.8080
	ORA	D
	.Z80
	OUT	(C),A
	.8080
	EI		;ENABLE VALET
	RET
;	
FNDODD:	LDA	TEMY
	ANI	1
	MVI	A,0F0H
	RNZ
	CMA
	RET
;
FIXLFT:	CALL	SETFIX
..LL:	RLC
	ORA	E
	MOV	E,A
	DJNZ	..LL
	CMA
	ANA	D
	RET
;
FIXRGT:	CALL	SETFIX
..MM:	RRC
	ORA	E
	MOV	E,A
	DJNZ	..MM
	CMA
	ANA	D
	RET
;
SETFIX:	CALL	REDBYT
	MOV	E,A
	CALL	FNDODD
	MOV	D,A
	ANA	E
	MOV	E,A
	MVI	B,3
	RET
;
RESET:	LHLD	NXTSTX
	SHLD	TEMX
	LDA	NXTY
	STA	TEMY
	RET
;
MSKTAB:	DB	1,4		;1
	DB	0F8H,88H	;2
	DB	06H,60H		;3
	DB	0FH,0F0H	;4
	DB	66H,66H		;5
	DB	21H,84H		;6
	DB	048H,012H	;7
	DB	42,162		;8
	DB	1,5		;9
	DB	1,15		;10
	DB	1,161		;11
	DB	13,2		;12
	DB	128,128		;13
	DB	32,133		;14
	DB	1,177		;15
	DB	250,10		;16
	DB	180,186		;17
	DB	69,21		;18
	DB	39,46		;19
	DB	10,74		;20
	DB	11,13		;21
	DB	15,255		;22
	DB	0FFH,0FFH	;23
;
;
FCB:	DB	0
FCBNAM:	DB	'        CHT'	;NAME OF FILE TO SAVE (FILE TYPE = COM)
FCBEX:	DB	0,0,0,0,0
	DS	16	
FCBCR	EQU	FCB+32


LSTONE:	DB	0
BEGX:	DW	1
BEGY:	DB	1
LSTX:	DW	1
TEMX:	DW	1
TEMY:	DB	1
CHKX:	DW	1
CHKY:	DB	1
NXTSTX:	DW	1
NXTY:	DB	1
CHKBYT:	DW	1
NOABV:	DB	1
BITFND:	DB	0FFH
FNDBIT:	DB	0FFH
NXTBIT:	DB	0
CHKBIT:	DB	0
CHKBT2:	DB	0
MSK:	DW	1
SEEDX:	DW	1
SEEDY:	DW	1
SAVPNT:	DS	4
;
	END
FSINSTALEXE           А;hh­†  RV      EXE            nEQv  -UZ     BAT           -XOкЏ   DOS50   H!            аT|\K ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее$ = "Saturday"
3400 RETURN
10000 REM
10010 REM
10020 REM	SCREEN PRINT SUBROUTINES
10030 REM
11000 REM
11010 REM
11020 REM	SCREEN - 1
11030 REM
11040 REM GRAPHIC OF OTRONA NAME
11045 GRAPH
11055 REM DRAW "O"
11060 FOR OFFSET = 0 TO 1
11070 P$ = "0"
11080 X = 25 + OFFSET : Y = 220 + OFFSET : GOSUB 2800
11090 P$ = "1"
11100 X = 50 + OFFSET : GOSUB 2800
11110 Y = 200 + OFFSET : GOSUB 2800
11120 X = 25 + OFFSET : GOSUB 2800
11130 Y = 220 + OFFSET : GOSUB 2800
11135 NEXT
11140 REM "O" COMPLETED
11200 REM "T"
11210 FOR OFFSET = 0 TO 1
11220 P$ = "0"
11230 X = 75 + OFFSET : Y = 220 + OFFSET : GOSUB 2800
11240 P$ = "1"
11250 X = 95 + OFFSET : GOSUB 2800
11260 X = 85 + OFFSET : GOSUB 2800
11270 Y = 200 + OFFSET : GOSUB 2800
11280 NEXT
11290 REM "T" COMPLETED
11300 REM "R"
11305 FOR OFFSET = 0 TO 1
11310 P$ = "0"
11315 X = 120 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11320 P$ = "1"
11322 Y = 220 + OFFSET : GOSUB 2800
11325 X = 140 + OFFSET : GOSUB 2800
11330 Y = 210 + OFFSET : GOSUB 2800
11335 X = 120 + OFFSET : GOSUB 2800
11340 P$ = "0"
11350 X = 135 + OFFSET : Y = 210 + OFFSET : GOSUB 2800
11355 P$ = "1"
11360 X = 145 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11365 NEXT
11370 REM "R" COMPLETED
11400 REM "O"
11410 FOR OFFSET = 0 TO 1
11420 P$ = "0"
11430 X = 170 + OFFSET : Y = 220 + OFFSET : GOSUB 2800
11440 P$ = "1"
11450 X = 195 + OFFSET : GOSUB 2800
11460 Y = 200 + OFFSET : GOSUB 2800
11470 X = 170 + OFFSET : GOSUB 2800
11480 Y = 220 + OFFSET : GOSUB 2800
11490 NEXT
11495 REM "O" COMPLETED
11500 REM "N"
11510 FOR OFFSET = 0 TO 1
11520 P$ = "0"
11530 X = 220 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11540 P$ = "1"
11550 Y = 220 + OFFSET : GOSUB 2800
11560 X = 245 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11570 Y = 220 + OFFSET : GOSUB 2800
11580 NEXT
11590 REM "N" COMPLETED
11600 REM "A"
11605 FOR OFFSET = 0 TO 1
11610 P$ = "0"
11615 X = 270 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11620 P$ = "1"
11625 Y = 220 + OFFSET : GOSUB 2800
11630 X = 295 + OFFSET : GOSUB 2800
11631 Y = 200 + OFFSET : GOSUB 2800
11635 P$ = "0"
11640 X = 270 + OFFSET : Y = 210 + OFFSET : GOSUB 2800
11645 P$ = "1"
11650 X = 295 + OFFSET : GOSUB 2800
11655 NEXT
11660 REM "A" COMPLETED
11910 RETURN
12000 REM
12010 REM
12020 REM	SCREEN - 2
12030 REM                 
12040 GOSUB 3100 : REM STD TEXT
12045 L = 23: C = 0: GOSUB 2900
12050 RETURN
13000 REM
13010 REM
13020 REM	SCREEN - 3
13030 REM
13100 REM **** ATTACHE DISPLAY CAPABILITIES ****
13105 REM
13110 GRAPH
13115 L = 0: C = 0: GOSUB 2900
13120 PRINT CHR$(27);"S1";CHR$(27);"U(""ATTACHE DISPLAY CAPABILITIES";CHR$(27);"U "
13125 PRINT
13130 FOR J=0 TO 3
13135 PRINT CHR$(27);"T";CHR$(J);
13140 PRINT CHR$(64);"ABCDEFGHIJKLMNOPQRSTUVWXYZ[/]^";CHR$(95)
13145 PRINT "`abcdefghijklmnopqrstuvwxyz{|}~";CHR$(127)
13150 NEXT J
13155 WIDTH 100
13160 PRINT CHR$(27);"T0";CHR$(27);"S0";
13165 PRINT:PRINT CHR$(64);"ABCDEFGHIJKLMNOPQRSTUVWXYZ[/]^";CHR$(95);
13170 PRINT "`abcdefghijklmnopqrstuvwxyz{|}~";CHR$(127)
13175 PRINT CHR$(27);"U! REVERSE ";:GOSUB 13505:PRINT " ";CHR$(27);"U";CHR$(34);" HIGHLIGHT ";
13180 GOSUB 13505
13185 PRINT CHR$(27);"U$ BOLDFACE ";:GOSUB 13505:PRINT CHR$(27);"U SUPER";CHR$(27);"U0SCRIPT ";
13190 GOSUB 13505
13195 PRINT CHR$(27);"U SUB";CHR$(27);"U@SCRIPT "
13200 PRINT CHR$(27);"U(UNDERLINE";:GOSUB 13505:PRINT CHR$(27);"UPSTRIKETHROUGH";
13205 PRINT CHR$(27);"U ";CHR$(27);"S1 DOUBLE SIZE ";
13210 PRINT CHR$(27);"S0STANDARD SIZE"
13215 PRINT CHR$(27);"T1";
13220 REM     FORMS DRAWING
13225 PRINT
13230 PRINT "Q";
13235 FOR I=1 TO 20:PRINT CHR$(64);:NEXT I
13240 PRINT "W";
13245 FOR I=1 TO 6:PRINT CHR$(64);:NEXT I
13250 PRINT"E":PRINT "\                    \      \"
13255 PRINT "A";:FOR I=1 TO 4:PRINT CHR$(64);:NEXT I
13260 PRINT "W";:FOR I=1 TO 15:PRINT CHR$(64);:NEXT I
13265 PRINT "S";:FOR I=1 TO 6:PRINT CHR$(64);:NEXT I:PRINT "D"
13270 FOR J=1 TO 3
13275 PRINT "U";:FOR I=1 TO 4:PRINT CHR$(95);:NEXT I
13280 PRINT"[";:FOR I=1 TO 15:PRINT CHR$(95);:NEXT I
13285 PRINT "[";:FOR I=1 TO 6:PRINT CHR$(95);:NEXT I
13290 PRINT "P":NEXT J
13295 PRINT "Z";:FOR I=1 TO 4:PRINT CHR$(64);:NEXT I
13300 PRINT "X";:FOR I=1 TO 15:PRINT CHR$(64);:NEXT I
13305 PRINT "X";:FOR I=1 TO 6:PRINT CHR$(64);:NEXT I
13310 PRINT "C";
13315 PRINT CHR$(27);"T0"
13320 L=16:C=6:GOSUB 2900:PRINT CHR$(27);"S1FORMS";CHR$(27);"S0"
13325 L=0:C=64:GOSUB 2900:PRINT CHR$(27);"S1GRAPHICS";CHR$(27);"S0"
13330 L=16:C=42:GOSUB 2900:PRINT CHR$(27);"S1FORMULA";CHR$(27);"S0"
13335 L=18:C=49:GOSUB 2900:PRINT CHR$(27);"T3W";CHR$(27);"T0f";
13340 PRINT CHR$(27)"U0(n+1)";CHR$(27);"U ";"(";CHR$(27);"T2x";
13345 PRINT CHR$(27);"T0";")";CHR$(27);"T3E";CHR$(27);"T0";
13350 L=19:C=35:GOSUB 2900:PRINT "f(x)-p(x)=";CHR$(27);"T2C";
13355 PRINT CHR$(27);"T0(x)";CHR$(27);"T3Z";CHR$(27);"T1";
13360 FOR I=1 TO 9:PRINT CHR$(95);:NEXT I
13365 PRINT CHR$(27);"T3Z"
13370 L=20:C=49:GOSUB 2900:PRINT "S";CHR$(27);"T0  (n+1)  ";
13375 PRINT CHR$(27);"T3D"
13380 PRINT CHR$(27);"T0";CHR$(27);"U "
13390 PRINT CHR$(27);"7";
13395 FOR Q5 PRINT CHR$(27);"\";CHR$(27);"7"
10 CALL INITF
15 DEFINT X,Y,P:X=2:Y=2
20 CALL POINT(X,Y)
25 Y=30
30 CALL LIN(X,Y)
35 X=30
40 CALL LIN(X,Y)
42 X=30:Y=3	
43 CALL LIN(X,Y)
45 X=2:Y=2
50 CALL LIN(X,Y)
55 X=15:Y=15:P=23
60 CALL PFILL(P,X,Y)
70 A$=INKEY$
80 IF A$="" GOTO 70
90 END
PAK     EXE             QК:4“  PCSWP   EXE           -­wЭ:ЂІ  PCTOOLS EXE           ЄFъ
ф: 6 PKUNZIP EXE           €A$#Вr  ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;************************************************
;*                                              *
;*           GRAPHIC PRINTING ROUTINE           *
;*               MANNESMANN TALLY               *
;************************************************
;
	.PABS
	.PHEX
	.XSYM
BASE	=	2000H
;
	.LOC	BASE+1800H
;
	JMP	DUMPS
;
HOM	=	1EH
HL	=	22H
HLBOLD	=	26H
SPC	=	20H
ESC	=	1BH
CR	=	0DH
LF	=	0AH
SPRTR	=	0F3H
DPRTR	=	0F2H
SDSPY	=	0EEH
DDSPY	=	0FEH
CONIN	=	BASE+9
CONOUT	=	BASE+6
VALDSP	=	BASE+6
DUMPMN	=	BASE+64H
LINOFS	=	BASE+6DH
LINDSP	=	BASE+21H
VALMSG	=	BASE+24H
RETVAL	=	BASE+0CH
BADKEY	=	BASE+37H
SOUND	=	BASE+1EH
GETDMP	=	BASE+6FH
CONST	=	BASE+7BH
OUTBLK	=	BASE+72H
;
SETSTR:	.BYTE	4,ESC,'A',8,CR	;THIS IS FOR AMERICAN 
;				;VERSION - CR = EUROPEAN
GRFSTR:	.BYTE	4,ESC,'L',640-512,2
;
DUMPS:	MVI	A,239
	STA	GRFY
	XRA	A
	STA	DUBFLG
	MOV	H,A
	LDA	LINOFS
	MOV	L,A
	SHLD	COL
;
DUMPS1:	LHLD	DUMPMN
	CALL	VALMSG
	LXI	H,DUMPMS
	CALL	VALMSG
	CALL	GETDMP
	CPI	LF
	JRNZ	NLF
	MOV	C,A
	CALL	LIST
	JMPR	DUMPS1
NLF:	CPI	ESC
	JZ	RETVAL
	ORA	A
	JZ	QIKTEX
	CPI	4
	JZ	RETVAL
	PUSH	PSW
	CALL	SETPRN
	POP	PSW
	DCR	A
	JZ	DUMPTX
	DCR	A
	JZ	DUMPGR	;DUMPAL NEXT
;
DUMPAL:	MVI	D,"7"
	CALL	ESCOUT	
	MVI	A,3AH	;CODE FOR LDA
	STA	GRFLIN	;RESTORE GRFLIN CODE
DUMPER:	MVI	B,6	
..L3:	PUSH	B
	CALL	GRFLIN
	CALL	TEX8
	CALL	SCRL8
	CALL	TEX2H
	CALL	GRFLIN
	CALL	TEX6M	
	CALL	SCRL8
	CALL	TEX4H	
	CALL	GRFLIN
	CALL	TEX4L	
	CALL	SCRL8	
	CALL	TEX6H	Љ	CALL	GRFLIN
	CALL	TEX2L
	CALL	SCRL8	
	CALL	TEX8H
	CALL	GRFLIN
	CALL	SCRL8
	POP	B
	DJNZ	..L3
	MVI	C,LF
	CALL	LIST	
	JMP	RETURN
;
ESCOUT:	MVI	C,ESC
	CALL	CONOUT
	MOV	C,D
	JMP	CONOUT
;
LIST:	PUSH	B
	CALL	CONST
	JRZ	..L1
	CALL	CONIN
	CPI	ESC
	POP	B
	JZ	RETURN
	PUSH	B
..L1:	POP	B
LST2:	MVI	A,10H
	OUT	SPRTR
	IN	SPRTR
	ANI	24H
	CPI	24H
	JRNZ	LST2
	MOV	A,C
	OUT	DPRTR
	RET
;
QIKLIN:	MVI	B,80
	LXI	H,DSPBUF
	JMP	L1
;
QIKTEX:	LXI	H,NULL
	SHLD	MOD2+1
	MVI	C,CR
	CALL	LST2
	MVI	B,24
..Z1:	PUSH	B
	LXI	H,DSPBUF
..L1:	PUSH	H
	CALL	REDTEX
..L2:	PUSH	PSW
	LDA	CHAR
	CPI	7FH
	JRNC	..N2
	CPI	20H
	JRNC	..N1
..N2:	MVI	A,"*"
	STA	CHARЉ..N1:	POP	PSW
	BIT	4,A	;DOUBLE WIDTH
	JRZ	..NODB	
	INR	H
	XTHL
	MVI	M,20H	;REPLACE 1ST CHAR
	INX	H	;WITH A SPACE
	XTHL
..NODB:	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A
	INX	H
	MOV	A,B	
	CPI	80
	JRC	..L1
	CALL	INCOL	;RETURNS ZERO IF BLANK 
	CALL	CHKLIN
 	CNZ	QIKLIN	;LINE
	MVI	C,CR
	CALL	LST2	
	MVI	C,LF
	CALL	LST2
	CALL	CONST
	JRZ	..M1
	CALL	CONIN
	POP	B
	CPI	ESC
	JRZ	ETX
	PUSH	B
..M1:	POP	B
	DJNZ	..Z1
ETX:	MVI	C,LF
	CALL	LST2
	JMP	RETVAL
;
DUMPTX:	MVI	A,0C9H	;CODE FOR RETURN
	STA	GRFLIN	;DISABLE GRFLIN
	JMP	DUMPER
;
DUMPGR:	MVI	A,3AH
	STA	GRFLIN
	MVI	D,"7"
	CALL	ESCOUT
	MVI	A,239	;DUMP GRAPHICS ONLY
	STA	GRFY
	MVI	B,30
..L1:	PUSH	B
	CALL	GRFLIN
	CALL	SCRL8	
	POP	B
	DJNZ	..L1
	JMP	RETURN
;	
GRFLIN:	LDA	GRFY
	MOV	D,A
	XRA	A
	MOV	B,A
	MVI	C,DDSPY
	LXI	H,GRFBUF
..L2:	MVI	E,4
..L1:	MOV	A,D
	PUSH	H
	PUSH	B
	C=10 TO 160 STEP 50
13400 P$="0":X=273:Y=Q:GOSUB 2800
13405 P$="1":X=302:GOSUB 2800:Y=Q+29:GOSUB 2800
13410 X=273:GOSUB 2800:Y=Q:GOSUB 2800:X=302:GOSUB 2800
13415 X=318:Y=Q+16:GOSUB 2800:Y=Q+45:GOSUB 2800
13420 X=289:GOSUB 2800:X=273:Y=Q+29:GOSUB 2800:X=302:GOSUB 2800
13425 X=318:Y=Q+45:GOSUB 2800
13430 NEXT Q
13435 L=23:C=0:GOSUB 2900
13440 RETURN: REM RETURN TO MAINLINE *****
13505 REM SUBR TO INSERT BLANK SPACE
13510 PRINT CHR$(27);"U    ";
13515 RETURN
14000 REM
14010 REM
14020 REM	SCREEN - 4 - MAP DEMO
14030 REM
14100 REM **** PLOT A FIGURE FROM THE DATA TABLE ****
14105 REM
14110 REM 500=POINT PLOT
14115 REM 501=VECTOR PLOT
14120 REM 503=END OF LIST
14125 REM ANY OTHER NUMBERS ARE TREATED AS X,Y PAIRS
14130 REM
14135 GOSUB 14270: REM INITIALIZE
14140 GRAPH
14142 PRINT CHR$(ESC);"7": REM GRAPHICS ON
14145 FOR I = 1 TO 85
14150 X = PTS%(I)
14155 IF X = 500 THEN P$ = "0": GOTO 14180
14160 IF X = 501 THEN P$ = "1": GOTO 14180
14165 IF X = 503 THEN GOTO 14190
14170 Y = PTS%(I+1): I = I + 1
14175 GOSUB 2800
14180 NEXT
14185 REM PRINT TITLES
14190 L=13:C=12:GOSUB 2900:PRINT "CALIFORNIA"
14195 L=9:C=22:GOSUB 2900:PRINT "NEVADA"
14200 L=10:C=37:GOSUB 2900:PRINT "UTAH"
14205 L=4:C=48:GOSUB 2900:PRINT "WYOMING"
14210 L=10:C=51:GOSUB 2900:PRINT "COLORADO"
14215 L=17:C=35:GOSUB 2900:PRINT "ARIZONA"
14220 L=16:C=52:GOSUB 2900:PRINT "NEW"
14225 L=17:C=51:GOSUB 2900:PRINT "MEXICO"
14230 L=1:C=2:GOSUB 2900:PRINT CHR$(27);"S1SOUTHWESTERN SALES"
14235 PRINT"         REGION";CHR$(27);"S0"
14240 L=23:C=0:GOSUB 2900
14245 RETURN: REM RETURN TO MAINLINE *****
14270 REM 
14275 REM
14280 REM	INITIALIZE
14285 REM
14290 IF MAPSET THEN RETURN
14295 DIM PTS%(85)
14300 PTS%(1) = 500: PTS%(2) = 166: PTS%(3) = 178
14305 PTS%(4) = 501: PTS%(5) = 29: PTS%(6) = 200
14310 PTS%(7) = 24: PTS%(8) = 180: PTS%(9) = 28
14315 PTS%(10) = 145: PTS%(11) = 35: PTS%(12) =136
14320 PTS%(13) = 34: PTS%(14) = 131: PTS%(15) = 48
14325 PTS%(16) = 86: PTS%(17) = 73: PTS%(18) = 70
14330 PTS%(19) = 84: PTS%(20) = 48: PTS%(21) = 110
14335 PTS%(22) = 48: PTS%(23) = 153: PTS%(24) = 24
14340 PTS%(25) = 190: PTS%(26) = 23: PTS%(27) = 190
14345 PTS%(28) = 28: PTS%(29) = 207: PTS%(30) = 28
14350 PTS%(31) = 207: PTS%(32) = 32: PTS%(33) = 251
14355 PTS%(34) = 32: PTS%(35) = 251: PTS%(36) = 102
14360 PTS%(37) = 500: PTS%(38) = 260: PTS%(39) = 102
14365 PTS%(40) = 501: PTS%(41) = 260: PTS%(42) = 160
14370 PTS%(43) = 164: PTS%(44) = 164: PTS%(45) = 170
14375 PTS%(46) = 223: PTS%(47) = 240: PTS%(48) = 220
14380 PTS%(49) = 240: PTS%(50) = 160: PTS%(51) = 500
14385 PTS%(52) = 186: PTS%(53) = 163: PTS%(54) = 501
14390 PTS%(55) = 179: PTS%(56) = 22: PTS%(57) = 500
14395 PTS%(58) = 74: PTS%(59) = 193: PTS%(60) = 501
14400 PTS%(61) = 65: PTS%(62) = 148: PTS%(63) = 125
14405 PTS%(64) = 70: PTS%(65) = 110: PTS%(66) = 48
14410 PTS%(67) = 500: PTS%(68) = 116: PTS%(69) = 82
14415 PTS%(70) = 501: PTS%(71) = 117: PTS%(72) = 97
14420 PTS%(73) = 127: PTS%(74) = 94: PTS%(75) = 136
14425 PTS%(76) = 182: PTS%(77) = 500: PTS%(78) = 129
14430 PTS%(79) = 108: PTS%(80) = 501: PTS%(81) = 182
14435 PTS%(82) = 103: PTS%(83) = 260: PTS%(84) = 102
14440 PTS%(85) = 503
14445 MAPSET = 1
14450 RETURN
15000 REM
15010 REM
15020 REM	SCREEN - 4
15030 REM
15100 REM ***** GENERAL GRAPH PLOTTING PACKAGE *****
15105 REM
15110 REM * GET DATA *
15115 GOSUB 15455
15120 REM * PLOT FRAMEWORK *
15125 GRAPH 
15135 PLOT B(88,205) (288,55)
15150 FOR I=24 TO 64 STEP 8
15155 L = 20: C = I: GRAPH L(L,C): PRINT D
15160 D=D+E:NEXT I
15165 FOR I=0 TO 5
15170 L=19-I*3:C=23:GRAPH L(L,C):PRINT "-"
15172 L=19-I*3:C=19:GRAPH L(L,C):PRINT I*G+F
15175 NEXT
15180 L=1:C=39:GRAPH L(L,C):PRINT A$;
15185 L=2:GRAPH L(L,C):PRINT B$;
15190 L=22:GRAPH L(L,C):PRINT C$;
15195 L=23:GRAPH L(L,C):PRINT D$;
15200 L=11:C=1:GRAPH L(L,C):PRINT E$;
15205 L=12:GRAPH L(L,C):PRINT F$;
15210 L=18:C=4:GRAPH L(L,C):PRINT G$;
15215 L=20:GRAPH L(L,C):PRINT H$;
15217 GRAPH L(24,1)
15218 IF GRAFTYPE = 0 THEN GRAPH N(7)
15219 IF GRAFTYPE = 1 THEN GRAPH N(19)
15220 PLOT B(1,70) (8,60)
15225 PLOT B(1,50) (8,40)
15230 PLOT F(1,50) (8,40)
15255 K=150/(5*G)
15260 IF GRAFTYPE=1 THEN 15360
15265 REM *** PLOT BAR GRAPH ***
15270 FOR I=1 TO 6
15275 Q=(A(I)-F)*K+55
15280 IF Q>205 THEN Q=205
15285 IF Q<56 THEN Q=56
15290 Y=55:X=96+32*(I-1)
15295 PLOT B(X,Q) (X+12,55)
15305 NEXT I
15310 FOR I=1 TO 6
15315 Q=(B(I)-F)*K+55
15320 IF Q>205 THEN Q=205
15325 IF Q<56 THEN Q=56
15330 Y=55:X=108+32*(I-1)
15335 PLOT B(X,Q) (X+12,55)
15340 PLOT F(X,Q) (X+12,55)
15342 Y = 55: PLOT TO (X,Y): X = X + 1: PLOT TO (X,Y)
15345 NEXT I
15350 GOTO 15445
15355 REM *** PLOT LINE GRAPH ***
15360 FOR I=1 TO 6
15365 Q=(A(I)-F)*K+55
15370 IF Q>205 THEN Q=205
15375 IF Q<56 THEN Q=56
15385 X=108+32*(I-1):Y=Q
15386 IF I = 1 THEN PLOT  (X,Y)
15387 IF I > 1 THEN PLOT TO (X,Y)
15390 NEXT I
15395 FOR I=1 TO 5
15400 Q=(B(I)-F)*K+55
15405 Q2=(B(I+1)-F)*K+55
15410 IF Q>205 THEN Q=205
15415 IF Q<57 THEN Q=57
15417 IF Q2 > 205 THEN Q2 = 205
15418 IF Q2 < 57  THEN Q2 = 57
1542ALL	LINDSP
	POP	B
	POP	H
	OUT	SDSPY
	INP	A
	MOV	M,A
	INX	H
	DCR	D
	DCR	D
	DCR	E
	JRNZ	..L1
	INR	B
	MOV	A,B
	CPI	80	
	JRZ	RETG
	MOV	A,D
	ADI	8
	MOV	D,AЉ	JMPR	..L2
RETG:	MOV	A,D
	STA	GRFY
	LXI	H,GRFBUF
	MVI	E,2
..L2:	MVI	B,160	
..L1:	MOV	A,M
	ORA	A
	JRNZ	PRNGRF
	INX	H
	DJNZ	..L1
	DCR	E
	JRNZ	..L2	
	RET
;
PRNGRF:	CALL	HIRES
	LXI	H,GRFBUF
	MVI	B,80
..L1:	LXI	D,BYTES
	PUSH	B
	LXI	B,4
	LDIR
	PUSH	H
	CALL	OUT4
	POP	H
	POP	B
	DJNZ	..L1
	MVI	C,CR
	JMP	LIST
;
OUT4:	PUSH	D
	CALL	MAKE
	LXI	H,PRNBYT
	MVI	B,4
..L1:	MOV	C,M
	CALL	LST2
	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	..L1
	POP	D
	RET
;
OUT42:	MVI	B,8	
	LXI	H,PRNBYT
L1:	MOV	A,M	
MOD2:	CALL	NULL	;MODIFIED
	MOV	C,A
	CALL	LST2
	INX	H
	DJNZ	L1
	RET	
;
NULL:	RET
;
SIXHI:	RAL
	RAL
	ANI	0FCH
	RET
;
;
TWOHI:	RRC
	RRC
	ANI	0C0H
	RET
;
SIXLO:	RAR
	RAR
	ANI	3FH
	RET
;
;
TWOLO:	RLC
	RLC
	ANI	3
	RET
;
ZROPRN:	LXI	H,PRNBYT
	SHLD	PRNPNT
	XRA	AЉ	MVI	B,8	
..L1:	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
ESCOD:	MVI	C,1BH
	CALL	LST2
	MOV	C,B
	JMP	LST2
;
TEX8:	LXI	H,NULL
;
FIRST8:	SHLD	MOD2+1
	CALL	REDLIN
	CALL	CHKLIN
	RZ
	CALL	SETLIN
EL1:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE
	SDED	PRNPNT
	INX	H
	CALL	MAKE99
	CALL	OUT42
	POP	D
	POP	H
	INX	H
	INX	D
	POP	B
	DJNZ	EL1
	MVI	C,CR
	JMP	LIST
;
TEX8H:	LXI	H,NULL
;
LAST8:	SHLD	MOD2+1
	CALL	CHKLIN
	JZ	INCOL
	CALL	SETLIN
LL:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE8
	SDED	PRNPNT
	LXI	H,BYTES+5
	CALL	MAKE88
	CALL	OUT42
	POP	D
	POP 	H
	INX	D
	INX	H
	POP	B
	DJNZ	LL
	MVI	C,CR
	CALL	LIST
	JMP	INCOL
;
;
TEX6M:	LXI	H,SIXLO
	JMPR	FIRST8
;
TEX4L:	LXI	H,FOURLO
	JMPR	FIRST8
;
TEX2L:	LXI	H,TWOLO
	JMPR	FIRST8
;
;
TEX6H:	LXI	H,SIXHI
	JMPR	LAST8
;
TEX4H:	LXI	H,FOURHI
	JMPR	LAST8
;
TEX2H:	LXI	H,TWOHI
	JMPR	LAST8
;
REDLIN:	LXI	H,DSPBUF
	LXI	D,ATTBUF
..L1:	PUSH	H
	PUSH	D
	CALL	REDTEX
	POP	D	;SAVE ATTRIBUTE
	XCHG
	MOV	M,A
	XCHG
	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A	
	INX	H
	INX	D
..L4:	MOV	A,B
	CPI	80	
	JRC	..L1
	RET
;
REDTEX:	LHLD	COL
	MOV	A,L
	ORI	0E0H
	MOV	E,A
	OUT	SDSPY
	MOV	B,H
	MVI	C,DDSPY
	INP	A
	STA	CHAR
	MOV	A,E	
	ANI	0DFH
	OUT	SDSPY
	ANI	1FH
	MOV	L,A
	INP	A
	RET
;
INCOL:	LHLD	COLЉ	INR	L
	MOV	A,L
	CPI	24
	JRNZ	..L2
	MVI	L,0
..L2:	XRA	A
	MOV	H,A
	SHLD	COL	;FALL	IN
	RET
;
CHKLIN:	MVI	B,80		;CHECK FOR EMPTY LINE
	LXI	H,DSPBUF
..L3:	MOV	A,M
	CPI	20H
	RNZ	
	INX	H
	DJNZ	..L3	
	RET
;
SETLIN:	CALL	HIRES
	LXI	H,DSPBUF
	LXI	D,ATTBUF
	MVI	B,80
	RET
;
;			
FINDCR:	LXI	H,CHRTBL
	MOV	E,A
	MVI	D,0
	MVI	B,10
..L1:	DAD	D
	DJNZ	..L1
	LXI	B,10
	LXI	D,BYTES
	LDIR
	RET
;
;
CVRT20:	CALL	CVERT2
	JMP	PUTIN
;
CVRT21:	CALL	CVERT2
	JMP	IN3	
;
CVRT22:	CALL	CVERT2
	JMP	IN2
;
CVRT23:	CALL	CVERT2
	JMP	IN1
;
DOSIX:	MOV	A,M
	CALL	CVERT	
	CALL	PUTIN
	MVI	B,1	
	CALL	CVRT20
	MVI	B,2	
	CALL	CVRT20	
	MVI	B,3	
	CALL	CVRT20	
	INX	H	
	LDED	PRNPNT	
	MOV	A,M	
	CALL	CVERT	
	CALL	IN3	
	MVI	B,1	
	CALL	CVRT21	
	MVI	B,2
	CALL	CVRT21
	MVI	B,3
	CALL	CVRT21
	INX	H
	LDED	PRNPNT
	MOV	A,M
	CALL	CVERT
	CALL	IN2
	MVI	B,1	
	CALL	CVRT22
	MVI	B,2Љ	CALL	CVRT22
	MVI	B,3
	JMP	CVRT22
;
MAKE8:	CALL	ZROPRN
	LXI	D,PRNBYT
	LXI	H,BYTES+1
	CALL	DOSIX
	LXI	H,BYTES+8
	LDED	PRNPNT
	JMP	MAC2
;
MAKE88:	CALL	DOSIX
	LXI	H,BYTES+9
	LDED	PRNPNT
	JMP	MAC2
;
MAKE:	CALL	ZROPRN	
	LXI	D,PRNBYT
	LXI	H,BYTES	
MAKE99:	CALL 	DOSIX
	INX	H
	LDED	PRNPNT
MAC2:	MOV	A,M
	CALL	CVERT
	CALL	IN1
	MVI	B,1
	CALL	CVRT23
	MVI	B,2
	CALL	CVRT23
	MVI	B,3
	JMP	CVRT23
;
GETCHR:	CALL	FINDCR
	POP	H
	XTHL
	MOV	A,M
	ANI	0FEH
	XTHL
	PUSH	H
	RZ		;FALL INTO ATTFIX IF NEEDED
;
	.PAGE
;###########################################
;PRINTER DEPENDANT CODE
;ATTFIX DEPENDS ON THE CHRGRF TABLE
;USED. THIS IS FOR CHRGRF.TAB
;			
ATTFIX:	MOV	C,A
	BIT	4,A
	CNZ	DUBFIX
	MOV	A,C
	BIT	3,A
	CNZ	BLDFAC
	MOV	A,C
	BIT	5,A	;UNDERLINE
	CNZ	UNDLIN
	MOV	A,C
	BIT	6,A
	JRZ	..L1
	BIT	7,A
	JRNZ	STRKTH
	CALL	SUPSCR	;SUPERSCRIPTЉ	JMPR	REVRS
..L1:	BIT	7,A
	CNZ	SUBSCR	;SUBSCRIPT
	JMPR	REVRS
STRKTH:	LXI	H,BYTES+2	;STRIKE THROUGH
	CALL	FF
	LXI	H,BYTES+6
	CALL	FF
REVRS:	MOV	A,C
	BIT	1,A	;REVERSE VIDEO
	JRNZ	REVID	
	RET


;
;				FALL IN
REVID:	MVI	B,10
	LXI	H,BYTES
..L1:	MOV	A,M
	CMA
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
BLDFAC:	LXI	H,BYTES
	MVI	B,10
..L1:	MOV	A,M
	ANI	77H	
	RAL
	ORA	M
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
;
UNDLIN:	LXI	H,BYTES+9
	CALL	FF
	DCX	H
FF:	MVI	A,0F0H	
	ORA	M
	MOV	M,A
	RET
;
SUPSCR:	PUSH	D
	LXI	H,BYTES
	MVI	B,3	
..L1:	CALL	SHIFT
	DJNZ	..L1
	LXI	H,BYTES+8Љ	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+3	
	CALL	SHFLFT
	ORA	D
	MOV	M,A
	INX	H
	MVI	B,3
..L2:	CALL	SHIFT
	DJNZ	..L2
	LXI	H,BYTES+9
	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7
	CALL	SHFLFT
	ORA	D
	JMPR	SCRDON
;	
SHFLFT:	MOV	A,M
FOURHI:	RAL
	RAL
	RAL
	RAL
	ANI	0F0H
	RET
;
SHFRGT:	MOV	A,M
FOURLO:	RAR
	RAR
	RAR
	RAR
	ANI	0FH
	RET
;
SHIFT:	CALL	SHFLFT
	INX	H
	MOV0 X=108+32*(I-1):Y=Q:PLOT (X,Y)
15425 X=108+32*I:Y=Q2:PLOT TO (X,Y)
15430 Y=Y-1:PLOT TO (X,Y):X=X-32:Y=Q-1:PLOT TO (X,Y)
15435 Y=Y-1:PLOT TO (X,Y):X=X+32:Y=Q2-1:PLOT TO (X,Y)
15440 NEXT I
15445 RETURN: REM RETURN TO MAINLINE *****
15455 REM PLUG IN VALUES FOR DEMO
15460 A$="   S H I P P I N G    "
15465 B$="P E R F O R M A N C E  "
15470 C$="    Y E A R     "
15475 D$=""
15480 E$=" MILLIONS  "
15485 F$="OF DOLLARS "
15490 G$="TARGET"
15495 H$="ACTUAL"
15500 D=1975
15505 E=1
15510 F=0
15515 G=1
15520 A(1) = 1!: A(2) = 1.5: A(3) = 2.1
15525 A(4) = 3!: A(5) = 4!: A(6) = 4.2
15530 B(1) = .8: B(2) = 1.9: B(3) = 2.4
15535 B(4) = 2.7: B(5) = 3!: B(6) = 4.6
15540 REM FIRST PASS GRAFTYPE = 0  BAR GRAPH
15545 RETURN
16000 REM
16010 REM
16020 REM	SCREEN - 6 - LINE GRAPH DEMO
16030 REM
16105 REM
16110 GRAFTYPE = 1
16115 GOSUB 15000
16120 GRAFTYPE = 0
16125 RETURN: REM RETURN TO MAINLINE *****
17000 REM
17010 REM
17020 REM	SCREEN - 7 - TWIL DEMO
17030 REM
17100 REM **** SQUARE TUNNEL PLOT ****
17105 REM
17110 GRAPH
17120 B=100
17125 FOR A=100 TO -119 STEP -3
17130 X = 160 - B: Y = 120 + A: PLOT (X,Y)
17135 X=160+A:Y=120+B:PLOT TO (X,Y):X=160+B:Y=120-A:PLOT TO (X,Y)
17140 X=160-A:Y=120-B:PLOT TO (X,Y):X=160-B:Y=120+A:PLOT TO (X,Y)
17145 B=B-2:NEXT 
17150 GOSUB 1000: REM PAUSE
17155 X = 160
17165 Y = 125
17175 ANGLE = 360
17185 GRAPH
17205 FOR J = 1 TO 2
17215 IF J = 2 THEN GRAPH C
17225 FOR I = 10 TO 100 STEP 10
17235 PLOT (X,Y)
17245 PLOT C(X + I,Y), ANGLE
17255 ANGLE = - ANGLE
17265 NEXT I
17275 NEXT J
17285 GRAPH B
17290 RETURN
18000 REM
18010 REM
18020 REM	SCREEN - 8 - WP DEMO
18030 REM
18040 GOSUB 3100: REM STANDARD TEXT
18050 RETURN: REM RETURN TO MAINLINE *****
19000 REM
19010 REM
19020 REM	SCREEN - 9 - SPREAD SHEET
19030 REM
19040 GOSUB 3100: REM STANDARD TEXT
19050 RETURN
20000 REM
20010 REM
20020 REM	SCREEN - 10 - CLOSING MESSAGE
20030 REM
20040 GOSUB 11000: REM GRAPH OF 'OTRONA'
20045 GOSUB 3100: REM STANDARD TEXT
20050 GOSUB 3300: REM DATE
20055 L = 18: C = 36: GOSUB 2900
20060 PRINT CHR$(ESC);"S1On ";DAYNAME$;", ";DATE$
20065 FOR PAUSE = 1 TO 1000: NEXT
20070 GOSUB 3200: REM TIME
20075 L = 21: C = 44: GOSUB 2900
20080 PRINT "Current Time ";CHR$(ESC);"U!";TIME$
20085 RETURN: REM RETURN TO MAINLINE *****
60000 REM
60010 REM
60020 REM	INITIALIZE VARIABLES, FLAGS, ARRAYS, DATA
60030 REM
60050 DEFINT X-Y,C,L
60100 REM
60110 REM
60120 REM	FLAGS
60130 REM
60140 DEMO = 1
60190 REM
60200 REM
60210 REM
60220 REM	VARIABLES
60230 REM
60240 NMSCRN = 10
60250 ESC = 27
60280 REM	NMSCRN 		NUMBER OF SCREENS
60281 REM	SCREEN		INDEX FOR SCREEN IN USE
60282 REM	LYNE		'DATA' LINE FOR SCREEN
60283 REM	CHAR		CHARACTERISTIC (X,Y,ATTRIB,ETC)
60284 REM	PAUSE		COUNT FOR PAUSE
60285 REM	NUMLYNE		NUMBER OF LINES FOR A SCREEN
60286 REM	ESC		ESCAPE IS CHAR 27
60290 REM
60295 GOSUB 2500: GOSUB 2700: REM CLEAR GRAPHICS & TEXT
60300 REM
60310 REM
60320 REM	ARRAYS
60330 REM
60340 DIM SCREEN$(10,21),SCRN%(10,21,8)
60380 REM	SCREEN$		TEXT FOR SCREEN (1 TO 20 LINES)
60381 REM	SCRN%		SCREEN CHARACTERISTICS
60382 REM			SCRN%(SCREEN,LINE,CHAR)
60383 REM			CHAR = 0  LINE 1 - NUM OF LINES
60384 REM			1 = CPOS  2 = LINE 3 = COL
60385 REM			4 = CSET  5 = SIZE 6 = ATTR
60386 REM                       7 = CLR SCRN       8 = CLR GRPH
60400 REM
60405 REM PAUSE FOR SCREENS - DELAY ARRAY
60410 DIM DELAY(12)
60415 DELAY(1) = 0:REM SCREEN 1
60420 DELAY(2) = 1400:REM SCREEN 2
60425 DELAY(3) = 8000:REM SCREEN 3 DISPLAY DEMO
60430 DELAY(4) = 1600:REM SCREEN 4 MAP DEMO 
60435 DELAY(5) = 4000:REM SCREEN 5 BAR CHART
60440 DELAY(6) = 3400: REM SCREEN 6 LINE CHART
60445 DELAY(7) = 1100:REM SCREEN 7 TWIL GRAPHICS
60450 DELAY(8) = 6000:REM SCREEN 8 WP DEMO
60455 DELAY(9) = 4000:REM SCREEN 9 SPREAD SHEET
60460 DELAY(10)= 1600:REM SCREEN 10 EXIT MESSAGE
61000 REM
61005 REM
61010 REM	SCREEN DATA READ ROUTINE
61015 REM
61020 FOR SCREEN = 1 TO NMSCRN
61025	READ NUMLYNE
61026	SCRN%(SCREEN,0,0) = NUMLYNE
61029   IF NUMLYNE = 0 THEN 61060
61030	FOR LYNE = 1 TO NUMLYNE
61035		FOR CHAR = 1 TO 8
61040			READ SCRN%(SCREEN,LYNE,CHAR)
61045		NEXT CHAR
61050		READ SCREEN$(SCREEN,LYNE)
61055	NEXT LYNE
61060 NEXT SCREEN
61065 RETURN
61100 REM
61110 REM
61120 REM	SCREEN - 1 - GRAPHICS "OTRONA" TITLE SCREEN
61130 REM
61140 DATA 0 : REM 0 LINES
61200 REM
61210 REM
61220 REM	SCREEN - 2 - REST OF TITLE SCREEN
61230 REM
61240 DATA 5 : REM 5 LINES
61250 REM LINE 1
61260 DATA 1,9,35,0,0,32,0,0
61262 DATA "PRESENTS"
61265 REM LINE 2
61267 DATA 1,14,26,0,1,36,0,0
61269 DATA "A T T A C H E"
61270 REM LINE 3
61272 DATA 1,13,52,0,0,64,0,0
61274 DATA "tm"
61275 REM LINE 4
61277 DATA 1,19,18,0,1,33,0,0
61279 DATA "THE EXECUTIVE COMPUTER"
61280 REM LINE 5
61282 DATA 1,18,62,0,0,64,0,0
61284 DATA "tm"
61300 REM
61310 REM
61320 REM	SCREEN - 3 - DISPLAY DEMO
61330 REM
61340 DATA 0 : REM 0 LINES
61350 REM LINE 1
61400 REM
61410 REM
61420 REM	SCREEN - 4 - MAP DEMO
61430 REM
61440 DATA 0 : REM 0 LINES
61450 REM LINE 1
61500 REM
61510 RE	D,A
	CALL	SHFRGT
	ORA	D
	DCX	H
	MOV	M,A
	INX	H
	RET
;
SUBSCR:	PUSH	D
	LXI	H,BYTES+3
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+8
	CALL	SHFRGT
	ORA	D
	MOV	M,AЉ	MVI	B,3
	LXI	H,BYTES+3
..L1:	CALL	SHIFT1
	DJNZ	..L1
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+9
	ORA	D
	MOV	M,A
	MVI	B,3
	LXI	H,BYTES+7	
..L2:	CALL	SHIFT1
	DJNZ	..L2
	XRA	A
SCRDON:	MOV	M,A
	POP	D
	RET
;
SHIFT1:	CALL	SHFRGT
	MOV	D,A
	DCX	H
	CALL	SHFLFT
	INX	H
	ORA	D
	MOV	M,A
	DCX	H
	RET
;
DUBFIX:	PUSH	B
	PUSH	D
	PUSH	H
	LDA	DUBFLG
	ORA	A
	JRZ	HALF1
HALF2:	XRA	A
	STA	DUBFLG
	LXI	D,BYTES
	LXI	H,BYTES+4
	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+9
	LXI	D,BYTES+8
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1Љ	JMPR	HFDON
;
HALF1:	CMA	
	STA	DUBFLG
	LXI	D,BYTES+4
	LXI	H,BYTES
	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+8
	LXI	D,BYTES+9
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
HFDON:	ORA	C
	ORA	B
	MOV	M,A
	POP	H
	POP	D
	POP	B
	RET
;
STRCH:	MOV	A,M
	MOV	C,A
	ANI	44H
	RRC
	RRC
	MOV	B,A
	RLC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	88H
	RRC
	MOV	C,A
	RLC
	RET
;
STRCH1:	MOV	A,M
	MOV	C,A
	ANI	22H
	RLC
	RLC
	MOV	B,A
	RRC
	ORA	B
	MOV	B,AЉ	MOV	A,C
	ANI	11H
	RLC
	MOV	C,A
	RRC
	RET
;
SHFT:	ORA	C
	ORA	B
	XCHG
	MOV	M,A
	XCHG
	RET
;
;
	.PAGE
;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
;
IN1:	RRC	;THIS CODE IS DEPENDANT ON
	RRC	;THE LAYOUT OF THE HEAD.
IN2:	RRC	;THIS CODE IS FOR A HEAD
	RRC	;WITH BIT 7 ON THE TOP.
IN3:	RRC
	RRC
PUTIN:	XCHG
	ORA	M
	MOV	M,A
	INX	H
	XCHG
	RET
;
CVERT2:	MOV	A,M
..L1:	RLC
	DJNZ	..L1
CVERT:	ANI	88H
	MOV	B,A
	RLC
	RLC
	RLC
	ORA	B
	ANI	0C0H
	RET
;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
	.PAGE
;
;THE FOLLOWING CODE IS DEPENDANT ON
;THE ACTUAL ESCAPE CODES USED
;	
SETPRN:	LXI	H,SETSTR
SNDSTR:	MOV	B,M
	INX	H
..L1:	MOV	C,M
	INX	H
	CALL	LIST
	DJNZ	..L1
	RET
;
SCRL8:	MVI	C,LF
	JMP	LIST
;	
HIRES:	LXI	H,GRFSTR
	JMP	SNDSTR
;	
RETURN:	MVI	D,"6"
	CALL	ESCOUT
	MVI	B,"2"
	CALL	ESCOD
	MVI	C,LF	
	CALL	LIST
	JMP	RETVAL	;RETURN TO EXECUTIVE
			;MODULE
;
;END OF PRINTER DEPENDANT CODE
;############################################
	.PAGE
;	
;	PUT UP PRINTER NAME ON MENU
;
DUMPMS:	.BYTE	HOM,ESC,"S","1",ESC,"U",HLBOLD
	.ASCII	" MANNESMANN "
	.BYTE	ESC,"S","0",ESC,"=",23+20H,80+0A0H
;
;
PRNPNT:	.BLKW	1
DUBFLG:	.BYTE	0					
CHAR:	.BLKB	1
COL:	.BLKW	1
GRFY:	.BYTE	239
BYTES:	.BLKB	4
TEXBYT:	.BLKB	6
PRNBYT:	.BLKB	8
;
	.LOC	BASE+1800H+5FFH	;CHARACTER GENERATOR TABLE START
;	
CHRTBL:	.BLKB	2560	;CHARACTER GENERATOR ROM IMAGE
;
LSTBYT	=	.
;
	.LOC	BASE+1800H-320
;
GRFBUF:	.BLKB	80
	.BLKB	80
ATTBUF:	.BLKB	80
DSPBUF:	.BLKB	80
;
	.END
UINSTALLCOM           xфХ+Q  UNIFORM DAT           xфаЂ еDEL    COM           |±tћ;   ARC     DOC           ЂЂ4џ;Щ ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее100 REM ***********************************************************************
110 REM *                                                                     *
120 REM * Name: MAP                                                           *
130 REM * Rev.: 1.0                                                           *
140 REM * Date: May 14, 1982                                                  *
150 REM *                                                                     *
160 REM * Desc: Graphics / Text Demo: Map of Southwestern Sales Region        *
170 REM *                                                                     *
180 REM *                                                                     *
190 REM ***********************************************************************
200 REM 500=POINT PLOT
210 REM 501=VECTOR PLOT
220 REM 503=END OF LIST
230 REM ANY OTHER NUMBERS ARE TREATED AS X,Y PAIRS
240 REM
250 DEFINT X,Y,C,L,N
260 RESTORE
270 GRAPH: REM CLEAR GR & TEXT - ENABLE GR
M
61520 REM	SCREEN - 5 - BAR GRAPH DEMO
61530 REM
61540 DATA 0 : REM 0 LINES
61550 REM LINE 1
61600 REM
61610 REM
61620 REM	SCREEN - 6 - LINE GRAPH DEMO
61630 REM
61640 DATA 0 : REM 0 LINES
61650 REM LINE 1
61700 REM
61710 REM
61720 REM	SCREEN - 7 - TWIL DEMO
61730 REM
61740 DATA 0 : REM 0 LINES
61750 REM LINE 1
61800 REM
61810 REM
61820 REM	SCREEN - 8 - WP DEMO
61830 REM
61840 DATA 13 : REM 13 LINES
61850 DATA 1,2,7,0,1,36,1,1
61851 DATA "A T T A C H E  with WORDSTAR-PLUS"
61852 DATA 1,1,33,0,0,64,0,0
61853 DATA "tm"
61854 DATA 1,1,73,0,0,64,0,0
61855 DATA "tm"
61856 DATA 1,6,21,0,0,32,0,0
61857 DATA "WORDSTAR-PLUS - EASY TO LEARN AND PERFORMS"
61858 DATA 1,8,21,0,0,32,0,0
61859 DATA "ALL OF YOUR  'WORD PROCESSINGS'  FUNCTIONS"
61860 DATA 1,12,15,0,0,34,0,0
61861 DATA           "A:ATTACHE  PAGE  5 LINE 22 COL 45"
61862 DATA 1,13,10,0,0,34,0,0
61863 DATA "L----!----!----!----!----!----!----!----!----!----!----!----!---R"
61866 DATA 1,14,10,0,0,32,0,0
61867 DATA "ATTACHE features  'WordStar-Plus'  word processing.  Our keyboard"
61868 DATA 1,15,10,0,0,32,0,0
61869 DATA "reference template makes it easier for you to learn and use Word-"
61870 DATA 1,16,10,0,0,32,0,0
61871 DATA "Star-Plus.   Formulating and arranging your ideas directly on the"
61872 DATA 1,17,10,0,0,32,0,0
61873 DATA "screen offers you the maximum in freedom and flexibility.   Enter"
61874 DATA 1,18,10,0,0,32,0,0
61875 DATA "your thoughts as they come to you; from the beginning, middle, or"
61876 DATA 1,19,10,0,0,32,0,0
61877 DATA "end.  Changes, additions, or deletions are easy with Attache.    <"
61900 REM
61910 REM
61920 REM	SCREEN - 9 - SPREADSHEET DEMO
61930 REM
61940 DATA 21 : REM 21 LINES
61950 REM LINE 1
61951 DATA 1,2,26,0,1,36,1,1
61952 DATA "A T T A C H E"
61953 DATA 1,1,52,0,0,64,0,0
61954 DATA "tm"
61955 DATA 1,5,16,0,0,32,0,0
61956 DATA "SUPPORTS CP/M BASED 'SPREADSHEET CALCULATORS' FOR"
61957 DATA 1,7,16,0,0,32,0,0
61958 DATA "YOUR BUSINESS AND FINANCIAL PLANNING REQUIREMENTS"
61959 REM
61960 DATA 1,10,10,0,0,32,0,0
61961 DATA  "   |         A        ||   B   ||   C   ||   D   ||   E   |"
61962 DATA 1,11,10,0,0,32,0,0
61963 DATA  " 1|"
61964 DATA 1,12,10,0,0,32,0,0
61965 DATA  " 2|"
61966 DATA 1,12,34,0,0,36,0,0
61967 DATA     "BALANCE  SHEET"
61968 DATA 1,13,10,0,0,32,0,0
61969 DATA  " 3|"
61970 DATA 1,14,10,0,0,32,0,0
61971 DATA  " 4|"
61972 DATA 1,14,13,0,0,36,0,0
61973 DATA      "                         Jan      Feb      Mar      Apr"
61974 DATA 1,15,10,0,0,32,0,0
61976 DATA  " 5|"
61977 DATA 1,15,13,0,0,36,0,0
61978 DATA     "ASSETS"
61979 DATA 1,16,10,0,0,32,0,0
61980 DATA  " 6|Receivables           1000.00  1200.00  1150.75  1475.25"
61981 DATA 1,17,10,0,0,32,0,0
61982 DATA  " 7|Inventory              750.00   875.00   750.55   525.30"
61983 DATA 1,18,10,0,0,32,0,0
61984 DATA  " 8|Cash on Hand           450.35   760.98  6637.48   345.56"
61985 DATA 1,19,10,0,0,32,0,0
61986 DATA  " 9|"
61987 DATA 1,19,13,0,0,36,0,0
61988 DATA     "--------------------------------------------------------"
61989 DATA 1,20,10,0,0,32,0,0
61990 DATA  "10|"
61991 DATA 1,20,13,0,0,36,0,0
61992 DATA     "Total Assets"
61993 DATA 1,20,35,0,0,32,0,0
61994 DATA                           "2200.35  2835.98  8538.78  2346.11"
62000 REM
62010 REM
62020 REM	SCREEN - 10 - CLOSING MESSAGE
62030 REM
62040 DATA 6 : REM 6 LINES
62050 REM LINE 1
62061 DATA 1,6,6,0,1,32,0,0
62062 DATA "THANKS YOU"
62063 DATA 1,9,14,0,1,32,0,0
62064 DATA "FOR LOOKING AT"
62065 DATA 1,12,22,0,1,32,0,0
62066 DATA "A T T A C H E"
62067 DATA 1,11,48,0,0,64,0,0
62068 DATA "tm"
62069 DATA 1,15,30,0,1,33,0,0
62070 DATA "THE EXECUTIVE COMPUTER"
62071 DATA 1,14,74,0,0,64,0,0
62072 DATA "tm"
65000 RETURN
69 DATA 1,15,30,0,1,33,0,0
620                                                                                                                                                                                                                                                                щ: Й6я+6я}юТ%.6я+6X+6E+: w+: w+6Геъяе* СНбгйЦН—Г»‡Н—Г»«Н—Г»кН—*НќГяYН—Гя·Н—ЛН—ГяmН—Г»ю|Ию`Ъ™ю{Т=Ц ю@Т¶ю:Ию?Ию$Ию.Ию#Ию<Ию>ИГ=Ц@РГ=ю$Ию^Ию|Ию1ЪOю:ТOЦ1‡2Хе!HюТэ_ ^#Vб{ІКэ·Кщw+ГоС#~Йе!4:юТF_ ^#Vб{ІКFГою Иw#ВЙе*%#"%!6 !+6 kb"#б",Йю ШжЂА:юЂИ:юЃИ:+<2+Й л"люКЏю Кbs#r#:ёЪXюКЏю В|ЇГbЇ>Й	Н Й~юИю ВЁ> #е_Н бГќН—Й3Н—*%НхНґ*#е~#юКЪюВО6 бНгГя~#·И_еНрбГгГ еХЕцяяя	Ъю
 	л|µДх{Ж0_Н БСбЙ~#ВЙХ_x±{СИw#Г#SUB error line # $
(ex already aresent)$
text buffer empty$
Input/EX Buffer Overlap$
No parameter or default parameter$
Parameter$
File filename.typ$ not there$
Control character$
Too many arguments - $EX 1.4   11-22-82$
$           яё ё                                                pppppppppppppppppppppppppppppppp                                                              б"|б"~"Ђ~юѓВ +"~2–1|* |Цg."‚* "„†НП*„л!„ НП1|*~~280 READ N
290 IF N=500 THEN P$="0":GOTO 280
300 IF N=501 THEN P$="1":GOTO 280
310 IF N=503 THEN GOTO 350
320 X=N:READ Y
330 GOSUB 520
340 GOTO 280
350 L=13:C=12:GOSUB 560:PRINT "CALIFORNIA"
360 L=9:C=22:GOSUB 560:PRINT "NEVADA"
370 L=10:C=37:GOSUB 560:PRINT "UTAH"
380 L=4:C=48:GOSUB 560:PRINT "WYOMING"
390 L=10:C=51:GOSUB 560:PRINT "COLORADO"
400 L=17:C=35:GOSUB 560:PRINT "ARIZONA"
410 L=16:C=52:GOSUB 560:PRINT "NEW"
420 L=17:C=51:GOSUB 560:PRINT "MEXICO"
430 L=1:C=2:GOSUB 560:PRINT CHR$(27);"S1SOUTHWESTERN SALES"
440 PRINT"         REGION";CHR$(27);"S0"
450 L=23:C=0:GOSUB 560
460 FOR PAUSE = 1 TO 12000 : NEXT
470 GRAPH A:GRAPH F:REM CLEAR TEXT & GR
480 INPUT "DISPLAY MAP AGAIN (Y/N) ";A$
490 IF A$ = "Y" OR A$ = "y" THEN 260
500 SYSTEM
510 REM  *** GRAPHICS DRIVER ***
520 IF P$ = "0" THEN PLOT (X,Y)
530 IF P$ = "1" THEN PLOT TO (X,Y)
540 RETURN
550 REM *** DIRECT CHARACTER POSITION ***
560 GRAPH L(L+1,C+1)
570 RETURN
580 REM ********************************
590 REM
600 REM TABLE VALUES
610 DATA 500,166,178,501,29,200,24,180,28,145,35,136,34,131
620 DATA 48,86,73,70,84,48,110,48,153,24
630 DATA 190,23,190,28,207,28,207,32,251,32
640 DATA 251,102,500,260,102,501,260,160,164,164,170,223
650 DATA 240,220,240,160,500,186,163,501,179,22,500,74,193
660 DATA 501,65,148,125,70,110,48,500,116,82,501,117,97
670 DATA 127,94,136,182,500,129,108,501,182,103,260,102,503
,74,193
660 DATA 501,65,148,125,70,110,48,500,116,82,501,117,97
670 DATA 127,94,136,182,500,129,108,501,182,103,26ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее.TITLE "---- OTRONA 503 SYSTEM MONITOR V[G] ----"
.SBTTL "COPYRIGHT 1983, OTRONA ADVANCED SYSTEMS CORP."
;
;|--------------------------------------|
;|    OTRONA 503 SYSTEM MONITOR V[HX]   |
;|          (FILE MON503.ASM)           |
;|--------------------------------------|
;
;	R.LINGEMANN 08/16/83	
;	S.GRAY
;	L.LOVELACE
;
;|-------------------|
;|	 SET-UP	     |
;|-------------------|
;
BASE	=	0
;
	.LOГ	BASE
;
STACK	=	0FE00H
;
	.PABS
	.PHEX
;
;	LIST CONTROL
;
	.PRNTX "LIST CONTROL (0=OFF, 1=ON)"
;
LSTDEF	=	\"  DEFINITIONS       "
LSTINI	=	\"  INITIALIZATION    "
LSTMTR	=	\"  MONITOR           "
LSTSUB	=	\"  GP & IO SUBROUTINES "
LSTDSK	=	\"  DISK ROUTINES     "
LSTDSP	=	\"  DISPLAY DRIVER    "
LSTINT	=	\"  INTERRUPT ROUTINES"
LSTTBL	=	\"  TABLES            "
LSTRAM	=	\"  RAM AREA          "
;
;	SELECT DISK CONFIGURATION
;
DBL	=	1	;DENSITY (0=SINGLE, 1=DOUBLE)
FILSIZ	=	(DBL+1)*256
SECS	=	1	;SECTORS (0=9, 1=10)
SIDES	=	1	;SIDES   (0=SINGLE, 1=DOUBLE)
FILBUF	=	0FE00H	; LOCATION OF DISK BUFFER
;
	.IFE	LSTDEF,[
	.XLIST
]
;
;|----------------------|
;|	CONSTANTS	|
;|----------------------|
;
;	ASCII CODES
;
BEL	=	7H	;BELL
BS	=	8H	;BACKSPACE
CR	=	0DH	;CARRIAGE RETURN
CTRLJ	=	0AH	;CTRL-JЉCTRLJH	=	0C8H	;CTRL-JH
CTRLK	=	0BH	;CTRL-K
CTRLO	=	0FH	;CTRL-O
CTRLP	=	10H	;CTRL-P
CTRLPS	=	0D3H	;CTRL-PS
CTRLQ	=	11H	;CTRL-Q
CTRLQP	=	90H	;CTRL-QP
CTRLS	=	13H	;CTRL-S
CTRLX	=	18H	;CTRL-X
ESC	=	1BH	;ESCAPE
FF	=	0CH	;FORM FEED
LF	=	0AH	;LINE FEED
SPC	=	20H	;SPACE
;
;	I/O PORTS
;
STAT86	=	0B8H	; 8086 PORT STATUS
DATA86	=	0B9H	; 8086 PORT DATA
FPYBCA	=	0E0H	;FLOPPY BASE & CURRENT ADDRESS
FPYBWR	=	0E1H	;FLOPPY BASE & WORD COUNT
DSPBCA	=	0E2H	;DISPLAY BASE & CURRENT ADDRESS
DSPBWR	=	0E3H	;DISPLAY BASE & WORD COUNT
STDBCA	=	0E4H	;STD BUS BASE & CURRENT ADDRESS
STDBWR	=	0E5H	;STD BUS BASE & WORD COUNT
SIOBCA	=	0E6H	;SIO BASE & CURRENT ADDRESS
SIOBWR	=	0E7H	;SIO BASE & WORD COUNT
DMACSR	=	0E8H	;DMA COMMAND/STATUS REGISTER
DMAWRR	=	0E9H	;DMA WRITE REQUEST REG;************************************************
;*                                              *
;*           GRAPHIC PRINTING ROUTINE           *
;*                AXIOM PRINTER                 *
;************************************************
;
	.PABS
	.PHEX
	.XSYM
;
BASE	=	2000H
;
	.LOC	BASE+1800H
;
	JMP	DUMPS
;
HOM	=	1EH
HL	=	22H
HLBOLD	=	26H
SPC	=	20H
ESC	=	1BH
CR	=	0DH
LF	=	0AH
SPRTR	=	0F3H
DPRTR	=	0F2H
SDSPY	=	0EEH
DDSPY	=	0FEH
CONIN	=	BASE+9
CONOUT	=	BASE+6
VALDSP	=	BASE+6
DUMPMN	=	BASE+64H
LINOFS	=	BASE+6DH
LINDSP	=	BASE+21H
VALMSG	=	BASE+24H
RETVAL	=	BASE+0CH
BADKEY	=	BASE+37H
SOUND	=	BASE+1EH
GETDMP	=	BASE+6FH
OUTBLK	=	BASE+72H
CONST	=	BASE+7BH
;	
DUMPS:	MVI	A,239
	STA	GRFY
	CALL	LINDSP
	MOV	A,B
	STA	LINOFS
	XRA	A
	STA	DUBFLG
	MOV	H,A
	MOV	L,B
	SHLD	COL
;
DUMPS1:	LHLD	DUMPMN
	CALL	VALMSG
	LXI	H,DUMPMS
	CALL	VALMSG
	CALL	GETDMP
	CPI	LF	
	JRNZ	NLF
	CALL	LIST
	JMPR	DUMPS1
NLF:	CPI	ESC
	JZ	RETVAL
	ORA	A
	JZ	QIKTEX
	CPI	4
	JZ	RETVAL
	PUSH	PSW
	CALL	SETPRN
	POP	PSW
	DCR	A
	JZ	DUMPTX
	DCR	A
	JZ	DUMPGR
	JMP	DUMPAL
;
ESCOUT:	MVI	C,ESC
	CALL	CONOUT
	MOV	C,D
	JMP	CONOUT
;
;
LIST:	MOV	C,A
..L1:	MVI	A,10H
	OUT	SPRTR
	IN	SPRTR
	ANI	24H
	CPI	24H
	JRNZ	..L1
	MOV	A,C
	OUT	DPRTR
	RET
;
;
QIKLIN:	MVI	B,80
	LXI	H,DSPBUF
	JMP	OUT42+5
;
;
QIKTEX:	MVI	A,CR
	CALL	LIST
	MVI	B,24
..Z1:	PUSH	B
	LXI	H,DSPBUF
..L1:	PUSH	H
	CALL	REDTEX
..L2:	PUSH	PSW
	LDA	CHAR
	CPI	7FH
	JRNC	..N2
	CPI	20H
	JRNC	..N1
..N2:	MVI	A,"*"
	STA	CHAR
..N1:	POP	PSW
	BIT	4,A	;DOUBLE WIDTH
	JRZ	..NODB	
	INR	H
	XTHL
	MVI	M,20H	;REPLACE 1ST CHAR
	INX	H	;WITH A SPACE
	XTHL
..NODB:	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A
	INX	H
	MOV	A,B	
	CPI	80
	JRC	..L1
	CALL	INCOL	;RETURNS ZERO IF BLANK 
 	CNZ	QIKLIN	;LINE
	MVI	A,CR
	CALL	LIST	
	MVI	A,LF
	CALL	LIST
	CALL	CONST
	JRZ	..NN1
	CALL	CONIN
	POP	B
	CPI	ESC
	JRZ	ETX
	PUSH	B
..NN1:	POP	B
	DJNZ	..Z1
ETX:	MVI	A,LF
	CALL	LIST
	JMP	RETVAL
;
;
GRFLIN:	LDA	GRFY
	MOV	D,A
	XRA	A
	MOV	B,A
	MVI	C,DDSPY
	LXI	H,GRFBUF
..L2:	MVI	E,3	
..L1:	MOV	A,D
	PUSH	H
	PUSH	B
	CALL	LINDSP
	POP	B
	POP	H
	OUT	SDSPY
	INP	A
	MOV	M,A
	INX	H
	DCR	D
	DCR	D
	DCR	E
	JRNZ	..L1
	INR	B
	MOV	A,B
	CPI	80	
	JRZ	RETG
	MOV	A,D
	ADI	6
	MOV	D,A
	JMPR	..L2
RETG:	MOV	A,D
	STA	GRFY
	LXI	H,GRFBUF
..L2:	MVI	B,240	
..L1:	MOV	A,M
	ORA	A
	JRNZ	PRNGRF
	INX	H
	DJNZ	..L1
	JMPR	DON
;
;
PRNGRF:	CALL	HIRES
	LXI	H,GRFBUF
	MVI	B,80
..L1:	LXI	D,BYTES
	PUSH	B
	LXI	B,3	
	LDIR
	PUSH	H
	CALL	OUT4
	POP	H
	POP	B
	DJNZ	..L1
DON:	MVI	A,CR
	JMP	LIST
;
;
;
OUT4:	PUSH	D
	CALL	MAKE
	LXI	H,PRNBYT
	MVI	B,4
..L1:	MOV	A,M
	CALL	LIST
	MOV	A,M
	CALL	LIST
	INX	H
	DJNZ	..L1
	POP	D
	RET
;
;
OUT42:	MVI	B,8	
	LXI	H,PRNBYT
..L1:	MOV	A,M	
	CALL	LIST
	INX	H
	DJNZ	..L1
	RET	
;
;
ZROPRN:	LXI	H,PRNBYT
	SHLD	PRNPNT
	XRA	A
	MVI	B,8	
..L1:	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
ESCOD:	MVI	A,1BH
	CALL	LIST
	MOV	A,B
	JMP	LIST
;
;
GETTEX:	LXI	H,DSPBUF
	LXI	D,ATTBUF
..L1:	PUSH	H
	PUSH	D
	CALL	REDTEX
	POP	D	;SAVE ATTRIBUTE
	XCHG
	MOV	M,A
	XCHG
	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A	
	INX	H
	INX	D
..L4:	MOV	A,B
	CPI	80	
	JRC	..L1
	RET
;
TEX6:	CALL	GETTEX
	CALL	CHKLIN
	JRNZ	DOLIN
	RET
;
TEX4:	LHLD	COL
	MVI	H,0
	SHLD	COL
	CALL	GETTEX
	CALL	INCOL
	JRNZ	LIN2
	RET
;
TEXLIN:	CALL	TEX6
	CALL	SCRL6
	JMPR	TEX4
;
REDTEX:	LHLD	COL
	MOV	A,L
	ORI	0E0H
	MOV	E,A
	OUT	SDSPY
	MOV	B,H
	MVI	C,DDSPY
	INP	A
	STA	CHAR
	MOV	A,E	
	ANI	0DFH
	OUT	SDSPY
	ANI	1FH
	MOV	L,A
	INP	A
	RET
;
;
INCOL:	LHLD	COL
	INR	L
	MOV	A,L
	CPI	24
	JRNZ	..L2
	MVI	L,0
..L2:	XRA	A
	MOV	H,A
	SHLD	COL	;FALL	IN
;
;
CHKLIN:	MVI	B,80		;CHECK FOR EMPTY LINE
	LXI	H,DSPBUF
..L3:	MOV	A,M
	CPI	20H
	RNZ	
	INX	H
	DJNZ	..L3	
	RET
;	
;
SETLIN:	CALL	HIRES
	LXI	H,DSPBUF
	LXI	D,ATTBUF
	MVI	B,80
	RET
;
DOLIN:	CALL	SETLIN
..L1:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR	
	CALL	MAKE
	SDED	PRNPNT
	INX	H
	CALL	MAK9	
	CALL	OUT42
	POP	D
	POP	H
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	JMP	DON
;
LIN2:	CALL	SETLIN
..L2:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE2
	SDED	PRNPNT
	INX	H
	CALL	MAC4+9
	CALL	OUT42
	POP	D
	POP	H
	INX	D
	INX	H
	POP	B
	DJNZ	..L2
	JMP	DON
;
;
FINDCR:	LXI	H,CHRTBL
	MOV	E,A
	MVI	D,0
	MVI	B,10
..L1:	DAD	D
	DJNZ	..L1
	LXI	B,10
	LXI	D,BYTES
	LDIR
	RET
;
MAKE2:	CALL	ZROPRN
	LXI	H,BYTES+6	
	LXI	D,PRNBYT
	JMP	MAC4+9
;
GETCHR:	CALL	FINDCR
	POP	H
	XTHL
	MOV	A,M
	ANI	0FEH
	XTHL
	PUSH	H
	RZ		;FALL IN
;
	.PAGE
;###################################
;	START OF PRINTER CODE
;
;ATTFIX DEPENDS ON THE CHRGRF TABLE USED
;
;THIS CODE IS FOR CHRGRF2.TAB
;
;
ATTFIX:	MOV	C,A
	BIT	4,A
	CNZ	DUBFIX
	MOV	A,C
	BIT	3,A
	CNZ	BLDFAC
	MOV	A,C
	BIT	5,A	;UNDERLINE
	CNZ	UNDLIN
	MOV	A,C
	BIT	6,A
	JRZ	..L1
	BIT	7,A
	JRNZ	STRKTH
	CALL	SUPSCR	;SUPERSCRIPT
	JMPR	REVRS
..L1:	BIT	7,A
	CNZ	SUBSCR	;SUBSCRIPT
	JMPR	REVRS
STRKTH:	LXI	H,BYTES+2	;STRIKE THROUGH
	CALL	FF
	LXI	H,BYTES+5
ISTER
DMAWSM	=	0EAH	;DMA WRITE SINGLE MASK BIT
DMAWMR	=	0EBH	;DMA WRITE MODE REGISTER
DMACBP	=	0ECH	;DMA CLEAR BYTE PNTR FLIP-FLOP
DMATMP	=	0EDH	;DMA TEMP REG. & MASTER CLEAR
SDSPY	=	0EEH	;DISPLAY COMMAND REGISTER
DMAWAM	=	0EFH	;DMA WRITE ALL MASK REG. BITS
DCOMM	=	0F0H	;COMMUNICATIONS PORT DATA
SCOMM	=	0F1H	;COMMUNICATIONS PORT COMMAND/STATUS
DPRTR	=	0F2H	;PRINTER PORT DATA
SPRTR	=	0F3H	;PRINTER PORT COMMAND/STATUS
BAUDC	=	0F4H	;BAUD TIMER FOR COMM PORT
BAUDP	=	0F5H	;BAUD TIMER FOR PRINTER PORT
DSPINT	=	0F6H	;DISPLAY INTERRUPT (60 HZ.)
FPYINT	=	0F7H	;FLOPPY INTERRUPT TIMER
DPIOA	=	0F8H	;PIO PORT A DATA
			;  A0-7 = LATCH DATA OUT
			;	L0 = /MOTOR ON
			;	L1 = MINI/FULL
			;	L2 = /EPROM ENABLE
			;	L3-7 = DISPLAY BRIGHTNESS  
			;  A0-7 = 8910 DATA I/O
			;  A0-3 = 5832 D0-3 I/O
			;  A4-7 = 5832 A0-3 OUT
			;  A0-3 = 5101 D0-3 I/O
			;  A4-7 = 5101 A0-3 OUT
DPIOB	=	0FAH	;PIO PORT B DATA
			;  B0-1 = 5101 A4-5
			;  B2-4 = OPERATION SELECT
			;	0 = 8910 ADDRESS LOAD
			;	1 = 8910 DATA LOAD
			;	2 = 5832 WRITEЉ			;	3 = 5832 READ
			;	4 = 5101 WRITE
			;	5 = 5101 READ
			;	6 = LATCH LOAD
			;	7 = NO-OP
			;  B5 = /OPERATION STROBE
			;  B6 = /KEYBOARD DATA IN
			;  B7 = /KEYBOARD CLOCK OUT
SPIOA	=	0F9H	;PIO PORT A COMMAND
SPIOB	=	0FBH	;PIO PORT B COMMAND
SFLPY	=	0FCH	;FLOPPY COMMAND/STATUS
DFLPY	=	0FDH	;FLOPPY DATA
DDSPY	=	0FEH	;DISPLAY DATA
DMAP	=	0FFH	;RAM VIRTUAL MAP DATA
;
;	CONTROL VALUES
;
TIMCW0	=	57H	;TIMER CONTROL BYTE
TIMTC0	=	2	;9600 BAUD
TIMTC1	=	16	;1200 BAUD
LINES	=	24	; # OF LINES IN DISPLAY
RDA	=	1	; RECEIVE DATA AVAIL. 1 = N.F.G
TBE	=	2	; TRANSMIT BUFFER EMPTY 2 = N.F.G.
TSTRAM	=	0F8H	; TEST 8086 RAM
TSTGPO	=	0F9H	; TEST GPIB OUT
TSTGPI	=	0FAH	; TEST GPIB INPUT
TSTSER	=	0FBH	; TEST 8086 SERIAL LOOP
;
;	FLOPPY PARAMETERS
;
HLT	=	8	;HEAD LOAD TIME
HUT	=	0FH	;HEAD UNLOAD TIME
ND	=	0	;DMA MODE
SRT	=	10	;STEP RATE = 12 MS
MTRTIM	=	300	;5S MOTOR TIMEOUT FOR TESTING ONLY
MTRDLY	=	45	;750MS. MOTOR START DELAY
;DISK ERROR CODES
; 
;  1 = W765 TIMEOUT IN DISKOP
;  2 = R765 TIMEOUT IN DISKOP
;  3 = DISKOP INTERRUPT TIMEOUT
;           
	.LIST
	.IFE	LSTINI,[
	.XLIST
]
;
	.PAGEЉ;
;|-------------------------|
;|	INITIALIZATION	   |
;|-------------------------|
;
;	VECTORS (USED BY SECONDARY BOOT ROUTINES)
;
	JMP	INIT	;INIT
	JMP	GOMON	;MONITOR
	JMP	DISKOP	;FLOPPY DRIVER
	JMP	DISPLY	;DISPLAY DRIVER
	JMP	ERROR	;DISK ERROR
;
; ------ ADD OTHER VECTORS HERE ------
;
;	SIGN-ON MESSAGE
;
SIGNON:	.BYTE	ESC
       	.ASCII	'JOTRONA ATTACHE [X]'   
	.BYTE	CR,LF+80H
;
SIGNLN	=	.-SIGNON
;
;	SET UP ALL I/O VIA TABLE
;
INIT:	DI
	LXI	H,IOTBL	;POINT TO I/O TABLE
..L1:	MOV	A,M
	MOV	C,A	;C=PORT
	INR	A	;JUMP OUT IF DONE
	JRZ	CPUTST
	INX	H	;B=COUNT
	MOV	B,M
	INX	H
..L2:	MOV	A,M	;MANUAL BLOCK OUTPUT
	OUTP	A	;  SO SLOW DEVICES
	INX	H	;  CAN KEEP UP
	DJNZ	..L2
	JMPR	..L1
;
;	TEST CPU REGISTERS
;
CPUTST:	MVI A,0FFH	;MAIN SET
	STC
	STAI
	LDAI
..L1:	MOV	B,A
	MOV	C,B
	MOV	D,C
	MOV	E,D
	MOV	L,E
	MOV	H,L
	EXAF		;ALTERNATE SET
	MOV	A,H
	EXX
	MOV	B,A
	MOV	C,B
	MOV	D,C
	MOV	E,D
	MOV	L,E
	MOV	H,L
	EXAF
	MOV	A,H
	JRNC	CPU1
	CMA
	ANA	A	;FF PATTERN OK?
	JRZ	..L1	;--IF SO, TRY ZEROESЉCPUERR:	HLT		;--ELSE ERROR														
CPU1:	JRNZ	CPUERR
	ORA	A	;ERROR IF NOT ZERO
	JRNZ	CPUERR
	LXI	X,0FFFFH ;INDEX & SP REGISTERS
	SPIX
	DAD	SP
	XCHG
	LXI	Y,0FFFFH
	SPIY
	DAD	SP
	DAD	D
	JRNC	CPUERR
	INX	H
	LXI	X,0
	SPIX
	DAD	SP
	XCHG
	LXI	Y,0
	SPIY
	DAD	SP
	DAD	D
	INX	H
	MOV	A,H
	XRA	L
	JRNZ	CPUERR
;
;	TEST CPU FLAGS
;
	MVI	A,40H
	ADD	A	;SET V & S, CLEAR C & Z
	JRZ	CPUERR
	JRC	CPUERR
	JP	CPUERR
	JPO	CPUERR
	ADD	A	;COMPLEMENT C, S, & Z
	JRNZ	CPUERR
	JRNC	CPUERR
	JM	CPUERR
	ORI	1	;COMPLEMENT V
	JPE	CPUERR
	MVI	A,9	;CHECK H & N FLAGS
	ADI	1
	DAA
	CPI	10H
	JRNZ	CPUERR
	SBI	1
	DAA
	CPI	9
	JRNZ	CPUERR
;
;	MAP MEMORY
;
	LXI	SP,STACK
	LXI	H,STDMAP
	LXI	X,.+7
	JMP	MAP
;
;	TEST START BLOCK (RAM FD00-FDFF)Љ;	 & SET TO ZERO
;
RAMCHK:	LXI	H,0FD00H
..L1:	MVI	C,0FFH
..L2:	MOV	M,C
	MOV	A,C
	XRA	M
	JNZ	MEMERR
	SLAR	C
	JRC	..L2
	INR	L
	JRNZ	..L1
;
;	SET INITIAL VALUES
;
	CMA
	STA	SHLOCK
	MVI	A,0C0H	;SET LSTATE
	STA	LSTATE
;
;	REINITIALIZE DISPLAY IF 50 HZ
;
	MVI	D,2
	CALL	RDCMOS
	MOV	A,C
	CPI	9	
	JRNZ	..J0
	MVI	A,0A4H
	OUT	SDSPY
	MVI	A,29
	OUT	DDSPY
	MVI	A,0A5H
	OUT	SDSPY
	MVI	A,37
	OUT	DDSPY
;
;	SEE IF 8086 PORT O.K.
;
..J0:	MVI	A,1	; SET UP PORT
	OUT	STAT86
	XTHL		; WASTE TIME
	XTHL
	XRA	A	; CLEAR PORT
	OUT	STAT86
	IN	DATA86
;
	LXI	B,250*256 ; SEE IF 8086 IS TALKING
..L0:	IN	STAT86
	ANI	RDA	; IF NO BYTE	
	JRNZ	..J1	;  THEN ..J1
	IN	DATA86	; ELSE GET BYTE
	SUI	0F0H	; IF <> 0F0H
	JRZ	..J2	;  THEN KEEP TRYING
;
..J1:	DCR	C	; DECREMENT LOOP
	JRNZ	..L0	
	DCR	B	; IF LOOP NOT DONE
	JRNZ	..L0	;  THEN ..L0
;
	MVI	A,0FFH	; ELSE 8086 NOT THERE
..J2:	STA	FLAG86	; 0 = O.K., <> 0 = N.F.G.
;
;	SET UP INTERRUPT SYSTEM
;
	MVI A,V60HZ/256	;SET TO USE INTERNAL DISPLAY						
	STAI		;  & SET VECTOR AREA
	IM2		;MODE 2
	EI		;INTERRUPTS ON
;
;	SIG	CALL	FF
REVRS:	MOV	A,C
	BIT	1,A	;REVERSE VIDEO
	JRNZ	REVID	
	RET
;
REVID:	MVI	B,10
	LXI	H,BYTES
..L1:	MOV	A,M
	CMA
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
BLDFAC:	LXI	H,BYTES
	MVI	B,10
..L1:	MOV	A,M
	ANI	77H	;CHANGED FROM 07H
	RAL
	ORA	M
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
;
UNDLIN:	LXI	H,BYTES+9
	CALL	FF
	DCX	H
	DCX	H
FF:	MVI	A,0F0H	
	ORA	M
	MOV	M,A
	RET
;
SUPSCR:	PUSH	D
	LXI	H,BYTES
	MVI	B,2	
..L1:	CALL	SHIFT
	DJNZ	..L1
	LXI	H,BYTES+6
	PUSH	H
	CALL	SHFRGT
	MOV	D,A
	LXI	H,BYTES+2	
	CALL	SHFLFT
	ORA	D
	MOV	M,A
	POP	H
	CALL	SHIFT
	XRA	A
	MOV	M,A
	LXI	H,BYTES+3
	MVI	B,2	
..L2:	CALL	SHIFT
	DJNZ	..L2
	LXI	H,BYTES+8
	PUSH	H
	CALL	SHFRGT
	MOV	D,A
	LXI	H,BYTES+5
	CALL	SHFLFT
	ORA	D
	MOV	M,A
	POP	H
	CALL	SHIFT
	JMPR	SCRDON
;
SHFLFT:	MOV	A,M
	RAL
	RAL
	RAL
	RAL
	ANI	0F0H
	RET
;
SHFRGT:	MOV	A,M
	RAR
	RAR
	RAR
	RAR
	ANI	0FH
	RET
;
SHIFT:	CALL	SHFLFT
	INX	H
	MOV	D,A
	CALL	SHFRGT
	ORA	D
	DCX	H
	MOV	M,A
	INX	H
	RET
;
SUBSCR:	PUSH	D
	LXI	H,BYTES+7
	CALL	SHIFT1
	LXI	H,BYTES+2
	PUSH	H
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+6
	CALL	SHFRGT
	ORA	D
	MOV	M,A
	POP	H
	MVI	B,2	
..L1:	CALL	SHIFT1
	DJNZ	..L1
	XRA	A
	MOV	M,A
	LXI	H,BYTES+9
	CALL	SHIFT1
	LXI	H,BYTES+5
	PUSH	H
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+8	
	CALL	SHFRGT
	ORA	D
	MOV	M,A
	MVI	B,2
	POP	H	
..L2:	CALL	SHIFT1
	DJNZ	..L2
SCRDON:	XRA	A
	MOV	M,A
	POP	D
	RET
;
SHIFT1:	CALL	SHFRGT
	MOV	D,A
	DCX	H
	CALL	SHFLFT
	INX	H
	ORA	D
	MOV	M,A
	DCX	H
	RET
;
DUBFIX:	PUSH	B
	PUSH	D
	PUSH	H
	LDA	DUBFLG
	ORA	A
	JRZ	HALF1
HALF2:	XRA	A
	STA	DUBFLG
	LXI	D,BYTES
	LXI	H,BYTES+3
	MVI	B,3	
	CALL	HALFDO
	XCHG		;D=BYTES+6
	LXI	H,BYTES+8
	MVI	B,2
	CALL	HALFDO
	JMPR	HFDON
;
HALFDO:	PUSH	B
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	HALFDO
	RET

HALF1:	CMA	
	STA	DUBFLG
	LXI	D,BYTES+3
	LXI	H,BYTES
	MVI	B,3	
	CALL	DOHALF
	XCHG		;H=BYTES+6
	LXI	D,BYTES+8
	MVI	B,2
	CALL	DOHALF
HFDON:	POP	H
	POP	D
	POP	B
	RET
;
DOHALF:	PUSH	B
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	DOHALF
	RET
;
STRCH:	MOV	A,M
	MOV	C,A
	ANI	44H
	RRC
	RRC
	MOV	B,A
	RLC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	88H
	RRC
	MOV	C,A
	RLC
	RET
;
STRCH1:	MOV	A,M
	MOV	C,A
	ANI	22H
	RLC
	RLC
	MOV	B,A
	RRC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	11H
	RLC
	MOV	C,A
	RRC
	RET
;
SHFT:	ORA	C
	ORA	B
	XCHG
	MOV	M,A
	XCHG
	RET
;
;THE FOLLOWING CODE IS DEPENDANT ON THE
;ACTUAL ESCAPE CODE AND ARRANGEMENT OF
;BITS ON THE PRINT HEAD
;
SETPRN:	MVI	B,"7"	;132 COLUMNS
	CALL	ESCOD
	MVI	B,"9"	;STOP ENHANCED PRINT
	CALL	ESCOD
	MVI	B,3BH	;CANCEL DOUBLE DENSITY
	JMP	ESCOD
;
;
DUMPAL:	MVI	D,"7"
	CALL	ESCOUT
	MVI	B,8
..L1:	PUSH	B
	CALL	TEX6
	CALL	GRFLIN
	CALL	SCRL6	
	CALL	TEX4
	CALL	GRFLIN
	CALL	SCRL4
	CALL	TEX6
	CALL	SCRL2
	CALL	GRFLIN
	CALL	SCRL4	
	CALL	TEX4
	CALL	SCRL2	
	CALL	GRFLIN
	CALL	SCRL2
	CALL	TEX6
	CALL	SCRL4
	CALL	GRFLIN
	CALL	SCRL2
	CALL	TEX4
	CALL	SCRL4
	POP	B
	DJNZ	..L1
	MVI	A,LF
	CALL	LIST	
	JMP	RETURN
;
DUMPTX:	MVI	B,24
..L1:	PUSH	B
	CALL	TEXLIN
	CALL	SCRL4	
	POP	B
	DJNZ	..L1
	JMP	RETURN
;
;
DUMPGR:	MVI	D,"7"
	CALL	ESCOUT
	MVI	A,239	;DUMP GRAPHICS ONLY
	STA	GRFY
	MVI	B,40	
..L1:	PUSH	B
	CALL	GRFLIN
	CALL	SCRL6
	POP	B
	DJNZ	..L1
	JMP	RETURN
;
SCRL2:	MVI	B,4
	JMPR	SCRLL
;
SCRL4:	MVI	B,8
	JMPR	SCRLL
;
SCRL6:	MVI	B,12
;
SCRLL:	PUSH	B
	CALL	CONST
	POP	B
	JRZ	..L2
	CALL	CONIN
	CPI	ESC
	JZ	RETURN
..L2:	PUSH	B
	MVI	B,">"
	CALL	ESCOD
	CALL	DON
	POP	B
	DJNZ	SCRLL
	RET
;
MAK9:	CALL	MAC4+9
	JMPR	MAKE1
;
MAKE:	CALL	MAC4
	JMPR	MAKE1
;
;
MAC4:	CALL	ZROPRN
	LXI	D,PRNBYT
	LXI	H,BYTES
	MOV	A,M
	CALL	CVERT
	CALL	PUTIN
	MVI	B,1
	CALL	CVRT20
	MVI	B,2
	CALL	CVRT20
	MVI	B,3
	CALL	CVRT20
	INX	H
	LDED	PRNPNT	
	MOV	A,M
	CALL	CVERT
	CALL	IN3
	MVI	B,1
	CALL	CVRT21
	MVI	B,2
	CALL	CVRT21
	MVI	B,3
	JMPR	CVRT21
;
MAKE1:	INX	H
	LDED	PRNPNT
	MOV	A,M
	CALL	CVERT
	CALL	IN2
	MVI	B,1
	CALL	CVRT22
	MVI	B,2
	CALL	CVRT22
	MVI	B,3
	CALL	CVRT22
	RET
;
CVRT20:	CALL	CVERT2	;FALL	IN
;
PUTIN:	RRC
	RRC
IN3:	RRC
	RRC
IN2:	RRC
	RRC
IN1:	XCHG
	ORA	M
	ANI	3FH
	MOV	M,A
	INX	H
	XCHG
	RET
;
	
;
CVRT21:	CALL	CVERT2
	JMPR	IN3	
;
CVRT22:	CALL	CVERT2
	JMPR	IN2
;
;
CVERT2:	MOV	A,M
..L1:	RLC
	DJNZ	..L1
CVERT:	ANI	88H
	RRC
	MOV	B,A
	RRC
	RRC
	RRC
	ORA	B
	ANI	0C0H
	RET
;
;
HIRES:	MVI	B,"8"	;ENHANCED
	CALL	ESCOD
	MVI	B,":"	;DOUBLE DENSITY
	CALL	ESCOD
	MVI	B,01CH	;GRAPHICS MODE
	CALL	ESCOD
	MVI	A,80
	JMP	LIST
;
RETURN:	CALL	SETPRN
	MVI	D,"6"
	CALL	ESCOUT
	MVI	A,LF
	CALL	LIST
	JMP	RETVAL
;
;END OF PRINTER DEPENDANT CODE
;###########################################
;
;	PUT UP PRINTER NAME ON MENU
;
DUMPMS:	.BYTE	HOM,ESC,"S","1",ESC,"U",HLBOLD
	.ASCII	"   AXIOM    "
	.BYTE	ESC,"S","0",ESC,"=",23+20H,80+0A0H
;
;
GRFY:	.BYTE	239
DUBFLG:	.BYTE	0
;
	.LOC	BASE+1800H+5FFH	;TABLE START
;
CHRTBL:	.BLKB	2560	;CHARACTER GENERATOR ROM IMAGE
;
LSTBYT	=	.
;
	.LOCN ON
;
	LXI	H,SIGNON
	CALL	MSSG
	JMP	BOOT
;
	.LIST
	.IFE	LSTMTR,[
	.XLIST
]
;
	.PAGEЉ;
;|----------------------|
;|	 MONITOR 	|
;|----------------------|
;
;	COMMANDS
;
;	BS	=	OPEN, DECREMENT, CLOSE	
;	CR	=	CLOSE
;	CTLR/LF =	GOTO TERMINAL MODE
;	LF	=	CLOSE, INCREMENT, OPEN
;	/	=	OPEN
;	SPACE	=	MOVE HL TO DE, CLEAR HL
;	G	=	DISPLAY TEST
;	H	=	ALPHA MEMORY TEST
;	I	=	JUMP
;	K	=	KEYBOARD ECHO
;	L	=	LOOP MODIFIER
;	M	=	MEMORY MAP
;	N	=	NOT USED
;	O	=	OUTPUT TO PORT 
;	P	=	FORMAT DISK
;	Q	=	CMOS RAM TEST
;	R	=	RAM TEST
;	S	=	SET BAUD AND PORT
;	T	=	CLOCK TEST
;	U	=	UNIFIED TEST
;	V	=	READ FROM FLOPPY
;	W	=	WRITE TO FLOPPY
;	X	=	TRANSMIT BLOCK OF DATA
;	Y	=	RECEIVE BLOCK OF DATA
;	Z	=	FLOPPY R/W TEST
;	[	=	8086 RAM TEST
;	\	=	8087 TEST
;	]	=	8086 SCC TEST
;	)	=	GPIB CONTROLLER TEST
;	(	=	GPIB TALKER/LISTENER TEST
;	#	=	8086 DEBUGGER
;
	.PAGE
;
;	SEND CRLF & @
;
MNTR:	MVI	C,CR
	CALL	CO
	MVI	C,LF
	CALL	CO
	MVI	C,'@'
	CALL	CO
	LXI	D,0
	SDED	SAVDE
MNTR2:	MVI	H,0	;CLEAR B,L,H
	MOV	L,H
	MOV	B,H
;
;	GET CHAR, MAKE UPPER CASE
;
GET:	CALL	ABTTST	;CHECK FOR ABORT
	LDA	FLGCMD	;MACRO IN PROGRESS?
	ORA	A
	JRZ	..J1
	PUSH	H
	LHLD	CMDPTR	;YES, PROCESS MACRO
	MOV	A,M
	INX	H
	SHLD	CMDPTR
	POP	H
	ORA	A	;--ZERO IS END OF MACRO
	JRNZ	..J4
	STA	FLGCMD
..J1:	LDA	FLGLOP	;LOOP IN PROGRESS?
	CPI	80H
	JRNZ	..J2
	LXI	H,CMDSTT ;--YES, RESET U POINTERS
	SHLD	CMDPTR
	LHLD	SAVHL2	;--& RESTORE FOR NEXT CYCLE
	LDED	SAVDE2
	LDA	SVCMD2
	JMPR	..J4
;
..J2:	CALL	CIKIN
..J4:	BIT	6,A	;MAKE UPPER CASE
	JRZ	ECHO
	RES	5,AЉECHO:	MOV	C,A
	CALL	CO
	STA	SAVCMD
;
	.PAGE
;
;	BS - CLOSE, DECREMENT, AND OPEN
;
CBS:	CPI	BS
	JRNZ	CCR
	XCHG
	XRA	A	;IF DATA FLAG, SAVE NEW DATA
	ORA	B
	JRZ	..J1
	MOV	M,E
..J1:	DCX	H
	JMPR	LFRET
;
;	CR - CLOSE LOCATION
;
CCR:	CPI	CR
	JRNZ	CESC
	XRA	A
	ORA	B
	JZ	GOMON
	XCHG	
	MOV	M,E
	JMP	GOMON
;
;	CTRL/LF - RETURN TO TERMINAL MODE
;
CESC:	CPI	86H
	JZ	GOTERM
;
;	LF - CLOSE, INCREMENT, AND OPEN
;
CLF:	CPI	LF
	JRNZ	CSLASH	
	XCHG	
	XRA	A	;IF DATA FLAG, SAVE NEW DATA
	ORA	B
	JRZ	..J1
	MOV	M,E
..J1:	INX	H	;INCREMENT ADDRESS
LFRET:	MVI	C,CR	;CRLF
	CALL	CO
	CALL	DSH	;DISPLAY NEW ADDRESS
	MOV	A,H
	MOV	H,L
	MOV	L,A
	CALL 	DSH
	MOV	A,L
	MOV	L,H
	MOV	H,A
	MVI	A,'/'	;FAKE A SLASHЉ	JMPR 	ECHO	
;
;	/ - OPEN AND DISPLAY
;
CSLASH:	CPI	'/'
	JRNZ	CSPC
SLASH:	MVI	B,0	;CLEAR DATA FLAG
	MOV	D,H	;SAVE IN D-E
	MOV	E,L
	MOV	H,M	;GET DATA
	CALL	DSH
	MVI	C,SPC
	CALL	CO
	MVI	H,0	;CLEAR HL
	MOV	L,H
	JMP	GET
;
;	SPACE - SAVE HL VALUE IN DE, CLEAR HL
;
CSPC:	CPI	SPC
	JRNZ	CGRAPH
	SHLD	SAVDE
	XCHG
	JMP	MNTR2
;
;	G - PRESENT DISPLAY TEST PATTERN
;	& PROVIDE CLOCK SET-UP OUTPUT
;
CGRAPH:	CPI	'G'
	JRNZ	CALPHA
;
;	DISPLAY TEST PATTERN
;
	MVI	C,1EH	;HOME
	CALL	DISPLY
	LXI	D,2175	;SET COUNT
	MVI	C,'+'
..L1:	CALL	DISPLY	;SEND A SCREENFUL
	DCR	E
	JRNZ	..L1
	DCR	D
	JRNZ	..L1
;
;	CLOCK SET-UP
;
	CALL	CLKID	;WHICH CLOCK
	BIT	7,D
	JRZ	..J1
	MVI	D,0CFH	;OKI, HOLD 1024 HZ
	CALL	RDCMOS	;  ON PIN 9
	MVI	A,88H
	OUT	DPIOB
..L2:	IN	DPIOB	;WAIT FOR KEY WITH
	BIT	6,A	;  INTERRUPT OFF
	JRZ	..L2
	EI
	JMP	ABORT
..J1:	MVI	D,4FH	;NATIONAL, SET 2 HZ
	CALL	RDCLK	;  ON PIN 13
	EIЉ	CALL	ABTTST	;WAIT FOR ABORT
	JMPR	..J1
;
;	H - TEST ALPHANUMERIC DISPLAY MEMORY
;
CALPHA:	CPI	'H'
	JNZ	CIN
;
	LDA	FLAG86	; IF NO 8086 BOARD
	ORA	A	
	JRNZ	..JE	; THEN ..JE
	MVI	A,0FDH	; ELSE TURN ON HI-RES GRAPHICS
	CALL	OUT86
	CALL	IN86
	CALL	IN86
;
..JE:	MVI	E,0
..L3:	MVI	C,DDSPY	;C = I/O POINTER
	MVI	D,80H	;TEST PATTERN
	MOV	A,E
	OUT	SDSPY	;LINE & FRAME
	MVI	B,0	;CHAR POS. 0
;
..L5:	INP	H	;GET CHARACTER
	OUTP	D	;SEND TEST PATTERN
	INP	A	;GET DATA BACK
	OUTP	H	;RESTORE CHARACTER
	CMP	D
	JRNZ	..JF
;
	LDA	FLAG86 
	ORA	A	; IF NO 8086
	JRNZ	..J0	;  THEN ..J0
;
	MOV	A,E	; ELSE
	ANI	0E0H
	CPI	90H	; IF NOT TESTING GRAPHICS
	JRNC	..J0	;  THEN ..J0
	MVI	A,80H	; ELSE TEST ODD SCAN OF GRAPHICS
	XRA	B
	MOV	B,A
	ANI	80H	; IF ALREADY TESTED
	JRZ	..J0	;  THEN ..J0
	JMPR	..L5	; ELSE TEST ODD SACN
;
;	REPORT FIRST ERROR OF EACH FRAME
;
..JF:	XRA	D	;D = DATA
	MOV	D,A
	MOV	A,E
	ANI	1FH
	MOV	H,A	;H = LINE
	MOV	A,E
	ANI	0E0H
	MOV	E,A	;E = FRAME
	MOV	L,B	;L = CHAR. POS.
	CALL	DSDATA
	JMPR	..J1
;
;	ROTATE PATTERN
;
..J0:	RRCR	D
	JRNC	..L5
	INR	B	;LINE DONE?
	MOV	A,B
	CPI	80
	JRNZ	..L5
	INR	E	; FRAME DONE?
;
	LDA	FLAG86	
	INR	A	;  FLAG86 = 0 OR 0FFH
	ADI	LINES	; A = 24 OR 25
	MOV	C,A
	MOV	A,E
	ANI	1FH
	CMP	C
	JRNZ	..L3
;
;	CHECK FOR NEXT FRAME
;
..J1:	MOV	A,E
	ANI	0E0H
..J2:	ADI	20H	;SET UP FOR NEXT BLOCK
	CPI	0A0H	; SKIP A0 RAM SEGMENT
	JRZ	..J2
	MOV	E,A
	ORA	A	; IF <> 0
	JRNZ	..L3	;  THEN DO NEXT
;
	LDA	FLAG86	; ELSE IF NO 8086 BOARD
	ORA	A
	JNZ	LOPTST	;  THEN EXIT
	MVI	B,0FEH	; ELSE TURN OFF
	JMP	DO86	;  HI-RES GRAPHICS
;
;	I - INPUT
;	FORMAT NNI WHERE NN IS THE PORT NUMBER
;
CIN:	CPI	'I'
	JRNZ	CJUMP
	MOV	C,LЉ	INP	H
	CALL	DSH
	JMP	LOPTST
;
;	J - JUMP AND EXECUTE (RETURNS TO MONITOR)
;
CJUMP:	CPI 	'J'
	JRNZ	CKYBD
	LXI	D,MNTR
	PUSH	D
	PCHL
;
	BASE+1800H-320
;
GRFBUF:	.BLKB	80
ATTBUF:	.BLKB	80
DSPBUF:	.BLKB	80
PRNPNT:	.BLKW	1
CHAR:	.BLKB	1
COL:	.BLKW	1
BYTES:	.BLKB	4
TEXBYT:	.BLKB	6
PRNBYT:	.BLKB	8
;
	.END
FOX     BAT           ќy~    VFAX    BAT           §°v¤     SFAX    BAT           Мz&%   AUTOEXECBAT           Ж†PИ   ASSETS  BAT           =|¤    DOT     BAT           €И!   LASER   BAT           1іq )   PRODIGY BAT           ЦxYџ"…   ИХ>рҐo СЙ}жИХ }жшoСЙ}жИ}жьoХ СЙ}жИ#Й~#В0ЙюaШю{Рж_Й:Ы_Н Н Д&Н0:Ж&Ц2яН "В&ЙНґ


   XF 1.0 By CDM -- File Transfer Program for CP/M -- 10/31/83
    A - Again retag files    |  B - Backup one file
    C - Copy file            |  D - Delete file
    E - Erase T/U files      |  F - Find file
    G - Go back  :=o& НЭНґ files    |  H - Hex dump a file
    J - Jump  :==o& НЭНґ files       |  L - Log-in drive/user
    K - Kill files           |  M - Mass copy (Tagged)
    N - Mass copy (Untagged) |  O - Mass Output
    P - Print text           |  Q - (Un)Squeeze tagged files
    R - Rename file(s)       |  S - Stat drive
    T - Tag file             |  U - Untag file
    V - View text file       |  W - Wildcard tag of files
    X - Exit to CP/M         |  Y - Set tagged file(s) attr.
                 <space>,<cr> advances one file

 Й)))) 'Й!\ е* лН^б·КЛЮ@Gяю:КХю*КЇЦ0Oю:КХх>Ж	OсЦ0ЃOю:КХ:Ы<w>яГШpy2 НCКю#ю*Во6?ГрwВЭНCКГф#6 Вюю.В.НCК.#ю*В6?Г wВНCК5Г$#6 В.#6 В7л" Й·Ию Ию=Ию_Ию.Ию:Ию;Ию<Ию>Й·Ию АГ^!В$ л!  yЕ¬g)Тѓ>¬g>!­oВwБлr$s%#ВmЙ:Щ·ИеЂ~Н¦#В›бЙЕе* л ЄO!В$	~«W$^л" бБЙ                                                               ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее               Ѓ^11g€g€       -RICKWINTER  E1  1€         BACKUP  AQM * љ1  1€         BACKUP  COM6  €Ю1  1€         BACKUP  HQXB  №¦1  1€         BIOS225 MSGS  Ї>1  1€         BIOS25  AQMX '‹Д1  Е„  J      BIOS25  HQXY »в1  2€         CCP     HQXШ; Tl1  2€         FORMAT  AQM нg1  2€         FORMAT  COM' ]01  2€         FORMAT  HQX-	 6х1  2€         SAVSYS  COM6 ҐA1  2€         SYSDUP  AQM< ўГ1  2€         SYSDUP  COMP ¦}1  2€         SYSDUP  HQXV	 n1  2€         SYSTEM  DOC_ 9F1  2€        я                               я                               я                               

	FAUG:

		Enclosed in a copy of the source code for the

CP/M 2.2.5 bios and the format, sysdup, and backup utilitys.

Please distribute copys to all ATTACHE user groups (and users) 

that would like them.  The assembler used was XASM (by TDL)

which we cannot provide.  It is not too difficult to change it
		
for other assemblers if needed. 


		There is also a basic program that shows the

difference in the sound escape codes from 2.2.3 to 2.2.5.

The changes were necessary to fix bugs in the original code.

The offset must be added so the BDOS does not interpet it as 

a control code and change it. (like expanding TABS to SPACES)



				Thank you

				Rick Winter
				Otrona Advanced Systems






Rick,


MANY THANKS FOR YOUR MANY KINDNESSES.  HERE YA' GO GANG!     

                                 Charles,  



vяљBACKUP.ASM J         
 	  ця    тяхя          ¬я  јяєяѕяУя ія¶яЇя­я«я     ·яІяЯя! °я" »я# Ся% $ & ЅяДяПяЭя' Ея±я№яОяЄя( ) ґяµяНяёя* ¦я+ §я©я- , / . 0 ѓяҐяЁя1 ЗяoяШя2 ТяМя3 4 Вя5 Фя6 Ля8 7 ЖяЙя9 Кя: Ия< ; њяья> = Чя? @ ЦяB A ЩяC БяD щяХяE ›яI G F H йябяыя†яРяќяеяъячяАяГяяюЌяряЈяђяPVоОj@*wDXE,v
уiЭ/€ЉЁњІ:Рj‹п§мРАYh*wDLNM uї юю€еdОj@*‡ў‡CМ'®ЁЊ1Е*b±У‹cш)
@Кў;ю8«eе~а¬ґњЂіР”КшУ§ZµСSмКкІ:љмсЧОj@ЛЙ иY(+чgµYяЎЧoЦа­2л?бkVЧщ¬я”џљХf5*·°1YМ*cсНjі‹Y4ЄСП^,bDХиf[…`ЖЁFy”ПВь@МХ,Лgб™t2ЄuШЏї|цЄ®QЌ6ЫЮ5ЄЩљПjіЋ¤+Јљќ=ЏY5Јъ;[‡F5Ъ¬6«Q№%=‹4D|ЉќМjіPVоАYHэљўH OхТ.BZmWбшњХЂІrG ООЦэ‚Hь^ЂVЌ<О:UІ_(OхО:сНО:UІai‚™YГgµY\u/ДUн)КаHСЎ§z¤GЏ©
yЦ8vчY“jv/ СПъЕ3яя‡ќ5©fчВўD?ыяVрSЭ°%ХY@vЦ¤љЭЛQ}Цџ(ћщя?ЯY“jv/Зъмяѕ‚џк†-©юdgэT7lIu4@vV›uЄdГу13kШЎб¬OР0?ђќuЄdГВv>kШЎб¬OРL:±Ђм¬OђљI§/ ;лЗ4“NhЂм¬OРL:d=лЗ4“N(ЩY'ћ ЩY§J6,‹Yњ5мРpЦЏ'и‹іИО:UІaA›5мРpЦЏ'и‹ИО:UІyyщ$bqЦ·§dТЮ;НjіPVоHЃіР—·Т‹	й"¤Єзdа¬”•;Rа¬6лTЙж…!ЉI§Y“j6)є5zSл‘28’®(“ъiЦ	vл|Ц8vwk43TДфbBє©к9НъП[Э/hЌ*ЮDz±ЁІ€ґY'Ш}ьеЦhKЇНъ†l‰‘¬СМР‹	й"¤Ё”™х'ЉgЋ­оњ5БU“Т­QЕ›HoЈЋ¤«Ym6¶є_PpЄdїPћкњuЄdутTWИ›хн)™ґчNіN•l^BД$ЁYЯћ’I{п4лЫSтЕYњхЩWЕtgэ9s«d5лІЫ»іюњ№UІљuЄdуВЕ¤У¬»­C†Пъ†l‰‘fэ‰в™яяrРі&ёjRє5Каxep$]НъCBфя‹!ія9(ш†lйJіюД3я?ДґFoЈќ^Ю.8k‚«о…XЈ™ЎЋ¤+К¤~ў!¶jЖИKъљљ5ЋЭЭҐ
SGТU™х'Љgю3ДҐЉ7‘^,Є,"Ќ*L!¦ПjіясЯћ’/ўfя_Д|{Jѕ8fэ!!ъ®ЖYm¶Е€ЈаJмоіL:ЎьT7| “Nі8ёћuАБх¬S%›—ЂЯEв¬oOЙ¤Ѕwљ5©fч‚nЦ·§d8л	С-Жпм%ЎЕ(8UІy	ш]$Оъц”LЪ{§Y§J6/u‡—„YЯћ’I{п4Ыbь
N•l^ZЊдќf}{J&нЅУl‹Mрн)щв,Оє‹Щ:dш¬oИ–ў4лO<sl–zЦ7d·wgэ9s«d5лІҐZљхзМ±Хэ‚іѕ!ыЄо¬?gn•;	K - KEYBOARD INPUT TO 500 DISPLAY
;	 ^ GETS BACK TO MONITOR
;
CKYBD:	CPI	'K'
	JRNZ	CLOOP
..L1:	CALL	CIKIN
	CPI	'^'
	JZ	GOMON
	MOV	C,A
	CALL	DISPLY
	MOV	H,A
	CALL	DSH
	CALL	SPACE
	JMPR	..L1
;
;	L - LOOP MODIFIER
;
CLOOP:	CPI	'L'
	JRNZ	CMAP
	MVI	A,0FFH
	STA	FLGLOP
	JMP	GOMON
;
;	M - MEMORY MAPPING TEST
;
CMAP:	CPI	'M'
	JRNZ	CN
	DI
	LXI	H,REVMAP ;REVERSE MAP
	LXI	X,.+7
	JMP	MAP
	LXI	H,0	;WRITE PATTERN
	MVI	B,7
..L1:	MOV	M,B
	MOV	A,H
	ADI	20H
	MOV	H,A
	DJNZ	..L1
	LXI	H,STDMAP ;RESTORE MAP
	LXI	X,.+7
	JMP	MAP
	EI
..J1:	LXI	H,2000H	;COMPARE
	MVI	B,1
..L2:	MOV	A,M
	CMP	B
	JRZ	..J2
	MOV	D,A	;PRINT ANY ERRORS
	MOV	A,H
	ORI	'0'
	MOV	C,A
	CALL	CO
	MOV	E,H
	MOV	H,D
	CALL	DSH
	MOV	H,E
..J2:	INR	B
	MOV	A,H
	ADI	20H
	MOV	H,A
	JRNZ	..L2
	JMP	LOPTST
;
;	N - 8086 UNIFIED TEST
;	    (8087 & RAM)
;
CN:	CPI	'N'
	JRNZ	COUT
	MVI	B,0F8H
	JMP	LOOP86
;
;	O - OUTPUT
; 	 FORMAT NNMMO WHERE NN IS THE PORT NUMBER
; 	 AND MM IS THE DATA TO SEND OUT
;
COUT:	CPI	'O'
	JRNZ	CP
	MOV	C,H
	OUTP	L
	JMP	LOPTST
;
;	P - FORMAT THE DISK IN A
; 	 SDP WHERE S=1 FOR 96TPI, ELSE 0
; 	 D=0 OR 1 CORRESPONDING TO DRIVE #
;
CP:	CPI	'P'
	JRNZ	CCMOS
	CALL	SELFMT
	JMP	GOMON
;
;	Q - CMOS RAM TEST (NON-DESTRUCTIVE)
;
CCMOS:	CPI	'Q'
	JNZ	CRAM	
	MVI	C,0
..L1:	CALL	RDCMOS	;D=LOC CNTR, E=OUT CODE
	MOV	L,C
	MVI	B,0
..L2:	MOV	C,B	;WRITE PATTERN
	CALL	WRCMOS
	CALL	RDCMOS	;READ BACK
	MOV	H,C	;RESTORE
	MOV	C,L
	CALL	WRCMOS
	EI
	MOV	A,H
	ANI	0FH
	XRA	B
	JRNZ	..E1	;JUMP OUT IF ERROR
	INR	B	;LOOP ON ALL PATTERNS
	MOV	A,B
	CPI	16
	JRNZ	..L2
	INR	D	;LOOP ON ALL ADDRESSES
	MOV	A,D
	CPI	64
	JRNZ	..L1
	JMPR	..E2
;
;	ERROR REPORT
;
..E1:	MOV	H,D	;D=ADDRESS
	MOV	L,A	;E=ERROR MASK
	CALL	SPACE
	CALL	DSADDR
..E2:	JMP	LOPTST	;EXIT
;
;	R - RAM TEST
;	LNR WHERE N IS THE 16K BLOCK TO TEST (0-3)
;	& L WILL CAUSE LOOPING ON A WRITE TO THE
;	FIRST ERROR LOCATION
;
CRAM:	CPI	'R'
	JNZ	CSET
;
;	SELECT SEGMENT TO TEST
;
	DI
	MOV	A,L	;BLOCK 0 ?
	ANI	3
	MOV	A,L
	JRNZ	..J0
	LXI	H,0FD00H ;--IF SO, SAVE DATA IN BLK 3
	LXI	D,09D00H
	LXI	B,100H
	LDIR
..J0:	LXI	H,TBLMAP ; MAP TEST BLOCK TO BLK 2
	MOV	D,A
	ANI	3
	RLC
	RLC
	MOV	C,A
	MVI	B,0
	DAD	B
	LXI	X,.+7
	JMP	MAP
	EI
;
;	FILL RAM WITH THE PATTERN
;
	MVI	B,9	; MAX ERROR COUNT
	MVI	E,0	; INITIALIZE PATTERN
RL1:	LXI	H,8000H ; SET START ADDR
..L0:	MOV	A,L	; GET LOW ADDR
	XRA	H	; XOR WITH HIGH ADDR
	XRA	E	; XOR WITH MODIFIERЉ	MOV	M,A	; STORE IT
	INX	H	; LOOP TILL DONE
	MOV	A,H
	CPI	0C0H
	JRNZ	..L0
;
	DI		; 68 mS DELAY
	MVI	H,0E0H
..L1:	INX	H
	MOV	A,H
	ORA	L
	JRNZ	..L1
	EI
;
;	TEST AGAINST PATTERN
;
	MVI	H,080H ;RECONSTRUCT PATTERN
RL4:	MOV	A,L
	XRA	H
	XRA	E
	XRA	M	;COMPARE WITH PATTERN
	JRNZ	MEMERR	;REPORT IF ERROR
RL5:	INX	H	;ELSE LOOP TILL DONE
	MOV	A,H
	CPI	0C0H
	JRNZ	RL4
	CALL	KEYSTS	; CHECK FO ABORT
	JRNZ	RJ4
;
RAMINR:	INR	E	; INCREMENT MODIFIER
	JRNZ	RL1
	JMPR	RJ4
;
;	ERROR REPORT
;
MEMERR:	EXAF		;SAVE ERRORS
	MVI	C,SPC
	CALL	CO
	RES	7,H
	CALL	DSH
	SET	7,H
	MOV	A,H	;SAVE H
	MOV	H,L
	MOV	L,A
	CALL	DSH
	MVI	C,'-'
	CALL	CO
	MOV	A,H
	EXAF		;SHOW PATTERN
	MOV	H,A
	CALL	DSHЉ	MOV	H,L
	EXAF
	MOV	L,A
	BIT	4,D	;LOOP ON READ AT FAILURE ?
	JRZ	..J1
	MOV	M,A	;--YES, WRITE IN A LOOP
..J1:	DJNZ	RL5	;ERROR COUNTER
;
;	RESTORE MAP, VARIABLES, & INTERRUPT SYSTEM
;
RJ4:	DI		;ELSE, RESTORE INT & REMAP
	LXI	H,STDMAP
	LXI	X,.+7
	JMP	MAP
	MOV	A,D
	ANI	3
	JRNZ	..J2
	LXI	H,09D00H  ;RESTORE VARIABLES
	LXI	D,0FD00H
	LXI	B,100H
	LDIR
..J2:	EI
	JMPR	CTIM1
;
;	S - SET BAUD & SELECT PORTS FOR ERROR REPORTING
;
CSET:	CPI	'S'
	JRNZ	CTIMER
	MOV	A,L
	STA	OUTSEL
	MOV	A,H	;SET UP COMM BAUD
	MVI	C,BAUDC
	CALL	..S0
	MOV	A,H	;SET UP PRTR BAUD
	RRC
	RRC
	RRC
	RRC
	MVI	C,BAUDP
	CALL	..S0	
	JMP	GOMON
;
..S0:	ANI	0FH	;SUBROUTINE TO SET BAUD
	RZ
	PUSH	H
	LXI	H,TBLBAD-1
	MVI	D,0
	MOV	E,A
	DAD	D
	MVI	B,57H
	OUTP	B
	OUTI
	POP	H
	RET
;
;	T - REAL TIME CLOCK TEST;
	PUSH	H
	LXI	H,TBLBAD-1
	MVI	D,0
	MOV	E,A
	DAD	D
	MVI	B,57H
	OUTP	B
	OUTI
	POP	H
	RET
;
;	T - REAL TIME CLOCK TEST
;
CTIMER:	CPI	'T'
	JRNZ	CUЉ	CALL	CLKID	;WHICH CLOCK
	CALL	RDCLK	;GET SECONDS
	MOV	H,C
	MVI	B,125	;DELAY 2 SEC.
	CALL	DELAY
	CALL	RDCLK	;READ SECONDS AGAIN
	EI
	MOV	A,C
	CPI	0FH	;FAIL IF F
	JRZ	..J0
	CMP	H
..J0:	JZ	QERR	;FAIL IF VALUE NOT CHANGED
CTIM1:	JMP	LOPTST	;ELSE GO TO MONITOR
;
;	U - TYPE A UNITED SET OF TESTS
;	FORMAT UCCCCC...C RET
;	WHERE C IS A COMMAND AND
;	RET WILL START THE SEQUENCE
;	U RET WILL RUN AA PREDETERMINED
;	STANDARD TEST SEQUENCE (SEE ..T1)
;
CU:	CPI	'U'
	JRNZ	CV
	LDA	FLGLOP
	CPI	80H
	JRNZ	..J0
	LHLD	CMDSTT
	JMPR	..J3
..J0:	LXI	H,CMDBUF ;POINT TO CMMD BFR
	PUSH	H
	SHLD	CMDPTR
..L0:	MVI	M,0	; GET COMMANDS
	CALL	CIKIN
	MOV	C,A
	CALL	CO
	CPI	CR	; CR?
	JRZ	..J1
	MOV	M,A	;--NO, SAVE COMMAND
	INX	H
	JMPR	..L0
..J1:	POP	D	;YES, COMMAND STRING?
	ANA	A
	DSBC	D
	MOV	A,H
	ORA	L
	JRNZ	..J2
	LXI	D,TCMD	;IF NOT, USE STANDARD
..J2:	XCHG
	SHLD	CMDSTT
..J3:	SHLD	CMDPTR
	MVI	A,0FFH
	STA	FLGCMD
	JMPR	¬fэ!!єЕ€6«НЖvq`§J6/їп¬oOЙ¤ЅwљuАБpЦуY\ПъCBtl‡Г¬6ыWЈаTЙжҐџzg}{J&нЅУмяїД
ѕ=%_њЕYw1[‡џхЩтщYО[Э/8лІеEщYОЬ*YНъ†м«bєіюњ№UІљх‡„ия‰ќХf5 ¬ЬЂіђКЙ|y» ep¤0?ђц[‡КаHєRиY(+wа¬6{9И%8UІyQн©YЯћ’I{п4лTЙже’ЙiЦ©’љОтY§Jv]Xќеі&Хм^bлpЦyЬбќПє»»gэT7C“Nі&Хм^XЭ}­СМPHуЈ±uШлФf«~Є[ЕЬЮ¬I5»ќaш,“Nh‚џк†dТiЦ‡w>лЂ<орОgђЗ]П: ЏО: Џ›Пъц”уgя?±‚+±»Пъц”уgЌcw·F3Ca~ Ќ­CЉБYв™яявАZЈTс&Т§zTфвp з2†)ѓ#йjЦ]МЦ›Оgэ‰gюяДО:Бns{Цh‹GЪД‹QµШа¬бЌоі8П:а`8лЂѓлYўxжДкі88јуY?ХНЕ¤У¬cSіяq`Мgp0њuАБх¬п|Ц±©YmVКК	pVєоD…щЃОj@Y№#Оjі‡ѓаJмоіL:ьT7| “Nіѕ=%ЯUќfќ*Щ°°і&Хм^ШY?Х­"€љ…-©О
&Хмє DoЌККR%zКаHСЎ§*d*+;«НЖvq8Иг®gќ*ЩјЬ@29Н: Џ›П: ЏОjіЪ¬мf€bТiЦ8vчYв™я?^vV›uЄdуВђzЦ·§dТЮ;Н:а`8лЂѓщ¬тёщ¬тёб¬S%›†Ё:Нъц”МђH=«Нjія/+8UІyЙbџхн)™ґчNі8ОRМgђЗНgђЗg}{JЋрўПjіЪ¬S%›ЊЁzЦ·§dТЮ;Н:а`8лЂѓщ¬тёщ¬тёб¬oOЙзкВОjіЪ¬S%›—,Ціѕ=%“цЮiЦГYМgќ*ЩјАfrљu@7џu@7њхн)9В;«НjіN•l^к/	і~<A_$’wљuЄdЧ…Хe€’эО:UІa№ЃdrљuЄdуЙiV›эх’аКе'[»„Н¤џЪ›5БUчBf]№ь4л,Vg}oћх'`яязkнbQei43b±С‹Iи±НъПьяк%k“РcЈэФіH3C18л	ѕ$ґ­}H -FifhЭ!Ѕ„Ы¬6ыяџЇа»UQі°%Хї‚oИ>Є[ЈІІфX§ЋzЄB¦ІІіюDсМяяag}{Jѕ)Є:Нъц”њЕЛњ5©fчr¬уYH€юяЪмяXБyЬбќ[ЛвЌЌ4QQGТЅ‡”EШв¬oOЙYјчђfppxзіяяAp0њuАБ|ЦWKџuЈы¬џкVLDН:ааzЦрFЧію€gЋнвpuljV›Хfr©“jv/Ћ¤«Y“jц-м¬?$DЗуИ¬6бDLЄЩЅДЦб¬I5ы}ЦўгщdV›=W7V0©fчrіjі&Хм[ШYH€Ћз7ђYm6В+Tі{‰­ГY“jц-м¬6«НЖу€`‚«®Kџ5©fчВкі~Є[ЕЬЮ¬	®є—zЦ¤љ]vЦ¤љЭ
;П±Шдq‡w>kRНоEg>Л¤+ш©nш@&ќfppxзіѕ=%#б©®fђЗЮщ¬тёлYдqГYдqуYЯћ’a~аlL_БyЬх¬oOЙ0ѕдН:ааzЦ•ШЭgбї‚oOЙ0?pЦ8vчYв™г‡ќuіх¦уYв™cъО:Бns{і†7єПъ©ns{і8П:а`8лЂѓлYОЬbДqЦ‡w>л	Сс‹mV›ЌVp%vчY&ќѕ‚џк†dТiЦ¤љЭ«Пъ©N­bnoЦуYgpp=л,FуYg1љПљаЄ{iіѕ!›Хgэ‰в™гз;л,FГY“jv+ъlь|g1єН:БnБDФ¬/	†іюД3Зs\mqЦ‡w>лІЩYЗіYH€ЋзXlіЪl<ЗХЮщ¬cSіЪl/oPpЄdуВU'@vЦў!ОвќНвЅ‡$8UІya€ЄУ,ДYј‚I5».¬>ыя‰њЕh2лTЙ†еи¬a‡†і†сМяџШYЗ¦fµЩ›ўЄ“аTЙж…!ЄNі&Хмє°ъмя'V0©f“ўП:‹уY“j6)ъ¬S%ґYГg?в™я?±іЋMНjіHxЄ+БyЬбќП: Џ»ћu@7њu@7џu‚Эй)БY_gэ‰gюя;k‚«оОъ©оф”Ља¬oOЙ‹ХЁfэT·Љ`т¬	®є—zЦOu«’YmЦWЭЛќхSЭ*‚wV›uЄdуў"€„YдqГYЯћ’I{п4лЂѓбмяXБWЭK›хн)щb±Х¬џк~н¦Y\u/х¬џк~н’Y§J6/Ї]$Мъц”LЪ{§YМgp0њuАБх¬п|Ц±©Ymцb±•аTЙ®љЋ¦sПєОК Kџх'ћ9±іОbфќuі2|¶¤:љаіЏкЦЁ¬,=Ц)ѓ#E‡ћЄђ©¬м¬’Нкъ¬?QјNм¬;Мfu}ЦрFЯЩД
~H¶Ющ¬?ДяяagќЕиzЦў;ыяVp‡ЩhќП:65«Н’цЮI0БUЯBf]gE°ЬYЗц°ЬYg±b>лЏxж‹5лЫSтЕ€т¬?$D“цЮiV›…йр%O0©fЯ‚6ыя‰LЄЩuС/діяџѕ‚бG<уя§п¬бЌѕіюDсМяџШYЗ¦f5{цbD	юђ`}V›Ѕ8‹‚?$XџХfa~ а	ЦgµЩVЙJpЄdуzД3лЫS2iпќfќ^ЂVЌ<О:65«Нj¶кujoV›=b†ьЧХЬЮ-ЉҐТЮ-"Ѕл|V›}щ$bQр_Ts{·H  •цn‘ћT$VљхЯЯНЩтTN]©~y“џх_Ts{·HO*’.•цn‘©HєT е=дҐЅ[$D*_ќПъппжlyJa~ ­ы‘@•SVZmсэ”эК{Ц}PН:дEп|Ц7gЛS№#q8Д|вЉІиЋї…b±ШйЕ1ь…ЦI°ЕB/–џх_TіЮyС;/zзE‡|Ц7gЛS№#уйyN‰ЦЌЦэ‚R$P&bBaМХF»@¦0жjЈµ@лU±_рэтц¬яъ љхО‹щ¬яюn~–ЁњМ0?ђf‘В«ЌЦ=П)СєQGТ•jђf†Љн¶чz<ьфвp з9%Z7Zm13№Б_љХfCД$(Б}PНнЭ"ЎX*нЭ"ЎJе‹Ћ—ЇО[у"}¤ўЧ|Ц7?ЛЧэ‚H 2’‘ь¬6[wxIьЧХ¬w^tИgэчwуі|Э!Ѕ„Ы/?Ыb$п$шЇЄQлђЅуўw^Ъ»EB¤т=К=лїї›џеqP‹O (D ›Љ‡BQ8°GBkЊUЎ(Ф ¶Si?х,КПцSПўаї>ЁfЅуўC^Ъ»EB±4лїї›џел~A$Р.bЕ[¤G–ўp  xдЁ •џш]$
юлѓjnп	U*_tј|u^Ъ»E%АcќПьXБ}PНнЭ"ЎJеyщкјґw‹ф‘ Џu>ры
юлѓjnп	U*_tј|u^Ъ»EъHеёжіЪмS]!Oр_Ts{·HЁRщуrф—цn‘©|їЬіюы»9[ћ=пYeсDe¤bї ••“™ѕvЋTV–К{Ц}PНнЭ"!RС»ОgµYA$юлѓjnпI&©ґw‹„*•п1/(;џх_Ts{·H€Tѕ_>«"xяхA5Јй|VEђюлѓjFУщ¬Љ`ьЧХЊ¦уYкї>Ёжцn‘©|ux¬уYНћ}н"Aр_Ts{·H2IҐЅ[$T©|ЏyAЏ’—цn‘©|ї|цµKяхA5Јй|цµ›яхA5Ј±|Ц}PНнЭ"!RщкрXзіЪl»аї>Ёжцn‘d’J{·HЁRщуrф—цn‘©|ї|Ц7gЛУШ:МвI r2ЛПъЇЄ№Ѕ[$D*_ќл|V›Е€ЄяхA5·w‹$“TЪ»EB•Кч—ЈЗјґw‹„Hеыеіюы»9[ћћЗ¬ІxЁњМтћх_Ts{·H€Tѕ:<Цщ¬6›ЕZр_Ts{·H2IҐЅ[$T©|Џy9zМK{·H€Tѕ_>лїї›іеiµЕМІxЁјgэЧХЬЮ-"•ЇОЏu>«Н2¤ьЧХЬЮ-’LRiп	U*Яc^ЋуТЮ-"•п—ПъппжlyКаHєRY<	тћх_Ts{·H€Tѕ:<Цщ¬6«ЪS‚яъ љЫ»E’I*нЭ"ЎJе{МЛСc^Ъ»EB¤тэтYяэЭњ-OU{*‹'ЃКЙ,пYяхA5·w‹„Hе«sАcќПjіQuьЧХ¬Ѕ°е[фўфе;лї>ЁfЅие[ѕE/zXѕіюлѓjЦ‹^РК·иE/Зе;лї>ЁfЅиеhщЅи]щОъЇЄY/zAYѕE/zС;/ЯYmVsµЗЬлФн"¤5В0-ѕYm6=Ґ"(шЇЄYg>{‘HЮIр_'рЬм¬Љ№=БќАЪм¬Љ`"Jр_'°6;{‘€ѓаїNа№ЩY†(&ќяukііЄ‘§@БќАsііЪ¬я„ЇY]Nf>ыTї QэПЮ@29	юлЦfuўdїірЃ™њяukієQІЯYmЦеИ¬я&ВY‘“ т=К=лїї›џеqP‹O (D ›Љ‡BQ8°GBkЊUЎ(Ф ¶Si?х,КПцSПўаї>ЁfЅуўC^Ъ»EBнs‚1 * T ~·>L >њ2]>( >P2Е2Г "х "	"8"%"O"Ј*  "т "п!НЦ!Ѓ6 :Ђ ·(:‚ юF w1 !“НЦ!НЦНсюКчюКч!ЃжЯюF wюC(~· ННMJЇ2‚ЪББ!ЂНЦ>	Нф!ЂНЦ!"НЦ!0НЦНсжЯюR(юКчюBКiюКчж!ЊНЦСбБs!bНЦНсжЯюYКiюNКчюКчк!:НЦ! >хЇ2Ѓ>
2}>я2‚ЪсхЕХеНфЇНф·(жа(х:}=бСБ Ьс2ЃЙбСБсЙЇ2‚ЪНm >2~LЕ! еХ:Ѓ·(!"НЦСбеХ!RНд!ЪНЦСбеХНк!тНЦСбеХНр!
НЦСб! $еХНц!""{  ! $л~лнЎвБ(хГґ:~ю( 
НmН[>ЂхН`сСбW<2~БВ^Й>> 
>>G>
2}xх>я2‚ЪсН~хЕХеНфЕНдБЇНф·(жа(р:}=2}бСБКЎсПЇ2‚Ъ>
2}бСБ$${ю
  :~є(сюИ¬сЙ!S!R
4 щЙ!R
6 #6  хЙхЕХе:zє(z2zНё2Иx2Зy2Ж!ЅХНЦС{Нё2Цx2Х!МНЦбСБсЙ00Л(жЖ(Цd0ЖdЦ
ъУшЖ:ЙNЛyЛ№#ВоНотНю щЙГ  Г  Г  !НЦн{‚ЙdU \S1      ATTACHES0U0tmU   DISK BACKUP UTILITY VERS. 1.7
               COPYRIGHT 1982, OTRONA CORP., BOULDER, CO


        DISK WILL BE BACKED UP FROM DRIVE A: TO DRIVE B: BY TRACKS.
   DISK IN DRIVE B: WILL BE FORMATTED IF NECESSARY. COPY WILL BE VERIFIED®d=) JBACKUP >ѕ
BAD COMPARE®

U$OPTIONS: (R)ETRY, (W)ARM BOOT, (B)EGIN AGAIО
dBACKUP ANOTHER ? (Y or N) =) Л=- К=) J‹=(HU" < WAITING >TRACK --- SECTOR -- U c=(ZU"000U c=(eU"01U c=(HU" READING:   U c=(HU" WRITCTIM1
;
;	V - READ A FLOPPY SECTOR TO 8C00H
;	 FORMAT CCHSV WHERE CC IS THE
;	 CYLINDER, H IS SIZE, HEAD
;	 & DRIVE, & S IS SECTOR
;
;	HHHH
;	|| |Љ;	|| DRIVE
;	|HEAD
;	1=96 TPI
;
CV: 	CPI	'V'
	JRNZ	CWR
	LXI	X,ERROR
        CALL	FPREAD
CV1:	LDA	ST0
	ANI	0C0H
	CNZ	FPER
	JMPR	CTIM1
;
;	W - WRITE TO FLOPPY, FORMAT SAME AS
;	 U COMMAND
;
CWR:	CPI	'W'
	JRNZ	CXMT
	LXI	X,ERROR
	CALL	FPWRIT
	JMPR	CV1
;
;	X - TRANSMIT DATA TO ANOTHER SYSTEM
; 	 THROUGH PORTS SELECTED BY PREVIOUS
; 	 S COMMAND, FORMAT NNNN MMMMX
; 	 WHERE NNNN IS THE NUMBER OF BYTES TO
; 	 TRANSFER (IN HEX) AND MMMM IS THE
; 	 START OF THE DATA AREA TO TRANSMIT
; 	 FROM. THE FORMAT OF THE DATA IS AS
; 	 FOLLOWS:
;
;	CR
;	NN
;	NN
;	.
;	.
;	NN
;	CR
;
;  WHERE NN ARE TWO CHARACTERS FOR EACH
;  DATA BYTE IN PSUEDO HEX (0,1,2,3,4,5,
;  6,7,8,9,:,;,<,=,>,?) WITH MSD SENT
;  FIRST
;
CXMT:	CPI	'X'
	JRNZ	CY
	MVI	C,CR	;SEND LEADING CR
	CALL	CO1
..L0:	MOV	A,M	;SEND A BYTE
	RRC
	RRC
	RRC
	RRC
	ANI	0FH
	ORI	'0'
	MOV	C,AЉ	CALL	CO1
	MOV	A,M
	ANI	0FH
	ORI	'0'
	MOV	C,A
	CALL	CO1
	DCX	D	;DECREMENT COUNT
	INX	H	;INCREMENT ADDRESS
	MOV	A,D
	ORA	E
	JRNZ	..L0	;LOOP IF NOT DONE
	MVI	C,CR	;ELSE SEND FINAL CR
	CALL	CO1
	JMP	LOPTST	;AND LEAVE
;
;	Y - RECEIVE DATA FROM ANOTHER SYSTEM
; 	 THROUGH PRTR PORT, FORMAT NNNNY WHERE
; 	 NNNN IS THE STARTING ADDRESS OF THE
; 	 LOAD AREA. SEE X COMMAND FOR DATA 
; 	 FORMAT
;
CY:	CPI	'Y'
	JRNZ	CZ
..L0:	CALL	CIPI	;WAIT FOR CR
	CPI	CR
	JRNZ	..L0
..L1:	CALL	CIPI	;TAKE DATA
	CPI	CR	;DONE IF CR
	JZ	LOPTST
	ANI	0FH	;ELSE STORE IT
	RLC
	RLC
	RLC
	RLC
	MOV	D,A
	CALL	CIPI
	ANI	0FH
	ORA	D
	MOV	M,A
	INX	H
	JMPR	..L1
;
;	Z - FLOPPY SPIRAL R/W TEST
;
CZ:	CPI	'Z'
	JNZ	CLBRK
;
;	GET PARAMETERS & FORMAT
;
	CALL	SELFMT	
;
;	SET UP COUNTERS & BUFFER
;
	XRA	A
	STA	ERRCNT
	RES	6,L
..L0:	MOV	A,L	;SET SECTOR 1
	ANI	0D0H
	INR	A
	MOV	L,A
..L1:	PUSH	H	;LOAD FILE BUFFER
	LXI	H,FILBUF ; WITH DBE6 CODE
	LXI	B,FILSIZЉ..L2:	MVI	M,0DBH
	CCI
	MVI	M,0E6H
	CCI
	JPE	..L2
	POP	H
;
;	WRITE 1 SECTOR ON EACH TRACK
;
..L3:	MVI	H,40	;SET MAXIMUM TRACK
	BIT	6,L	;48 TPI, SIDE 0: 40
	JRZ	..J0
	MVI	H,36	;48 TPI, SIDE 1: 36
..J0:	BIT	7,L
	JRZ	..L4
	MVI	H,80	;96 TPI, SIDE 0: 80
	BIT	6,L
	JRZ	..L4
	MVI	H,78	;96 TPI, SIDE 1: 72
..L4:	DCR	H
	CALL	ABTTST
	LXI	X,ERROR
	CALL	FPWRIT	;WRITE
	LDA	ST0	;CHECK & REPORT ERRORS
	ANI	0C0H
	CNZ	FPER
	MOV	A,H
	ORA	A
	JRNZ	..L4
;
;	READ & COMPARE ALL TRACKS
;
..L5:	PUSH	H
	CALL	ABTTST
	LXI	X,ERROR
	CALL	FPREAD	;READ
	LDA	ST0	;CHECK & REPORT FLOPPY ERRORS
	ANI	0C0H
	CNZ	FPER
	LXI	H,FILBUF ;REPORT RAM COMPARE ERRORS
	LXI	B,FILSIZ
..L6:	MVI	A,0DBH
	CCI
	JRNZ	..J1
	MVI	A,0E6H
	CCI
	JRNZ	..J1
	JPE	..L6
	POP	H
	JMPR	..J2
..J1:	POP	H	;RAM ERROR REPORT
	LDA	ST0
	ANI	0C0H
	STA	ST0
	STA	ST1
	CZ	FPER
;
;	CHECK FOR LAST TRACK
;
..J2:	INR	H
	MOV	A,H
	CPI	80
	JRZ	..J4	
	CPI	78	;SIDE 2?
	JRNZ	..J3
	BIT	6,L
	JRNZ	..J4
..J3:	BIT	7,L	;48 TPI?
	JRNZ	..L5
	CPI	40Љ	JRZ	..J4
	CPI	36
	JRNZ	..L5
	BIT	6,L	;SIDE 2?
	JRZ	..L5
;
..J4:	INR	L	; DO NEXT SECTOR
	MOV	A,L
	ANI	0FH
	CPI	11
	JNZ	..L1
;
	BIT	6,L	; DO NEXT SIDE
	SET	6,L
	JZ	..L0
	JMPR	LOPTST
;
;	[ - 8:16 RAM TEST
;
CLBRK:	CPI	'['
	JRNZ	CKMAT
	MVI	B,0F9H
	JMPR	LOOP86
;
;	\ - 8:16 8087 TEST
;
CKMAT:	CPI	'\'
	JRNZ	SER86	
	MVI	B,0FAH
	JMPR	LOOP86
;
;	] - 8:16 SERIAL TEST
;
SER86:	CPI	']'
	JRNZ	GPIBTK	
	MVI	B,0FCH
	JMPR	LOOP86
;
;	) - 8:16 GPIB START AS CONTROLLER
;
GPIBTK:	CPI	')'
	JRNZ	GPIBLS
	MVI	B,0FBH	
	JMPR	LOOP86
;
;	( - 8:16 GPIB START AS LISTENER
;
GPIBLS:	CPI	'('
	JRNZ	MON86
	MVI	B,0FFH	
	JMPR	LOOP86
;
;	# - GOTO 8086 MONITOR
;
MON86:	CPI	'#'
	JRNZ	NUM
	LDA	FLAG86
	ORA	A
	JRNZ	NO86
	MVI	A,0F1H
	CALL	OUT86
..L0:	CALL	IN86
	ORA	A
	JRZ	END86
	CPI	1
	JRNZ	..J0
	CALL	CIKIN
	CALL	OUT86
	JMPR	..L0	
;
..J0:	MOV	C,A
	CALL	CO
	JMPR	..L0
;
LOOP86:	LDA	FLAG86
	ORA	A
	JRNZ	NO86
DO86:	MOV	A,B
	CALL	OUT86
..L1:	CALL	IN86
	ORA	A
	JRZ	END86
	MOV	C,A
	CALL	CO
	JMPR	..L1
;
END86:	CALL	IN86
	JMPR	LOPTST
;
NO86:	CALL	SPACE
	MVI	C,'x'
	CALL	CO
	JMPR	LOPTST
;
	.PAGE
;
;	SPECIAL MONITOR EXITS
;
LOPTST:	LDA	FLGLOP
	ORA	A
	JRZ	GOMON
	CPI	80H
	JRZ	GOMON
	MVI	A,80H
	STA	FLGLOP
	LXI	H,SAVDE
	LXI	D,SAVDE2
	LXI	B,5
	LDIR
	JMPR	GOMON
;
;	0-F - SHIFT A NUMBER INTO HL
;
NUM:	SUI	'0'	;CONVERT TO HEX
	JRC	..J2
	CPI	10
	CMC
	JM	..J1
	CPI	11H
	SUI	7
	CPI	16
	CMCЉ..J1:	JRC	..J2	;SKIP OUT IF INVALID
	DAD	H	;ELSE SHIFT INTO H
	DAD	H
	DAD	H
	DAD	H
	ORA	L
	MOV	L,A
	INR	B	;SET DATA FLAG
	SHLD	SAVHL
	SDED	SAVDE
..J2:	JMP	GET
;
;	'?' ERROR
;
QERR:	MVI	C,'?'
	CALL	CO
	JMPR	GOMON
;
;	TEST FOR ABORT FROM CONSOLE
;
ABTTST:	CALL	KEYSTS
	RZ
;
ABORT:	CALL	CIKIN
	XRA	A
	STA	FLGLOP
	STA	FLGCMD
GOMON:	LXI	SP,STACK
	JMP	MNTR
;
	.LIST
	.IFE	LSTSUB,[
	.XLIST
]
;
.PAGEЉ;
;|------------------------------|
;| 	GENERAL SUBROUTINES	|
;|------------------------------|
;
;	GENERAL DISPLAY ROUTINES
;
;	RETURN ACCESS CODE FOR SECONDS OF THE
;	APING:   U c=(HU" VERIFYING: U c=(HU" FORMATTING:U c=(HU" TESTING:   U                 	    
я!НуННѕ,Н Гф!Г™!НуННѕГqzж8O!о	НуГЕ!кНуННѕ,Н zжНѕГqy‡‡O!О	НуНЈхНЈWс_Н•Гqy‡‡O!¦	НуНЈН’Гqy‡‡vяxуBACKUP.HEX '        Пя	  Ня
 Оя Ля Кя Мя    Зя »яєяјя Йяѕя№я ЅяИяЖяхяoяЕятяья    ыя  ъяСя    !  % # & $   " ±яёяґяіяяю¶яЈящя­я«яЇяЮяІя°яяяеяйbrі¦p¦5ќYвУЕDі&3•)Moцшjnv;S;іЧWsіЦ„¦3ЃЩЗWумТ%_НЫ&БzьёЬс5?(i–D›®_СhХо6]рюj(љXїўХCЅ®PЏVуTтхАjёT;]р_йф!?ґu­Жшk5\rЗ<я ’WШtIАЗрW#ЂЗ*5яN>}пьП‘яpьХ°DҐK>тWsЗъ}›¬„~\ ск{з‡ЂїъЮщ‘mє$аѓрЯ·ЗГ·Gwћ<|ѓнО“‡Аxny{Я&лBАЋ¦K>иWsлЫ„шCљ%ъЈп“«пЩxњу!ЦvBEє$аГсПхЅу#ЪiЯ~аwЃяк{з‡ ЅъЮщбlє$аЈ5„ш«пќ}{<ZЮЮ·’р¶;OѕЌєЛґчtIАЗжЇ|{tзЙЬІАэХчОЏЌ†0	!лХчОЭҐK>ьWуиЫгСтцѕн.УГ·iЭyтрнСќ'psBій’ЂЇуо№пќВЏЗг8Ћh_О‡ПСоB”¤KѕфХ ы9љч!ЦvѕzнjХ·џ‡у}ыyX"†ZnWҐKѕ‚±Їpd?ЗnШиРwч1ћ;mШириФщK•.	шЄЇЖv}зэ Ћ?Ъ"нщyz/бЗ[н
Зx¶Д·tIАWж_ЊТsЯ;?6ZнJП}·№„н^}пь M—|сWcЈЎХ®ѕ›»ЇWЯ;?6ZнкЫяоћы.—.	шўьпьШh~M«]}ы|	ТK"цщш1АЏп–.	шІ_бЧ4KZі€¶љ:.±ЇvЋp¤=ы&Цпм¤Kѕ:я}зэи»м#ьтХwюГcЈЎHфiПЇOє$а«}5єЄ]ќF;Ю0нсцѓпў]oшнБњ.	штьХhЗђhw!Іџ	?h‡ЇhЮ‡XЫyфMЪГЧiє$аѕЅvµкЫПЈWЯmОчнзa‰Уr»Ш?ЩµУ%?Д_Ќ;DцsГFGw‡ё{зC¬нўЭ…И~nр‘.	ш1_ЌЌЌ†XЯофнGGЪіuвgЯЋОаЊtIАЏвЯuЏN…ЉgрC(=?ЯЕ џчґSЎф\=]рѓ|5Пw‘Eдxь ёЇN}хЪХ*qПЦ‰б,Т%?вBД=чmщкь"кдEhЁз—`чkWЯ;зH—ьp_НcѓШѕ-?B;ї‡vЅ„Ю_}пьhШирињ.	шaщ«Ѓxј[вЕпп-Яіxз<сGПyѕwѕуnЗѓЪtIАЏэХ|Аћ{Чйґn	нЦREWkЏѕ[{ЂЅЮП}»§K~4юqЯѕuO;нсХјЗWу_Н…лУчОЏ¶‰eэй’Ђ?_НдNaуАV№ГV‡­иє®лъ ¦f01мmє$ашџ‚­€ГVЕЙд[Ґлъ¬­«Џc«I—ь‰ЇF]ЇХЎУ‡ЦХ+O•*ФфЂZђп;]Ч«Т%†]Чu]Чu]Чх‰схўҐЎC†kф@РMУ%тW#8¤®ЏЇ)Ќџ6Р'Ж—кjкъh|ХфYЌ"J—ь!ь—Фх‰сwwwЯє®лє®ліґb¬^dЁrє$аэjLџ®Џ¦фС`bмФЊ^«q}riьl}¦4t"]рЗс_yJ„УkЖл3ҐЎ•§фQ8}TTЇ)Ж¦KюфЇЖДШ
µ»o]Чg5hЕX}и4}¦4ґт”>кO—ьЩь‡У‹ќ>]Mй“З—fjj¦fфЎ“хiюй’Ђ?ю«151UQ1(UУ'ЖЧ‹кE†Nџ®Џ¦фК”¤K~ќя©ТРЙC§f\ѓН[T‡w;LЊ­ХёЮ}є$а—ѕСl»ыfф‰сілѓТ”kЯww°UљсхюtIАЇаїfишiбtqItЄ¦TT]”fл#GТ%їк«1~|Ќє.‰N:Mнно6ПhА9]р+у?1¶Vгъ`Ъшљб©’^Хі'Т§‰єoџ.	шЕ_ШШў:l·°±µuШо`c‹к°гШВЖГо–.	шEщЇТj<є^d0ґfиґ!zґљТ`b¬®­­­;›.	шeїS5гKє¶¶[е›6¶ёl•Џgџ.	шХщЏГV№ГжЂЌ-О[%Е°Uо°9`c‹‡еУ%їЪW¶J«сТФ`VѓNNЧuШ*wШ°±ЕГ™¤K~yюa«ґ/RZ3tЪђpє®ГV№ГжЂЌ-VҐK~ЖW¶J«сКSҐЎ“‹ќ6$њ[е›6¶xШоtIАПв¶J«сЙгKі55C§	[е›6¶xмtIАПуХЂ­ТjјfЄўfиґ!бt]‡­r_MЊл«№*]рsсW#__Ниъj†\_НДхХ__НМхХ<?]’ЫgтХњ^_НФхХЊ»јПJ—длbR“¬¦7=]рѓ|5Пw‘Eдxь ёЇN}хЪХ*qПЦ‰б,Т%?вBД=чmщкь"кдEhЁз—`чkWЯ;зH—ьp_НcѓШѕ-?B;ї‡vЅ„Ю_}пьhШирињ.	шaщ«Ѓxј[вЕпп-Яіxз<сG
Message number:  6
From ROGER DOGER to ALL
Dated: 12/25/84
Subject: BIOS225.LBR

MERRY CHRISTMAS BIOS225.LBR IS Attache cpm 2.2.5 source,
It's Public Domain, Curtesy of Otrona & FAUG
I am looking for an RBBS to run on my 8:16, is yours
available?  Have fun with BIOS225 it contins everything
needed to build cpm except the *.VL2 files, it is as
compressed as possible (some elements yes,some no,
dependant on size...) it requires either TDL's or PSA's
(Pheonix) assembler, or reediting the source for MSoft
goodnight
vяBIOS25.ASM ‹         
 	    ця     Яя   тя хя  єя«я­я  ѕяія  ¬яјя°яДя  ¶я»я !   " ±яЇяІя$ # % Ѕя·я& ( ' Уя) №я* ©я+ - , ПяЄяѓя. / Ся0 ґя¦яОяЕя1 µя2 oяёя§я3 5 4 7 6 ЁяТя9 8 Ня: < ; Ґя= ? > ‹я@ љяA B ЊяћяВяМяC ЌяD КяE G F H ШяJ I K ЛяђяL ИяЙяN M ЗяњяP O “я‘я–я—я›яQ S R T ьяЉя”яЧяЦя’яU ъяФяЖяV ™яW РяX Y чяZ Щя\ [ Џя] _ ^ бя` a ыя€яb Аяc ќяd e БяяЬяХя†яўяf g ¤яi h ‡яj Гя‰яk шяuяl n m мяЈяp o r ®яs q v t пяu няйя…яw x ияжяеящязяояy Ыягяz { } | Ђ  Ѓ ~ вяЮяЎяряЭяЪядяїя„ кяѓ … ‡ † € ‰ ‚ Љ сяЋя яџя-яляEя6яNяIя‚яЃя•я„яфяуя%яяю,я+я2я0я7я4яDя:яЛoяx=y¶№¶”OЗЗЧяІ}ЮќҐЋ.jяЛ¶8{u2]ѓkи^!MЛ•kи^С$єW®Ў{Х¦	з2ЬЭk  л;цХN—<w/,z¶№6Ћ=зьЩЅrЭ+љвi“®\Cч
iZ®\ѓkиf]љП.± ЛС!ЛСбCЎkи>ЛaЎщЭBЧР¦xОaбЗ5Р•ЛkПХ•Л«x2W.eµt»ЧYўSЮ'7Ри_яЛ]nфЋ.jяЛ¶)ћЙ®Ј~с$ўSЮ'ч[ЫаюЇ¶iс8ЩuФџжOtКыдNy€ћsю}2ш-|mТЙ®Ј~?С)п“{¶№¶…яi§Ч&џм:ку”и”чЙ=‹\[Ш:н“Бoб«mвdЧQїЁSўSЮ'чlsmaлґOї…Ї¶‰“]Gэ’…D§јOniдл*µ…яќ^їM‹W“]Gэ6ќт>№S±ПNяќ¶тд6-ц&»ЋъEЅ€NyџЬВЦkмR‹c±w:eшOmЉgІлЁ_‚‰и”чЙ-lЅЖ.µ8{§_MЌc'шПиЙ®Јю;D§јOnaл5v©Е±Ш;}ѓг[d*цYцdЧQїёС)п“[ШzЌ]jq,цNWрєтщmЉgІлЁЯ|$ўSЮ'·°х»ФвXмќ6џ}6Х6MxІлЁЏи”чЙЌнс~?ЩKа·Шл‰кыHрљёM‹NvхcCќт>№±=ЮoaлґOї…Ї¶	зЙ®Ј~lЬD§јOnlЏч»‚Ч•Пп“Бoб«mЉgІлЁ?*Pќт>№Ј]L€¶рїsАлчЙа·рµiВ“]GэD§јOоїзсjгШч«u›_m“Nvхcыќт>№±}мћЗлъуЩжЧ¦Е«Й®Б•K+=ЋъЕ“ЊЕwеR6lэ®kгКеµНП5ёЦ7^ъ-lќцµПѕЯ§ТґЁk )Чaб«DзB|†Жag©‡…Їv†]УyєЦќэ‰ОЁ]я»ъмяЪВћ цD7XПЇзчпБ^иEЈ,ґ…э°]M‹¶iQУyчѓї.'v­VјJt–ZdpЇ«OёЧА”ЎdНаЩЯfиhZФµюќ¦Dзѓв>УxЛЭЎѕ:K]яNSЧ»ЪёGt®‰КоРй’зnмќj3мыЭщ”єЪёЧц9—ю«®іЭ•ињи®6о!Ђ‰Ч®,ДwMй":Qв@пlw=пъ:KќТе:‹\‰О”®xсQ‹оРу®ЇіФіИХu¶№ќ)]с–Ј@СЎз]_g©g›«+¶N‰Оv‡†а=їУYjaлґ¶…]KхїЫ5	[§D'`Z4~БоР	<зБЯВЦiCрћЯй-ДYєЮрў0-ЉR°;ф»NѕыОРю|ъБJ®·°uљ/ў0-µ`wиwќ|·°uљЇ~рџ=ъnQЇQ":УўСмэ®“п¶^c—Z‹ЅCW›зТD'`ZҐ`wh+Oо№ф_Џњц·ТХfн':с•v‡¶Р~»GЫ<—юklр№NgPђи,Gewий+НyС3(IпtµqПUІc%ўђ м=ѓ’фNЧk§ЧR>-еsппJУўЭЎaЗищu*64?Сs©…­У>ь>ЧаКеµНП5ё†n+Oо”aэюк\їЅ :ЧD)ъЫыќNю“GПҐя\їЅ€N`Ў`ииў@П®ЯЮ?•‰N`Ў`ииў@П®Б5tпљ¬н”Е«®Бu~ѓиЊR0фьЖpќ+С‰Ї`иy§iЅvz®йќЂ(:нsм6ї>пѓє¦F„иvБРйџЃЊё¦F¤ :Ѓ„Ї`ифП@F
ЧфПќА\0tъg §®йџ‘‰N@*:э3ђЩ5э3.ўіќюИЛ5э3®JtҐ`ифП@^Х5э3Ц6СY.ќюИµнљюkы":Ј
†NяPROPRIATE CLOCK CHIP. SET UP NATIONAL
;
CLKID:	MVI	C,9H	;SET NATIONAL INTERRUPT
	MVI	D,4FH
	CALL	WRCMOS
	CALL	RDCLK	;READ BACK
	MOV	H,A	;SAVE SECONDS ADDRESS
	MOV	A,C
	CPI	0FH
	JRZ	..J1	;JUMP IF OKI
	MVI	D,40H	;ENABLE NATIONAL
	MVI	C,7
	CALL	WRCMOS
	MVI	D,4EH
	MVI	C,1
	CALL	WRCMOS
..J1:	MOV	D,H	;D=CLOCK SECONDS ADDRESS
	RET
;
;	DELAY FOR B^3 MICROSECONDS
;
DELAY:	PUSH	B
..L1:	PUSH	B
..L2:	DJNZ	..L2
	POP	B
	DJNZ	..L1
	POP	B
	DJNZ	DELAY
	RET
;
;	DISPLAY A SPACE, HL, A DASH,
;  	& DE
;
DSDATA:	CALL	SPACE
	CALL	DSADDR
	MVI	C,'-'
	CALL	CO
	MOV	H,D
	MOV	L,E
;
;	DISPLAY HL
;
DSADDR:	CALL	DSH	
	MOV	H,L
;
;	DISPLAY H IN HEX
;	(AC) [Y]
;
DSH:	MOV	A,H
	RLC
	RLC
	RLCЉ	RLC
	CALL	DSH1
	MOV	A,H
DSH1:	ANI	0FH	;CONVERT TO ASCII
	ADI	'0'
	CPI	'9'+1
	JM	..J1
	ADI	7
..J1:	MOV	C,A
	JMP	CO
;
;READ CLOCK - TRY 4 TIMES TO READ A NON-0FH
;VALUE FROM LOCATION F OF THE CLOCK. FAILURE
;MEANS OKI CHIP. RETURN ADDRESS OF SECONDS
;COUNTER ADDRESS OF APPROPRIATE CHIP.
;
RDCLK:	MVI	B,4
..L1:	CALL	RDCMOS
	DJNZ	..L1
	MOV	A,C
	CPI	0FH
	MVI	A,42H
	RNZ
	MVI	A,0C0H
	RET
;
;CMOS RAM OR CLOCK READ/WRITE
;  D=ADDRESS 0-63
;  D6,7=0 IF CMOS RAM
;  D6=1 IF CLOCK
;  D7=0 IF NATIONAL
;  D7=1 IF OKIDATA
;  C0-3=DATA TO BE WRITTEN
;  C4-7=0
;  ON EXIT C=DATA (IF READ)
;LEAVES WITH INTERRUPT OFF
;(A,C,D,E)
;
RDCMOS:	MVI	E,0FH
	JMPR	RWCMOS
WRCMOS:	MVI	E,0
RWCMOS:	MVI	A,0CFH	;SET "A" DIRECTION
	PUSH	D
	DI
	OUT	SPIOA
	MOV	A,E
	OUT	SPIOA
	MOV	A,D	;SET UP ADDRESS & DATA
	RLC
	RLC
	RLC
	RLC
	MOV	D,AЉ	ANI	0F0H
	ORA	C
	OUT	DPIOA
	MVI	A,0B0H
	BIT	0,E
	JRZ	..J1	;SET BIT 2 IF READ
	SET	2,A
..J1:	BIT	2,D	;CLOCK ?
	JRZ	..J2
	XRI	18H	;--YES
	BIT	3,D	;OKI ?
	JRZ	..J2
	XRI	4	;--YES, INVERT BIT 2
..J2:	MOV	C,A
	MOV	A,D
	ANI	3
	ORA	C
;PULSE A DEVICE ON THE PIO PORT
;  A CONTAINS THE PORT # IN 2-4, THE UPPER
;  TWO ADDRESS BITS (NEEDED ONLY FOR CMOS
;  RAM) IN 0 & 1, AND ONES IN 5 & 7.
;  C CONTAINS THE "A" PORT DATA AS READ
;  WHILE THE PULSE WAS ACTIVE.
	OUT	DPIOB	;SEND B0,B1
	RES	5,A
	OUT	DPIOB	;PULSE DOWN
	PUSH	PSW
	IN	DPIOA	;READ DATA
	ANI	0FH
	MOV	C,A	;SAVE IN C
	POP	PSW
	SET	5,A	;PULSE UP
	OUT	DPIOB
	POP	D
	RET
;
;MAP RAM FROM TABLE STARTING AT (HL)
;(A,B,C,H,L)[X]
;
MAP:	LXI	B,DMAP
..L1:	RLD
	OUTP	A
	MOV	A,B
	ADI	20H
	MOV	B,A
	RRD
	OUTP	A
	MOV	A,B
	ADI	20H
	MOV	B,A
	INX	H
	ORA	A
	JRNZ	..L1
	PCIX
;
;	SEND MESSAGE TO CRT
;
MSSG:	MOV	C,M
	INX	H
	BIT	7,C
	RES	7,C
	JNZ	CO
	CALL	CO
	JMPR	MSSG
;
;	MAKE SOUND SPECIFIED BY 14 BYTE TABLE
;	 POINTED TO BY H-L (R14 OF THE SOUND
;  	 CHIP IS FIRST, R0 LAST)
;	 ----- LEAVES INTERRUPTS OFF -----
;	 (A,B,C,H,L)
;
SOUND:	MVI	A,0CFH
	DI
	OUT	SPIOA
	XRA	A
	OUT	SPIOA
	MVI	A,0E3H
	OUT	DPIOB
	LXI	B,14*256+DPIOA
..L1:	DCR	B
	OUTP	B
	INR	B
	MVI	A,0C3H
	OUT	DPIOB
	MVI	A,0E3H
	OUT	DPIOB
	OUTI		;SEND THE DATA
	MVI	A,0E7H
	OUT	DPIOB
	MVI	A,0C7H
	OUT	DPIOB
	MVI	A,0E7H
	OUT	DPIOB
	JRNZ	..L1
	RET
;
	.PAGEЉ;
;|--------------------------------------|
;| 	I/O DRIVER SUBROUTINES		|
;|--------------------------------------|
;
;	KEYBOARD INPUT ROUTINE
;
CIKIN:	CALL	KEYSTS
	JRZ	CIKIN
	XRA	A	;--YES, GET IT
	STA	KEYFLG
	LDA	KEYCOD
	RET
;
;
;	COMM/PRTR INPUT ROUTINE
; 	 EITHER OR BOTH PORTS MAY BE SELECTED
; 	 AS SPECIFIED BY THE S COMMAND.
;	 FETCHES COMM. PORT 1ST.
; 	 RETURNS '?' IF NEITHER SELECTED
;
CIPI:	LDA	KEYFLG
	ORA	A	; IF KEY PRESSED
	JNZ	ABORT	;  THEN ABORT
;	
	LDA	OUTSEL	; ELSE 
	ANI	11H	;  IF NO PORT SELECTED
	JZ	QERR	;   THEN ERROR
;
	BIT	0,A	; ELSE IF PRINT PORT SELECTED
	JRZ	..J1	;  THEN ..J1
;		
	CALL	CISTS	; ELSE IF NO BYTE AT
	JRZ	..J1	;  COMM. PORT, THEN ..J1
	IN	DCOMM	; ELSE GET BYTE
	RETЉ;
..J1:	LDA	OUTSEL
	BIT	4,A	; IF PRINT PORT NOT SELECTED
	JRZ	CIPI	;  THEN CIPI
;
	MVI	A,10H	;  ELSE CHECK PRINT PORT STATUS
	OUT	SPRTR
	IN	SPRTR
	ANI	1	; IF NO BYTE AT PRINT PORT
	JRZ	CIPI	;  THEN CIPI
	IN	DPRTR	; ELSE GET BYTE
	RET
;
;	COMM/PRINTER PORT INPUT ROUTINR
;
CO1:	LDA	OUTSEL
	BIT	4,A	
	JRZ	..J0
;
..L0:	MVI	A,10H
	OUT	SPRTR
	IN	SPRTR
	ANI	24H
	CPI	24H
	JRNZ	..L0
	MOV	A,C
	OUT	DPRTR
;
..J0:	LDA	OUTSEL
	BIT	0,A
	JRZ	..J1	
;
..L1:	MVI	A,10H
	OUT	SCOMM	
	IN	SCOMM
	ANI	24H
	CPI	24H
	JRNZ	..L1
	MOV	A,C
	OUT	DCOMM
;
..J1:	MOV	A,C
	RET
;
;	CRT OUTPUT DRIVER
;	(A,C)
;
SPACE:	MVI	C,SPC
CO:	JMP	DISPLY	; OUTPUT?
;
;	KEYBOARD STATUS
;	(A)
;
KEYSTS:	LDA	KEYFLG
	ORA	A
	RET
;
;	COMM INPUT STATUS TEST
;	(A)
;
CISTS:	MVI	A,10H
	OUT	SCOMM
	IN	SCOMM
	ANI	1
	RET
;
	.PAGE
;
;	TERMINAL EMULATORЉ;
TERMNL:	XRA	A
	STA	KEYFLG
..T0:  	CALL	CISTS	;CHECK COMM SATUS
	JRZ	..T1	;  THEN CONTINUE
	IN	DCOMM	;  ELSE OUTPUT CHAR. TO SCREEN
	ANI	7FH
     	MOV	C,A
	CALL	CO
..T1:	LDA	KEYFLG	;CHECK KEYBOARD
	ORA	A	; IF NO CHAR.
	JRZ	..T0	; THEN LOOP BACK
	LDA	KEYCOD
	MOV	C,A
	CPI	86H	; ELSE CHECK FOR EXIT CHAR.
	JRNZ	..T2	;  IF NO EXIT, THEN CONTINUE
	XRA	A
	DI
	STA	KEYFLG
	EI
	JMP	GOMON
..T2:	MVI	A,10H   ;CHECK COMM STATUS
	OUT	SCOMM
	IN	SCOMM
	ANI	4	; IF BUFFER NOT EMPTYдЪѕ\У?Јќe”‚ЎУ?Y]У?CFt–сќюH™л«‰и,ПCїљцх\%‰иRБРR>wKп	Ч!ќА.zXшZzOёЦ+ќ@БРхЪй№Ч@iдл*uК°юu®‘ІxЭиЊсў0ф‘С)Яч†№Рщ4ЉлэП·7С‰ Ѕ¦цќ>энэ2ш]пД(ќсЧ0t”5А]—}зџOЧїПoсЖ.№Чz>СYЋЉњЁюлм/ПВДЎ‹·EЧя®>ы?Ча*Љс‰ОrT†¶N»x[фИ[ф·чsш‰N@*ZШ:нвmС y‹юц~®Pќ C‹{чќЕs®Ѓй’зnaлґПыаЃќІxХ5ё"ОѓиЗюЧ?ч#§эџpEaСYf@ы_яЬВћ—~>%WДч :ЗюЧ?7ч9ня„kpЭВЦi‹c±ЧЧ>ы~яќкh’?®{ЊЦЦ‰N”ЁсNX»Щ‰г­VјєvЕвќ(юВЪэЛN<1]зQ‰О‰юe{±оjЕ«З[vќЗґЪ8ўі,Д_»yФРВћ—~>ҐћGNУ®6о№хWGt®)/0t‘лoaлґлK?џ®6оµkQЅ>СYєИхw}йзSыz§яЩiЪҐТШuЏ!к”иЬcь3]»5тМЈєЉ:­6ЋиЬc€:ENґPFN4ЏєvQ&Ћ·<±k-Х¦D'
CЧRэпоук;ШэПNУкљаЇ/ќ]Ф_mњ<WQЄ6нСхҐџOWч\ѓkQя<¦DgQµqт”р1tєд№»ѕф—}ЅУE®їлKйљ®»^ї‰ОўюyL{нєЁї^џЎУ%ПЭхҐџOнлќюg§©k}й®SўіЁSd™ЎлK?џѕwќєО[€Ct¦t!‹ъ«ЌsЅ·мџ)С‰]јЕЦо_vbWaПѓџиЊн&љЁZсj/Цэ/;qје‰]…={$ўSШуа—gўyL«Ќ“eabЧаКҐ•…={$dЩX|Ч=r€N|@бє6®\ZйQШіGB.‹пєGN С	$ p]W.­ф(мЩ#!г‹пєGN С	H@бє6®Бх_›и,@б\№ј¶щ№ЧРmеЙ}еу«kp•®Тњ6С	< `ђFѕ®RЧї?XыКз»JWiFўxе‚AщєJ-цЯ}еу]EЅжґ‰Nа-ВЦkмRП»ѕЖ±xОѓї·зХк*к5#С	<”‚AШzЌ]кyЧЧ86"С)ѓр»Ц/жґ‰NаЕ/к=ѓµз]_гШ	<зБЯ[€уju­_М€CtoMБPїи¬=пъЗFд#:e~Чjуњ6С	јЁCµ№з]_гШ	<зБЯ[€уju­6П€Ct/JБPmоyЧЧ86"С)ѓр»Љ{§z€Nаб+ДЅ;еыЮPИSяю`нуМ¶юw\ЕЅзќА‹®`чnД±яхAхчyf[я;®вЮ€zќАЫѓёw#ЋэЇ«…жсъЮuЪіэ®вЮ€ыќА›qпFы_ЯYј>ПlлЗUЬ;НС	јT0€{woџћKяхяiiШ)Ќ|№Љ{яы":Ѓ'
qпюпѕъ<sгШч®яќNгнгZEЅJD'р^Б lЅЖ.uКчЅЎђ§юэБк*оЌШ7С	<©`чnД±яхЈп]§}ћ№gы««Hщѕ‰N@
†”п»Ї|~‹э·kMщѕ‰N@*)Яw_щь®°єЉльCtТBБpя;}еу[мї]лuю!:	Ґ`ёЋ…яќѕтщ]яю`uќ7(С	Hс†yѓўїЅЯi)џNщѕыКз{фНС	Hk
†yѓўїЅЯi)џѕЋ…яќѕтщ®ў^~ўђўВЦkмR[шЯ9ах{ўЁ@7±«t•,ьD' E)¤‘Ї«Фюwxэюц~ЗU\6oўђр—Н}еу{·Ш»ТґhиЮ 2JЈчШ?-цЯќБпJУўЃhфѕуП§3tҐiСАQnф6џ}6Х~pПг№ТґhаXhф~ЧЙw?ёзс\iZ4p t”¶^c—z>ЦҐ+M‹†о Ј4zг‹®ґШ·•'»¶Iю†о QЅЧаCYh QЪК“]iZ4tпшИ(ЌЮkрЎ,фђ(ќБпJУўЎ{H”Fп5e Ь@ўґ•'»ТґhиЮс‘QЅЧ”Ѓro ‰Ть®вІy&:i—Н}еу{n±яvҐiСР=ИrЈчљ2Pо№Ж•¦ECчјЂЊЯиќЇwц·v}гҐпJУўЃ@Ј7ѕиК@o!NЏј…+M‹–ЅсEWZмї{д-\iZ4pЎС{>”…Fыџ+M‹ў4zЇБ‡ІРзmбJУўЃсЅЧ”Ѓr#ЋэП•¦EЧ4zЇ)е>oWљЊЪи=цOEЏј…+M‹Fiф†™/WљЭуљFoy&—QрuѕЮЩЯfШхџ<?WљЭsФFoy¦Ї4з}D‹эw[иJУўЎ{ЋТи-Пф•жјЏи4rљvїkЅlЮD' EW0\6ч•ПпЭ)Яч†Вµ^6ПD' НГes_щьћ;еыЮPёVi\%ўђRБ Ќ|]ҐNщѕ7тФї?X]…4®С	Hў`ђFѕ®R‹э·«х*ќЂф
aл5v©ЕюЫUЬы":I*Оѕізѓ{фЅЇыoЧаКе°х»riҐЗQљї±ш®\К†­Яum\№ј¶щyфЧ°Bљ–+Ч°вњуodЏјЕmбП-= (z.хuтН•kX!MЛ•k Iюё†9зЯ)‹Ч;FПЇлЖћh»ѕфуйrg©яЩiЪЂkШPґ­]ЯoрквќЧ?ч®хЭуxќблъТП§Зѓж_ё†]ј-:Kэ‹Ч)]ЛюЕл-Дyµv–¤ъ~K;э|zО’дlн-ДЌ(ЮyЯOtНэ‹ЧsОїSЇvЊ> t€вБy‹'zя¶rнъчщљ{q^­ќҐ¤ ]Г/^П6ЧNsОїOї…Їmн=jоВ.ЮyэsЧЌЅvхЪйх®э‹ЧЋR{їю…­}2ш-|mkѓх‰¶Х5{^ъЈФR##,4чоZЄяЭ}^}й\плџќЂф  `ШBњОRЯ.»юќ¦Ќc[§=ѓ’ґtќэзќ)]Иўюjг\з,IDзќaэSдьл?Я5ёr9rвьл?Я5ёО9яy‹w\ѓ+#чЕ9зпњ%‰Бь~-ХЖ^ъщёr9—ю#°Јd°PШґя«ќ.yою№пнПЗ5ё†ТґW®aЕ”‡и9зП•kX!M‹yе\УњуЏ1r_‡iОщ—]ѓkµfaЊЛ№ф_MЖdyџlјљЊЙ(“Ќ2ѕўC§сцiуЩWaSmыјъ~ЧtЮѓ®\ољ¬едtЙsчВra№fІkpеТJђяІЖв»r№kІ–“е‰.кdЧµqеrЧd+'w–[5Zпяw*^/ТљЁSњN¦kp®iОщ—c–<°і$µ…яќ^їєЧАъ~ѓW_пШ«xgЏЪVћЬЭэч<ћkpеђY†НсОY’:\ЩВЯ?·•'чЯуx®iепЊq·+пЊ1›!Ў_щ|WZxё"а}u[©E†П•‘З4GК®ґPЖ‚aFO„Я•wЖ8·+-”±pMуX€сО·q3Ь‚{ф<rљvя~Wfр_ЬЭ5wСвa6ЅкJe,єУ†=}пjрrҐ€А8¦y,ё2r_‡ieЧаљжH9Ж!іЭ,ЊыџooWЦbЮя$ш]yc–ЫА·¦peэ›ЈюэџkpґРюЖц±{Ї6Ћ=ѓ’фNu®mВYv67]Ы„уђY†ЁW*%WЮеlДЏBЧ4”пЊс6¶+-”±pҐ€А8¦y ёWЦї™§VfWЮе6l¶РюРхэ¶Р~»GЫ<—юklр№ІюM›зТ®2Лzхп4]Япъwљц•-ьпёЧАъ~ѓWЧRэпоkџ}їяNmйд»Уќkџ}»"MсpnфZ:щол<Мf°vѕ\™ц<bM(3фЦЯ’…ўeПђ­i»\DоtзЪ#§эm†Х•йІ^бКИЃq¬яЬ]®їзТуoЩ3Ъњ»ѕЯйОµПѕ{CСіНµ±}кТ•7f9eє2н1xДљ2Pveє,Ч0t[© и№ф_Ј·lЌ+#'Ћх§›ЎM‹ювБ>o‹Nw®}цЭ8v}їg›kcыШ=ЏW]ѓkэзЋсЖ,·QfhУ„ЯЁЇлыќо\ым»qмЩжЪШ>vПгUW¦=зяЪO}ї§Їф3|®ј1Лm”wбКґЗ вьщ|†ъ~ПЗљ‹_­®ј1ЛmDзКґЗ вь~†ъ~_ЗВяNП®ј1ЛmDзКґЗ вь”o†ъ~§|ЯЛћ7(\yc–Ы $©peЪcqюьC}їз7Fяl6ЏзКіЬ ®L{"ОЗт`Ёп7–xї{Г•Іі№]™цDњ_З”ЎѕЯµ°Тп‘УФ•7f№а®ј1ЛЩ \™цDњ5e мКіЬЖWЮеl”]™цDњ5e мКіЬ ®ј3ЖЩШ®L{"Ољ2Pveдѕн}єЧъУгЌYОFtm~ї§Їф3|®L{±¦”]YяжПр—.†оъ~П6ЧЖцYє2н1hюу±џЎНпч|¬№шрХкКъ7зуЗГєлы=Ы\ЫgйКіњЌ5®L{±¦”Ъь~ПoЊюЩlП•хo&рМo0tЧч{¶№6¶ПТ•7f9Q]™ц<bM(3ґщэЖт пЧгaoёІюM,Џ‡†оъ~П6ЧЖцYєтЖ,gx…+УѓG¬)e†6їЯµ°Тп‘УФ•щlnWFNлИS†6-
 gI2ђ¤=CWЮе6 I*\лИУлЯ¬ЕИiКР]ЯпЩжЪШ>KЧаjплД8d¶Y0яІј†ЎлыќАsь=}Ґџбл+[шЯqе›?Г_є\iббvеќ1ОЖvеђY
ЈјЖХЮЈЈШ‚В•"гhпQve-†`vєєю|^O_йgшъКюw\9ДnОзЏ‡‘Ўлы}ҐjУ-fУ«1W¦=зу·€ђЎ{>Ц\|шjн±*\™цЬ"rБO†олXшЯйyѓВ•iЏБ-")ЯdиNщѕ—=oPёr€M,Џ‡Т•iЏA,Џ-"dиЖт пЧsйїЪvН эч<ћkуЖ,·¤(йКъ7НGљнЏ·МРхэ6џ}6Х>ьѕю№Ї‘ПЗљ‹п\SсТґҐ|:Ќњ¦ќ
{х/]П5ётЖ,g#ѕkJ#~ЊX‹жLWЮеl ў +Уѓgѕr”ш®L—% ®јтЕЩ•‘гkљ2ф"бґ©hф†ыЫчиъnЫiд4uҐ€А8¦4в»WЮе6Ђќ
WЦї‰XѓЇ%~јеш®ј1Лm _бКъ7П|е(сг-Їqeэ›yjҐav®Ѓ©xiЪR>ќFNУ®п»WXУ4Жіњ†ѕБъ[ІPґмІ5maDоtзЪsйїЪЎ4ЋbW¦=ЏXSКЭ?·…В¦э_§‘Уґ‹]{~v}Я•йІ^бКИЃq¬п[шжѕчO…СujЇю№лыmбзЂЧwеЌYОF|W¦=ЏXSК®L—еWFЊc}ЯВПР0чЅ*Њ®S{хП]Яoя;јѕ+лЯLc*3CїQ_Чч;Ќ©4МЅH8m 'J#§iЧч'v®ЃхэЇюЕkя;ј~ЧАфБу\ѓk}ЯВгЌ-v{XT €“gaНЪ"C}‹·ЌЅфувЎчyЫ•хпЕ®+нЅ@†;‹Ч®|–юwxэЪєЧАjН°3t®2ЛВЁЦ3ЊwО’дКґЗаэj5»ЧАъ~ѓW[§}ніпчЯ©®Б•iЏБ4Ћ4М®Н!і,ЊzҐ?Џх}ркzЅdҐRя=ЏзЪL{
[§щrm>лJЩЩЬ®¬3	[§хЌ—~‹c±ЧЂ+лЯ,к/„+Уѓжњ®Ы•‘ыj¦t№W.Їm~®Б5ё†Тґ€•kXСК“»ѕ^эч<№r+¤i+ЧаZКзЮ?ЦW>‡Fг°іФsйїjф\ъЇєv_щь~рџRg©I*ъїs[ёя«®Б5рЫыќк\mюу€q9—югјA‘:еыо+џпКе\ъЏс]№њKя…ЎП«п»r9—югDXT €CЖџёЈЯ^XµC[ш—ЌЅфуqеr.эЗoп„ :eшOЌИGёr9—юг·чO C§|ЯЛћ7(zўиўАД®Б•Л№фEЅ,ьи"nЩюwx}W.зТDqеr.эG†>ЇѕпКе\ъЏЂXS0tјэ„щmб_v†®\ОҐяXfи”Aш;K]v®\ОҐя(]%?CK#_W©-ьпръ®\ОҐя€вКе\ъЏ(}^}Я•Л№ф±¦`иxы	у3ЪВїм]№њKя±м\…­{ЇЯuтmфмыО?ЧаКе\ъЏхІy3t}ї…=/}›agр»r9—юг‚+—sй?I*\№њKяp®\ОҐя(.›7C‹эwKщфШ?®\ОҐяXvеr.эG|k
ЧаКе\ъЏвІyfиъOћ_
	JRZ	..T0  	;  THEN LOOP BACK
	DI		;  ELSE CLEAR KEYFLAG
	XRA	A	
	STA	KEYFLG
	EI
	MOV	A,C
	OUT	DCOMM	;   TRANSMIT CHAR
	JMPR	..T0	
;
;	8086 I/O ROUTINES
;	
OUT86:	MOV	B,A
..L0:	IN	STAT86
	ANI	TBE	; IF NOT READY TO OUTPUT
	JRNZ	..L0	;  THEN ..J0
;
	MOV	A,B	; ELSE OUTPUT BYTE
	OUT	DATA86
	RET
;
IN86:	IN	STAT86
	ANI	RDA
	JRNZ	IN86
	IN	DATA86
	RET
;
	.LIST
	.IFE	LSTDSK,[
	.XLIST
]
;
.PAGEЉ;
;|------------------------------|
;| 	DISK SUBROUTINES	|
;|------------------------------|
;
;GENERAL FLOPPY HANDLER
;(A,B,C,D,E,H,L)
;READS A TABLE TO DO DISK OPERATIONS
;  FIRST BYTE
;	0-3 = # OF BYTES TO SEND TO 765
;	4 = 1 IF DMA TO BE ACTIVATED
;	5 = 1 IF INTERRUPT IS TO BE PROCESSED
;	6 = 1 IF WRITE TO DISK, ELSE READ
;	7 = 1 IF ST3 IS TO BE READ
;  IF DMA IS NEEDED, THE NEXT TO BYTES ARE
;    THE START LOCATION IN MEMORY
;  NEXT BYTES ARE TRANSFERRED TO THE 765
; IF ERROR, RETURN ADDRESS IN X REG.
;  (USUALLY CONTAINS ADDRESS OF ERROR ROUTINE)
;
DISKOP: PUSH	H
	LHLD	MTRCNT	;NZ=MOTOR ON
	MOV	A,H
	ORA	L
	PUSH	PSW
	LDA	LSTATE	;START MOTOR
	SET	0,A
	LXI	B,0FBH*256+DPIOB
	PUSH	PSW
	MVI 	A,0CFH
	DI
	OUT	SPIOA
	XRA	A
	OUT	SPIOA
	POP	PSW
	OUT	DPIOA	;SEND	MOTOR	BIT
	OUTP	B
	RES	5,B
	OUTP	B
	SET	5,B
	OUTP	B
	EI
	LXI	H,MTRTIM
	SHLD	MTRCNT
	POP	PSW
	JRNZ	..J1	;MOTOR ON ?
	LXI	D,MTRTIM-MTRDLY+1
..L1:	LHLD	MTRCNT	;NO,	WAIT FOR UP TO SPEED
	DSBC	D
	JP	..L1
..J1:	POP	H
       	MOV	D,H
	MOV	E,L
	BIT	4,M
	JRZ	..J3
	MVI	A,44H	;SET UP DMA MODEЉ	BIT	6,M
	JRZ	..J2
	MVI	A,48H
..J2:	OUT	DMAWMR
	PUSH	H
	INX	H
	MVI	C,FPYBCA
	OUTI
	OUTI
	MVI	C,FPYBWR
	OUTI
	OUTI
	MVI	A,0
	OUT	DMAWSM	;MASK	OFF
	DCX	H
	XCHG
	POP	H
..J3:	PUSH	H	;SEND 765 COMMANDS
	MOV	A,M
	ANI	0FH
	MOV	B,A
	MOV	H,D
	MOV	L,E
..L2:	INX	H
	MOV	C,M
	PUSH	B
	CALL	W765
	POP	B
	MVI	A,1
	JRNZ    ..L3
	POP	B
	POP	B
	PCIX
..L3:	DJNZ	..L2
;
	POP	H
	BIT	5,M	;WAIT FOR INT ?
        JRNZ	..J4
	BIT	7,M	;READ ST3?
	RZ
     	CALL	R765	;YES
	STA	ST3
	MVI	A,2
	RNZ     
	POP	B
	PCIX
..J4:	MVI	B,2	;WAIT FOR INTERRUPT (1.2 S.)
..J41:	LXI	H,0A000H
..J5:	LDA	FPYFLG
	ORA	A
	JRNZ	FICLR
	DCX	H
	MOV	A,H
	ORA	L
	JRNZ	..J5
	DJNZ	..J41
	MVI	A,0FFH	;INTERRUPT TIMEOUT
	POP	B
 	PCIX	
FICLR:	XRA	A	;NORMAL EXIT
	STA	FPYFLG
	RETЉ;
;PRINT FLOPPY ERROR INFORMATION
;
ERROR:	CALL	FPER
	JMPR	FPEEXT
FPER:	LDA	ST0
	MOV	D,A
	LDA	ST1
	MOV	E,A
	PUSH	H
	CALL	DSDATA
	POP	H
	LDA	ERRCNT
	INR	A
	STA	ERRCNT
	CPI	23
	RM
FPEEXT:	JMP	GOMON
;	
;SEEK & SETUP FOR U AND W
;H=CYLINDER, L7=1 IF 96 TPI,
;L6=HEAD, L4=DRIVE, L0-3=SECTOR
;
FPYSET:	PUSH	H
	LXI	H,FPYTBL ;SET UP PARAMETERS
	LXI	D,TYPE
	LXI	B,21
	LDIR
	POP	H
	BIT	6,L	;SET DRIVE & HEAD
	JRZ	..J1
	MVI	A,1
	STA	RHD
..J1:	MOV	A,L
	RLC
	RLC
	RLC
	RLC
	ANI	5H
	STA	RDRV
	STA	SDRV
	RES	2,A
	STA	HDRV
	LDA	HOMES	;RECAL?
	BIT	4,L
	JRNZ	..J2
	BIT	0,A
	SET	0,A
	JRNZ	..J4
	JMPR	..J3
..J2:	BIT	1,A
	SET	1,A
	JRNZ	..J4
..J3:	STA	HOMES
	PUSH	H
	LXI	H,RCLTBL ;--YES, OUT-IN-OUT
	PUSH	H
	CALL	DISKOPЉ	LXI	H,SEKTBL
	CALL	DISKOP
	POP	H
	CALL	DISKOP
	POP	H
..J4:	MOV	A,L	;SET SECTOR
	ANI	0FH
	STA	RCRD
	MOV	A,H	;SEEK
	STA	NCN
	STA	RDCYL
	LXI	H,SEKTBL
	CALL	DISKOP
	LXI	H,TYPE	;SET TO READ
	RET
;
;READ A FLOPPY SECTOR, WHERE
;H=CYLINDER, L7=1 IF 96 TPI,
;L6=HEAD, L4=DRIVE, L0-3=SECTOR (1-10)
;
FPREAD:	PUSH	H
	CALL	FPYSET
	CALL	DISKOP
	POP	H
	RET
;
;WRITE A FLOPPY SECTOR, WHERE
;H=CYLINDER, L7=1 IF 96 TPI,
;L6=HEAD, L4=DRIVE, L0-3=SECTOR (1-10)
;
FPWRIT:	PUSH	H
	CALL	FPYSET
	MVI	M,79H
	MVI	A,DBL*40H+5
	STA	CMMD
	CALL	DISKOP
	POP	H
DLY2MS:	MVI	B,13
	JMP	DELAY
;
;FORMAT A DISK
;
SELFMT:	XRA	A	;SET SIZE
	BIT	4,L
	JRZ	..J1
	SET	7,A
..J1:	BIT	0,L	;SET DRIVE
	JRZ	..J2
	SET	4,A
..J2:	MOV	L,A
	MVI	H,0	;CYLINDER 0
FPFRMT:	XCHG
	LXI	H,FILBUF ;SET UP DATA FILE
	MVI	B,10	;10 SECTORS
..L1:	MOV	M,D	;--CYLINDER
	INX	H
	XRA	A	;--SIDE
	BIT	6,EЉ	JRZ	..J1
	MVI	A,1
..J1:	MOV	M,A
	INX	H
	MVI	A,11	;--SECTOR
	SUB	B
	MOV	M,A
	INX	H
	MVI	M,DBL+1 ;--N
	INX	H
	DJNZ	..L1
	XCHG
	PUSH	H	;SET UP FORMAT TABLE
	CALL	FPYSET	;SEEK
	PUSH	H
	XCHG
	LXI	H,FMTTBL ;SET UP
	LXI	B,11
	LDIR
	LDA	SDRV
	STA	RDRV
	POP	H
	CALL	ABTTST
	LXI	X,ERROR	;FORMAT THE TRACK
	CALL	DISKOP
	POP	H
	CALL	DLY2MS
	INR	H
	MOV	A,H	;FINAL TRACK?
	CPI	40
	JRC	FPFRMT
	BIT	7,L
	JRZ	..J3
..J2:	CPI	80
	JRNZ	FPFRMT
..J3:	BIT	6,L	;HEAD 1?
	SET	6,L
	MVI	H,0
	JRZ	FPFRMT
	RET
;
	.PAGE
;
;|----------------------|
;|	BOOT		|
;|----------------------|
;
BOOT:	MVI	C,0	;ISSUE ILLEGAL COMMAND
	CALL	CMD765	;  TO CLEAR 765
	CALL 	FICLR
        LXI	H,SPCTBL ;SET UP CONTROLLER
	CALL	DISKOP
	MVI	A,3	;TRY TO READ 3 TIMES
..L1:	SSPD	BOTSTK
..L3:	STA    	BOOTRY
	LXI	X,..J1
	LXI	H,1
        CALL 	FPREAD
	LXI	H,NOCPM
	LDA	ST0
	ANI	0C0H
	JRNZ	..J1
	LDA	FILBUF+3
	CPI	0A7HЉ	JZ	FILBUF
	LDA	BOOTRY
	DCR	A
	JRNZ	..L3	
	JMPR	..J2
..J1:	MVI	C,8	;SENSE INTERRUPT STATUS
	CALL	CMD765
	CALL	R765
	LSPD	BOTSTK
	LDA	BOOTRY
	DCR	A
	JRNZ	..L1
;
	LXI 	H,NOHOM	;OUTPUT ERROR MESSAGE
..J2:	CALL	MSSG	
GOT‹эw[шsЏэSбКе\ъЏ(®\ОҐяHsбКе\ъЏЂW.зТ¤№pеr.эG@’
†юпЬоџЏkp®\^Ыь\ѓkX!M‹X№†зњЏјЕ;дК5¬ђ¦E¬\ѓлњуЏqИ,eЖњ9Ю9KCїsтйу>x`o!ОТ•7f9eЂ]ъјм«®sю@ЊXО¤+‡МІ0ж“ю<вќі$1t1	Щхпу;K}^ЪЈяћЗseЪcр¶NуE†оуТ-ЋЕћ+Ї|qveдѕзь\зьЛ1^щвL†ЮзXмuсОk+хyiЏ~здгJЃqњуиКИ}љуќ!ЪJ]zЮўя±Ї=п4нџыОpй:зїгЌЩf2ўђЎПЫўўt}йзS]зьQb2K™1зї&Ю9KCїsтйу>x`o!ОТ•7f9eЂ]ъјм«®sюсcјАZpvеђYЖ|ДџGјs–$†.F/ІлЯзw–ъј-ъпy<W¦=oaл4_®ЊЬЧбњTЧ9я51^щвL†ЮзXмuсОk+хy[ф;'WЉЊгњ|WFолРњпЙРVк2РуэЏ}Хиy§iяЬw†KЧ9яЁ1^щвЬtҐH‡‰-ТйъТП§SбЗ•‘ЗщgЊmҐ®/э|ЅЈс`П9я>W±9сзпњ%)Ю†о7кkSЏјE_ЩВяNПҐ^ ЂВ•[X.ёІюНщ€?Џxз,Iс.ёrИ,c>зҐxз,IЭ¦ѕЉRµiЏ®/э|\iббнКіњЌ2@†>ЇѕЯзэSк”AшЯqеќ1n#№2]–e|dиЮїЛхч?;M{О ы”Z~®Њњ8ОщG!C›µR—^5Ъњ{№њуЏвКtYв#C›&ьF}Ѕ/@Сям4н9ѓPмSjщ№2r`зьг“ЎMсX©aо_<ШжЬЛењ|Ч9я(1±9џTсОY’ЪВtЮэапvљєТВГнКъ7з“J#Ю9K’+лЯњлtпњ%Й•7f№Ќ2ъјъ~_E©ЪґGЧ—~>®¬s>зҐxз,I®2K™1з]јs–$†~здУз}рАЮBњҐ+oМr6К єфyяШW]зьсЕxЃµамК!і,Њ№Nя<вќі$1t1z‘ђ]я>їіФхЅiя=ЏзКґЗа-lќж‹ЭхЅiяЬрЙ~яіУФ•Wѕ8»2r_‡sю(dhsnуыџмw}йзг\зџ±…ҐiСРµTя»»Шµзч`П9я'\№/О6W2t›уПэsП6Ч¶Рю>ь>Ча:з]ЊWѕ8“Ўч9{]јуЪJ]Я›ц;'WЉЊгњ?>І]НщО0ЖИ}с†яђЎ­Фe з-ъыЄСїx°зќ¦эsЯ.]ѓkX!M‹yеV¶NыпyјК•kX!M‹yе\ПЫўwЧ—~>®Бu>вП#Же\ъЏ(С®\"тLйrе‘ЏаљтІмКе\ъЏсЃ"ЮЁ®\ОҐя0ЂР~Чщ¤Т€q9—ю#Ађ\№њKя`(\зs^Љq9—югГqеr.эЗиКе\ъЏeЂбепКе\ъЏе5жkБ•Л№фI*Д®Б5°ѕ7нџ>D§Т°Pјг\з:эу€q9—югJбКе\ъЏЂTёr9—ю#АPј-ЗЎэ®sќn!b\ОҐя0А‡иTЉw\ѓkаyi;џэ_яЬ©4,п4а\з“ю<b\ОҐяё°Pёr9—юcW.зТ\ѓ+—ГЦпКҐ•Gэ~cс]№”[їлЪёrymууи®a…4бёr+љвY№†U›в!g›+Щ\№†Mс¬\Г
iВqе\№9q¶№єЧАx_ЌЅфу©®Б•‘ыbљsюсОY’:¤<DЧїПwEМ9яcдѕ€sю€}о®џпКИ}1eX?CК°жсєюэБкКИ}1eh!CК°жс:ы,ЫBWFо‹)Г~†”aНгu*цYvї+#чЕaлg¶юNЕ>ЛОаweдѕxЃ0SС©ШgЩь®ЊЬПЫв†у¶x§S±ПІ-teдѕXды1Ь{]ј-ъз.тэъКuйКИ}±ѕ!к”ЎѕсТoaлФ•‘ыb}яџ)C}їяЩiЪ8teдѕXЯЇ/1Фч»ѕфуiє2r_¬п‹{3Фч[Ь»·зХкКИ}сј-ОЫўҐ“п¶N]№/"ЋэЏqмэs[§®ЊЬ‡­ї~†у>x`[Чї?X]№/Ц—юЩхҐџOяіaыЫ]ѓk¶NыЪgЯпїУПг№Ча*®yЧGt.zЮхu–ZШ:нkџ}їяNПcZ—®Б5PШ:m p®Ісў CГЬІ±їН°яћЗs•Ќ_&:eг®\"т”Ќ Z6цэч<ћ+—€| CЧtцOEпу¶+—€|…=3(вљЃfhaOП $}нsч<rљєr‰ИG0U0цАЂ6-КР©xijф#§Ж^ъщTЧа(lќ6Pv®\"т”Ќ_6 2ґlмяъпy<W.щ@†®ймџЉЮзmW.щ
{fP2Д5—ZШУ3(IF_ыЬ=Џњ¦®\"тL+{`e†NЕKSЈч95цТП§єЧ@aлґЇ}цэю;=Џњ¦-еУвXмхЋ№WqН@ЊKD>‚йєлхЙРхҐѕЮйvљєr9—ю#JјуЁИ2z9M»Vъ®\ОҐя%Ю‰&љGE–'^;|·iСРуИiЪч®SЧ'»c\ОҐяш/Ы‹M—]№Dд#(кґЪ8d№ZШ:­6о!Л®\"тц<ш‘еfhaПK?џRЯ[жКе\ъЏ{дђЎч9®\ОҐяђЎч9•]№Dд#(мyрЛџЎSсТґ«Ќ{®\"т¬ҐъП”ќ%©ѕп\П«п`Oґ”OЈґ…яќ^ї±—~>µ'ІиЂШЕД®БХВ_Ћq9ЏйМWяBЊЛyLg.ёZшQb\Оc:sБ5ёFАыкїзсZК§џмїчh°>Ча№Ї?ЏXGо‹ВЦ)Cc/э|ъз¶N]№Ї¦°х%†ЖцxїУщь®ЊЬя/Щъъїъ;еы^¶…ш»юэБкКИ}ся’…mбю–Nѕ;еы^є2r_ьї”БПРьшызNщѕ—®ЊЬkЎ`иїзсZ‹=Ш5ѓPё2r_јАЏнБРOfc{јЯ{gм’+#чЕaЎЁWј(ЎҐ|zЮХ¦6џ}6UЧа€нcч<^m)џ~ІяЬЈБъ\ѓ+ўJc›c\ОҐяёb{ФЕёњKя5I*\EќJГгr.эG@’
WlЏЉ—sй?®iШй±^"тLГ¦©+¶GєEЊЛ№фWlЏoп—sй?®Б5{йзS]ѓ+#чЕюyL]№/¦±=\№/n№аgиу¶иtзЪ8v*64їѕЋ…їз
WFо‹[DRѕъј-:Э№6ЋќЉНЇSѕпeП®ЊЬEћsю-r#ц№{ОщчюNюmОэs§t№2r_4зtЭmЎэvчъAМћпї+#чЕt_Y’ъјШЕh„<ЧЙЧ;=,|ќ%©ѕпЉ?цRЊ‘ыbJWј(Ц'ъз>OШуТoД>wП9яNйкx_®Б5рОзЫЗоyјк\«НЗј&Же\ъЏАЫC[hїЭЈлЯ¬ќҐNщѕ—}еуыњ^CЧzе<b\Оc:іМР`}ў-мyГй]Kхї»Ґ|є^9Џw\Ї}.шc\"тLаIЕqf©ЖёњKяpх’†9Же\ъЏЂл7bя—sй?®{Ь	ю—sй?ќ2mv–zЏ}оюѕк:Г©4М1.зТZЫЬR>=o8}ўуiОNџpЭг–†9Ж%"БЁ АРіНХЫгgг‘Џ М?ГзљЖTж—sй?®ЯЮТ0ЗёњKяђ¤В‚·4М1.зТ\§ЇґЕ‰q‰ИGpъJ®Тёю<b\"т”оязб*кїЇ—€|Л@9є‚ЎЕюЇлЯчеКҐ• яeЌЕwеr.эЗиўє®Ќ+—Vzь—5Я•Л№фггs]W.з1ќYfhйјЧR>Цз\Г
iВбК5¬ЪВяОЇЯШK?џЪИѕБъ{~ќaпо•kXхњA(ц)u–zГ~Шѓ}ѓгЫkјОRгл•kX!M8\№W.з1ќ№АРзХw°'ZК§УOќЉe®\Оc:sЃЎП«п`Oґ”O§џ:Л.»bQЃ".Ж%"Бz°Ё CGє€лoпwzўфS§bЩ»r‰ИG°LєJ-Ќ|]Ґ¶р/{ўфS§bЩ(»ЧА;џЧ`}§-ьпръХ5ёZшгЗёњЗtж‚«…MЊЛyLg.ёZшЈЖёњЗtж‚«…?JЊЛyLg.ёZшсЕёњЗtж]ѓ«ЁSc\ОҐяёАРp№—Ц'ЪВNЧЌ,/аs-ЋА^Љ1r_.ч’mЉgBr№А^Љ1r_.чІM:!№Љk†(1.щ—{Й6Е3!№Љk†1.щ—{Щ¦	ќђ\№Dд#04\оe›&tBr®вљЛ1.щ¦л®Ч'CЧ—ъz§яЩiкКе\ъЏ(сОЈ"Лdиyд4нZXй»r9—юc”x'љhYћxнрMЬ¦ECП#§iЯ»N]џмћc\ОҐяш/Ы‹M—]№Dд#(кґЪ8d№ZШ:­6о!Л®\"тц<ш‘еfhaПK?џRЯ[жКе\ъЏ{дђЎч9®\ОҐяђЎч9•]№Dд#(мyрЛџЎSсТґ«Ќ{®\"т¬ҐъП”ќ%©ѕп\№ј¶щ№Ч°Bљ–+Ч°"bџ»зњ#ы<дy[4xхПэ‹ЧіН•+Ч°Bљ–+ЧаЉsю1
лКіЬ I…+лЯДцЁяbh;ЫЯШпчюэ[ыК~W™eЅЊъwљ†>ЇѕЯхп4н+[шЯqеі¤+Уѓ"П9Wжі№]9qDМeW¦=…­SW™ea жJ®L{ЮЇVі+Уѓ)C]№ЇCДњуw®€№cЪcРњУu3ґ…цЫ=lЬл1{2јь®ЊЬуЗ^bиЖ±#чХ?wJWзУ)]сўфDхЅFМ{ibєєЉ<зьcј1Лm”Л®¬іѕ”аgиу¶иr№лK?џкКъ7ПKр3фyя”є\оoпW]iZ4tявdР\]ъпј-эw\yc–Ы@aиъ~§|ЯЉю№ПЫВ•Cf9e (Z&ЅУе®/э|zяЮэнэ\iZ4tЧ7^ъ-ЋЕ^®2Ka,0tэыьЮїяЩiЪЂСхҐџO/Р•CfY)]Э#oСхпу{q^­=СьМBНќҐNйљШ5ёD†/Ж¬EуЄ†®{=т-цЯ®јАZpfаdW^`-(8Щ5ёєтkБ«"\ygЊЫ®L{¦bZ­p=€H9Ж+_ј*В5ётkБ‚Ѓ“]™ц¶N›ЎGЮўлK?Чѓе‡ШMQ§©”иЪН|67C[©Eќ¦Rjф\9q<€<eиюЕѓэПNУy‹':O]№Ў%рЂ‚ЎM‹ѕQ_ЧчЪJ-lќvѕZdш:џ~здгКИ‰kД(3ґiВVjaлґуХ0я>Јс`ЏњЇю№Ы~W™eaњ—аghS<oФЧя”z›·…®йрfhсТyчѓїПы§Ф)ѓрїгК+_,ъјъуy-lќvКчЅЎh±яvе•/
W^щвмКИ‰гA@ЙМРVк2РзэSЄFявБ~здгК+_ј*В•‘ы:<€CяSкmЮєЧѓИУ‡МІ0кK	юРвҐуоЧ—~>ќ2я;®йрvе•/}^эщј¶N;еыЮPґШ»тК]yе«MсМ®Њњ8„Ир1ґ•єѕфуiфъ¶9яЬ)]®ј1Лm”†~Јѕ®пчyя”:eюw\Yяжy	~WZxX0ґ…йјыБЯ#oСW¶рїУsЙ•Эs©  и‰®ўTmЪЈлK?џљ1±+пЊqП•йІ,mkЏ]џ·EЧ—~>ЅH8н2РтseдА8xХДРmҐ†щэ‹ЫњѓWM®ґрPётЖ,џ0ґiВ8v}йзУ)ѓр7z=|ІЯЦ–]ЯЇэs—'v=рЄ)FC[О»ь]_ъщtК ь®ЭјтЕ«"ъјъуy-lќvКчЅЎpeдѕ"ГЗРжч>ЩпъТПЗ5ё”М1^щвU®ј1ЛmDзКуѕkp=‘б‹сКЇЉ`и>/}+•є^†+egs»тјп\Sѕп;eсZК§зњu}жњ®;FЩЩЬmЎэvчz§їмуМKWЦї‰ЁТШf†Fд#к?-Ќmо,I®¬іЁ§ПРE®їgP’Юiwъ{®¬„;БПРiј}„{Њњ:e~WЦї	уф•:Ќ·Oc{јЯv¶Я•7f№$
Гм,Im>ы*lЄ®L{Ћ±*\™ц¬п_fА•Cf9шЂ‚A<iѓг·ёwo!О«µmm|@бКґЗ`}_ЬЫ•Cf›…Ѓ-ґ?ґщэЮBњОRЧtЮѓmЎэvERM: LXI	H,OPTON
	CALL	MSSG
	DI
 	XRA	A
	STA	KEYFLG
	LXI	SP,STACK
	EI
	JMP	TERMNL
CMD765:	MVI	B,10	;CLEAR OUT LEFTOVER INFO
..L1:   PUSH    B
        CALL    R765
        POP     B
	DJNZ 	..L1
	CALL	W765	;SEND COMMAND
	JMP	R765	;READ FIRST DATA

;
;WRITE A BYTE FROM C TO THE FLOPPY CONTROLLER
;WHEN STATUS SAYS READY. SET Z IF TIMEOUT.
;(A,B,C)
W765:	MVI	B,1FH
..L1:	DJNZ	..L1
	MVI	B,10
..L2:	IN	SFLPY	;GET STATUS
	ANI	0C0H	;MASK READY & DIRECTION
	CPI	80H
	JRZ	..J1
	DJNZ	..L2
	RET
..J1:	ORA	A	;CLEAR Z
	MOV	A,C
	OUT	DFLPY
	RET
;
;READ FROM FLOPPY CONTROLLER
;WHEN STATUS SAYS READY
;(A,B,C) SET Z IF TIMEOUT
R765:	MVI	B,1FH
..L1:	DJNZ	..L1
	MVI	B,10
..L2:	IN	SFLPY	;GET STATUS
	ANI	0C0H	;MASK READY & DIRECTION
	CPI	0C0H
	JRZ	..J1
	DJNZ	..L2
	RET
..J1:	ORA	A
	IN	DFLPY
	RETЉ;
	.LIST
	.IFE	LSTDSP,[
	.XLIST
]
;
	.PAGEЉ;
;|--------------------------------------|
;|   500 DISPLAY & KEYBOARD DRIVER	|
;|--------------------------------------|
;
;	COMMAND CODES
;
;	BEL	BELL
;	BS	BACKSPACE
;	CR	CARRIAGE RETURN
;	LF	LINE FEED
;	CTRL/Z	HOME CURSOR & CLEAR SCREEN
;
;	ESC =LP	POSITION TO L(0-24) AND P(0-79)
;		OFFSET BY 20H
;	ESC YLP SAME AS ESC =LP
;	ESC A OR CTRL/K		CURSOR UP
;	ESC B			CURSOR DOWN
;	ESC C OR CTRL/L		CURSOR RIGHT
;	ESC D			CURSOR LEFT
;	ESC H OR CTRL/^		CURSOR	HOME
;	ESC J	ERASE TO END OF SCREEN
;	ESC K	ERASE TO END OF LINE
;
;	DISPLAY ENTRY (CHARACTER IN C)
;
DISPLY:	PUSH	X
	PUSH	H
	PUSH	D
	PUSH	B
	PUSH	PSW
;
;	CHECK CYCLE
;
DISP1:	LHLD	CHRADR	;H=COLUMN, L=LINE
	CALL	CMPOFF
	LDA	DSPCYC	;A=CYCLE
	ORA 	A
	JNZ	ESCCHK
;
;	CHARACTER OR CTRL
;
	MOV	A,C	;CONTROL?
	ANI	60H
	JRZ	CTROL
;
;	HANDLE CHARACTERS (FROM C)
;
	MOV	A,C	;TRANSLATE ALTERNATE
	CPI	'@'	;CHARACTER SET
	JRC	..J00
	CPI	'a'
	JRNC	..J00
	ANI	3FH
	PUSH	PSW
	LXI	D,CHRTBL
	XCHG
	LDA	CURCHRЉ	MOV	C,A
	MVI	B,0
	DAD	B
	MOV	A,M
	POP	B
	XCHG
	ORA	B
..J00:	MOV	E,A	;SAVE CHAR IN E
	MOV	A,L
	ORI	0E0H	;CHAR COMMAND
	OUT	SDSPY
	MOV	B,H
	MVI	C,DDSPY
	OUTP	E
;
;	SEND ATTRIBUTE
;
	ANI	0DFH	;ATTRIBUTE COMMAND
	OUT	SDSPY
	ANI	1FH
	MOV	L,A
	LDA	CURATT
	OUTP	A	;SEND IT
;
;	BUMP CHARACTER POSITION
;
	MOV	A,H
	CPI	79
	JRNZ	BUMP
EXIT0:	XRA	A
	STA	CHRADR+1
	MVI	C,LF
	JMPR	DISP1
BUMP:	INR	A
EXIT1:	MOV	H,A
	STA	CHRADR+1
CRSRET:	MVI	A,0ACH	;SET CURSOR
	OUT	SDSPY	
	MOV	A,H
	INR	A
	OUT	DDSPY
	MVI	A,0ADH
	OUT	SDSPY
	MOV	A,L
	ANI	1FH
	OUT	DDSPY
EXIT2:	XRA	A
EXIT3:	STA	DSPCYC
DSPRET:	POP	PSW
	POP	B	;POP AND RETURN
	POP	D
	POP	H
	POP	X
	RET
;
;	CONTROL CHARACTERS
;
CTROL:	MOV	A,C
	CPI	ESC
	JRNZ	CTROL2ЉCTROL1:	MVI	A,1
	JMPR	EXIT3
CTROL2:	CPI	BS
	JRNZ	..J2
	MOV	A,H	;BS
	ORA	A
	JRZ	EXIT2
	DCR	A
	JMPR	EXIT1
..J2:	CPI	CR
	JRNZ	..J3
	XRA	A	;CR
	JMPR	EXIT1
..J3:	CPI	LF
	JRNZ	BELCHK
	LDA	CHRADR
	CPI	LINES-1
	JRZ	..J4	; LF NOT AT BOTTOM
	INR	A
	STA	CHRADR
	INR	L
	MOV	A,L
	CPI	LINES
	JRNZ	CRSRET
	XRA	A
	MOV	L,A	
	JMPR	CRSRET
..J4:	MVI	A,0ABH	;LF AT BOTTOM
	OUT	SDSPY	;UP SCROLL
	OUT	DDSPY
	LDA	LINOFS	;BUMP OFFSET
	INR	A
	CPI	LINES
	JRNZ	..J5
	XRA	A
..J5:	STA	LINOFS
	MOV	A,L
	INR	A
	INR	L
	CPI	LINES
	JRNZ	..J6
	MVI	L,0
..J6:	CALL	LFCLR1
	LDA	CHRADR+1
	MOV	H,A
	JMPR	CRSRET
BELCHK:	CPI	BEL
	JRNZ	HOMCHK
	LXI	H,BEEP	;BELL
	CALL	SOUND
	EI
	JMPR	EXIT2
;
HOMCHK:	CPI	1EH
	JRNZ	UPCHK
HOMCK1:	LXI	H,1
	SHLD	CHRADR
	MVI	C,8
	JMP	DISP1Љ;
UPCHK:  CPI	0BH
	JZ	ESCHK1       
;
LFCHK:	CPI	0CH
	JZ	ESCHK2
;
CLZCHK:	CPI	1AH
DSPRT:	JNZ	DSPRET
	LXI	H,0
	SHLD	CHRADR
	CALL	CMPOFF
	PUSH	H
	CALL	CLTOND	
	POP	H
	JMPR	LP2
;
;	ESCAPE SEQUENCES
;
ESCCHK:	DCR	A
	JNZ	LINCHK
;FIRST CHAR. AFTER ESC
	MOV	A,C
	CPI	'='
        JRNZ	..J0	
;
;	= - DIRECT POSITION
;
..JF:	LXI	H,DSPCYC ;SET DSPCYC=2
	INR	M
	JMPR	DSPRT
..J0:	CPI	'Y'
	JRZ	..JF
..J1:	CPI	'A'
	JRNZ	JMP2
;
;	A - UP
;
ESCHK1:	LDA	CHRADR
	ORA	A
	JRZ	EX2
	DCR	A
	DCR	L
	JP	LP1
	MVI	L,LINES-1
LP1:	STA	CHRADR
LP2:	JMP	CRSRET
JMP2:	CPI	'B'
	JRNZ	..J3
;
;	B - DOWN	
;
	LDA	CHRADR
	CPI	LINES-1
	JRZ	EX2
	INR	A
	INR	L
	PUSH	PSW
	MOV	A,L
	CPI	LINES
	JRNZ	..J30
	MVI	L,0
..J30:	POP	PSW
	JMPR	LP1
..J3:	CPI	'C'
	JRNZ	ESC1
;
;	C - RIGHT
;
ESCHK2:	MOV	A,H
	CPI	79
	JZ	EXIT0
	INR	A
EX1:	JMP	EXIT1
ESC1:	CPI	'D'
	JRNZ	..J9
;
;	D - LEFT
;
	MOV	A,H
	ORA	A
	JRZ	EX2
	DCR	AЉ	JMPR	EX1
..J9:	CPI 	'J'
	JRNZ 	..J12
;
;	J - ERASE TO END OF SCREEN
;
	CALL	CLTOND
	JMPR	EX2	
..J12:	CPI	'K'
	JRNZ	..J14
;
;	K - ERASE TO END OF LINE
;
	CALL	LFCLR2
	JMPR	LP2
;
;	H - CURSOR HOME
;
..J14:	CPI	'H'
	JZ      HOMCK1
;
;	I - CURSOR UP
;
	CPI	'I' 
	JZ	ESCHK1
EX2:	JMP     EXIT2
;
;	MULTI-CHARACTER SEQUENCE HANDLERS
;
;	CURSOR POSITION LINE NUMBER
;
LINCHK:	DCR	A
	JRNZ	CHRCHK
	MVI	A,3
	STA	DSPCYC
	MOV	A,C
	SBI	SPC
	CPI	LINES
	JRNC	..J1
	STA	CHRADR
..J1:	JMP	DSPRET
;
;	CURSOR POSITION COLUMN NUMBER
;
CHRCHK:	DCR	A
	JRNZ	EX2
	MOV	A,C
	SBI	SPC
	CPI	80
	JM	EXIT1
	JMPR	EX2
;
;|------------------------------|
;|	DISPLAY SUBROUTINES	|
;|------------------------------|
;
;	CLEAR LINE L·їН°S±O]є2н1xїZНЭ<°і$µщм«°©6ЋќЖЫ§о—+]9Дf¶NЫґhиъ ићуаoaлґqШ?wJ—+пЊ1Ы•Іі№]Yя¦ЁSi:Ќ·O‹:•†Щ•з}єЧъюebј1ЛmDо‹!r_maэLЯfиКъ7†ъуy№Їю№sОЯ•CfY€9зя: жњ?шO©Їlбwe-†`™Ўю|^Gо«оYд
ёІюН5®2ЛВE®іИµь§ФW¶р»ІC0Є+Пы®Б•ЛaлwеТJЏЈ~1OЌЕwеR6lэ®kгКеµНП5ёЦ7DќЖ8d–…0t}їЯ9щtКв№тО·‘Ъь~[§ЌCW¦Л
[§mҐ¶N[дWбдЯOfлwеЃ‰Эїx°ПыаЃ®¬іѕ©ЁS†~Јѕ®?џЧВЦiгР•[n†ѕБсн5J=—єХ•[nWn!ё]№…аvеќ1c»rИ,…!®yЧzС?чјлл,µёfWЉ-(\yЮw®a…4-bеVёxr-·я¤ЌѓхuЛkн{ЦГ•Г[ЧsZ№†Тґ€•kp­пя3Ќ±ОI°ѕй?S†юg§iяЬхЅ©k‘пгyџ}Юм=jn°>Сs©xЯҐ.тэ\ѓkX!M‹X№†.ћ\гвб—‹¶®q°Ю"гЎny­}ЇГГБzёrxляК5¬ђ¦E¬\ѓk}їѕгќ1n#№ІюНъ¦х%2авб—‹¶®еў5.Ю¤®<п»Ч°Bљ±r«ЖЕ“лµ&@kґµЦZ‡‡‹Ы8Xo‘сP·јЦѕзД•kX!M‹X№ЧъѕёwЊuN‚вЮ[Wћч]ѓkX!M‹X№†UЛ­CCЌ‹
MЇqсрЛE[ЧЁ'™@^xлzN\№†Тґ€•kp­/эіcј1ЛВ \ygЊГH®<п»Ч°Bљ±r+ћ·Eп®/э|И•kX!M‹X№Чу¶€q1ЦЎЌhшсO2:аJ\94N‚?j92L‚?j9tА•йЮ4-„­{Ї±=ЮoяТ•хoЉ:•†Щ•,тzD3К®Д•Cг:<ґµў-ЋлрРЦкh‹Г[‡&·^4Ф®Д•Cг:\щPЎбЂL‚+ЧлрРЦкµРдР\9Б"ЇG4#zл&ACеJ\94FoќЬЪ/ЏrлрРд·'AЌ†
U4ь®ДЙL°8®‹^ґЕб­#ѓ\ґ^Ю:щў­› еЦЗлuxhkyфЧ°Bљ±r+"ЋэЇwЧ—~>дК5¬ђ¦E¬\ѓ+вШяb\ЊuhD#РrС?юI&љ\ґu®Д•Cг:<ґµў-ЋЁЈЙ5ZЇГC[«Ј-oљЬzСP»r‚h‹L4?ў·n=9ј–[ыЕбхzЁї+qеРЅurkї8<Wв_ЬzЊЮєIРP‘!zлЦ“ГлIPЈЎB?љЮZтseдА8в_ТIPЈ‘яъxш'mщў­лIPЈЎBїkpЊЮєхдрZ.ZO‚ЄhшСдрЦ2O®‡¶m<9јuё®Б•,тzD3д…jRЬх&„<е|ЁсC®'AЌ†
U4ьЅ?®+лЯu*3ZШєзсЫгэ¶р/]‰+‡ЖIPЈбG-зJTkЎoТµp'%ГZлбNЪrСoRWвКЎqФhkбNJ†IPЈ­…;iЈ7.Ю¤kбNкJTлЈZ‹ёx“К­›Ф•ёлЈZ‹“ F“[7)&AЌ&·nТFo\<ьrл&u%ЄµР€‹7).~WвКЎqФhёxшЙ0	j4\<ьЌЮёx“ввбw®шЧџtФh1Юе6 I*И lЭуxЌнс~[ш—®¬SФ©4М®Б5яъxш'mщў­ли­[OЇеўх$ЁСPЎЉ†Mo­ЖЕГ/mќkp%ЄµР8	j4ьЁеИЂ†zн{ФhЁPEГЯлр&@[µь\mС\9qDC…*~2аNєЮвz=щu49Ча8Aґux=	j4TЁўбG“Г[«ЧббЏ¶n-Ь^‡7ЪzЁ]ѓ+ЧВїЋhd5~ФrЌЮ“ FГЏZYv%®'AЌ†µњ+Q­…F\јIЧВќ”ёhахZлбN*?WўZЊхёѕ1	jґµp'u%ю	З	ИЂ‹7йZё“6zO‚m-ЬIезКИЃqDC…*~2аNєЮвz=щu49ЧаёЦzё“в6Ъ:ј–[ЇqС&Аs®Dµлq}cФhrл&u%~4TЁ€‹7)ю	ЗЂ‹7©ЬєIЅ'AЌ&·nRщ№2r`СPЎЉ†џwТхЧлЙЧЁЈЙ№Ч@№uhш'Еmґux-·>^гўMЂз\‰j-4ввMЉ‹‡џёhа5.~№hлдзJT‹±Ч7&AЌ†‹‡Я•ш'X' .Ю¤ёxшЅ'AЌ†‹‡_~®ЊG4TЁўб'о¤л-®Ч“ЇQG“s®Ѓ Йб_Яи	ў-2^ЛEkФx‹!Чёxшеў­kщў­kщ&‘›d^ЇГ“ПХ•лЎ^З	И0	j4\<ьЌЮ“ FГЕГoЩ•D[dўђхZMѕ–[‡†Rщ№явЦ#юЕMЂ»892аЏ6	j№N—<wгвб—‹¶Ч•‘“€:ZґE–Џё“®·ё^OѕF­Ј-2Ю:щPE‹ћkpЊ¶ИxлдC-z-­Qг-†\Л­CГ?©kpе‹ј'0 2L‚Ј7аСGTлЈZ‹“ F“[7©+ЧCЅ\Я•ёлЈZ‹“ F“[7)&AЌ&·nТFпIPЈЙ­›4ЮІkpњ Mяъ-_ґIPЇeфhл&m4Ьћ5j<ьxёёhлЦѕЧбЎ­е\QG‹¶ИтЕёлР€F еў5~ь“L0	*4№hл\‰+‡ЖuётЎBГЦбК‡
ЌЮЂ+#чuё.zС‡·ЋrСzqxлд‹¶n‚–[ЇЈ·n=9<Ча€:љ\ЈЎоIPЈЎB?љЮZЅґukЅo±?Йzлрp{qлрђлрРЦr®hЁPEГгb¬C#Ђ–‹ЦhшсO2Ѓ+qеР8	j4ьЁеИ0	j4ьЁеЅW®‡zСИPn№hЌ†я$ёWЌлpеC…†2¬Г•ЅЛ®Б5¬ђ¦еК5¬ўM0A4ФЌ?ЪZx-_ґu}ЮЌ†z­Fы_ЛЄhСГн^№†Тґ\№ЧuС‹¶8јu1.Ж:4ў‘aBа­‹ЦrС?юI&p%®сЦЙ‡
d@­сЦ­‹¶·'Z{<№‰]Yя¦ЁSiЙраћЗklЏчЫВїt%ЄµР€‹7).~2аЏ6Бв&‘ГлхЈбК5.~№hл\™ПжfА)№rеЩ‡8E"Wte>››§Hд
‰lv–zў|voyО>·xЧѓbГпКіpЉD®Ш¦E3llрu–єЁSWвКЎoТхqеИ°~4\№ЖЕГ/m]ЛEk\<јI]ѓk ~№хЇЧЏ†+Чёxшеў­“џkp%ЄЕXЏллгКЎб—cX?®\Јб—[o‘сZ>Th8pеС™hЖ®њ`‘ЧгF™hЁў‡¶цё-/<ьС&АГнІ+Ј­C#ў‡†ЫлЙ5Єuxhk­Ѕь\9q”o=TлгК‘AѕхPЎкхЈбКхzт5кhr®Б5pэhёr-ЇIд“o]Јб—[o‘сЊЖE› ЇСpoТ–Ч$тЙ‡·N~®Б•ЁЦB#.Ю¤kбNкJT‹±Ч7ЦЗ•[wR\ґ	рz­хp'•џ+сO°8N@\јIЧВќґС{}\№µp'•џ+#Жuґ	РдрЇп\qС&АлµЦГќФh\ґ	рZnюIезС\‰j1ЦгъЖъёrrл&u%~4TЁ€‹7)ю	ЗЂ‹7©ЬєIЅЧЗ•“[7©ь\90ЋЁЈMЂ&‡}Ча€‹6^Їµо¤FгўMЂЧrлРрOj4.Ъx-ЇIд“oќь\ѓ+Q­…F\јIЧЗ•s%ЄЕXЏллгКбвбgАЕ›t}\№FпхqеpсрЛП•ш'X'peдДq49ьл“wТхЧлЙЧ Йб_Я5ё.n]ґЕб­лµЦГќФhyM"ЧЁЈЙ5юhлЦбб—k\<ьrСЦ№WWФС&@“Гї~ХZh\W.zлдИ°~4\№ЋЮєхддрPЛП•СЦЎН•шQO"ЋэЇ ~Txhлzэhёr-ЇIд“П5ёNЂ¶цЅ>Ъ"гµ\ґ–o=TЁZn}ј^?®\ЛkщдГ[з\е[Хъёr1ўZЌёx“®…;©+qеРё>®ЬZё“єХъЁЦ".Ю¤rл&u%оъЁЦвъёrrл&u%ЄµР€‹7йъёr®Д•Cгъёrёxш]‰j-4®Г•ИЂo­–‹ЦлрРЦ’џ+Ј­C#љ+сЈћ<o‹ў’aнсpЌ^Oѕ.»r1ЦЎЌ@ЛEk4ьш'™А•ёrh\W.zлдИЂ:Z/хZлЎЖAGoЭzrx®Б50е«ФbяЭ?w>-ќ|чJТ;®Бu49ьлЗ€j-4ввMЉ‹‡џ бNЪтљD>щрЦ5кI&ђЮ:WўЎ^Џёxш'АќФ•D[dў2РИ°m­µo№hЌ»юzтЙ№r‚E^Џл ЦЉ6‰јPб5юh“ –sҐШ‚…+Е,\)¶`бJ±WЉ-XёRlБВ•kЎ­Ех]ЧGХлЈбц:<Thrл-2^ЇW®е5‰|тб­kґµЦZ‡‡‹лJT‹±Ч2ЦЗ•“Ч$т№r-ґµёЦGХиЅ~4\№F[k­uxёё®\ьлгЂ¦EкhСлхP·x®Dµ>ЄµёЦhhk­#рддYЬ$rќ.yо^MН5p‚E^ЏшЌт>2 ВCЌ№х;љ|=AґEЖs%ЄµРёm­h‹#CфЦ_яъ=ґµ—џ+Ј­C#љ+#Жq]ф&€¶ИxdАќtЅЕхzтх:<ґµ\ѓk`фЦ­'‡ЧС‡·MnЅhЁЌћ mЭ¤Ќ†z­ЖЌЮzrшЧпµЦ[‡‡_nЅhЁ]ѓ+'Xдх€f”]‰+‡Жхqеў·NЋлгКEoќ\ЈwЩ•‹Ѓ}РґhАЌ6Й:ьxт¬…‡+ЧёСC[њkpЇЧГmЬh“¬ГЏgt1z=Ь^WОи;cЇЛшz.эW]ѓлєиMm‘сb”ҐВL†Вћѕ3цjO$ЮД‹„њЁ»rИ,gЈјЂЏЎпЊЅ./ал№ф_uецђЎEо;cП5ё®…&‡ЦлЈб¶јррPчСo­–‹&Џ|лўMРлGГ•kyM"џ|xл\ѓ+Q­…Жи­“[ыЕб‘!zлЦ“Гk№µ_ћ+с/n=FoЭZл­#ѓ\ґ^kЅuxшеў­[{щ№ХZhД['*4ђa=ФЌЇЈЙЧxлЦE[‡лКuЁ'M‹ФСZѕIЦЙ­Џ·®·.~<\ЬхPгА5ёвG…‡¶®ЧЏ†+ЧтљD>щрЦµ|СЦхZл­ГГ/mЭЪwфЦ­'‡з\mСИЂ·n]ґuётsе:Ф‚¦Eо¤л-®Ч“ЇqЈ№r1ЦЎЌ@ЛEk4ьш'™А•ёrh\W.zлдИ ЇIд“o]GoЭzrrxЁ]‰*"ЋэЇp%ЄµР€·N>Th8pе:<9ЧаVHУrеVеЦCµћЬЪ7о$тZm№хPгµ|СЦu9*R^лЙ5юh,m^›]№†Тґ\№W\јIсO°ё+C1Ѕ—“ F“[7iG[ЧЛхqедЦMj4юh,m^Go=№хoR№u“єr1рЇЏWўZЊхёѕЃ‹7©ЬєI]‰j-ґЕаZd@-z-Їµ—ГkьС&XЪ:<Wвџ`qњЂёhаЙП•лPOљлрд&Y‡єЧ“ЇQG“sD-z-Їµ—ГГmјЕю$hЁЊ–ГГ•лхЧГБъ]ЖuеzЁѓk№r=Ф‹Бх]‰j-ґЕаZ®Д?Бв8.ћnЛ‡
ё®\‡'з\№¶~W.­ф8кuj,ѕ+—Іaлw]W.Їm~®Б5¬ђ¦еК5¬єЗюWФЯ‹Г['_ґuа¶ЬъxЅёхЧw=ьhЁ:zлЦ“Гk№h\№†U·ЬъxЅ~4\№^k=ЬIЌ>o‹ўю^‡‡¶nЛ­ЏЧ‹[нqЧГЏ†Љ+Ч°к^k=ЬI—4Еіr+¤i№r®a}\№µp'mф^?®\Їµо¤ЌCЈЧЗ•“[7iЈчъСpеZnюI‡†kXWЈчъСpеї\гpЩС[·ћ^O^WwЅ	1№еµцrxё®AѕuС&ихqед5‰|Ќ†z­^‡'7Й:ФЌ·n]ґu-*4фzЁoќ|ЁРp°tлрд&Y‡єсЦЙ‡
Ќ:jд„А[­Ч“ЇсЦ­‹¶ОqмEЊ7f№Ќє2r_‡GeЧу¶(jЊ7f№єQ”c¬SФiє…лЕBЊ7f№Ќ2АРхэ–тй2РзэSЄ®¬SФ©4МmaagыЫг}ЧўЋrЊхoћ—аgиъуy}Ю?%W¦=Нхѓ’ДРжчы<s]¶”O[§®bSФiєC›Яп”п{CСR>-
;
LFCLR1:	MVI	H,0
	MOV	A,L
	ORI	0C0HЉ	MOV	L,A
	LXI	D,SPC
	LXI	B,79*256+SDSPY
	PUSH	B
	OUTP	L
	MVI	C,DDSPY
..L1:	OUTP	D
	DJNZ	..L1
	OUTP	D
	POP	B
	SET	5,L
	OUTP	L
	MVI	C,DDSPY
..L2:	OUTP	E
	DJNZ	..L2
	OUTP	E
	RET
;
;CLEAR LINE L FROM POSITION H
;  TO END OF LINE
;
LFCLR2:	MOV	A,L
	ORI	0C0H
	MOV	L,A
	LXI	D,SPC
	MOV	B,H
	MVI	A,80
..L1:	MVI	C,SDSPY
	CMP	B
	RZ
	OUTP	L	;CLEAR ATTRIBUTE
	MVI	C,DDSPY
	OUTP	D
	MVI	C,SDSPY
	SET	5,L
	OUTP	L	;CLEAR CHARACTER
	MVI	C,DDSPY
	OUTP	E
	RES	5,L
	INR	B
	JMPR	..L1
;
;	CLEAR TO END OF SCREEN
;
CLTOND:	CALL	LFCLR2	;CLEAR FIRST PARTIAL LINE
	LDA	CHRADR	;CALCULATE # OF FULL LINES
	SBI	LINES+1
	CMA
	MOV	B,A
	JMPR	..JJ2
..JL1:	MOV	A,L	;LOOP TO CLEAR LINES
	ANI	1FH
	INR	A
	CPI	LINES
	JRNZ	..JJ1
	XRA	A
..JJ1:	MOV	L,A
	PUSH	B
	CALL	LFCLR1
	POP	B
..JJ2:	DJNZ	..JL1
	RET
;
;	CALCULATE LINE OFFSET
;
CMPOFF:	LDA	LINOFS	;ADD OFFSET TO LINE
	ADD	L
	CPI	LINES
	JRC	..J1
	SBI	LINES
..J1:	MOV	L,A
	RET
;
;MOVE LINE D TO POSITION E
;
MOVLIN:	MOV	A,D	;SET UP
	ORI	0C0H
	MOV	D,A
	MOV	A,E
	ORI	0C0H
	MOV	E,A
	MVI	B,80
	PUSH	H
	PUSH	B
	CALL	..S1	;MOVE ATTRIBUTES
	POP	B
	POP	H
	SET	5,D	;MOVE CHARACTERS
	SET	5,EЉ..S1:	MVI	C,SDSPY
	OUTP	D
	LXI	H,DSPBUF
	PUSH	H
	PUSH	B
	MVI	C,DDSPY
	INIR
	POP	B
	POP	H
	OUTP	E
	MVI	C,DDSPY
	OUTIR
	RET
;
	.LIST
	.IFE	LSTINT,[
	.XLIST
]
;
	.PAGEЉ;
;|------------------------------|
;| INTERRUPT SERVICE ROUTINES	|
;|------------------------------|
;
;	50/60 HZ INTERRUPT
;
SRV60:	PUSH	H	;SAVE REGISTERS
	PUSH	D
	PUSH	B
	PUSH	PSW
;
;	HANDLE KEYBOARD
;
	IN	DPIOB	;CHECK FOR KEY
	BIT	6,A
	JRZ	..J2
;
	LXI	H,CLICK	;SOUND THE KEY
	CALL	SOUND
	MVI	B,9
..L3:	IN	DPIOB	;BIT INTO CARRY
	RLC
	RLC
	CMC
	RARR	L
	MVI	A,7FH	;CLOCK DOWN
	OUT	DPIOB
	MVI	A,0FFH	;CLOCK UP
	OUT	DPIOB
	DJNZ	..L3
	BIT	6,L
	JRZ	..J1
	RES	7,L
..J1:	MVI	H,0
	LXI	D,KEYTBL
	DAD	D
	MOV	A,M
	CPI	0FEH
	LDA	SHLOCK
	JRNZ	..J4
	CMA
	STA	SHLOCK
	JMPR	..J2
..J4:	ORA	A
	MOV	A,M
	JRZ	..L4
	CPI	61H
	JRC	..L4
	CPI	7BH
	JP	..L4
	RES	5,A
..L4:	STA	KEYCOD
	MVI	A,0FFH
	STA	KEYFLG
;
;	FLOPPY MOTOR SHUT-DOWN
;
..J2:	LHLD	MTRCNT	;GET MOTOR TIMER
	MOV	A,H
	ORA	L
	JRNZ	..J3	;IF <> 0 THEN DECR. & EXIT
	MVI	A,0CFHЉ	OUT	SPIOA
	XRA	A
	STA	HOMES	; MOTOR OFF, CLEAR HOMES FLAG
	OUT	SPIOA
	LDA	LSTATE
	RES	0,A
	OUT	DPIOA
	LXI	B,0FBH*256+DPIOB
	OUTP	B
	RES	5,B
	OUTP	B
	SET	5,B
	OUTP	B
	INX	H
..J3:	DCX	H
	SHLD	MTRCNT
;
;	COMMON INTERRUPT EXIT
;
IEND:	POP	PSW
	POP	B
	POP	D
	POP	H
	EI
	RETI
;
;	FLOPPY INTERRUPT ROUTINE
;
SRVFPY: PUSH	H
	PUSH	D
	PUSH	B
	PUSH	PSW
	MVI	A,0FFH	;SET INTERRUPT TAKEN FLAG
	STA	FPYFLG
	IN	SFLPY	;FDC	BUSY ?
	ANI	10H
	JRZ	..J1
	LXI	H,ST0	;YES, READ AND SAVE RESULTS
	MVI	B,7H
..L1:	PUSH	B
	CALL	R765
	MOV	M,A
	INX	H
	POP	B
	DJNZ	..L1
	JMPR    IEND
..J1:	MVI	C,8	;NO, SENSE INTERRUPT STATUS
	CALL	W765
	CALL	R765
	JRNZ    ..J2
	BIT	7,A
        JRZ	..J2
	BIT	6,A
	JRZ	IEND	;IF SO, EXIT
..J2:	STA     ST0	;NO, SAVE ST0 & PCN
	CALL	R765
	STA	CYL
	JMPR	IEND
;
        .LIST
	.IFE	LSTTBL,[
	.XLISTЉ]
;
	.PAGEЉ;
;|------------------------------|
;|            TABLES		|
;|------------------------------|
;
;	I/O SETUP TABLE
; 	 FORMAT: PORT#, # OF BYTES, BYTES
;	 PORT ENTRY OF 0FFH ENDS IT
;
;	DISPLAY
;
IOTBL:	.BYTE	SDSPY	; START TIMING CHAIN
	.BYTE	1
	.BYTE	0AEH
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	0
	.BYTE	SDSPY	; RESET
	.BYTE	1
	.BYTE	0AAH
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	0
	.BYTE	SDSPY	; REG 0
	.BYTE	1
	.BYTE	0A0H
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	97	; 98 CHAR-1
	.BYTE	SDSPY	; REG 1
	.BYTE	1
	.BYTE	0A1H
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	42H	; H WIDTH=15, H DLY=1
	.BYTE	SDSPY	; REG 2
	.BYTE	1
	.BYTE	0A2H
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	04DH	; 10 SCANS/ROW, 80 CHAR LINES
	.BYTE	SDSPY	; REG 3
	.BYTE	1
	.BYTE	0A3H
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	97H	; 24 LINES
	.BYTE	SDSPY	; REG 4
	.BYTE	1
	.BYTE	0A4H
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	3
        .BYTE	SDSPY	;REG 5
	.BYTE	1
        .BYTE	0A5H
	.BYTE	DDSPYЉ	.BYTE	1
        .BYTE	20	; 60HZ, V DLY=12
	.BYTE	SDSPY	; REG 6
	.BYTE	1
	.BYTE	0A6H
	.BYTE	DDSPY
        .BYTE	1
	.BYTE	LINES-1	; LAST ROW=23
	.BYTE	SDSPY	; RESTART CHAIN
	.BYTE	1
	.BYTE	0AEH
	.BYTE	DDSPY
	.BYTE	1
	.BYTE	0
;
;	PARALLEL PORT
;
	.BYTE	DPIOB	;SETUP TO TURN ON HIGH
	.BYTE	1
	.BYTЕ	0FFH
	.BYTE	SPIOA	;DATA & ADDRESS PORT
	.BYTE	3
	.BYTE	4FH	;RESET
	.BYTE	0CFH	;BIT MODE
	.BYTE	0	;ALL OUT
	.BYTE	SPIOB	;CONTROL PORT
	.BYTE	3
	.BYTE	4FH	;RESET
	.BYTE	0CFH	;BIT MODE
	.BYTE	40H	;BIT 6 IN, OTHERS OUT
	.BYTE	DPIOA	;BRIGHTNESS, MOTOR OFF,
	.BYTE	1	;  EPROM ON
	.BYTE	0C0H
	.BYTE	DPIOB	;LOAD STATUS LATCH
	.BYTE	3
	.BYTE	0FBH
	.BYTE	3BH
	.BYTE	0FBH
;
;	DMA CONTROLLER
;
	.BYTE	DMATMP	;RESET DMA
	.BYTE	1
	.BYTE	0
	.BYTE	DMACSR	;PARAMETERS
	.BYTE	1
	.BYTE 01000000B ;DACK LOW, DREQ LOW,
			;LATE WRITE, FIXED
			;PRIORITY, NORMAL TIMING,
			;ENABLED, NO HOLD OR
			;MEMORY-TO-MEMORY
	.BYTE	DMAWMR	;MODES
	.BYTE	DMALN
TBLDMA:	.BYTЕ 01001000В	;FLOPPЩ - SINGLE¬ INCREMENlќє2н1(lќ2ґИ-lќvѕЮЩЯfиZФ±г›ўNS)1ґщэuљJЙ•щln†¶R‹:MҐФ‹„У\90ЋE(Эїx°—ЛЃвК!6Eќ¦[0фхххчШхwѕ\™.Л+хy[t¬ї%m-ћpeдА8Х–ъvКр[>ЧаКіL
CїQ_KщЬыw>Ќ8цїЋЂх»u¬‰сЖ,gHў`иѕ®№Е»Ф?·ЩbЇїЅџkQGФEЖ±Ё#*C·”OВ7ъќ]_KцС?·+E:LЭвҐ]Zє2r`‹:ЦёЧўЪrЊІі№:_пмo3l‘бseэ›ўNҐafич<^c{јпКуѕkQJЊZ(ЪJупwN†/ѓµSѕЇсѕНР•‘ЗўЋ†о_<ШяХЯўNS)х6o]Ы‡Ш</БПРoФЧ"ќeџчO©Пы§дJ‘7CwК ьп,ЫJЅH8mА•‘гXФQfhУўїx°Пы§дКіЬFtЭoФЧз]щь~здгКґЗ °uкZФSЋqИ,#_я®жРшј:_ЯfШч«ХјteЪcр~µљ]‹Y€сЖ,“‘ю2†NгнУУТ|DП $ЅгКґЗ °х%W¦=S†2ґщэћѕ’+7ґ„T0фЅ§ЇБлz§У®П•йІњЊМРVкй+5z#\9q,кY`июЕѓЌШзо9зпКtYN¶“ъЌъЪJ=}ҐFoлКИ‰cQm™Ўы¶5Г|^Џ]зkйКtY–
†~Јѕ¶R/N{ъJЌЮйџ!ПqeЖс€bЃЎыцyя”ZШ:н|-]yc–ЫАЗРoФЧз]щь–Dку*8~ПҐяЄ+УѓВЦ©+#чuXФSfи‘уХ?wѕѕН°ц6o]ѓkQПBЊClЦчҐave>››Ў­Ф6¶Зы®L0Ћi@l†о_<ШзХчЫгэЖц±{Їє2r_DМ9†Fмsчњуw®ЃхэЇып–тiД±яЌcџ·EQ]ѓ«№~P’b2ЛВ(кџA)t1єѕЯm!О«ubW±YФ__rҐ…‡Ы•wЖшЊНРЇлыњЁѕфу™Ш•7f9e†ћ»ѕП‰pШхҐџOнџ[&Ѕ3±+‡Ш,кuкК;cLЖfиФх}N$ЋЕ^гpbЧаК!6‹ъя™2t}ї«ЇgыЫJЯOётО…±]ѓk*¦Х
ўsй\№ґдї¬±ш®Б•іэMАH®bуЙnWFNS1ќбК!6џмћ]S1ќc>›Ы•wЖёбКИЃqLЕ4>>є2]–ш †NЕKУ–тйjЕл…ОRЗЗЧяІ®<Й•ґЊ]јшК…+#чuX­ИSЧає6®\Zйс_ЦX|єWFо‹©ЖЗзКе<¦3Лш\ѓлЪёЧTLгг‹1]–с†NЕKУ–тйjЕл…ОRGµяe]y’++h‰]јшК…kp­VдiЊwЖ(ЊнКуѕkpетЪжз\ѓщБwцhiдл*u±Ўпё†ъчщµпьу1єИч«mҐ†п‰'ЧPЯ›Ц¶RГчДFo(ЪBынюЇє†у¶0qмFзУR>чю®Б5<шO©Ї}цэю;Х5ёоFп|ЅіїН°SП5°hф>пѓvПyрwэыѓХ5°»Ьи-еsпЯям4uм^hф®/э|qм®ЃЭ(ЌЮхҐџOџ·…k`7ѕFoaл5v©%‘ъј
ЋЯsйї~здУw­жҐk`wtЌЮВЦkмR?h¶-lќц;'џѕk5/]ѓkаЬиЌГОRЧ—~>µо6¬Т;=СЦЯи]ћШ505z‹c±Ч8tЌЮям4нџ{~fыџ«фNO4ЫЯQЅ«obЧАЧи]_ъщфП=?і…эП†UzЗ5°ЌЮ[€уjнџыџ«фNя,Џtтн\ѓЁУTJќІxХ5ё†6M(Ри]Б”^­8:еыпЫ]ЛЌЮBє[мї[КзЮЯ5pЎС[ N‹эw#ЋэП5ҐС[СbяЭзmбїСы¤rџ—циІkаљFп:-w}oЪ?w|ЧАЁЌЮ'-фyiЏ^pЊТи]§]Я›цПэПNSЧР¦	ЕЧиЌђN#¶эљ[К§ПЫўд\Г;'џ¶µ-6няDПҐ®пН^Ч;=Ы?Qќёід~сZФi*Ґ®omѓ¦Ч)‹·t®ЃіэЭQЪzO%кљ~зdш2X;еыпЫ]gыkG1ў¶iQфОЧ;ыЫыЫыuїkаlн(FTcMЈч$Qў®iџ·EЙ5ёЧ°BљЛК5¬єП»тщ-кґ”єW®a…4-–•k ]…­УуЩЬVкќТІ	§Ђ+#ЖQФH™Ўс`›sГ'ыэ_э®bSФi*%†~ЈѕюЇюuљJЙ•іэЊblWћч]ѓkX!M8®\ГЄыј+џЯпњ|aС’H}^Зп№ф_еК5¬ђ&W®БUФH9ЖtYвc°Rп”–ЅH8m|®ЊGQ#э‹Ыњ{№Њ,ё2н1Ођ\9d–…!Ю№«Щ•iЏБыХjvе›зUp|WЮгllєТВГЩ•CfYўNS)№Љ:К1Юe2к•\™цLfр»тkБЩ•wЖ8·+УѓўOжJe,\yе‹і+EЖQФQvеyЯ5ё†Т4!Ї\ГЄыј+џЯпњ|aСљ‡­EЯЇЦm~Э+Ч°Bљ&д•kp5Іcє,ЈseдА8ЉAqеђY–Ођ\™цј_­fW±y ґЯ•Z–]№…ед=Щ•хoЉѓAрvе›ўNS)№тОgc»rCKа…kpеђYЖз04МВЦ©+Уe	$ peдДQT¬м\™.Kа…+#ЖQTlБ•7f9 CЧRэпv®ўb1Юг6f†ЮctюЕ;Х•ZRбКtYЖweд$ЉЉ-lWnh№†Ўнт-;
ъ#*z|WQ±…Ј…‡Ы•wЖ8Ы•CfYйќѓЊкК!іFTWQ1”Е®GQ1WQ±rЊiЏБыХjvеђY†xз®fWFо‹ч«Хм\№ј¶щ№Ч°Bљpт•kXu‹ЬВЦiзлќэm†Э+Ч°Bљpт•kp¬{-lќцµПѕЯ§єWQ#(1Цї)к4Э‚ЎѕЯаХВЦiзkЩПгUWЮг6Y€Ж±Ahї+7ґmЉPётЊдКъ7ў®<#№тЊдК|6“+лЯ”nЪпКъ7„ц»ІюН*@hї+лЯ¬SЪпК-Q\YяжI ґЯ•wЖёбК-ЈH…+лЯ<€T®Б•K+AюЛ‹п\ygЊВШЅE¬їл4•FKщt||тDХ•іэЊДР©xiЪвXм5пщW±щd·+#'Ћ©4МР•Cl>Щ=»¦Т0ГуЩЬ®ј3ЖmWFNу4•†+П®Бum\№ґТгї¬±ш®Б•‘ыbћ¦ТpеrУ™eЧµq®yљJ#Жъ7л4•†+пЊqЏ‰¬/э|\YяжAњ—\ѓ+k1Ґ{qђH±яо-ДyµєІCр ¶З•g¤Г™®mВщЖ,“ёR$gєІОIр ь-цЯќ2їkpе›ўNУ-\™.ЛІ+#'ЋўFЦ0ґ•:еыЮP4zKщЬыэ‹»NнеК;cLЖfи~Јѕ®п7xхAьyётЖ,·q)‹зК-“+лЯ<€tWЮе6Pў+\9ЫOАH®ЊGQ#с]™Џe| p5?Жъ7вПГUФИљ…uе(†аэO‚џбЙцmбл;я|:e~WЮг6
Wжі9¬Фwющt†®2ЛВёящцve-†аэO‚Я•‘ЗъПэЏkpеі®L{VXяю®њнзc»2r`EЌ¬Щ®2ЛВ \Y‹!xя“аweдѕу?ўд*jdНЋ1н1hюТ0W†~І}[шъ:щz§‹[fWЮг6nWжі№¬ФЕ-sЈ7аКИ‰ЈЁ|®ј1ЛmDahQ§©”ЅЈёrИ,ЈNя<\№ЇCQ#eА5ёЉБгЌYn#>C‹:MҐФиЯ•CfY'Ќ?WQ#e ЖґЗ И'Х©+џumћч]ѓ+—Ч6?ЧаVHУ"V®aЕЫЦґlaлґOї…ЇrеVHУ"V®БХьҐa®1±y ґџЎНпчuтхN·4М®2ЛВ(ni«+gы	Ы•'О•КЪOбКуѕkp­п‹гЌYn#*АPЯп|ЅіїН°їЅ_ї+лЯuљаgи‰ДKзЭю'z.u=XT`bWКОжvеЦ‚…+oМr6р1ф†ўУxыфyїзТХ•CfYх®UьQЋсОoc»ТBWЉЊc”]yе‹…+Пы®Б5°ю}~‹c±ЧwющTЧаZя№я‰сЖ,·peЪcґiВх}сг]`иІ<]_КPґ”O‹c±ЧаХ?wЅЮ®ј1ЛmаchQ§©”Ѕс№ІюMQ§©”иК
ZFqeЪcpЊэSбКg]ѓkи4Ю>]дыµ4¶№єЧ4Ћ4М1™ea ®¬Е,ni+]yЮw®Ѓiј}zГRџWБс{.эW[:щnI$ЧАEЫZБЧvЊgЮЈSѕпEяЬзХч]ѓkG)Жіњ|ќЖЫ§%‘\“4К±6-zgЊЙ]™ц<Qў®qеќ1ОFrҐ€А8&i”йКуѕkpетЪжзHЧ°Bљ–+Ч°кћwµ©Ґ‘Ї«ФвXмљ&јr«оъ~mрк9яўҐ‘Ї«Ф)Гтпф†ўЕЅ[К‡+Ч°кЮ-Ќ|]ҐОЧ;ыЫ{CСв‹ЅS;еыЮP,№r«оъ^K#_W©SѕпEя=ЏW[К§яћЗk)џ{я%W®aХ}Ю¬Ќ°їиё–Ж6w}ї­Ф»їЅ_з”АS—+Ч°кћј'wКрokЧЏТц“ЩЯR>=№>X_‹c±З•kXuЧї?X'wКчЅЎЁ4MxеVHУrе\Т4бocЇ¶…яќ^ї…­{Oiљ°kp­°юэc2ЛВЁўюy0t}°ѕЗbЇлЯ¬®ј1Лm”]№ЇC‘OЄeЧа*тIucэ›ўNS)‘Ўл{УО§ПK{Шщмя\yc–ЫXpщ¤ZЋ±юНу*8ѕ+Уѓх}с]ЕЙWу'ѓжўnaл4_®БUШ:НWЊwЖ(ЊВ•wЖшЊбКЩ~Ж7nWFNEЋ 0ДЎЧ©ЅZЬ»лыаеКіЬFьшYЯoрjqпѕіx®њнgTгveдДQдИ‚+oМrсс®"GbМа§ё7в>®јАZ°pҐ…2®ј1ЛdHWiNЫ•ьЦ•ьЦ•7f™й*Н€гК~лК~лКіЬаК~Љ{#кНЂDЮ»N™%Й•"ЙXёR–
і+Ї|± «И”/°,кѓўЈD]У)Яч†ўєтО·q»rCK@*lНcяЧ8м№ф_нџ»>(\ygЊі±ftf©зТХ•wЖXВ•wЖ8ЊзJa]E1Z(cБ rѓрЫС3:Рщф;'WЮc2nW^`-8»2н1€€uCЧEgшz.эЧ?·$’+Ї|qveдДQдИ†6з^.#kЪJэОЙЗ•"г(тX`xPґИ®јтЕВ•іэЊbЬVку¶иъQ\yвИРїx°Н№—ЛH|ЧаКіњЌ2Cџ·EЧЏвКґЗаyвјJWG†.6цъј-zЏСsйїкК¬†о7клwN>®БUдИљЇ|±`ѕwuЅ:Ѓз<ш]ѓ+Мя€RЊiЏБ4Ћ$’+‡ШuљJЙ•щX(\Yя¦ЁУTJ®”ќНнКу>ОыаЃ=С;'џ‰]ѓkшлЇ‡ЫлўM"·jјЋЮzЁPuфРЦ“kщў­kФx‹!ЧтZ{9ј^‡‡¶ЦЪ·ЬъxЁхZ-·>^»ьС& хZЅ84\\јµz=Ф-·>^§^‡‡ѓ–‹Цrлгµ|Ёў-nqkЯшЈЎ–[*јu®Б%кљoМr6PКt].Ј€А8.—`hсЖ.5JФлrўш}Ї?!&vеЌYОF`и2Рзэc_u].G9FYҐq•ъј-єюэБкК-Ѓ®L—%> `h+хЅЬ8цpeдДq№Њ Эїx°—ЛаJЃq\.G™ЎЯЁЇПы§дКуѕkp].#@ЊщlnWЮг6C§сцйёћнwe?…4®CЧEПҐя\yЮw®бЇїnЇ‹6‰ЬzЁс:zлЎBХСC[O®Qг-†\ЛkнерzЪZkЯrлгЎохP/n№–[П5 Ж[№Ж•C“›·еµцrx-ЯєhґЬъx-‰д\O”Ёkbј1ЛЩ@)Уu№@Њ"гё\ЂЎЕ»Ф(Q¬Л‰вчЅю„Ш•7f9eЂЎЛ@џчЏ}Хu№е-d•ЖUbиuxhk5®љЬ$ё®ЬРH@бКtY	(ЪJ=GAџЈў—]9q\.# Cч/ме2ёRD`—ЛQfи7клую)№тјп\—Лc>››ЎУxыt\Пц7zзеtйJ)¤q•ъј-z.эзКуѕkpеrШъ]№ґТгЁ_ІРX|W.eГЦпє6®\^Ыь\ѓkX­ђ&њ°Z№†ХЉ¦	·iBW+Ч°ZQT,
			»  AUTOINIФ OFF¬ READ
	.BYTЕ 01001001В	;INIT OTHERS FOR STABLE OPERATION
	.BYTE 01001010B
	.BYTE 01001011B
DMALО	Ѕ	.-TBLDMAЉ	.BYTE	DSPBCA	;DISPLAY CHANNEL
	.BYTE	2
	.WORД	0	;DISPLAЩ BASЕ ¦ CURRENФ ADDRESS
	.BYTE	DSPBWR	
	.BYTE	2
	.WORД	0	;DISPLAЩ BASЕ ¦ CURRENФ WORД COUNT
;
;	TIMERS
;
	.BYTE	BAUDC	;COMM PORT
	.BYTE	4
	.BYTE	3	;RESET
	.BYTE (V60HZ-4)@256 ;INT. VECTOR
	.BYTE	TIMCW0	;CONTROL WORD
	.BYTE	TIMTC0	;COMM BAUD
	.BYTE	BAUDP	;PRTR PORT
	.BYTE	2
	.BYTE	TIMCW0	;CONTROL WORD
	.BYTE	TIMTC0	;PRTR BAUD
	.BYTE	DSPINT	;60 HZ INTERRUPT
	.BYTE	3
	.BYTE	3	;RESET
	.BYTE	0D5H	;+ EDGE, INT. ON
	.BYTE	1	;COUNT OF 1
	.BYTE	FPYINT	;FLOPPY INTERRUPT
	.BYTE	3
	.BYTE	3	;RESET
	.BYTE	0D5H	;+ EDGE, INT. ON
	.BYTE	1	;COUNT OF 1
;
;	SERIAL PORTS
;	 COMM PORT
;
	.BYTE	SCOMM	;MODES
	.BYTE	SIOLN
TBLSIO:	.BYTE	0	;REG 0
	.BYTE	0,0D8H	;RESET
	.BYTE	4	;REG 4
	.BYTE	44H	;X16 CLOCK, 1 STOP, ASYNC
	.BYTE	1	;REG 1
	.BYTE	60H	;NO INTERRUPT, DMA READY
	.BYTE	3	;REG 3
	.BYTE	0C1H	;RCV 8 BITS, ENABLE RCVR
	.BYTE	5	;REG 5
	.BYTE	0EAH	;DTR ON, XMIT 8 BITS
SIOLN	=	.-TBLSIO
;
;	 PRTR PORT
;
	.BYTE	SPRTR	;MODES
	.BYTE	SIPLN
TBLSIP:	.BYTE	0	;REG 0
	.BYTE	0,0D8H	;RESET
	.BYTE	4	;REG 4
	.BYTE	44H	;X16 CLOCK, 1 STOP, ASYNC
	.BYTE	1	;REG 1
	.BYTE	60H	;NO INTERRUPT, DMA READY
	.BYTE	3	;REG 3
	.BYTE	0C1H	;RCV 8 BITS, ENABLE RCVR
	.BYTE	5	;REG 5
	.BYTE	0EAH	;DTR ON, XMIT 8 BITSЉSIPLN	=	.-TBLSIP
;
;	TERMINATOR
;
	.BYTE	0FFH
;
;	KEYCODE TRANSLATION TABLE
;
	.RADIX 16
;
;	NO CTRL, SHIFT
;
KEYTBL:	.BYTE	08,09,0A,00,00,0D,00,0FE;BS TAB LF N/A N/A CR N/A LOCK
	.BYTE	20,00,00,1B,81,82,83,84	;SP NA NA ESC LFT RT UP DN
	.BYTE	5E,21,40,23,24,25,26,2A	;^!"#$%&'
	.BYTE	28,29,22,3A,3C,2B,3E,3F	;()*+<->?
	.BYTE	7E,41,42,43,44,45,46,47	;@ABCDEFG
	.BYTE	48,49,4A,4B,4C,4D,4E,4F	;HIJKLMNO
	.BYTE	50,51,52,53,54,55,56,57	;PQRSTUVW
	.BYTE	58,59,5A,7B,7C,7D,5F,07	;XYZ[\]_
;
;	CTRL
;
	.BYTE	08,09,86,00,00,0D,00,0FE;BS TAB LF N/A N/A CR N/A LOCK
	.BYTE	20,00,00,1B,81,82,83,84	;SP NA NA ESC LFT RT UP DN
	.BYTE	30,31,32,33,34,35,36,37	;01234567
	.BYTE	38,39,3A,3B,2C,3D,2E,2F	;89:;,=./
	.BYTE	00,01,02,03,04,05,06,07	;CTRL-@ABCDEFG
	.BYTE	08,09,0A,0B,0C,0D,0E,0F	;CTRL-HIJKLMNO
	.BYTE	10,11,12,13,14,15,16,17	;CTRL-PQRSTUVW
	.BYTE	18,19,1A,1B,1C,1D,1E,1F	;CTRL-XYZ[\]_
;
;	NO SHIFT OR CTRL
;
       	.BYTE	08,09,0A,00,00,0D,00,0FE;BS TAB LF N/A N/A CR N/A LOCK
	.BYTE	20,00,00,1B,81,82,83,84	;SP NA NA ESC LFT RT UP DN
	.BYTE	30,31,32,33,34,35,36,37	;01234567
	.BYTE	38,39,27,3B,2C,3D,2E,2F	;89:;,=./
	.BYTE	60,61,62,63,64,65,66,67	;`abcdefg
	.BYTE	68,69,6A,6B,6C,6D,6E,6F	;hijklmno
	.BYTE	70,71,72,73,74,75,76,77	;pqrstuvw
        .BYTE	78,79,7A,5B,5C,5D,2D,7F	;xyz{|} DEL
;
	.RADIX 10
;
;|------------------------------|
;|	DISK OPERATION TABLES	|
;|------------------------------|
;
; ---- READ/WRITE TABLE ----
;
;  (SET UP FOR READ OF DRIVE 0, TRK0
;  MOVED TO RAM AND CHANGED AS NEEDED
;  FOR OTHER OPERATIONS)
;
FPYTBL:	.BYTE	39H	;TYPE
	.WORD	FILBUF	;DMAADD
	.WORD	DBL*256+255 ;BCNT
	.BYTE	DBL*40H+6 ;CMMD
	.BYTE	0	;UNIT
	.BYTE	0	;C
	.BYTE	0	;H
	.BYTE	1	;R
	.BYTE	DBL+1	;N
	.BYTE	SECS+9	;EOT
	.BYTE	37-(SECS*22);GP2
	.BYTE	0FFH	;DTLЉ;
; ---- RECALIBRATE ----
;
	.BYTE	22H
	.BYTE	7
	.BYTE	0
	.BYTE	23H
	.BYTE	0FH
	.BYTE	0
	.BYTE	5
;
; ---- SPECIFY ----
;
SPCTBL:	.BYTE	3
	.BYTE	3
	.BYTE	SRT*16+HUT
	.BYTE	HLT*2+ND
;
; ---- FORMAT A TRACK ----
;
FMTTBL:	.BYTE	76H
	.WORD	FILBUF
	.WORD	4*(9+SECS)-1
	.BYTE	40H*DBL+0DH
	.BYTE	0	;HD & DRIVE
	.BYTE	DBL+1	;SECTOR SIZE
	.BYTE	SECS+9	;SECTORS/CYL
	.BYTE	87-(SECS*57) ;GAP 3
	.BYTE	0E5H	;FILL DATA
;
;	BAUD RATE TABLE
;
TBLBAD:	.BYTE	174,128,64,32	;110,150,300,600
	.BYTE	16,8,4,2,1	;1200,2400,4800,9600,19.2K
;
;	ALTERNATE CHARACTER SET TRANSLATION TABLE
;
CHRTBL:	.BYTE	40H	;0 = STANDARD SET
	.BYTE	00H	;1 = FORMS RULING
	.BYTE	80H	;2 = GREEK & LANGUAGES
	.BYTE	0C0H	;3 = MATH & WORD PROCESSING
;
;	COMMONLY USED MEMORY MAPS	
;
;  FORMAT: 8 NIBBLES CORRESPONDING IN ORDER
;  TO VIRTUAL BLOCKS 0-7. THE CONTENT OF EACH
;  NIBBLE REPRESENTS A REAL BLOCK VIA THE
;  FOLLOWING:
;		XXXX
;		|---
;		| |
;		| REAL SEGMENT #
;		0=DISABLE
;		1=ENABLE
;
TBLMAP:	.BYTE	089H,0ADH,0FBH,0ECH ;TEST BLK 0
	.BYTE	089H,0DBH,0EAH,0CFH ;TEST BLK 1
	.BYTE	08CH,0ABH,0D9H,0EFH ;TEST BLK 2
	.BYTE	0D9H,0ABH,0C8H,0EFH ;TEST BLK 3ЉREVMAP:	.BYTE	0FEH,0DCH,0BAH,098H ;ALL BLOCKS REVERSED
STDMAP:	.BYTE	089H,0ABH,0CDH,0EFH ;STANDARD MAPPING
;
;	STANDARD CONTINUOUS TEST
;
TCMD:	.ASCII	'NHQTMR1R2R3RZ1Z'
	.BYTE	0
;
;	ERROR MESSAGES
;
NOHOM:	.BYTE	0DH,0AH
	.ASCIS	'NO DISK OR DISK NOT READABLE'
NOCPM:	.BYTE	0DH,0AH
	.ASCIS	'NO SYSTEM ON DISK'
OPTON:	.BYTE	0DH,0AH
	.ASCII	'NOW IN TERMINAL MODE'
	.BYTE	0DH,0AH,8AH
;
;	SOUND TABLES
;
CLICK:	.BYTE	0,1,0,16,16,16,48,1    
	.BYTE	0,0,0,0,1,128   
;
BEEP:	.BYTE	2,12H,0,1FH,1FH,1FH,38H,0
	.BYTE	0,20H,0,40H,0,10H
;
SIZTST	=	.
;
;	INTERRUPT VECTORS
;
	.LOC	BASE+0FF4H
V60HZ:	.WORD	SRV60	;60 HZ
VFLPPY:	.WORD	SRVFPY	;FLOPPY
;
	.LIST
;
AVAIL	=	V60HZ-SIZTSTщєJmбзЂЧп“БoбkУ„®V®aµўiВmљРХК5¬VHNX­\ѓk=t•b¬хьп®JW™mS<х2,ьхO]Ы4ЎјАZ°pеЦ‚В•XО®јАZрЄWZИ*Ќ«DWnhY
†¶RK"5Мїg°–\9q”®ИCч/мъ`}mб_vэыѓХ5ё†Т4сК5¬єП«аш}»ѕ–тйу¶0qмќOKщЬычК5¬ђ¦‰W®Б•7f9QъЌъъј-:JџWБс{.эW]™ц<OњW]9q”®
C+адЯзmС{ЊћKяUW±Y?АР©xiЪх®ЬРђрmҐ®hз©+‡МІ0Dќ¦RreдА8JWdCявБ~здг\Г
i’gеVЭзUpьѕЉ]_Kщt}ojфyiЏО§ПЫўФ©ШРьzеVH“<+Ча*]‘…oМ2шиКґЗ "JФ5mk_ЧлkяІлЯ¬®Њњ8JW…Ў­Фпњ|ЊюЕѓmО-ЮщцveЪcрD‰є†®Њњ8JW…ЎПЫўЛхчyїзТ®ј3Жdl†®{]?аКtYв
†¶R[€нaE§|ЯЉFмЪ¶Vр	WFN\Sєт”Ўы6вх>ЇE†П•CfYх®ј3ЖЫHэF}]>Їл\™ц<Qў®aиу¶hшdїзТ®ТA‰1GсО·7C·$RГьыј-J®ґPЖВ•wЖx›ЎлПзuэeWЮг6R·+7ґ$|…+Уe№ mҐ®пM;џ>/нС°ю>WFNҐ+ІАРэ‹;/M[К§+Дѓmб_єrИ,CФi*ҐРэF}}ЮҐѕ.vнTlh~ўлЯя№тО·qУ•йІДЗРVjД¶ЯBsKщфy[”\Ґ+?ЖИ‰Јµ
†о_<ШOfї«tEЦДXЯgгfи7клwN>®ЊЬЧЎtE:/M[К§+Дѓmб_єЧ°Bљp\№†SсТґҐ|>Щп|ЅіїНђ+Ч°Bљp\№WйКУX›•ќНMWЦї)к4БПРiј}ZФi‚ЯUє"шb2Ы,Q§©”Bo(:/M[Фi*%WЮг6nWОц3Љ±ЪJ=ЫЯQєѕпКИЃq”®…Ўыц;'WЮеm эF}ќЖЫ§Eќ¦Rre-г3ґ•ZФi*ҐFoА(FзУ(®ЊњDkЭїx°џМ~WFЊЈtҐ2CїQ_[©Eќ¦RкEВiЗп_<ШЛe*»љ&мКіЬF|†uљJ©aF4zЗweэ›uљJѓЎ»ж№л{Ую№яЩiЪс]iббfhш-к4•RЈчW™eaФйџ‡+#чu(]):єWйJеE:ЬmҐuљJ©	§ЅЖ•‘г(]iЃЎыцr™\9d–…qТшу-к4•RГЊhф^гКіЬFT†®№Eо(ъјґ‡ќПюП•‘ы:”®]ѓ«tҐ…E:ЬmҐuљJ©	§Х•‘г(]iCч/ме2­q®L{љї4М•ЎEќ¦RjЌЮQ]iббНР5w}їЇ“ЇwєёҐav®bу Ri0ф/мъЮґnсЄ=Oф?;M]™ПжveдДQєRTWЦїY§©4єлПзх?;MЫВ®пMыпy<W™eaФйџ‡+oМrQ>D‹:MҐФЌЮQ\Ґ+EcЪcPд“к”Ў»ѕ7нџыџќ¦®Ц>(bЊЬнѓВ5ёJWZЈH‡›Ў­ФўNS)х"бґЈёJWЉcдА8Љ:}з0tявБ~здcф>Їaоь‹wЄ«tҐЁ1Юе6ў0ґЁУTJ3ўС;Љ+лЯ<Ї‚г»rИ,гюзЫ;tН}^}їпьуйoпw\Y‹!xя“аwе›ўNУ->D‹:MҐФи]6ЊО§Q\Yя¦ЁУTJ®йp3ґ•ZФi*Ґ^$њ6z—]90ЋТ•Pъцr™P\9d–…!ЭяП#tїQ_Г'ыќЇ¶µҐ|оэ]№ЇCйJс]Ґ+ЎД8d–…qџмwѕЪЦ>o‹О§Зюз*])~ЊiЏБъѕшЭiј}ъј
ЋЯsйїЪ8цyхэюц~ьќ2я;®L{
[§щbh[+ш:еыЮPё2r_‡Ц>(\ѓkX!M‹X№†ПЫўП«ашµ'љ'оoпW»W®a…4-bе\ПзХ‡МRхэF}}Ю}^ЗЇ®2ЛВ8ЇBрv=вФQЋсkБЩ•iЏБ%к†у¶иrПҐяZ:щnI$W^щвмКG†~здct\Пцw}Я•хoCwЭШл№фџ+-”QёТВГ›Ў-L§SбЗ•"гxД©ЈМРзmСрЙ~ПҐя\iббМРiј}:®gы]yЮw®a…4-bеV¶Nыќ“O%W®a…4-bе\Т™·€qИ,`hд;'џF6bЫoЎ№Ґ|ъј-J®¬ЕјяIр3t§сцйыџЧЬwющґ­]я>я	WFо‹ЯЮь-к4•RзУы‹PёWQ§пњУѓiI$†nПЅGзлќэm†эОЙЗ•ClЉ:MҐДР¦	‹:MҐФщ4Вюўс…+у±Д®¬SФi*%WFолРЪ]ѓ«xзЫ;ЖґЗhУ„aюG”є'‰uMГьыј-JэОЙЗ•‘ы:ґцAБР¦	‹:MҐФщ4ВюўЃ®Б•ЛaлwеТJЏЈ~›ЌЕwеR6lэ®kгКеµНПЈ/ё†Т„гК5¬H+Onq,цN%W®a…4бёr®a…4Eя•kXµiQ›зТ}ћ°зҐo3м^№†ТэW®Б5ehaЊClЪ<—юsе†–(®Њњ8ю_ІР•іэЊнКИ‰гЁЯBWFол0ќoЎkpMfрЗ8Д¦Нsй?Wnh‰вКИ‰гяҐ~WОц0¶+#'ЋЈю~WFол0ќџБп\ПЫвќ‡Шґy.эзКіЏ+П>®ЬРЕ•‘ЗяKєR¤ГнКИ‰гЁЯBWЉtё]9qLз[иКИ}ю_ІР5ё^ LEЊClЪ<—юsеЩЗ•gWћ}\yцqе†–(®Њњ8ю_КаwҐH‡Ы•‘Зt~ї+E:Ь®Њњ8Ћъ3ш]№ЇГяKь®БuШъcbУж№фџ+П®<{ётмбК-Q\9qьї”БпJ‘·k3rвОПаweдѕGэь®Б•Лk›џkp+¤i1Ї\ГЉVћЬ'ѓЯВWЫ4б•kX!M‹yе\3ш/рw*цYцП=lэ-fУл‰®cбп+џ?±kpхgрЗцхзъ]90ЋЈю~WЮг6’+3ш)®уЏ+Пы}Б5РВьќЉ}–-ќ|ч°х·xMЇ'єЋ…їЇ|юД®БuФoaЊiЏБQї­Я•‘ЗQї…®ґђв:яётјп\3ш/рw*цYцПэ©ЕГlz=QКчЅјтщ»ЧяKь1¦=я/еъ]90Ћя—2ш]ygЊЫH®Ма§Hщѕ]yЮw®Ѓ^апTміlйд»я/µxMЇ'Jщѕ—}еу'v®я—,Њ1н1шЙЦпКИ‰гя%]i!EКчнКуѕkpМаїАЯ©ШgЩ?wК°жсZ<М¦ЧҐу'v®йью#чEaл5J®Б5РВьќЉ}–-ќ|wК°жсZ<М¦ЧM_iОы€‰]ѓk:ЯВXуYW±ЫП··4М®Мg7·k›вaЉЈЁЧ··+…uе›УWJр3ЊњЇб·ЈS±ПТ•щlnWFNУщєтkБВ•X
W^`-8»rИ,cъJ3(Е[vеђY
cъJ3(№rИ,gc:ѓТЂИІ+‡Ш2
WaЏ+G1§ЇtБпJ‘d,\Y‹!8}Ґ~W™eaL_)БпJ‘oW>лК-ЈHГЅлґі$хlGqе•/О®јтEбК+_,\yЮw®\^Ыь\ѓkX!M8qеVЭVћЬхпЦюЇю>ьѕЪЅr+¤	'®\ѓkахwК°жсZ<М¦Ч^апъч«kpMЦг›6ПҐя\№Ў%Љ+#'Ћя—lэ®њн'`lWFNGэ¶~W±9}Ґї+уЩЬ®ЊЬЧбЇЯь kpьЇю¶юійuяю®°єЧaлЇ?Ж!6mћKя№тмAWћ=\yцpе†–(®Њњ8ю_Кх»R¤ГнКИ‰гЇїd†®БuФџлЏсЖ,·Q
†юЇю¶юОаїАЯхпVWfрі^зWZИzќ\эЩcЬРr!~бКtY.Д/\9qьх—МР•7f№А•з}Ча:к·хЗxc–Ы(CяW[[xЃїлЯ¬®МаgЅО?®ґђх:яё2r_‡ї~k†®БхяR®?ЖіЬF(ъїъыяRgр_апъч«+3шYSѕoWZИљт}»2r_‡їюl†®Бхя’­?ЖіЬF(ъїъыяR[xЃїлЯ¬®МаgMщѕ]i!kКчнъл·fг†–eЧ_їщБO]э%3ЊсЖ,·HRбКуѕkpетЪжз\УRЊ7f™`®L{¦3ш]yc–Й DбКИ}1eБп\НѕіGЯЇЦm~}2ш-|®Бх~µљcј3ЖdЬ®њнg#№тјК(FrҐ…2®ЊА8¦3ш]™цLfр»2r_‡ч«Хм\…­ЧШҐ.zЧ–2xzЧdm§bџєt®ўn!NЊwЖ8…+УѓўOжК;cњЌб\…­ЧШҐћ{Чю€Ь»&k;ымфЯ©®БUФвЙbј3ЖmМ®<#№тЊдК3’+ПH®L{Љ"Rvеќ1ncvE¤г†–ЂTёrK peє,QvбКИMQD\№…eWQDbј3ЖdlWFо‹)Г~Ч@ЧАTlh~ќ2ь'Џы§"ЦюwaСіэµvњ_§bCуmaпe[©гЪЦ®п=цOE#м®ЃулЕЌ°їhlрµ…ЅCз_јѓ°хu>O,]…­{Ї¶…яќ^йС\ЗШ?1^`-xU„+oМr@’
W
лК~ЦЛжнJЩЩЬ®МаgЅlЮ®bsФїяsеќ1ОЖvе•/^бКИ‰г‘І+уЩњ]№ЇГ1"®cDК1nё9»ЋY€±юНQяюП•ь—НЫ•7f№`ЖWё2ѓџвІyvеЌYn#:|…+3ш).›gWЮе6Ђ_AWfрS\6П®<п»ЧА{O_явuН ]Ї—¬dџи№Фїx]ЋЯsйїю{П5tуКю'ъзћK] GOtКс;Kэ‹Ч5ѓPґщБwцПЗ5tУЦ–м©ЯифШхOм\kЎ€сО·q»ІюНџбхЋ+-”±pmО7f№ I…+…ue?лeуциЈмlnWfрі^6oWЮе6 I*\™БOqЩ<»rИ,gЈнЦDЌW\6oЧљG9F‘gWfр_њ]iббмКіЬђP
WfрS\6П®ј1Лm Ґpe?ЕeумК~K†ъ и_јыoWЮе6ЂҐpe?ЕeумКіЬђў®Ма§ёlћ]yc–Ы ^”В•ь—Ні+#Ж±жQvеyЯ5ёr9lэ®\ZйqФ/кe,ѕ+—Іaлw]W.Їm~}Б5¬ђ&W®aES<+Ч°jУўk  …­ЧШҐЖ±§Ї4з}D‹c±wёr+љвY№†Т„гК5ё†ТґWt«6M8eшOќІx•+Ч°BљуК5ё¦†<fND)&ощЌбютњАWLЬуNУzнф\У?CЛ‰ЂиЉ‰ыпЩ50э3д‰p"`ч°рµфћpLяy¦њ‹‰ы<lЩГВЧТ{В50э3дњHЕД}¬№шќАSуqLяynN€bвNы»НЇПыаЃ®Ѓйџ!ЏЊшЉ‰;Ќ·OO_iОы€ћAIzЗ50э3д‰гDе]LЬiј}z§o±Чз™—Ќcщ~ќАSуqLяyNT~ЕДќАSуй"ЯП5ёО•шЉ‰{ЮiZЇќћk`:њЕДќц9v›_џчБ]‡Д‰Ђ]LЬГВЧТ{В5ё†ТґW®aХ¦	їљцх:eс*W®a…4-ж•kp|55 “•J}ЌьыК~ЧАWS—eІR©Ї‘c/э|\_MЅ “•J2Y©ФњGNУg#\_MЌТLгнУжіЇВ¦Ъ8ц5тпщXsс]_M_&+•dІR‰уИiЪ’Г5рХФkъ.ЯНъ~Я»N«kа«©ЈRШєзсЪ|цUШФцЮжзшjк(|pПгµщм«°©нЅНП5рХФшXЯпџыщч|¬№ш®ЃЇ¦ЋЋхэю№Ї‘‹}¦®ЃЇ¦Ћсј-Zмя\_MXЯплXшЯйyѓўҐ“пNw®}цншjкEb}їSѕпeП-ќ|wєsніoЧАWSЈЏФВћ—~'рФ|ъОШs|55NyЮэнэ\CуХФтЫ<o‹Nw®}цншjкиw"ЋэЇоtзЪgЯ=QК°‚гwєsн=FNыЫ'v|5хfOН§БЛ5рХФ3xj>-2єѕљ:1Ѓ§жУЗљ‹пЪ4ЎЇ¦mZ4Ѓ§жУгIЯ5ґiB_M
;
        .IFE	LSTRAM,[
	.XLIST
]
;
	.PAGEЉ;
;|----------------------|
;|	 RAM AREA	|
;|----------------------|
;
	.LOC	0FD00H
;
;	DISK VARIABLES
;
;	DISK COMMAND TABLES (LEAVE AS IS UP TO ERRCNT)
;
;	--- READ/WRITE/FORMAT ---
;
TYPE:	.BLKB	1	;COMMAND INFO
			;  NNNNNNNN
			;  ||||||||
			;  ||||BYTES TO 765
			;  |||0=NO, 1=YES FOR DMA
			;  ||0=NO, 1=YES FOR INT
			;  |0=RD, 1=WR TO DISK
			;  0=NO, 1=YES TO READ ST3
;
DMAADR:	.BLKW	1	;ADDRESS TO START DATA XFER
BCNT:	.BLKW	1	;BYTE COUNT-1
CMMD:	.BLKB	1	;COMMAND TO 765
RDRV:	.BLKB	1	;UNIT #
RDCYL:	.BLKB	1	;CYLINDER #
RHD:	.BLKB	1	;HEAD #
RCRD:	.BLKB	1	;RECORD #
NSENT:	.BLKB	1	;BYTES/SECTOR
EOT:	.BLKB	1	;SECTORS/TRACK
GPL:	.BLKB	1	;GAP 2 LENGTH
DTL:	.BLKB	1	;DATA LENGTH
;
;	--- RECALIBRATE	---
;
RCLTBL:	.BLKB	1	;RECAL TYPE
	.BLKB	1	;RECAL COMMAND
HDRV:	.BLKB	1	;RECAL DRIVE
;
;	--- SEEK ---
;
SEKTBL:	.BLKB	1	;SEEK TYPE
	.BLKB	1	;SEEK COMMAND
SDRV:	.BLKB	1	;SEEK DRIVE
NCN:	.BLKB	1	;NEW CYLINDER NUMBER
;
;	READ BACK STATUS - MUST STAY IN ORDER
;
ST0:	.BLKB	1	;STO STATUS
ST1:	.BLKB	1	;ST1 STATUS
ST2:	.BLKB	1	;ST2 STATUS
CYL:	.BLKB	1	;CYLINDER STATUS
HD:	.BLKB	1	;HEAD STATUS
REC:	.BLKB	1	;RECORD STATUS
NUMBє	.BLKB	±	;NUMBEТ OЖ BYTEУ STATUS
ST3:	.BLKB	1	;DRIVE STATUS
;
;	OTHER FLOPPY VARIABLES
;
ERRCNT:	.BLKB	1	;DISK ERROR COUNTER
FPYFLG:	.BLKB	1	;FLOPPY FLAG(FF=INTERRUPT TAKEN)
HOMES:	.BLKB	1	;HOME FLAGS
MTRCNT:	.BLKW	1	;FLOPPY MOTOR TIMER
;
;	DISPLAY VARIABLESЉ;
CHRADR:	.BLKW	1	;CHARACTER ADDRESS
			;  H=CHAR POSITION (0=LEFT)
			;  L=LINE# (0=TOP, 23=BOTTOM)
CURATT:	.BLKB	1	;CURRENT ATTRIBUTE CODE
CURCHR:	.BLKB	1	;CURRENT CHARACTER SET
DSPBUF:	.BLKB	80	;BUFFER FOR MOVING LINES
DSPCYC:	.BLKB	1	;DISPLAY CYCLE COUNTER
			;	0 = NORMAL CHAR
			;	1 = ESC PENDING
			;	2 = LINE # PNDG.
			;	3 = CHAR # PNDG.
			;	4 = ATTRIBUTE PNDG.
			;	5 = CHARACTER SET PNDG.
 		        ;	6 = LEAD-IN PENDING
LINOFS:	.BLKB	1	;OFFSET DUE TO LINE FEEDS
;
;	KEYBOARD VARIABLES
;
KEYCOD:	.BLKB	1	;KEY CODE
KEYFLG:	.BLKB	1	;KEY FLAG (FF = KEY WAITING)
SHLOCK:	.BLKB	1	;SHIFT LOCK FLAG (FF = CAPS)
;
;	MISC. VARIABLES
;
FLAG86:	.BLKB	1	; 8086 FLAG; 0 = O.K.
BOOTRY:	.BLKB	1	;BOOT TRY COUNTER
BOTSTK:	.BLKW	1	;BOOT STACK STORAGE
CMDPTR:	.BLKW	1	;U COMMAND POINTER
FLGLOP: .BLKB	1	;LOOP PENDING FLAG
FLGCMD:	.BLKB	1	;MACRO FLAG
LSTATE:	.BLKB	1	;L0-L7 STATE
CMDSTT:	.BLKW	1	;START OF MACPTR
OUTSEL:	.BLKB	1	;OUTPUT SELECT STATUS
SAVDE:	.BLKW	1	;LOOP DE SAVE
SAVHL:	.BLKW	1	;LOOP HL SAVE
SAVCMD:	.BLKB	1	;LOOP COMMAND SAVE
SAVDE2:	.BLKW	1
SAVHL2:	.BLKW	1
SVCMD2:	.BLKB	1
CMDBUF:	.BLKB	20	;U COMMAND BUFFER
;
;
	.XSYM
        .END
EDIT    BAT           <ЌѓE	   ADINSTALEXE           т uI<eb  ANADISK EXE           ‰¦њБ)/‡ TDCHECK EXE           \їм§<WZ  TDCONFIGEXE           (Waі<_c  TELED204EXE           йTЖА<сt TELED211EXE           ±`п<Ѓі TELED212EXE           Ї0&=гі 100 REM ***********************************************************************
110 REM *                                                                     *
120 REM * Name: MX100                                                         *
130 REM * Rev.: 1.0                                                           *
140 REM * Date: May 14, 1982                                                  *
150 REM *                                                                     *
160 REM * Desc: EPSON MX100 printer setup utility                             *
170 REM *                                                                     *
180 REM *                                                                     *
190 REM ***********************************************************************
200 REM INITIALIZE VARIABLES
210 GOSUB 680
220 REM CLEAR SCREEN AND PRINT HEADING
230 PRINT CLR$
240 PRINT "*****  EPSON PRINTER SETUP UTILITY *****"
250 PRINT: PRINT: PRINT "STANDARD PRINTER CHARACTERISTICS"
260 PRINT
270 PRINT "LINE SPACING = 1/6 INCH"
280 PRINT "FORM LENGTH = 11 INCHES"
290 PRINT "CHARACTER SIZE = NORMAL"
300 PRINT "CHARACTER SET = US"
310 PRINT "1 INCH SKIP OVER PERFORATION = OFF"
320 PRINT: PRINT
330 PRINT "ANSWER THE FOLLOWING QUESTIONS WITH 'Y' IF YOU WANT THE OPTION"
340 PRINT "PRESS 'RETURN' IF YOU DO NOT WANT THE OPTION"
350 PRINT
360 REM LINE SPACING
370 INPUT "LINE SPACING CHANGED FROM 1/6 TO 1/8 INCH: ";A$
380 IF A$ <> "Y" THEN 430
390 SPC = 8
400 LPRINT ESC$ + "0" 
410 PRINT "FORM IS NOW 88 LINES LONG"
420 PRINT
430 REM FORM LENGTH
440 INPUT"CHANGE FORM LENGTH FROM 11 INCHES: ";A$
450 IF A$ <> "Y" THEN 500
460 INPUT "ENTER THE NUMBER OF LINES ON THE FORM: ";LINES
470 PRINT "FORM IS ";LINES/SPC;" INCHES LONG"
480 LPRINT ESC$ + "C" + CHR$(LINES)
490 PRINT
500 REM CONDENSED PRINT SIZE
510 INPUT "CHANGE TO CONDENSED PRINT SIZE: ";A$
520 IF A$ <> "Y" THEN 560
530 LPRINT ESC$ + SI$
540 PRINT
550 GOTO 610
560 REM EMPHASIZED CHARACTERS
570 INPUT "EMPHASIZED CHэЪґ(Щ0ялЌDє†6Mи«©Ґ6-ЉD6МїБъD#‘®ЎMъjjs›E"жЯ`}ў‘HЧР¦	}5uС¦E‹|?ЧР¦	}5µmУўзaпФЧГВЧТ{В5рХФѕіллџыAСYкљО{Р5рХФSѕіллџыAСYкaбs|5х …хќЯГВзшjк›вЌч_џkа«©!лыэч\ЫґШs|5ufoџю{®mRЧР¦	}5хХ¦EЕпїNЕ>KЧР¦	}5хЪnУўЦw~§bџeЯYјО°]C›&фХФ§M‹ZXЯщќЉ}–}gс:K’kа«©ло®oјф;ы,»ЪёЧ®ЃЇ¦ю»»ѕсТпTмімъѕkhУ„ѕљЬЭхЌ—~пяЏќБя\C›&фХФШо®oјф{Џїмс¶@ZишjjD-/M‹V {д-ъgшъпyјЮPф“ЅюзЪ4ЎЇ¦–э№лыЅУ·ШлуМ6CЧР¦	}5ui¤цјф;Ѓ§жУwЖћkа«©гx^}їЇ}цэю;Х5рХФ‹Пє±ЧЧ>ы~яќЪХRэпn°ѕОp”&v|5µј·iС4ОІk‚ЛЖ±П«пчµПТ5рХФkГуТЈЇ}цэю;µ'ЄҐъЯЭ`}ќб(MмшjкЕ†€|D#Оѕ:K’kа«©ODд#qцХєѕљzсLD•Ж6w}ї'КpbЧАWSЈQҐ±Н}^}ї'К’4±kа«©еЕљA(ъgшZ:щоџблїзс\_MЌџ	<5џО’дшjкµљ	<5џОР5ђ®\^Ыь\ѓkX!M8®\ГЉВЦkмR?шO©'JЕ>;эwЪВNwЇ\Г
iВqе\WHУb»r\хЅл§п,Асёr\!M‹нК5ё
[ЇQЉQXWЦz	ЉzХ?eиє±Чхп4н+[шЯqеђYЦЛхъпоРхэ®§i_ЩВяNяЬВЦkмRЧїУФ•X^бКіЬ ICЧч[ФKжю№-,мlc{јпКъ7EЅ¤avеі®јАZpfиє±Чз™mэпTW^`-(\yЃµ`б\·ќ%©ѕЯ?ч°рбР5ёi›a¬;н1Ъ4бt_Y*3tЪ#ЃcяЧГВЧY’кы®Б50/M;•Тx®БµM8±ЫЏЁW*ҐvmОщм6ЕіЪJ-к•J©	§ё¶	зЊkS<Ї¦TLєс`›s§вҐi‹zҐRr®Ѓ¶v*цЩйїУЇ¦}Ѕ–џkpеy•QЊДРoФЧчћѕ®аyќЉ}–mkпљ¬uеќ1n#№2]–Ї&†¶R§bџeЈч«Й•‘GQЇH™Ўы¶ЁW¤мК!6ЗЫВB†~Ј>W¦ыbbи¶R§bџe/N{ј-,teЖQФ+ІАРїx°3ш/р·ээs[Ї±K-ЋЕЮqхЉ”cЭ7f№Ќ2Cчхu}їEЅR)5z—]№/>™э(ЭЉ~2ы]ѓk ­ќЉ}vъпtКрџ<Z~®БUФ+Ілѕ3Ц¦x¶‘Ш&єrCЛЁ@БРVкTміl[{wКрџ<:ы,]‰cъ'†о_<ШжЬ?wКрџ<:нъ\ѓkа?Ц±ялTміУ§о=ю;pязШх}Ј­Фр=сДТ5ё2н1Ъ4бTLSqєCїQ_ЛЖюЇо=ю;pяЧхэ¶RГчД®Б50ѓя§bџeяЬ5ќч`o(є]ЫВtЮэапўwJщНЈФ®Б5зјлґЗhУ„3шSq:ѓя§bџeяЬ5ќч +#'QФлјПРOf[©ќҐѕћие1±+Уe9$WFN‡ґНР5ёЦџПkш]ґ…ќЉіЕ‰·м\Xлѕ3Ц¦x¶Q0фхuэщјѕr]v–>ЩпTміtmОхп6Е“ЉіЕ‰·м\3ш/рwOН§о‰Љ‰г-Ќ‰]ѓk:хјлґЗhУ„3шxљЎ3ш/рwOНЗ5ё>™э}eu®OfяBЊІі№:Ќ·O‹zҐRr}2ыQb¬SФ+•CЧџПkQЇTJ®ў^зэX_щbбК+_}^эщј>Пlл§єтКgWКОжvҐ°®¬SФKfW^щвU®ххЄКРзХџПлъwљц•-ьпётYWћчЙРз}р@ЧаКеµНП5ё®ђ¦иїr\uЯ¶¦eџ~_m)џ6-єr\µ)ћ{ЧяNЯYЂгqеёBљўяК5ёЧАюьќЉ}–эsГ5ёfр§вДъОX›&МglWЮm
ЈмЪ¦	е»Mс$рмя]Ы„уl›в‰olЧ6б9qmЉ'ѓ?ќІk›p¶рґ)бљБџN9ЦwЖЪП6†+пЊq6
Ч6бњЏmS<А
Ч6бњБЯ¦xЄЁWЙµM8ЯmS<Йў^%Ч6бњБµiВПµM8ohЫ ¤ВµM8gр·)ћ*кUrmОЪ6ЕS–
Ч6б|g¬Mсc»¶	з!v›вIаЩя»¶	зю«MЮ®mВщОX›вЩFбКtYF‰ЋЎ­Ф/WFN3шџм3ф/мю'ы®ЃtҐ…§MсэF}®mВY¤У¦xC[©Eзс:ы,]Ы„sдАё6M8ѓ?ќr3tявБОаO§мJЩЩЬэF}ќЖЫ§У>§ФБьые1±k›p>пі›Ў7}Юt®ьOцc=Д&в\Т0»rЛ2C[©‡…Їg_ќ%Й•'Ћэ‹ыјЯyR©лы®Б•Іі№]Yяf*О'Юrи”GoШиётЖ,·1$†№‡…ЇҐчDѓW†}Юtеќ1&c»тјп\3ш/рwOН§оbёЧюћX±™А“юpe>›Ы•Ж№тЖl›вЩ°SбЪ&щГю6ЕSEЅJ®mВщОX›вЩFбJ·k›pОаoS<BФ«дЪ&њoМ¶)ћm [®mВ9ѓїMсTQЇ’k›pѕ3Ц¦x¶1\Ы„у†¶Mс”ҐВµM8gр·)!кUrmОз}Чаё…и,Iхэю№‡…‡®Б5ЭW–К1Ћb¦вlq\У}eIЉх»MсіT]Ы„уўMсЧ6бњ.Ы¦x†…Їє¶	зИImЉ'ЭW¤мЪ&њ·°mЉ9,|Х5ЭW¤гќ±6Е3ЊнЪ&њПы®Б5рџлШяхЩ©ШgЩх}ЧаљЉi*NЊwЖљЫH®L—едиwІ+Oў+Уe‰(\y`ў+7ґD‘
WЮгllW±™А“ЉгК|6gWћч]ѓ+—ГЦпКҐ•GэLЖв»r)¶~ЧµqетЪжз\Г
iВqеVlS<)ГтиґлkУb»r+¤	З•kpMядгќ1n#СґЁkp+¤i±·r«оy§iЧk§ЧЅr+¤i±·r®йџ<bL—е\]90Ћi¤гК!v›вIаЩя»r¶їMсД7¶+#'®Mс¤)»R¤У¦x
Ч4"еE:mЉ§pеЌЩ6Еі@’
W¦ыjS<…+#w›дOл/\9Д&в\Т0»2џНнКИЃqL#ІаЪ&њпЊ5·QёІ‚¶Mс”ЈDueэ›©8[њxЛ®ј3ЖВШ®ЊЬПГ†д\У€,Дxc–…ё2r_L`э…kp+¤IЮV®aХќц9v›_џчБ»W®a…4ЙЫК5ё¦‘NЊйІLЗ•‘гЪ4б4$WЮea ®ЊЬXб\Г
iт•kXu_Kп‰о•kX!Mѕr®iH1¦ЛrH®ЊЗ4жбљ†TЋq€Н9яќ>ѓ•жЯычњяП·+пЊq66]9Дn¦вlq\™о‹і+#ЖµiВiHсъцќ±Ч	<5W±yoуNџЎЯЁЇ­Фз™m†уweє,‡…Ї"ЛЭ8FЧtЮѓ®ЊЗ4$†о_<Ш5K±ПлљNГ5ётЖ,‡ё2н1о+K’+УѓCJг”]9Дж°0K•Б|цUШФ5ќ<†+пЊQЫ•7f9e†4Ю>ќблaбseЪcР|¤4NјсйКіЬ°з‚ЎыЌъєШG цy]УЙcё2ѓџUФ«дК~
QЇ’+‡МІ0†…YЄ®ј3ЖmЬ®ґрp»2]–ГВW]90ЋiH®”ќНнљ†ґгќ1ЮЖveЪc0ЭW–КteдѕУђЦ0t?(єШG цy]УЙcёЧ4$”Уѓ5ќ^Эу3[Ш5K±ПлљNГ•Cl¦вlqв-»тОc»2r_‡iHkє]іфыј®йд1\ѓkRь-<Ь=?і…}gмuOН§EF@WЦї™ЉіЕqеќ1c»2н1о+K’kТљ#чЕtкyџЎ}gмuOН§EF@ЧаVHО+Ч°кћЯЭ+Ч°Bљp^№Ч4жcє,з7\90ЋiьЩ•Cl&рМoёr¶џЂ±]90Ћi<ЩwеђYЖьЖшР•iЏБљA(\щ¬kOцcЊЬџМюЧаVHУ„®\ГЄып№{еVHУ„®\ѓkЋ1]–@t…+#qј3цчм\Г
iZL+Ч°к>[ц°рµфћи^№†ТґV®Б5ЌѓЕ.K`.\‰гyШђ\ѓkX!M‹eеVЭ	<5џ>Ц\ьо•kX!M‹eе\У8?ЖtY©pe$ЋЗюЧаVHУb»r«оћљOщ~Э+Ч°BљЫ•kpMЈёcL—eщMЧ6б‰c‘пЧаVHSф_№†UwoџЮй[мхyf›aчК5¬ђ¦иїr®i¤qbL—ey®ЊЗф‡Њ®bузk§пК;cЖvеЌYаљюq1Цb¦вlq\™цLч•%Й•iЏБюW¦=Уш
W¦=НGJгё¦cдѕшdц/ёЧ°BљдЯК5¬єУxыфф•жјЏи”¤wєW®a…4Йї•kpMИbL—eъgИ\90ЋiД№rИ,cъJ3(№Rv6·+…ueэ›УWJр»ІCpъJь®|Ц•‘ы:L#О5ёrymуs®a…4-bеV|5нлuЪх5№r+¤i+ЧаъjJЕ4F‘·+#'ЋЇ¦4-»WЉtё]™.ЛтљВ•‘#еиfW^`-XёrИ,#•Тџ‡+#чuшjJУWЧАґGЗюЇ·зХЪYjмҐџOK'ЯќЉ}–®Ѓжч{йзcфЦўнпE?ЩKа=Сyвvь№#а}хПmяТ5ёѕљТґгќ1n#1фќ±ЧрЙ~§bџeяЬЫ•ґњLfи
Оямф;KR}Я•‘“%у«‰Ў­ФiџS2ъ¶…ШVt*цYє2]–“ЧLfh+µщјэЯй_lШQг=М€F‰_LLWFL„’щХДРэ‹ЫBl+:ы,]yЃµ`бК!і,ЊWУџ‡kp}5ҐйBЊg$2фххЋoЇQк№Ф®ј3Жgl†ѕ3цъзuо,u–¤ъѕ+oМR CЯuо,u–¤ъ~Ј7аJ±C}ўbtј-ЮД}eнџ{йзгК;c|ЖНРwЖ^Џ:w–{йзУ?чsҐ…2®ј3FaЬ}gмх]зОRc/э|ъз®јтЕ‚ЎП«?џЧ	<5џЮBњW«+/°}ЃµhмҐџOgШхп4uеyџп«nмҐџOo!О«Х5ёBЙьjЉсО·‘\№Ўe©peдѕЉsЮw®\^Ыь\ѓkX!M‹iеVЭЌмyд4mq6ў{еVHУbZ№ЧyLЕAДxc–Ы@q®a…4-¦•kXuЌмkдЯW¶рwЇ\Г
iZL+Чаz]ЩВcэ»i>Rє…лuБ_ЋсЖ,·ј‚ЎEЅR)5zЇpeдѕ#еи]ѓkX!Mт¶r«оr#ыщ7цТП§{еVH“ј­\ѓл…ҐџOЊ7f›Ы(»^XъелЯ4)ЭВ•Ј‚ж#se-† щИК®¬Е4YyБ•Іі№]Yя¦щ”в-»rCР|J®¬Е4џRЩ•µ‚жS*/ё2r_‡ЧЩ5ё†ТґV®aХї‘=Џњ¦-Щ1єW®a…4-¦•kpќЗTІ#ЖіЬЖ‚+#чux]ЩВп\Г
i’я+Ч°к^УИ®пчЅлґ¶”OKvЊо•kX!Mте\лыwќЖxc–Ы DбКъ7НGJ·pЌ”ЈK1Fо‹Of?Љkp+¤i±Z№†UwФF¶°uПгµщм«°©нЅНЇ{еVHУbµr®ўОж#Е(;›Ы•7f№$
CЗхlЧч{Џу¶(№ЋЁ1¦=ЗШ?®|Ц5RЋnЋu3r_|2ы\ѓkX!M8qеVЭQЩоyј6џ}6µЅ·щuЇ\Г
iВ‰+Чаъаl>RЊ7f№ЌWжі№zЈ/Чіэmk§сцqeдѕGTЧаVHУb^№†U7J#;Ќ·O›Пѕ
›*W®a…4-ж•kpMгЏcЪcР|¤4Ћkp+¤IюЇ\ГЄ_#»ѕЯ?ч5тпщXsс»W®a…4Йя•kpЅю|~Њ7f№ E)\Ї?џrЊхoљЏ4ЫoЩ•‘ы:Њ”Ј›]ѓkX!MтwеVЭС5Ілыэs_#яыL»W®a…4ЙЯ•kpЅѕ8УoМrшў®ЊЬЧбхзSv®a…4б¤•kXuЗЩзmСbяЧЅr+¤	'­\ѓлyBмлґЗаy[мпК!і,ЊARACTERS: ";A$
580 IF A$ <> "Y" THEN 610
590 LPRINT ESC$ + "E"
600 PRINT
610 REM SKIP OVER PERFORATIONS
620 INPUT "SKIP OVER PERFORATIONS: ";A$
630 IF A$ <> "Y" THEN 660
640 LPRINT ESC$ +"N" + CHR$(SPC)
650 PRINT
660 REM END OF OPTIONS
670 SYSTEM
680 REM VARIABLES INITIALIZED
690 ESC$ = CHR$(27)
700 CLR$ = CHR$(26)
710 SI$ = CHR$(15)
720 SO$ = CHR$(14)
730 SPC = 6
740 RETURN
IABLES INITIALIZED
690 ESC$ = CHR$(27)
700 CLR$ = CHR$(26)
710 SI$ = CHR$(15)
720 SO$ = CHR$(14)
730 SPC = 6
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	10	; IS LAST READ SECTOR <> 10 ?
	JRNZ	RWUPSC	;  IF NOT, THEN GOT UPSC
	INR	D	;    ELSE INCREMENT TRACK COUNT
	MVI	E,0	;    & SECTOR COUNT = 0 (NEXT INSTR. SETS TO 1)
RWUPSC:	INR	E	; INCREMENT SECTOR COUNT
  	POP	PSW	; RESTORE DISK COMMAND
	JMPR	RWONE	; GET NEXT SECTOR
;
RWNFG:	POP	PSW
	MVI	A,9
	RET
;
RWDONE:	POP	PSW	;  RECTIFY SP,
	XRA	A
	RET
;
GTRKSC:	LHLD	AUS	;ALLOCATION UNITS FOR
	MOV	A,B		;VALET.VL2 FILE
	ORA	A
	LDA	EXM
	JRZ	GTRKS2
	ORA	A
	JRNZ	GTRKS1
	SLAR	B
GTRKS1:	INX	H
	DJNZ	GTRKS1
GTRKS2:	MOV	C,M
	INX	H
	MOV	B,M
	ORA	A
	JRZ	GTRKS3
	MVI	B,0
GTRKS3:	MOV	H,B
	MOV	L,C
	DAD	H	; MLPY BY 4
	DAD	H
	MOV	B,H	; SAVE
	MOV	C,L
	LXI	D,10
	XRA	A
GTRKS4:	INR	A
	ANA	A
	DSBC	D
	JP	GTRKS4
	DAD	D
	ADI	2
	INR	L
	MOV	D,A
	MOV	E,L
	RET
;
VALMSG:	MOV	C,M	; PUT UP STRING TO SCREEN
	BIT	7,C
	RES	7,C
	INX	H
	PUSH	PSW
	CALL	VALDSP
	POP	PSW
	JRZ	VALMSG
	JMP	HILITE
;
;|-----------------------------------------|
;|    HILITE CHARS. OF VALET ACTIVE REG.   |
;|-----------------------------------------|
;		
HILITE:	PUSH	B
	PUSH	H
	PUSH	D
	LXI	D,1602H
;
..L1:	PUSH	H	; CALCULATE LINE OFFSET
	LDA	LINOFS
	ADD	D
	CPI	24
	JRC	..J1	
	ADI	-24
..J1:	POP	H
;
	ORI	0C0H	;THE LAST TWO LINES OF THE
	OUT	SDSPY	;SCREEN
	MVI	B,79
	MVI	C,DDSPY
..L2:	INP	A	;DO NOT CHANGE ANY OTHER ATTRIBUTES
	ORI	4	;HILITE	
	OUTP	A
	DJNZ	..L2
	OUTP	A
	INR	D
	DCR	E
	JRNZ	..L1
	POP	D
	POP	H
	POP	B
	RET
	.XLIST
	.IFN	LSTETB,[
	.LIST
]
	.PAGE
;
TSTLEN:	.BYTE	20,22,12,14,8		
TSTADR:	.BYTE	22,28,22,53,23,30,23,46,23,65
;			
TSTMSG:	.BYTE	HOM,ESC,"J",ESC,"U",HLBOLD,ESC,"S","1"
	.ASCII	"   M A I N  "
	.BYTE	ESC,"S","0",ESC,"T",SPC+1,"\","\",ESC,"T",SPC,CR,LF,ESC,'S','1'
	.ASCII	"   M E N U  "
	.BYTE	ESC,'S','0',ESC,"T",SPC+1,"\","\",ESC,"T",SPC
	.BYTE	ESC,'=',54,28+20H,ESC,'S','1'
	.ASCII	'CALCULATOR'
	.BYTE	ESC,'=',54,53+20H
	.ASCII	'SCREEN DUMP'
	.BYTE	ESC,'=',55,30+20H
	.ASCII	'ALARMS'
        .BYTE   ESC,'=',55,46+20H         
	.ASCII	'INSTALL'
	.BYTE	ESC,'=',55,65+20H
	.ASCII	'EXIT'
	.BYTE	ESC,'S','0',ESC,"c"+80H
;
OKERR:	.BYTE	ESC,"=",37H,SPC,ESC,"J",ESC,"S",31H
	.ASCII	"                VALET DISK ERROR"
	.BYTE	ESC,"S",30H,8DH
FATERR:	.BYTE	ESC,"=",37H,SPC,ESC,"J",ESC,"S",31H
	.ASCII	"    FATAL VALET DISK ERROR (MUST WARM BOOT)"
	.BYTE	ESC,"S",SPC,8DH
;
;|--------------------------|
;| TABLES FOR ALARM MODULE  |
;|--------------------------|
;
DAYTBL:	.BYTE	32,29,32,31,32,31,32,32,31,32,31,32
;
HOURS:	.BYTE	ESC,"=",36H,20H+45,ESC,"U",HLBOLD
	.ASCII	'HRS (00-23): '
	.BYTE	ESC,"U",HL+80H
;
MIN:	.BYTE	ESC,"=",36H,20H+61,ESC,"K",ESC,"U",HLBOLD
	.ASCII	'MIN (00-59): '
	.BYTE	ESC,"d",ESC,"U",HL+80H
;
;
MON:	.BYTE	HOM,ESC,"J",ESC,"U",HLBOLD
	.ASCII	"ENTER ALARM: "
	.ASCII	'MOS (01-12): '
	.BYTE	ESC,"d",ESC,"U",HL+80H
;
DAY:	.BYTE	ESC,"=",36H,20H+29,ESC,"K",ESC,"U",HLBOLD
	.ASCII	'DAY (01-31): '
	.BYTE	ESC,"U",HL+80H
;
CANYN:	.BYTE	ESC,"=",37H,40+20H
CANY1:	.ASCII	"  CANCEL? ("	
	.BYTE	ESC,"U",HLBOLD,"Y",ESC,"U",HL
	.ASCII ")ES OR ("<µsй»rИ,g#Љлы/Дш¬+Уe9Y~“йКИЃq<bяІ+‡Мr6К®ј3ЖЫШ®Gм_Ћ1н1xЃµ–\№ЇГH9єЩ5ё†Т„гЉ®aХЩхэѕЋ…яќћ7(Z:щоtзЪgЯЭ+Ч°Bљp\№ЧtзzБУѓ[D.ш]чљ2JЊПє2r_|2ы\ѓkX!M8aеVЭ‹ФИ®пwКчЅмyѓўҐ“пNw®}цЭЅr+¤	'¬\ѓkєsMwЊiЏБ-")Я®ЊЬЧб^SFq®a…4Йя•kXuЈ7І…=/эNа©щфќ±ЧЅr+¤IюЇ\ѓ«8йЯX¬oМ¶)ћm,ґiсЪ•‘ы:Њ”ЈK®Б5¬ђ&њґr«nњ6ІПЫўїЅ_чК5¬ђ&њґr®з‰oпУѓзmсoW™eaФEuеђYОFTWFолр€э\ѓkX!M8щК5¬єеЧИ>o‹Nw®}цЭЅr+¤	'_№ЧуДЩwЊ7f№ЌтBбКИ}FКС%ЧаVHУb^№†UwфЫИFы_§;Ч>ыо^№†ТґW®БqюЩwЊ7f№Ќ2JбКИ}FКС%ЧаVHNZ№†UчndѓW'рФ|єW®a…4б¤•kpЇћXч›©8[WЮгllW±ЫППЧNЯ•йѕ83X©ѕ:KЅУ_цyжҐ+#'®№гЇЩэ‹ыји
^	<еX‹t8ъЌъъОШлћљOѓ—+#Б+ЃgБ•7f9Њaб«ИІ+x%р,ДZ¤ГЩµM8ЯkS<Ы]Ы„sэ»Mс¤вlq\Ы„sдѕwь…Щ5ё†Т$o+Ч°кћЩ"#`'рФ|єW®a…4ЙЫК5ё
Lа‰х›©8[WЮkS<і±Ы4aW±ЫПњяNЯ•йѕ83X©зьѕ;KЅУ_цyжҐ+#qН'іЃЎс`џчБ]Lа)ЗЪВУэF}}gмuOН§EF@WЮе6†…Їє2Э‡+#0Ћ&р,ётЖ,‡ё
АіkgWЮг6fWЦї›©8[ЧaЋ1r_L§ћч]ѓkX!M‹З•kXu§Fц±жвwOН§{еVHУвqе\Џэ	<±b·)ћћэї+gы›сЌН 28ЏЧ+~СwЇезКИ‰гЋЏRоvҐ…‡…лЋЏRЋµiQWЮmn#Jt®LчЕ‚БJупэыXsс{О ы”\№Аъ†юЕѓ}gмuOНЗ5ёr€MД№¤ave>››Ў­Ф€іЇО’дКИЃqЬсЧl†о_<ШOfя‚kpeЪc0ѓяЙ~wи7кл4Ю>ќт oШ8tҐмlnWЦї)к•JЙ•‘ывђ¶2ф†ўEоЭГВЧТ{В5ё†Т$o+Ч°кЌмс¤Я	<5џо•kX!Mт¶r®Ѓ¶vъ'Џ…xг·…эjъуp®a…4-–•kXuїF6МїБъDчК5¬ђ¦ЕІr®Ѓ¶ц“ЩїРцЯуx®Б5¬ђ¦ЕІr«n©‘уo°>СЅr+¤i±¬\ѓk ­эdц/ґ…эч<ћkp+¤i±¬\ГЄЫЬИ†щ7Xџи^№†ТґXV®Б5РЦ~2ыЪВю{П5ё†Т$o+Ч°к.ЩEѕ_'рФ|єW®a…4ЙЫК5ёщNа‰х›?_;}WЮkc»тЖ,pe-†hУ„Sq¶8®L{¦ыК’дКИ}ошСmЧаVHУb^№†U·mdџ‡-{XшZzOpеVHУb^№Чу°!Еє‡ШmЉ'g‹гК;cњЌнК!6ѕvъ®LчЕ™БJупэыз«іФ{y–®ЊА8‚WO™Ўс`Я{ќАSуqmОiЏС¦	Чt†ЂэF}]УЙcф^W¦=F›&њо+KeЧ?єcдѕN=п»Ч°Bљ&д•kXuGЩiј}ъз~Pt–z§o±Чз™m†Э+Ч°Bљ&д•kpMг<(bL{Њ6M8ЌџЎh“ьuЭсЧм#чЕ'іБ5ё†Т„W®aХ=md§сцйџыAСYкaбл^№†Т„W®Б5ЌуЊ1н18¤4О‚+#чuёгG·]ѓkX!Mт¶r«оСИ¶°ѕу{XшєW®a…4ЙЫК5ёZX‡…1±™ЉіЕqеќ1ОЖvе»MсМщпф]YБ№93X©чп9яџoWFNwьTfи_<Шiј}zXшЗ~2ы]™цmљpMGА2CїQ_[XЯщ=Џ§=,|®ЊЬЧб“Йм_pЭсS9ЖґЗађТ8eє2r_‡O&іБ5ё†Т$o+Ч°кѕЩвЌч__чК5¬ђ&y[№WсЖ°0Ж!6Sq¶8Э®ј3ЖЩШ®b·)ћ9яќѕ++8sf°RпЯ?_®Њњ8ош©МРїx°Уxыф°рх†ўџМ~WЮг0f†~Јѕ®йд1ъ<іНР•wЖ8›ЎјЗNгнУsю?Я=,|®L{Њ6Mё¦^eWFолрЙdц/ёЧ°BљЛК5¬єa#»ѕЯПµ{еVHУbY№ЧъюЯsЊ7f№`®ЊЬЧб^SЮ®Б5¬ђ¦Еґr«оЬИNгнУПµ{еVHУbZ№Ч4ОЯsЊiЏБ4Оџ«л“Йм_€1r_|2ы\ѓkX!M‹З•kXu_ЌlсЖыЇS±ПІ{еVHУвqе\Е#ќУѓвЌTWFолрЙdц/ёЧ°BљpвК5¬єЧv#ЫВъОпTмім;‹ЧvЇ\Г
iВ‰+ЧаjaMЖxc–Ы RбєЧ”wЊ‘ыв“ЩЏТ®Б5¬ђ¦ЕjеVЭ§‘ma}зw*цYцќЕл,IЭ+Ч°Bљ«•kpґµџМю…¶°_M®Б5¬ђ&щ·r«оЪИ®oјф;ы,»ЪёЧЅr+¤Iю­\ѓk*Nµq1Юе6ўseдѕчљтv®a…4ЙЯ•kXuяFv}гҐЯ©ШgЩхэо•kX!Mтwе\Sqкы1Юе6р№2r_‡{My»Ч°BљдЯК5¬єБFv}гҐЯыяcgрїЪЅr+¤Iю­\ѓk}cягЌYn#Љ+#чuёЧ”·kp+¤)ъY№†U7ЦИ®oјф{Џїмс¶@ZШЅr+¤)ъY№Чъ†°0ЖіЬ0®mВ9r_‡{My»Ч°Bљђ+Ч°кF4ІGЮўлх’•м}ћЩЦяNg©†ЇяћЗл^№†Т„\№WQЇ
EЊ7f№ЌrФВ•‘ы:ЬkКЫ5ё†Т$яV®aХ-kdЧч{§o±Чз™m†Э+Ч°BљдЯК5ёЦчw:1Юе6Цё2r_‡{My»Ч°BљдяК5¬єKЌlaПKїxj>}gмuЇ\Г
i’я+Чаhk‹“юЌµ…эjъуp®a…4ЙЯ•kXuЗ5ІП«пчµПѕЯ§vЇ\Г
i’ї+Чаz^Ѕц‰1н1xкїцqeдѕџLfя‚kp+¤)ъЇ\ГЄ{сЩucЇЇ}цэю;•Ѕr+¤)ъЇ\ѓkЭvќУѓucЧ>®ЊЬЧб“Йм_p®a…4M^№†U·ј7ІУxыtMз=Ш8цyхэѕцЩчыпTцК5¬ђ¦Й+Чаhk§QУЃmaїљю<\ѓkX!MтoеVЭkУИ>/н1ъЪgЯпїS»W®a…4Йї•kp=i\ыДц<хзs1њW>ЇЇ}цэю;Х•iЏБt_Y*3фќ±Ч	<5џюЩ•‘ыb:хјПРЧyН`н+Wыm†®Б5¬ђ¦ЕІr«оЕ¦‘Ќ8ык,IЭ+Ч°BљЛК5ё"О•%)ЖіЬ I…+#чu€8—щAєЧ°BљЫ•kXu/ћЩ€іЇОђЅr+¤i±]№WД№2ЊQv6·+в\жc¬q.i]ч	€1r_|2ы\ѓkX!MСеVЭ‹зF6ўJc›»ѕЯe8qчК5¬ђ¦иїr®®х}DЌсЖ,·HRбКИ}о5еЧаVH“ь_№†U7Z#QҐ±Н}^}ї'К’4qчК5¬ђ&щїr®iDЌQv6·л^S^€±юMD•Ж6»2r_‡{ЌёЧ°Bљ«•kXuЛ«‘}пйлљA(Z:щоїзсєW®a…4-V+Ча*r…"Ж!і,Њ
Еџ‡+Уѓ5ѓPётYWFолpЇ‘ ЧаVHNZ№†Uгod'рФ|:KRчК5¬ђ&њґr®Y’xbј1ЛВАWveЪc0ѓ?ЃЗ•7f№@’
WЦї™А“юpeдѕч	p®a…4б¤•kXuЇХИNа©щt†Э+Ч°BљpТК5ёfАЈмlnWЦї™А“юpeдѕN=п»W.‡­Я•K+=ЋъпT‹пКҐlШъ]ЧЖ•Лk›џkp+¤	З]ГЉ¦xV®aХ¦Eop|ЫИNЕ>Л®omѓ¦ЧЕ†bјS№ўkXСПК5¬ђ&W®Б5¬ђ&cеVЭАBСИцјф;Ѓ§жУW®цЫ{Xш‚чьNчК5¬ђ&cе\‡…©ЖxgЊЫH®¬ eЅ’+пЊq6¶+‡ШњуЯй»2Эзveдn“ь0M#(tе›?_;}W¦ывмКИ‰гЂi)У•‘«9`љFP\LУH9Ж;cЬЖмЪ¦xXяnS<©8[WЮг0¶+УѓйѕІ$№тО·1\LУИB¬лЯьпєтЖ,·ЃвКИ}сЙмGq0M#(1Юе6 I*\№ЇГУ4Іа\Г
iZ®\ГЄ@)ЩВћ—~'рФ|ъКХ~›a§<А6пщќо•kX!MЛ•kpMy¤bг›яЭГBW¦Лђ¤В•‘8>™э®ј3Жaмvеќ1n#№І‚–хJ®ј3ЖВШ®ЊЬXoЩ5ё†ТґV®aХД/Щ0ялЭ+Ч°BљУК5ёЪЪOfяB[ШПг№Ч°Bљ±r«n`MСИющк,хNЯbЇП3Ы»W®a…4-bе\яN?Mcј3Жm$WVРІ^Й•хoю|нф]yc–Ы€кКИ}сЙмGq®a…4-Ц+Ч°кўЌм9яџпОRпф-цъ<іН°{еVHУbЅr®уN?Mcј3Жm$WVРІ^Й•CfY?_;}WЮkS<іq3ґщэющЪй»vУBY›в)\ygЊ·±єю|^Пщпф]YБ™3C§=8ц}oуNЯ•КЪOбК;cјЌНРхзуъЮжќѕ+#чЕ"Я	<®Б5¬ђ&щїr«n JСИ®йј{ямюЧЅr+¤IюЇ\ѓлю?УпЊqЙ•[X. …+7ґDБWxфсЊDWЮk
c»тО·‘\№Ўe”В•щl
Wћ‘\ygЊВШ®2ЛВHаЩя»тО·q»rCЛr№pe>›В•wЖxЫ•‘ы:|2Щ_p®a…4-V+Ч°крЌм=ю;pяЧ©ШgЩхэо•kX!M‹ХК5ёосS1ЌсО·‘\№Ў%Љ+пЊ1Ы•7f9Ђ+‡МІ0Rqю<\)¶амЪј3ЖmЬ®¬3Ѓ'ЗхЙd!ЖИ}сЙм_p®a…4E?+Ч°кў+ЩхЌ—~§bџeWчєW®a…4E?+ЧаZm\*¦±b3ЃgяпК-Ѓ'®ј3ЖЩШ®ј3Жm$WVРr20Щ•‘З—¦‘І+oМre p­qi)ЗПжмКъ7xця®ЊЬЧб“Йю‚kp+¤i1­\ГЄШE#»ѕЯПµ{еVHУbZ№ЧїзTLcј3Жm$W¦ЛтХдКИ‰г“Йю‚++h№ ®ЊЬ|2ы\™.Л5@бКИЃqьspeЪc0ЌузкКИ}QФлјпъзcдв“ЩїаК;cњЌнК!6З®П®LчЕЩ•wЖёЌЩ•‘яњ§®¬sмъчмъз<ЌqCЛ(…+-<Ь®ј3ЖЩШ®ј1Лmа
WFолрП‘Ілџ#1Ц3·лџ#еEЖсП‘Ч6M(пЊq6¶+пЊqЙ•iЏAуТ®ј3ЖmЬ®Мgsvеќ1ЮЖveдѕk*¦eЧаVHSфіr«n`.Щ{ьwаюЇЗЫў-м^№†Тэ¬\ѓлx"УпЊqЙ•хoЋ·……®ЊЬЧб“Йю‚kp+¤Iю®\ГЄHE#ЫВъОп;‹ЧvЇ\Г
i’ї+ЧаjaMЕ4Ж!6ЗЫВBW¦ыbreдА8Z¦‘WУ4RЋсЖ,·QveдѕшdцЈРХВ4Ќ,Дxc–Ыx5№2Э“+#'®iaљFК®mВщkБЩ•X®L{ZXSq\yе‹…+Ї|qveЪcґiВ©¦вё¶	зґЗhfр§вё¶	зИI¬©–]ygЊЫ(\Yяf*О'ЮІ+Уѓь	<®5УrЊ‘ыўЁЧyЯ5ёrymуk]ѓkX!M‹iеVЭЂ(ЩжчыЮuЪЅr+¤i1­\ѓ«щH©Ж8Д¦щHй®L—% 
WЮг6’+#ЖС|ТґМpп:­-еУ’Г•хoЮ»N]);›Ы•хoљЏ”nбКИ}ЦTLЛ®ж“¦елЯ”Э»N]№ЇCуyІїа\Г
i’·•kXuЇhd›ЯoYЯuо^№†Т$o+Чаj>Rљ–c”ќНMWОцsБH®Њњ8љOљўёТВГнj>iЉcэ›ж#‹·мК;cЬFrе9Й•з$Wnh	$ peэ›ж#sеЌYnђ
WFолР|ћмЈёЧ°Bљдmе
	.BYTE	ESC,"U",HLBOLD,"N",ESC,"U",HL			
	.ASCII	")O"
	.BYTЕ	ESC,"c",ESC,"U",HL+80H
;
CLRLIN:	.BYTE	HOM,LF,ESC,"J"+80H
;
ALMMSG:	.BYTE	ESC,"@",0FH,0FH	;SET ALARM TO OFF
	.BYTE	HOM,ESC,"J",ESC,"d"+80H
;
USEDMS:	.BYTE	HOM,ESC,"J",ESC,"=",36H,36H,ESC,"c",ESC,"U",HLBOLD
	.ASCII	"THIS ALARM IN USE"
	.BYTE	ESC,"U",HL
	.ASCII	"   ("	
	.BYTE	ESC,"U",HLBOLD,"C",ESC,"U",HL
	.ASCII	")ANCEL OR PRESS "	
	.BYTE	ESC,"U",HLBOLD,"E","S","C",ESC,"U",HL
	.ASCIS " TO EXIT"
;
ENTMSG:	.BYTE	HOM,ESC,"J",ESC,"U",HLBOLD
	.ASCIS	'ENTER MESSAGE:'
;
RESCMS:	.BYTE	HOM,ESC,"U",2EH	;BOLDFACE UNDERLINE
	.ASCII	'RESCHEDULE?   '	
DSPTYP:	.ASCII	'IMM '
	.BYTЕ	BS,BS,BS,BS,BS,BS,ESC,"U",34+80H
;
IMM:	.ASCII	"IMM"
MSSG:	.ASCII	"MSG"
COMM:	.ASCII	"CMD"
;
CHGMES:	.BYTE	HOM,ESC,"U",HLBOLD
	.ASCII	'  NEW MESSAGE?    '
	.BYTE	BS,BS,BS,ESC,"U",34+80H
;
PRSKEY:	.BYTE	HOM,ESC,"U",HLBOLD				
	.ASCII	' PRESS ANY KEY.'
	.BYTE	ESC,"U",34,ESC,"=",37H,79+0A0H
;
COMMSG:	.BYTE	HOM,ESC,"J",ESC,"c"
	.ASCII	"ENTER ALARM TYPE:  ("	
	.BYTE	ESC,"U",HLBOLD,"M",ESC,"U",HL
	.ASCII	")ESSAGE  ("
	.BYTE	ESC,"U",HLBOLD,"C",ESC,"U",HL
	.ASCII	")OMMAND LINE  ("
	.BYTE	ESC,"U",HLBOLD,"I","M","M",ESC,"U",HL
	.ASCIS	")EDIATE COMMAND LINE "
;			
ENTCOM:	.BYTE	HOM,ESC,"J"
	.ASCIS	'ENTER COMMAND'
;
ALMSTM:	.BYTE	HOM,ESC,"J",ESC,"=",36H,68,ESC,"U",2EH
	.ASCII	'ALARMS SET:'
	.BYTE	ESC,"U",HLBOLD,SPC,SPC,ESC,"S",31H		
ALMST:	.ASCII	'            '	;FILLED IN BY ALMAVL
	.BYTE	ESC,"S",30H+80H
;
MAXTBL:	.BYTE	36H,33H,34H,32H	; MAX 1ST DIGIT - MIN,HRS,DAY,MON
LINUP:	.BYTE	ESC,"=",36H,76+0A0H
MESLIN:	.BYTE	ESC,"=",37H,20+0A0H
BIG:	.BYTE	ESC,"S","1"+80H
SML:	.BYTE	ESC,"S","0"+80H
POS:	.BYTE	ESC,"=",36H,26+0A0H
ALMBUF:	.BLKB	8	
ATTCLR:	.BYTE	ESC,"U",34+80H;
NUM:	.BYTE	ESC,"?",22+80H;
;
POSMSG:	.BYTE	HOM,ESC,"J"
POSMS2:	.BYTE	ESC,"S",31H,ESC,"d",ESC,"=",36H,20+0A0H
;
;
SPLIT:	.BYTE	HOM,ESC,"J"
SPLIT2:	.BYTE	ESC,"T",1,ESC,"=",36H,SPC+18,ESC,"U",HLBOLD
	.BYTE	"\","\",ESC,"=",37H,18+20H,"\","\",ESC,"T",0
	.BYTE	ESC,"U",34,ESC,"=",36H,20+0A0H
;
;|-----------------------------|
;|  VARIABLES FOR EXEC MODULE  |
;|-----------------------------|
;
SAVSPL:	.WORD	0	; FOR SAVING SPOOL COUNTER
;			; DURING A SCREEN DUMP
FCB:	.BYTE	1
NAME:	.ASCII	"VALET   VL1"
EXTENT:	.BYTE	0,0,0,0
AU1:	.BLKB	16
CURREC:	.BYTE	0,0,0,0
;
VALOP:	.BLKB	1	; READ/WRITE COMMAND FOR RWONE
VALCNT:	.BLKB	1	; # A.U.'S TO R/W FOR RWVAL
RECNT:	.BLKB	1	; RETRY COUNTER FOR RWONE
STKSTR:	.BLKW	1	; STACK POINTER STORAGE
	.PAGE
	.LIST
	.IFE	LSTALM,[
	.XLIST
]
;
;|--------------------------------------|
;|                                      |
;|                ALARMS                |
;|              VALET.ASM               |
;|                                      |
;|--------------------------------------|
;
;R. WINTER 9/23/82
;S.GRAY
;
	.LOC	BASE+800H
;			
;|----------------------|
;|	ALARM MSSGS.	|
;|----------------------|
;
CURPRN:	.BYTE	1	;CURRENTLY SELECTED PRINTER
;
STR	=	.
MESS1:	.ASCII	'                             '
	.BYTE	ESC,"=",37H,20+20H
	.ASCII	'                             '
	.BYTE	ESC,"S",30H+80H	;NORMAL SIZE CHARACTERS
;			
MESLEN	=	.-STR

MESS2:	.ASCII	'                             '
	.BYTE	ESC,"=",37H,20+20H
	.ASCII	'                             '
	.BYTE	ESC,"S",30H+80H	;NORMAL SIZE CHARACTERS
MESS3:	.ASCII	'                             '
	.BYTE	ESC,"=",37H,20+20H
	.ASCII	'                             '
	.BYTE	ESC,"S",30H+80H	;NORMAL SIZE CHARACTERS
MESS4:	.ASCII	'                             '
	.BYTE	ESC,"=",37H,20+20H
	.ASCII	'                             '
	.BYTE	ESC,"S",30H+80H	;NORMAL SIZE CHARACTERS
MESS5:	.ASCII	'                             '
	.BYTE	ESC,"=",37H,20+20H
	.ASCII	'                             '
	.BYTE	ESC,"S",30H+80H	;NORMAL SIZE CHARACTERS
MESS6:	.ASCII	'                             '
	.BYTE	ESC,"=",37H,20+20H
	.ASCII	'                             '	;29 CHARACTERS
	.BYTE	ESC,"S",30H+80H	;NORMAL SIZE CHARACTERS
;
;|------------------------------|
;|    LENGTHS OF ALARM MESSAGES |
;|------------------------------|
;
LEN1:	.BYTE	0	
LEN2:	.BYTE	0
LEN3:	.BYTE	0
LEN4:	.BYTE	0
LEN5:	.BYTE	0
LEN6:	.BYTE	0
;
;|------------------------------|
;|    DATES & TIMES OF ALARMS   |
;|------------------------------|
;
ALM1:	.BYTE	0FFH,0,0,0,0,0,0,0,0FFH
ALM2:	.BYTE	0FFH,0,0,0,0,0,0,0,0FFH
ALM3:	.BYTE	0FFH,0,0,0,0,0,0,0,0FFH
ALM4:	.BYTE	0FFH,0,0,0,0,0,0,0,0FFH
ALM5:	.BYTE	0FFH,0,0,0,0,0,0,0,0FFH
ALM6:	.BYTE	0FFH,0,0,0,0,0,0,0,0FFH
;		   | | | | | | | | ALARM YEAR
;		   | | | | | | | ALARM TYPE
;		   | | | | | | MINUTES
;		   | | | | | 10'S MINUTES
;		   | | | | HOURS
;		   | | | 10'S OF HOURS
;		   | | DAYS
;      		   | 10'S OF DAYS
;		   MONTHS (0FFH = ALARM NOT TAKEN)
;
;	CALCULATOR MEMORY STORAGE
;	88 PRE-CLEARED BYTES FOR
;	STORAGE OF 8 MEM. REGS.
;
MEM1:	.WORD	0,0,0,0,0,0,0,0,0,0,0
	.WORD	0,0,0,0,0,0,0,0,0,0,0
	.WORD	0,0,0,0,0,0,0,0,0,0,0
	.WORD	0,0,0,0,0,0,0,0,0,0,0
;
	.PAGE
;
;|--------------------------------------|
;|				     	|
;|    MVЭЂT4ІНп·¬Gќ»W®a…4ЙЫК5ёљЏ”¦1Юг6’+7ґD‘
†уоЊЅѕr­vЇі$Хч]9d–…a>2Wжіy»тОoc»тЖ,·Q
WуyІЏcдѕшdцЈёЧ°BљдmеVЭe hd›ЯпRЯuо^№†Т$o+Ч@єљЏ”¦(1Юг6’+ПI®<'№rCK …+лЯ4џ’+oМrеrбКИ}љП“}Ч@є†Т$o+Ч°к.—‹F¶щэ.хЁsчК5¬ђ&y[№Wу‘Т4~ЊwЖёЌдК-Q¤‚бј;cЇЇ\«ќЗл,Iх}W™eaOЙ•щlЮ®ј3ЖЫШ®bУ|¤tWжі№]90Ћж“¦Q]™цј®‘?]НзЙюBЊ‘ыв“Щї@WуIУЁ1Љtё]90Ћж“¦Q\™цД®‘ї+#чuh>Oц\Н'MЈД(ТбveдА8љЏИц»тЖ,·џБJ=Џњ¦-Щ1:џg#\Н'MсЕ№/^Xъeуы]_КPф•-ь®ж#Іэ1ЉtёйКИЃq4џ<uеЌYncЌ+#чuh>iЉПХ|т4Ж!і,Њ'іБ•Xхэ>пѓцвјZ])Тбve$Ћ’Г•‘ыў8€yL]ѓkpетЪжз\Г
iЉю+Ч°к./Ќму¶иtзЪgЯЭ+Ч°BљўяК5ёљЏ”¦kbј3ЖЩH®L{±¦”]щ¬+7ґ¤В•щXN&»rИlі0ЉSЛЂ+пЊс6¶+‡Мr6К®ЊЬЏШїм\Г
iВ	+Ч°к.ЈЌlуыЅ…8ЇЦ–тйtзЪ€cял^№†Т„V®БХ|¤4Ќгќ±ж6’+лЯј-¬®ј1Лm”г®OfZ%ЖИ}сЙмGq®a…4ЙЯ•kXu—гЌlД±яuєsніпо•kX!Mтwе\НGJУ(1±y[X]ygЊі±]ygЊЫH®L{"Ољ2Pvеі®OfZt!ЖИ}сЙм_pu®a…4-W®aХ]^S4І%;FЧл%+Щ'zq^­maя_я=ЏЧЅr+¤i№r®жч+1™eaT(ь®њн'`Ь®”ҐВмКQБ
ЕЗ•‘гhюЉWуЇP”cј3ЖЫH®ЊЬЧЎщW(P\ѓ«щW(bј3Жm$Wћ!\НїBЃЈ,fWЉtx»2rвшd¦E\E-Ї‰сЖ,·Q^Sё2r_‡OfZ…®Б5¬ђ&њ°r«оrФў‘m~ї·зХЪцПрхЯуxmZtEЧ°BљpВК5ёЦч+1Юе6^бК
ОLБ{~§aF4zgIЄп·…эч<ћ+#7џМґиC?™эmҐ†ПјїЕћ+УeY^гКИЃ‰OfZtЃЎџМю¶RгґЛс]yc–іётО“±]9d–…QЎшуpҐШ‚3Co!ъзћw}эs_ЩВЯ?чyжҐ«9я
EЊµ‚Љ-Ћ+oМr®¬іB‘аweдѕE-Їq®\[ї+—Vzх‹;‹пКҐlШъ]ЧЖ•Лk›џkp+¤	З•kXQШzЌ]к
О'ѓЯВWЙ•kX!M8®\ѓлy[мгђYЬ_мЪь~_ЩВяNнџыпyјкК!іFћZ±ї+УѓжчУ2фy[ґШя№2r`aNcКРsУ¶R§'я>o‹О§aю]ЯwеђYFћЪ№ф]ygЊЫH®Мgs3ґ•оo3ЬЈSa/WFN—ЛАРэ‹{№Њ ®ґррfи7кkУyчѓїЕ.u–сЮФu№Њ 1Z(cБР¦уо_ЩВяNямJe,zCСY’ъ:щz§±=АзКИ}n(мw®зmсп‡МІ0аюЯЮЎНпч•-ьпФю№яћЗ«®2Kaд©эцveЪcРь~S†>o‹юц~®ЊGУ2tГњЖґ­ФiГЙїПЫўуiЧч]9d–…QњZ\ѓл†ВюпЊq·+7ґ$”В•wЖxЫ•з}Ча
sУegs»ІюН4¦Т0»тЖ,·1Y~“]yЮw®жчУЖxЃµ pеЌYО
Cџ·EГТ<ЏЧ(ќҐNw®®L{±¦”йКtYЇ`h+х"бґЃWё2r`—ЛАРэ‹{№Њ ®ј1ЛЩ€ПРoФЧзmС°4ПгuьОR§;WW¦=ЏXSК®L—е†¶R/N{ЌлrbјтEСнКгИРз}р@ЈУИiЪ0я®п»ІюН4¦Т03t}їУJc›]ѓ+‡ШМS+3CѓххuтхNя=ЏзК|6·+пЊ1›ЎлЖ^з©•†Щ•‘Зе2RvҐ,fЧає\FК1Юеl”Чеr 1^`-8»2н1xћHcкК+_њ]yв\)"0ЋЛе \yЮw®з‰4¦1™Ґ0ЉSЛЂ+E’±p].Ј…2®ј3ЖmЬ®Мgs3ґ•z7z®<qdиюЕѓЌx“Пk‘бsҐ…2эF}m~ї·зХкК;cњЌ›Ў]yЃµ `иє±ЧВ•"n†¶RпЖi—]90ЋЛe`июЕѓ}Юќо\ымЫ5ё2н1xЦа+G‰ПРoФЧзmСТЙw§‘УФ•‘ы:\.#eЧає\FЂУѓG¬)e†>o‹–Nѕ;Э№цЩ·лr)Зxе‹В•йІ¤‚Ў­Ф‹„У¤В•‘гё\Fєс`зеґПЫВ•щln†~Јѕ~здгКуѕkp].#1жc9мКъ·ЊВ•"Й(\№ЇГеr ®Б•Лk›џkp¬йд1z§o±Чз™m†^®Бµ¦3А+Ж;cњЌнК|6·+#'ЋCJг tе›?_;}WЮг0¶kMјК±N{ЊfєЇ,I®ј3ЖgWЮг6†+-<Ь®L—е°рUWFЊcMј\);›Ыµ¦^1ЮЈ0¶kMјPbјАZPётkБЩ•iЏБ;cГBW^щвмК+_®ј3ЖgWZx(\yc–ЫѕкКt_®ЊЗљxЕwеЌY
p­йЂWьEЖ±¦^(®ј3Жa<WFолpHiњІkp¬йд1z§o±Чз™m†-2єЧљО0Ж!6пmЮй»2џНнКИ‰гђТ8 ]k:–cј3ЖЩШ®bsО§пК;cЖveЪc0ЭW–$WЮг3†+пЊqГ•щlnWFЊcMGАWЮе6†…ЇєЦt\€Q¤ГнК;cЖv­й€гЦ‚В•XО®L{ЮєтКgW^щўpеќ1nCётОџ!\™ПжveдА8ЦtЊпКіЬЖ°рUЧљЋЂсcйp»тО…±])"0Ћ5Q\ygЊГx®Б5¬ђ¦ЕІr«о4Ю>=,|=єW®a…4-–•kpR€1н1о+KeТuHiњrЊ7fYЂ+пЊqГ•щX	(\ygЊГШ®2KaФ+№rИ,g#Jtk·°&jјUФ«дК¬gWfр_®ј1ЛdQЇ’лђТ(ЗБQёRD`‡”FЩ•ь…+Ї|qve}џkЊбКю‹Г•7f™!кUrR1fр_|®З!Ґ±аКю‹П•з}ЧаЖЫ§‡…ЇGK'Я}еjїН°‹ю№ќҐ>Ча:¤4ОBЊwЖёЌбК|,Ѓ®ј3ЖalW™Ґ0к•\ygЊіQётЖ,·ЃpR(1Юe2ЄЁWЙ•йѕ8»тД№2ѓяв`HгнУыяcgр?WЮe2„ЁWЙ•ь…+oМ2UФ«дКъ>ЧГ•ьCoџNЕ>;эw\yc–Йў^%Wfр_|®<ЇrЌ1\iббмСЗИ})Чаxgмх°рµиџ{Xшъ№Ч;cГВпЊq‚ЎѕЯаеК|,Ѓ®ј3FalWЮг6ћ+у±PётОџ±]yc–і%:W^`-XётkБЩ•iЏБ;c–оЊЅЮя;ѓяUW^щвмК+_,\YЯзC0Ь{ќЉ}vъпTWЦч№Жx®wЖ,Зxc–ЙЁў^%Wfр_®2ЛВхљAЙ•X®јАZpvеЌY&C€z•\iЎ=®ґРєтКgWZx8»тКWfр_|®ј1ЛdQЇ’+3шнqеyЯ5ё†Т„W®aХ}gмuOН§nшdїяћЫґиК5¬ђ&њёrЅ3цчг›cЧїgW¦ыbбКИН'іБ•‘З?‹]yЃµ`бК;cњЌВ•wЖёЌВ•ZFБWё2н1hюOЪ"ЮWЮг6fWnhҐpеќ1ОЖveє,Јё2rвxgмП(®ЬВђр®Lчvеќ1
c»тО·q»¶	ggЧ;c.ЗxF:Ь®З;c.»¶	з;cњбzgмП1Оц7ЈЫ•‘гшgы]yF:Ь®З;c^pЅ3цg”oМrС№2Эџ+#'ЋОШqҐ…‡П•КXётО·q»тЖ,gџ+#чuxgмП®¶?Ж;cЬЖмК-,)JбКtoWЮгllWЮг6ћ+7ЬЬ®<{ётмбКі‡+уЩњ]yе‹…+пЊ±0¶+#чЕЦ_ёю9c'Ж+_,\я,2Њuдѕшdц/ёWуТ±® eЅ’+л‡Ы•хЊГнКzЖбvеќ1>c»тЖ,…ёrИ,гп№єRlAбКуѕkp<ЇѕЯЧ>ы~яќк\OэЧ>1™ea$р¤вётЖ,o#>PёRv6·+oМr6в».—€СBWЮгmlWЉЊгr9 WЮе6†…Ї"Л®¬sО§пКъ7пmЮй»тЖ,·сjreэ›гmaЎkp<ЇѕЯщtoџю{®®БхФїзгЌYn#ѕTёІюН±лЯі+oМreWFолPдїзк\У8®1КОжveэ›cЧїgЧа*тЯsЌqИ,гп№єтЖ,gЈёЉьзH9Ж;cјЌнJe,\)"0Ћ"я9RvеyЯ5ёЦЌЅ®йјыЪgЯпїS]ѓkЭШµOЊCfY	<©8®2Kaьw_ыё2r_‡Ч>ж]ѓkаyхзує¦умkџ}їяNu®§ю|®‡МІ0ю»Ї}\9d¶)ЊћTЧkуѓ1Щb—і±Pvецётјп\УxыtMз=Ш8цyхэѕцЩчыпTЧаљFMЖц<х_ыёRv6·+лЯf©єтЖ,·мЁ…+3шYEЅJ®ј1Лm_E–]™БO!кUrеђYаКИ}5У?#О5ё¦сцйџыAСYкќѕЕ^џg¶єЧ4~†"ЦiЏБ!Ґq\9Дf*ОЗ•wЖ8Ы•ClОщпф]YБ™і+O]ygЊі±]УЂўгќ1ncёrCЛІTёТВГнКtY_ueдА8¦Е‚+egs»¦ЕB¬ygЊГШ®јАZpveЪcpHiњІ+Ї|qvҐ€А8¦EЩ•з}Чаha}зw>-Юxяu*цYєWk*NЊXl†ъ~ѓWKщґ…хќпЪ¦	еђЩ6ЕSў^3(Е[ve-†аќ±щ™]yc–ЫX@)Ш&њѓ…2®¬уОBжКИ}ZXЕ®БUј‘ЉгЦ‚кы^-еУвЌчџk›&”CfYў^і4в-»ІCрОШьМ®НіЬЖВ\°M8‘d,\Yяжќ…М5ёZXЕ1КОжveЪcPІc–$2ґ…хќЯщґxгэзК+_,\yЃµ`бК;cЬЖpe>–@
WЮг0¶+/°,\™цґрєтКWЮг6†+пЊс…+3шYEЅJ®Еј36?і+‡ШLаЩя»r¶џсЌнКИ‰Ј…вЌІлќ…,F‘d,Ш&њГќ…•мћЗл”ЕsµPјQЋхЦ‚…+УѓьГBWЮе6ЂВ•iЏAЙЋY’\yе‹В•WѕXётkAбК;cЬЖpe>–А
WЮг0¶+/°,\™цґрєтКWЮг6†+пЊс…+Ї|±peдѕБ?,t®’і$ЕzИ,CФk–ѓdЗи”¤waСн‰]yc–іЃ/ѕ«4f©гќ1ЮЖvҐ…2®GiМRЩ•з}Чаjб5,Њ1ѓџUФ«D/рчµПп,х°рµ+пЊq~оkџЯYк”¤w\)ТбvеЌYОF”и\yc–Йў^%W™ea€zН дjб5`9F­+У}qveдА8ZxXvеyЯ5ёfрcј1ЛЩАђ!ѓя_ыьОRП $ЅгК;cЬЖ#ГП}ну;K=,|®ј1ЛdQЇ’kяЂе3ш­+У}qveдА8fрXvеyЯ5ёr9lэ®\ZйqФo>’±ш®\К†­Яum\№ј¶щ№Ч@ЙЋС)Яч†В5ёљЏTя!:—®’#Ж!6Н§ДPЯoрjу)жS*»тОgc»r€Mу)•6m>2Г|dе¶°Џ5їупёІ‚3gW¦ДЉёJ®”ќННчNоґП)№rCР|d®в	љЏ¬мJQзDбК”X—М•ClКо]§©xiЪч®УкК;cњЌН еУsюEЈ7аК!і,Њ{Ч©+пЊq·+уЩњ]ygЊЫ]YяfТ0»2r`%;FЩ•7f№`/n
WЦї™ПЧyЧ>Їо4Ю>=Џњ¦tеЌYnђ¤‚бЮУЧAIN CONTROL MODULE FOR ALARMS 	|
;|					|
;|--------------------------------------|
;	
ALARM:	CALL	GETDAT
	LHLD	TIMFLG
	MVI	M,0	; SET FLAG TO DISPLAY TIME
	CALL	REDNUM	; GET ALARM # FROM CMOS
	CALL	CHKCOM	; GET ALARM TYPE
	LHLD	VALCMD+1
	MOV	A,M
	CPI	"!"	;   IF AN ALARM IS PAST DUE
	MVI	M,0	
	JZ	GOTALM	;    THEN SERVICE IT
;
ALARM1:	LHLD	TIMFLG	; DO UNTIL VALID SELECTION
	MVI	M,0	;   SET FLAG TO DISPLAY TIME
	CALL	REDNUM
	CALL	CHKCOM
	LXI	H,USD1
	CALL	FINDAV	;   ELSE FIND SET ALARMS
;
	LXI	H,SETMSG;   PUT UP MENU
	CALL	VALMSG
	LXI	H,SETLEN
	SHLD	LENTBL
	LXI	H,SETADR
	SHLD	ADRTBL
	MVI	L,0	;SET ALARM
AM1:	MVI	E,6H	;REVERSE BOLDFACE
	PUSH	H
	CALL	FIELD
	CALL	CONIN	; AND GET NEW COMMAND
	POP	H
	CPI	ESC
	JZ	RETRN3
	CPI	CR
	JZ	GTT
	MVI	E,0CH	;BOLD HILITE
	PUSH	H
	PUSH	PSW
	CALL	FIELD
	POP	PSW
	POP	H
	CPI	8
	JZ	BAA
	CPI	12
	JZ	FDD
	ANI	0DFH
	CPI	"S"	;   IF = "S"
	JZ	ALMSET	;    THEN SET NEW ALARM
	CPI	"R"	;   ELSE IF = "R"
	JZ	MESRED	;    THEN REVIEW SET ALARM
	CPI	"C"	;   ELSE IF = "C"
	JZ	CANCEL	;    THEN CANCEL  SET ALARM
	PUSH	H
	CALL	INVALD	;   ELSE RESPONSE IS INVALID
	POP	H
	JMPR	AM1	; END DO
;
BAA:	MVI	D,3	
	CALL	BKK
	JMP	AM1
;
FDD:	MVI	D,3
	CALL	FWD
	JMP	AM1
;
GTT:	MOV	A,L
	ORA	A
	JZ	ALMSET
	DCR	A
	JZ	MESRED
	DCR	A
	JZ	CANCEL
;
RETRN3:	CALL	FNDNXT
	MVI	C,ESC
	CALL	VALDSP
	MVI	C,"c"
	CALL	VALDSP
	CALL	WRTVAL
	JZ	RETRN2
	LHLD	TIMFLG
	MVI	M,0FFH
	JMP	RETRN
;
	.XLIST
	.IFN	LSTPRM,[
	.LIST
]
	.PAGE
;
;|--------------------------------------|
;|  SERVICE ALARM THAT HAS GONE OFF	|
;|--------------------------------------|
;
GOTALM:	CALL	GETDAT
	LHLД	±	
	LXI	D,1603H
	ANA	A
	DSBC	D
	SHLD	CCPLOC	;   ADDRESS OF CCP ENTRY
	LXI	D,7	
	DAD	D
	SHLD	COMLEN	;   ADDRESS OF BUFFER LENGTH IN CCP
	INX	H
	SHLD	COMBUF	;   ADDRESS OF BUFFER IN CCP
	LXI	D,169EH
	DAD	D
	SHLD	ALMWAT+1
;
	CALL	REDNUM	; GET ALARM NUMBER FROM CMOS
	CALL	CHKCOM	; CHECK ALARM TYPE
	LXI	H,ALMMSG
	CALL	VALMSG	;KILL ALARM IN CMOS RAM
;
ALMWAT:	LXI	H,WATADR
	MOV	A,M
	MVI	M,0
	ORA	A
	JRNZ	..J1
	LDA	ALMTYP	;CHECK FOR COMMAND LINE
	CPI	2	; IF IMMEDIATE TYPE
	JRZ	WBOOT1	;  THEN DO COMMAND LINE 
;
..J1:	CALL	SHWALM
	LHLD	TIMFLG
	MVI	M,0
NKEY:	CALL	CONIN	; GET RESPONSE 
	ANI	0DFH	; MAKE UPPER CASE
 	CPI	ESC	; IF RESPONSE = "ESC"
	JZ	RETRN3	;  THEN EXIT MODULE
	CPI	"Y"	; ELSE IF = "Y" 
	JZ	DOAGN	;  THEN INPUT NEW MSSG.
	CPI	CR	; ELSE IF = CR 
	JRZ	..J1	;  THEN ..J1
	CPI	"N"	; ELSE IF = "N"
	JRZ	..J1	;  THEN ..J1
	CALL	INVALD	; ELSE RESPONSE WAS INVALID
	JMPR	NKEY	; GET RESPONSE AGAIN
;
..J1:	LDA	ALMTYP
	ORA	A	; IF TYPE = 0
	JZ	CANC3	;  THEN CANCEL ALARM
;			; ELSE DROP THROUGH TO EXECUTE COMMAND
;	
;|----------------------------------------------|
;| DO ALARM W/COMMAND LINE (RELOAD CCP, RESTORE	|
;|    CP/M ENVIRONMENT, FILL COMMAND BUFFER AND |
;|    PASS CONTROL TO CCP)			|
;|----------------------------------------------|
;
WBOOT1:	MVI	C,CR
	CALL	VALDSP
	CALL	FINDAL
	MVI	M,0FFH
	CALL	FNDLEN	; GET ITS LENGTH
	MOV	A,M
	ORA	A
	JZ	ALARM1
	STA	LENCOM	; STORE LENGTH
	CALL	WRTVAL
WBOOT:	CALL	0	; RELOAD CCP+BDOS (ADDR. FILLED IN AT INIT)
	ORA	A	; IF A <> 0
	JNZ	RETRNB	;  THEN LOAD WAS UNSUCCESSFUL
GOCPM:	CALL	0	; ELSE INITIALZE CP/M ENVIRONMENT
	CALL	FINMSG	; GET MSSG.
	LDED	COMBUF	; GET ADDRESS OF CCP COMMAND BUFFER
	LDA	LENCOM	; GET LENGTH OF MSSG.
	ORA	A	; IF MSSG. LENGTH = 0
	JRZ	..GO1	;  THEN DON'T PUT IN COMMAND BUFFER
	CPI	30	; ELSE PUT MSSG. INTO CCP COMMAND BUFFER
	JRC	..L3
	LXI	B,29
	LDIR
	INX	H
	INX	H
	INX	H
	INX	H
	SUI	29
	JRZ	..GO
..L3:	MOV	C,A
	MVI	B,0
	LDIR
..GO:	XCHG
	MVI	M,0	;TERMINATE COMMAND LINE
	LDA	LENCOM
	LHLD	COMLEN
	MOV	M,A	;AND EXECUTE
..GO1:	CALL	FNDNXT
	LXI	H,RETST
	CALL	VALMSG
	LHLD	1
	LXI	D,25FDH	; CALCULATE CP/M STACK ADDRESS
	DAD	D
	SPHL		; LOAD STACK POINTER
	XRA	A
	STA	4	; CLEAR CDISK
	LHLD	BNKFLG
	MOV	A,M
	ORA	A
	JRZ	NBNK
	LHLD	CCPLOC	; GET ADDRESS OF CCP
	PUSH	H	;SAVE ON STACK
	EI
	JMP	CLNVAL	;RESET BANKS & EXECUTE
			;(CLNVAL SETS C=0 FOR DRIVE A:)
;
NBNK:	CALL	CLNVAL	;NON-BANKED EXECUTION
	MVI	C,0	;C=0 FOR DRIVE A:
	LHLD	CCPLOC
	EI
	PCHL		;EXECUTE
;
	.PAGE
;
;|---------------------|
;|   SET A NEW ALARM   |
;|---------------------|
;
ALMSET:	CALL	AVAL
	LXI	H,ALMAVL
	CALL	VALMSG	;FIND OUT WHICH ALARM TO SET
	CALL	GETNUM
	CALL	FINDAL
	MOV	A,M
	CPI	0FFH
	JRZ	DOT	;ALARM OPEN
;
RESET:	PUSH	H	
	LXI	H,USEDMS
	CALL	VALMSG
	POP	H	;IF ALARM IS USED THEN
	CALL	CONIN	;ASK FOR CANCELLATION
	ANI	0DFH
	CPI	"C"
	JNZ	ALARM1	
	PUSH	H
	CALL	CANC1
	POP	H
	JNZ	ALARM1
DOT:	CALL	DAT
;
DAT14:	CALL	MAKMES	;MAKE A MESSAGE
	JMP	ALARM1
;
	.PAGE
;
;|-------------------|
;|  REVIEW AN ALARM  |
;|-------------------|
;
MESRED:	LXI	H,ALMST
	CALL	FINDAV	;FIND WHICH ALARMS ARE IN USE
	LXI	H,ALMSTM
	CALL	VALMSG
MESRD1:	CALL	GETNUM	;GET NUMBER OF ALARM TO READ
	CALL	FINDAL
	MOV	A,M
	CPI	0FFH
	JRNZ	..J0	;EXIT IF NOT IN USE
	CALL	INVALD
	LHLD	TIMFLG
	MVI	M,0FFH
	LXI	H,REPICK
	CALL	VALMSG
	JMPR	MESRD1
;
..J0:	CALL	CHKCOM	; Eч®УЪ“%irKщ4М€ЮPtКч5ЮэаoWЮгml†-эwZІ2Нэ„щUWЦї)»wќєJvЊrЊКXётОoc3Ь»NиJe,\iЎЊ…+пЊс66CП]§®”ќНнКъ7S)1ФїПпTJгхючNveЪcpX(кЕђvЗюЇ‡…П•Ј‚ж#Ј+Уѓ—•1\VЦ’…ўv#
›Љћнп_<WЦїyYЩь.+{Јmm]™ц”	q\YяfэGЖPя>їҐ|ZжК!6Н§Tf№сєоыµ”Џ+УѓГBQЇxQ\9Љ!h>І2CюЕ;}eї+Уѓ—•№тЖ,“HѓdeэуеК¬W¦=%+ѓvfђ¬¬п]§-еУ?_э„щ№тКW¦=eBWЦїYя‘•кЯз·”OЛ\Eѕл4Ж!6Н§ДPя>ї‡…Ї‹wћ+пЊq6¶+‡Ш4џRЩ•щln+µщ”КmkпЯcЧЯГВзКИ‰гЁXИр‹[д¶ї7=ЮЖћ++8sveд$>™эe‘бk+хµлoу)№2ЕQІІ9W¦=‡…ЏAдЮ=,|®"§<bL{¦<А2ЊњЇб·Јчќт oX{џЧ"ГзКґЗ ”э№ф$EГ'ы=—юseдА8Љњт +‡ШLҐД`~їбCфЅлФ•щlnWFNп:2¤RЇяЈ6XQШTt†П•Іі№]Yяf*%WЩ]§1Юе6 I*о,¬dџи{Ч©л]§ycэ›ч®УWЦї™АsЧ©+#чu(т]§®wќЉcґрpУ•хo¦Rrе›ч®SWFолр®У<u®І{Ч)С)»л4ЮІkp}2ыЛ1±yYЩl?вu±±Ч?чЅ§Ї+x^яЬжч]№Ўe|WFЊг“ЩП0vэ=,|mҐ†п‰'–®bуІІщ/ёrCЛш®Њњ8>™э®БuФ?,Њ1н18,|VjДл}^пЯїx=vэ=,|нКґЗ desю®ЈюЛ1¦=SаЇEnы{CСOfї+УѓPцзТweдА8Ћъ,3H{Њ¶рз~2ы]ѓkp}2ыcb3i¬Ф€Ч€w^§сц±РмК|6·+Њ#Гоyд4mДkшћpeэ›ч®SWЦї)»wќ2ьЬзХџПл‡ЅSъ……fWЮе6ЂyЎ`ИgSёІюН|¶peэ›iHГмКуѕkppXгќ1ЮЖvе•/^бКИ}Ћъ‡…®Б5ё¦<АЖ8ДfТ03X©Їчy®Мgs3¤сц±РЬ»з‘УФ•ClЮ»N\90ЋiЬ°мКto2ьвБNщѕЖ»ьэ‹Чч®УЮPё¦qГrЊwЖ(ЊнКіL†х*1l(Ъю¶°ю·Eg©у±РЬц»ТВ‹Ы5џ-bМgS0ЬYXЙ>С?ч†»EKщtoWfр_Ь®<п»Чaб‹q€НъЏЊБJэ‹ЧуИiЪ¶цxµц/6tеќ1&cУ•ClЦde†ш}YЩµVјnWVpfreє,г3 ^ГчDяЬ’•х/^k.~?a~®L‰’•уwе›жS*3HЉ®ў^Ґ–тiш=,|®L{EЅвEqe?«ЁWЙUІІ!э‡Шј¬l¶џAІІюЕлс¤ЯOџ+7ґP
WVР…бпйлЛКЮЁќ%©съ	у«®Њњ8JІ!эWВg&ГeeіээЯµБЪEFфЅa©]ygЊі±]9d–…qп:]`ё¬мЌЪ?чЯУЧY’\ygЊЫё]yc–В€Ґ ]%Щђ~9Ж7…+ПI‡В•"г(Й†фЛ®ј3ЖЫШ®’lH!Ж!6л?І2в5|OtэGVn{vеќ1ОЖfђтй”‡+Пы®Б5ё^VcЪc°ѕ?ЫПPЯпЩююoЊЪ`mDaSС®<'n†Щю¶°wC;Пг№тњtё]yN:ЬwЖ^K'Я=Ы_Е€o¬qе†–@”‚бзЊІ±аКъ7/+›нwеyЯ5ёW(ыsйЗ8ДfэGVf°R#^GАъ[ІРЦв‰FШ_ґ+У}qfшЕkЙћъ{.эзКИЃq„І№фЛ®2ЛВHа№л”сълoJVжК;cLЖM†_јOъэ„щ№R$†ыЮuкК;cЬЖM†ыЮuЪяЌQ¬mҐюЕлџ/Wnё™ИЂШµ%+{ўуiї+E’±`ёwќ.Р•wЖx›ч®У…¶µсZІІ'ъЮuкКіЬ Iо=}}Я»N{І$MvҐ…2®ј3ЖЫШчЅлФКжТ/ЗhббМpeяЬрЙ~ПҐя\9ДfэGFW¦ывМђт}нуъз»юћKя№2rв(YЩ1+х[Ыа-YYk.~?a~®<0‘БJ=^­-rЫпК!і,у)•ЮЁЇЕKзЭю6џR№?В¦зК;cЬЖнК|67ГПm~їnшdїGFјУsй?Wћ82€Ь0я6зћЯИ€Ћ{'»R¤ГН 2цGдѕкКHєR¤ГнК;cјЌнJЩЩЬхэЋ{'·4¶№оъчщЅ>Dџ+Пы®Б5ёJVvМ?Ж!6/+›яГeeу_h[[К§съXsсы	уsе†– Љ+#'Ћ’мяѓ•:оќЬїx°anЙК,47|O<бК¬g†є±Ч2WЮгllWЮҐ0Ђч
†ї§Їі$хдЛКжї0№gы«+‡МІ0о]§Y’ъXsсы	уsеќ1nгv•dЗьЛ1nё)\yF:®ёxGIvМїмК;cјЌНP7цЪВѕwќ.ётКgуы-s•dЗьbґрp»тјп\ѓ«desю1Юe2 	(жьѕы	уsе›—•НЃa¶ї:K}YЩlя7Fueє7АЪ€В¦ўЎќзссzџЧєJVнг†–с$+ѓvn[¬Oф\jЙК~ѕzЏљ]y`ОыаЃmҐ†№%+іРЬр=с„+‡МІ0о]§®ј3Жm$†EЯ»NaСРщ4 №rГН›бзю{ъ:KRя|u>=зяуЭГВзК;cјЌMWZ(cбК;cјЌДpЃї©уi	hыѕwќєтјO†џыјыЭу;®БХ|¤С№DљЏTяq®ГBQЇ‡Ш4џ’+·°,Geђ,ќБЯ€В¦ўЎќзс\™оMєrИ,гІІЩ~WћW№Жё]9ЫOАШ®ЊЗEЅК®¬пsЌq»(кUЋ±ћqё]yc–іЃ,3l(QШTф°р№(кµЈ…‡і+·°D®qeд$(кµаК-,ЧётњдКs’+ПI®ј3ЖdlW±9,МRuеЦ‚WE0ФЌЅf©єrБЩ•йІѕкКИIPФЕ•[X"‡…Їє(к…c>›Й•Wѕ83XШsKщф“эwаЦзКуѕkp•	qbј3ЖmY§њЏ°pяЧцвcm\№Ў% ҐВ•щl®<'№тњдКуѕkp­пПцЗxgЊЫ’…ў3шQШTфlїk›&М3’+ПHd°°сЪyП•g$WnhYЖWётОgc»r€НЛКfы]№Ў%рў®МgsvҐмX–с®<п»Ча\Г5тп+[ш»^/YЙ>Сs©НGfOЙ5ё^ЧИ?Ж!6НGљнЏ·мКъ7/+›нweЪcpX(кЕ`!цОп’+3шYEЅJ®Е4™+УѓхэЩ~уы-seэ›ж#НцЗ[veЪcP&ДaЁп·¬·зХкК;cњЌнКіL†х*№ТВ‹ЫХ|¤ЩюлыЊНpga%ыDПцw}Я•ь·+Пы®Б5ё¦ы*b¬У|о,ћ+пЊqГ•йЮ®ј3ЖalWЮг6
W¦{»тОc»ТBWћч]ѓ+ѓkE\ІG1НGЖрd©ШРьЪ|dЌc›Џ¬мК!ћ щИК®¬Е4YЩ•U<Aу‘№тјп\+в*Е8Љ!h>%†'KЕ†жЧжSjЫ|JeWЋ9	љO©мКZAу)•]Yз$h>%Wћч]ѓ«8€yLcЕ4™+/°,\Y‹!h>ІІ+УѓШ5тwе(† щИК®јАZ°pe-† щИК®L{bЧИЯ•WѕXёІCР|d®¬Е4YЩ•iЏБлщ»r€Mу)•\Yя¦щ”иКґЗ vЌь]yе‹…+k1НGж\Г5тoмҐџOK'Я-+ҐrяЬ2Јд\CЪ#ЃcяЧвЌї[жЉ]#яУѓqЙ\yЃµ`бJЩЩЬiј}:нsJЌcoWЦїi>wЏБBын6оµxгп®Ц«+Eќ…+#&bЧИїмJ7C±ЎЇ‘2W¦=У})ЯЧxчѓїWмщ—c”ҐВL†с6цZјсwЛЪВ®ЎУ	ыїoьЭ%W¦=+в*№тkБВ•Іі№ТxыtЪз”\9Д¦щЬY<Џ>Љ:'О®Њ€]#яWЦчY66C±ЎЇ‘%W¦=У}®Ў‹Си-Юш»K®ЎSѕЇ}^‹7юnYo(Zјсw—\±kдїгЦ‚…+egs3¤сцйґП)№r€Mу№іx®uN®јтЕВ•‘“€]#WКRa&C}їБ«Ґ|Zјсw—§и-Юш»e®Ш5тG‰сОgC0ФчјZК§Е·¬qЪвЌї»дК;cLЖseOР,Ю®¬Е4‹7Є+‡МІ0МGжК!і†щ”\9‰Ш5тЏпJY*М®њн'`l†ЉШWПцЧ.7ЋётмгКу*ЛЖveдД»Fюс]YЯgЩШ®Ш5тЏc-† yєІCР<*])K…Щ•µ‚ж:иКZAs­tеl?ЛЖvеЦ‚WEётЖ,·QF),”uбКИ‰#vЌьЧётЖ,·Qћ‘d]ёbЧИMЊхoљ«eЁпчИРЬВЮV›a[О»ь®јтЕ«"\9ЫOАШ®ј1Лm, ®Њњ8bЧИ?Є+oМrsбС‡]#яЁ1ЦїiЦ5ф5тпќ>ёGc/э|\ygЊ…13ПЭ,Ют,ётО‡‘\YП8,\yц9®¬Е4џ©+vЌьЈДxgЊЫ]™ПfreдД»FюС№тkБЩХ<F9ЖQAу‘1ЬYXЙоyјNY<Wу°1Z(cБpga%»зс:eс\Y‹!h>2†;+Щ=ЏЧ)‹зКQAу™єr€'hoTWжі№])књ(\90»Fюш\9Д4‹7†+Е®в	љO‰бОВJvПгuКв№ТBГќ…•мћЗл”ЕseOР|JwVІ{ЇSП»Fюшb¬Е4џ©+УѓЧ5тwе•/О®IЖЩ•‘ы:Д®‘WмщGг•/зХџПkу‘5Ћm>%WЦbљOЙ•WѕXёІCР|d®<п»WуD§yЊrјeWуЁD§yЊxг»љл :НcД»°ЖХ\-Сi#Ю…(®жZ‰Nусў ®Б5¤сцiуЩWaSЯпО§д\НGJгДxc–і1,|Х•7f)АХ|¤4К1^`-83 ‘#з«‡…Їц°рUWЮеl¬q5)Ќ…/°њђ¦	ЏњЇ^У5mШЧ¶§єтО·!\™БП*кUrеђYОF”иЦnaMФx…ЁWЙ•Іі№]НGJ%Жю‹›i’?#з«сќЉ}ъКuйJЃq4)¤Iю<(zд|№2ѓявvеќ1nCёrЛ pеќ1
c»тКgWЉЊЈщHi,0 M~PфИщrеќ1nCёТВГнК-ЛRбК;cЖvе•/О®Gу‘Т(3 ‘Љ9_®<п»W.‡­Я•K+=Ћъ±сЊЕwеR6lэ®kгКеµНПЈ/ё†Тґ€•kXµiс
Ыг}rеVHУ"V®БЫ#УG1Dуї»ю©k›p®ЕДцёаwmОWѕxU„k›pѕтЕЩ•Wѕ(\yе‹…+‡МІ^¶GэSW^`-XётkAбК¬gW^`-xU„+‡МІ0 xKГмК;cЬЖнКіјА•хoBр®sеђYўJc›]ygЊЫё]yc–·ёІюMD­{®2ЛВАцxр»тkБВ•з}л\УЂШ1
лJЩЩЬ Eя7FнюyLыз>oW¦=3шз1uеђY¶GР•ClЋє±зКЩ~–ЌнКИЃqLbЈмJe,\iЎЊ…kеУѓШw5»Rv6·+лЯДцЁяreэ›ШЯЮ®¬іѕ/і+лЯ„yъJ®Lчveэ›ЯЮТ0»r€MЮuc®¬‚·4М®bQлЖћ+лЯDTilіkp=хпqЗ8d–… \Oэ{”c”ќНнzкЯc!Жъ7чёь®¬ЕЬг–†Щ•з}ЧаЉнсd?ЖґЗ`ЫГ•ВєrИl›в©—ЃнQя‰Џ®јтЕ«"\yе‹і+Ї|QётКWЋz	b{\р»тYWћч]ѓ+¶Зѓ?ЖіЬ I…+лЯ¬пKГмКg]™цМаџЗ”ђ¤ўяЈvя<¦эsЧЌ=W±9кЯя№ІюНQ7ц\9d–…ЃнqнгКґЗ ¶З]Н®ШзГoМrЂ$®¬ЫгЫЫ•CfY J”В•iЏБ+ЧW™еl¬Ђ‚®Ш9_1¦=…­Ч(№RD`±1rѕ\™цњПхb¶^c—:ЃзLSE DISPLAY CURRENT MESSAGE
	LHLD	TIMFLG
	MVI	M,0FFH
	CALL	SHWALM
	CALL	DSPTM1
	MVI	C,RVLF
	CALL	VALDSP
..J1:	CALL	CONIN	;WAIT FOR ANY KEY TO EXIT
	ANI	0DFH
	CPI	ESC
	JZ	ALARM1
	CPI	"Y"
	JZ	DOAGN
	CPI	CR
	JRZ	..J2
	CPI	"N"
	JRZ	..J2
	CALL	INVALD
	JMPR	..J1
;
..J2:	LXI	H,CHGMES
	CALL	VALMSG
..J3:	CALL	CONIN
	ANI	0DFH
	CPI	"Y"
	JRZ	..J4
	CPI	"N"
	JZ	ALARM1
	CPI	ESC
	JZ	ALARM1
	CPI	CR
	JZ	ALARM1
	CALL	INVALD
	JMPR	..J3
;
..J4:	CALL	MAKMES
	JMP	ALARM1
;
	.PAGE
;
;|----------------------|
;|   CANCEL AN ALARM	|
;|----------------------|
;
SPPC:	LXI	B,1920H	
..L2:	CALL	VALDSP
	DJNZ	..L2
	RET
;
CANCEL:	LXI	H,POS
	CALL	VALMSG
	CALL	SPPC
	LXI	H,POS
	CALL	VALMSG
	MVI	C,LF
	CALL	VALDSP
	CALL	SPPC
	CALL	GETNUM	;ASK WHICH ALARM TO CANCEL
	CALL	FINDAL
	MOV	A,M
	CPI	0FFH
	JRNZ	..L1	;IF NOT IN USE THEN 
	LHLD	TIMFLG
	MVI	M,0FFH
	CALL	INVALD	;ASK AGAIN
	LXI	H,REPICK
	CALL	VALMSG
	JMPR	CANCEL
..L1:	LDA	ALMNUM
	ORI	30H
	MOV	C,A
	CALL	VALDSP
	LXI	H,POS	; POSITION CURSOR
	CALL	VALMSG
	LXI	H,CANY1 ; CANCEL? Y/N W/O CUR. POS.
	CALL	CANC5	
	JNZ	ALARM1
CANC3:	CALL	FINDAL
	PUSH	H	;FALL	IN
	POP	X
	MVI	0(X),0FFH
	MVI	8(X),0FFH
	MVI	C,ESC
	CALL	VALDSP
	MVI	C,"?"
	CALL	VALDSP
	MVI	C,16H	;CHECK ALARM NUMBER
	CALL	VALDSP	; IN CMOS RAM	
	CALL	CONIN
	ANI	0FH
	MOV	B,A
	LDA	ALMNUM
	ANI	0FH
	CMP	B
	JRNZ	..J1
	LXI	H,ALMMSG
	CALL	VALMSG
..J1:	JMP	ALARM1
;
CANC1:	LXI	H,CANYN	;CANCEL? Y/N
CANC5:	CALL	VALMSG
	CALL	CONIN
	ANI	0DFH
	CPI	"Y"
	RET
;
	.XLIST
	.IFN	LSTSND,[
	.LIST
]
	.PAGE
;
;|--------------------------|
;|	RESCHEDULE ALARM    |
;|--------------------------|
;
DOAGN:	LHLD	TIMFLG
	MVI 	M,0
	LXI	H,SPLIT
	CALL	VALMSG
	LXI	H,POSMS2
	CALL	VALMSG	;RESCHEDULE ALARM
	CALL	DOSMAL
	CALL	DSPTIM
	CALL	FINDAL
	CALL	CNVALM	;CONVERT MONTH FROM 1 BYTE INTO 2 BYTES
	MVI	B,12
KEY:	CALL	CONIN
	CPI	08
	JRZ	BAK1	;BACKSPACE
	CPI	SPC
	JRZ	SPACE	;AHEAD 1 SPACE
	CPI	0CH
	JRZ	SPACE
	CPI	ESC	;CR = DONE
	JZ	ENDIT
	CPI	30H	;ONLY OTHER LEGAL KEYS
	JRC	NGKEY
	CPI	3AH	;ARE 0-9
	JRC	NUM1
NGKEY:	CALL	INVALD	;NO GOOD KEY
	JMPR	KEY
;
BAK1:	DCR	B
	JRNZ	..L1	;DON'T BACKSPACE BEYOND END
	INR	B
	JMPR	NGKEY
..L1:	MVЙ	C,8
	CALL	VALDSP
	CALL	LOOK	;CHECK IF WE NEED TO SKIP
	DCX	H	;SPACES OR "/" OR ":"
	JRZ	..L2		
	JMPR	KEY
..L2:	MVI	C,8
	CALL	VALDSP
	DCR	B
	MOV	A,B
	CPI	5
	JRNZ	KEY
	MVI	C,8	;SKIP 2ND SPACE BETWEEN 
	CALL	VALDSP	;DATE & TIME
	JMPR	KEY
;
SPACE:	MOV	A,B
	CPI	12	;DON'T GO BEYOND END
	JRZ	NGKEY
	INR	B
	MVI	C,0CH
	CALL	VALDSP
	CALL	LOOK	;CHECK IF WE NEED TO JUMP
	INX	H	;OVER SPACE OR "/" OR ":"
	JRZ	..L1
	JMPR	KEY
..L1:	MVI	C,0CH
	CALL	VALDSP
	INR	B
	MOV	A,B
	CPI	7
	JRNZ	KEY
	MVI	A,0CH
	CALL	VALDSP
	JMPR	KEY
;
NUM1:	MOV	C,A
	MOV	A,B
	CPI	12	;DON'T GO TOO FAR
	JRZ	NGKEY
	MOV	E,M	;SAVE ORGINAL VALUE
	MOV	M,C	;INSERT & DISPLAY NEW VALUE
	CALL	VALDSP
	INR	B
	INX	H
	PUSH	D
	CALL	CHKMAX	;CHECK FOR LEGAL DAY,MONTH,HOUR,
	POP	D	;OR,MINUTES IF NECESSARY
	JRC	..L1
	MVI	C,8	;BAD VALUE
	CALL	VALDSP;************************************************
;*                                              *
;*           GRAPHIC PRINTING ROUTINE           *
;*        OKI 83A  AND 84 STEP 2 PRINTER        *
;************************************************
;
	.PABS
	.PHEX
	.XSYM
;
BASE	=	2000H
;
	.LOC	BASE+1800H
;
	JMP	DUMPS
;
HOM	=	1EH
HL	=	22H
HLBOLD	=	26H
SPC	=	20H
ESC	=	1BH
CR	=	0DH
LF	=	0AH
SPRTR	=	0F3H
DPRTR	=	0F2H
SDSPY	=	0EEH
DDSPY	=	0FEH
CONIN	=	BASE+9
CONOUT	=	BASE+6
VALDSP	=	BASE+6
DUMPMN	=	BASE+64H
LINOFS	=	BASE+6DH
LINDSP	=	BASE+21H
VALMSG	=	BASE+24H
RETVAL	=	BASE+0CH
BADKEY	=	BASE+37H
SOUND	=	BASE+1EH
GETDMP	=	BASE+6FH
CONST	=	BASE+7BH
;
	JMP	0
	JMP	0
;
DUMPMS:	.BYTE	HOM,ESC,"S","1",ESC,"U",HLBOLD
NAME:	.ASCII	"   OKI 83   "	
	.BYTE	ESC,"S","0",ESC,"c"+080H
;
SCRSTR:	.BYTE	5,ESC,"%","9",12,CR	;CR FOR OKI83
;					;LF FOR OKI84 STEP 2
DUMPS:	MVI	A,239
	STA	GRFY
	XRA	A
	STA	DUBFLG
	MOV	H,A
	LDA	LINOFS
	MOV	L,A
	SHLD	COL
;
DUMPS1:	LHLD	DUMPMN
	CALL	VALMSG
	LXI	H,DUMPMS
	CALL	VALMSG
	CALL	GETDMP
	CPI	LF
	JRNZ	NLF
	MOV	C,A
	CALL	LIST
	JMPR	DUMPS1
NLF:	CPI	ESC
	JZ	RETVAL
	ORA	A
	JZ	QIKTEX
	CPI	4
	JZ	RETVAL
	PUSH	PSW
	CALL	SETPRN
	POP	PSW
	DCR	A
	JZ	DUMPTX
	DCR	A
	JZ	DUMPGR
;
DUMPAL:	MVI	D,"7"
	CALL	ESCOUT	
	MVI	A,3AH	;CODE FOR LDA
	STA	GRFLIN	;RESTORE GRFLIN CODE
DUMPER:	MVI	B,8	
..L3:	PUSH	B
	CALL	GRFLIN
	CALL	TEX6H
	CALL	SCRL6	
	CALL	TEX4H
	CALL	INCOL
	CALL	GRFLIN
	CALL	TEX2L	
	CALL	SCRL6
	CALL	TEX6M	
	CALL	GRFLIN
	CALL	SCRL6	
	CALL	TEX2H	Љ	CALL	INCOL
	CALL	GRFLIN
	CALL	TEX4L
	CALL	SCRL6	
	CALL	TEX6L
	CALL	INCOL
	CALL	GRFLIN
	CALL	SCRL6
	POP	B
	DJNZ	..L3
	JMP	RETURN
;
ESCOUT:	MVI	C,ESC
	CALL	CONOUT
	MOV	C,D
	JMP	CONOUT
;
LIST:	PUSH	B
	CALL	CONST
	JRZ	..L1
	CALL	CONIN
	CPI	ESC
	POP	B
	JZ	RETURN
	PUSH	B
..L1:	POP	B
LST2:	MVI	A,10H
	OUT	SPRTR
	IN	SPRTR
	ANI	24H
	CPI	24H
	JRNZ	LST2
	MOV	A,C
	OUT	DPRTR
	RET
;
QIKLIN:	MVI	B,80
	LXI	H,DSPBUF
	JMP	L1
;
QIKTEX:	LXI	H,NULL
	SHLD	MOD<ш]™цДтхbёцЩчыпФveЪcpъJў^®L{¦|ѓ—+УѓьаеКґЗаь†Ё—+6°'+Зш,®\н·vOНЗ•Clb{¤[ё2]–“лЙmҐЖцH·h[{±nWFN±Ѓ-0tявБ6зџ;cпЊ]reЪcґiВ)CъЌъЪь~O_Й•щln†¶RЈwъgИуjreдДАРэ‹ыЙмпъ>јъОв№2]–С1фхµ•ЅwMЦцЯі+#'ЋШАєс`›уПќ±wЖ.№2]–(»`и7кk+5N{ЧdmGGWFLДVfиюЕѓЅ\beW¦Лr!є‚ЎЯЁЇ­Ф8н]“µґ+#&bCaиюЕѓЅ\b(®ШАЂ#чElЏ'ыэF}эdцw}	^}gс\±Ѓ•cЬРRБР©ШРьъзЇлќN»>W¦Л¶)ћЙ{2C[©©wMЦцд=Щ•‘“€`июЕѓэdцw}їБ«п,ћ+УeЫПдёЙс–ъЌъЪJЌУЮ5YЫ“г&»2r`"60ЂЎыц“ЩЯх}$xхќЕseэ›ШйэF}]>ЇS±ПNяWl`1Fо‹жч±=ЪњоЊЅ3vЙJЊґD
†®пч®ЙЪ†аэЋMэsќ%©ѕпК!і,l`OVvеЦ‚…kpeдА8bc>ц3 ЌмщЌС?›Нг№r€Нћщ†”пkјыБЯ	<у®LчveЪcqюьCЭШk;Э№цЩ·+#чЕщQ/aл5v©xОѓїлЯя№WlМЗюX‹tЪПf(7ІзcНЕoрrеђYЖ|юx+#ЖуђнК;cЬЖНђЉ—¦ќАsь=k.>|µє2]–e©`ђтй{Л\›'ЋVк{Лђжч{ъJ®ґрp3јQ_[ОЫхх|¬№шрХкКИ}bCдщУу0F‘N›вЩЌмщXsс[dteдА8bаEєтО·q3¤вҐi'рњПЗљ‹_­®Мgs3HщфmЎЅБЫ•'ЋVкЫB¤щэћѕ’k›pйp3јQ_‹—ОЫхх|¬№шрХкЉ‘згЦўM‹тЄW¦=зПз»тКЇЉpеЦ‚WEё2н18џїE„a‹XПЗљ‹_­эsГ‡hlр№тКЇЉpeдѕ8џ/кеЉlЂWЊ"ќ6ЕійК!і,,Џ‡WFЊ#6°! +пЊq7Гy[tПyр7–x?Ч6бњ.K@*о-“џ+OJЇ"Нпчф•\Ы„і…‡›бЌъЪВtЮ®П•‘ы:Д†ИШ`ШPф°~Wl`CАE:ЬсЩXаэZdteдА8b#Ќiuеќ1nгn†у¶ићуаo,р~®Мgs3ЬКП•'ЋҐW‘жч{ъJ®йp3јQ_‹—ОЫх№bCdlДxЃµаU®L{"ОЗтpе•/^бК¬EуЄЧ6бњцДтШ"В°E¬ї±<АыхПў±=АзК!і,ЊЫЉMW¦=kЎ`ИаїАЯ5ѓPётКWуЄWFо‹Xў^Љ¶^c—>Dc{ЂПiLkЊ"n†5ЌмTlh~ќ†MSWFЊ#6Rѕ]9ДжПр—.†у¶ићуап4lљєrC0;Э‚бКюю№У°iЪПг№rИ,gЈј†бКюю№б“эNГ¦©k›p[pvҐ…‡Ы•йІ\Г`Ґѕvээ и,хЯуx®НИЃqДFУ2ГyхэѕІ…яW™eaАь3|бз®џЯYкїзс\);›ЫiLЛ1^`-xU„k›pѕАZґiВ…+Уѓ€у†€cялћуап4lљцП®јтЕ‚!Э№цЩ·+k1У°У-\™ц¬„‚!ѓяпNГ¦©+Ї|сЄWFо‹УWхЉ%[Ї±Kў±=АзЉЌ”пE:Ь¤+#Жйђ®L{ћ'Rѕ]™.Л2аКзJ·+#чu€‘УнЉЌtЈH‡Ы•‘г€Ќлѓ—+Уѓз‰”oWжі№]yв\Ы4Ўйp»bCдtЗцDњџтнКґЗ`К7x№2r_Ь"’тн\±q}рЉQ¤ГнЪ&њ#ЖЧР•iЏБуДї+УeY\yв\iббveдѕ±!тх]±q}cL{ћ'.ш]™Пжvе‰sҐH‡Ы"_?ЖґЗ вь~W¦=/шБЛ•‘ыв‘~ЧаКеµНП5ёЉzэ»гђYЖЂҐpeЪcрК5ЃЗ•CfY0яъѕ+УѓШw5»2r_хъ·Њ®БUФлЫ;Ж¬W^`-(\yЃµамКQБTњ-CЧЌЅNа©щф•«э6CW™Ґ0Ђ pҐШ‚В•X®Б•iЏБу¶ш7Cџ·E{?W>лКtYN–Яd†¶Rџ·EїsтqeдДQФлЯe†о_<ШВЦkмRїsтq®2ЛВX Pў}еjїН°xj>®НґЗа•kЏkpеђYFqj`haл5v©‹ћкК;cЬЖнКtYN&3tЇлјZ{ј-,47аКИЃq\.# ]yc–ЫЁWr].#@ЊwЖЊнКґЗ °х%WЉ$cбК;cLЖнКґЗ °х%ЧаКі|ЖC[Ї±K}[X—ЌcЧ—кТu№@ЊCf9(k·°&jј“c“]—ЛQЋ1н1(lЅFЙ•"ЙXётО“q»RD`—ЛQvҐ…2®йр№2r`—ЛёW¦=ПЫb†>o‹ы?W>лКtYN–Яd†¶RїsтqeдДQФлЯe†о_<Шпњ|ъ~µnуs®ј1ЛdФ+№2н1(lЅFЙ•CfY·…µ„~Јѕ¶^c—Zмя\ygЊЫё]№Ў% Ў-?“є2]–“ЃЙ]Бл:ЇЦoНё2r`—ЛHЩ•7f№Ќz%є.—‘rЊwЖЊНРВЦkмR‹]reЪcPШzЌ’+E’±pеќ1&гveЪcPШzЌ’kpеђYОКЪ-¬‰пdy&».—%ЖґЗ °х%WЉ$cбК;cLЖнJЃq\.Љkpхъ·,Ж+_,\™цН+Ч†ћљOяЬ##ЮйcНЕп”|З•7f№@’
WЦїщн-3C}їҐ±НµҐ|є,*Р8vКРBWЦї‰нсннК+_њ]yе‹В•WѕXётјп\№ј¶щ№Ч-"ь1¦=Пь®ј1ЛgМ—+#чu8oPЎkpЭ"’тcЪcр<‘тнКі|ЖјA‘\ѓлјAa†1ћ‘ИђБЃї?"ч\ъЇєтО“±¤“пћ7(\yc–і0ь=ЏзК!і,ЊщпyёRlБ™!eшOЌИGф†ўїЅ_§лЯр7"бJa]ygЊЙx®ј3ЖmЬч®УОаoяІЬуІgы]№Ўe pe>–Q\™Бq»ТBWfр[Wћч]ѓл|ю‘7ґ,KC-¬ф{<мЌ¶рgWћ‘ИР)џуТп+Wыm†®<#‘ЎҐ|zмџ
Wћ‘иК;cЖfиє±Чр!z<мWКОжvеЌYn#Љ+Уѓcмџ
†NгнУЧyхБЯгaoё2џНнК;cЬ† +#чЕ1цOCзУ6|€{Г5ёљя|мЏсЖ,gШѓщэѕлЬЉuveЪcр€5e МђҐћЏ5ѕZ{<мW^`-xUѓtтЭйОµПѕ]yc–іМ…+УѓG¬)eW^щвмКИ}сЪiКpн4mо_ПҐя\ѓ+–З‘X™eaАь3|сЖ§+oМr6Ц0¤bCуk,р~=—:љ-4»by”cmZфkС¦	П(=—ю«maїќ
Ч6б|c–іЃВђҐ^У5ѓPTW,Џ…X›Ѕ3ЖЫШtҐ…2®G,ЏW™Ґ0 Уў©pҐШ‚ВµM8_щвмJЃqmљ0–GЩ•з}ЧаљБ?ЏiЊ7f9®2ЛВXXpеђY
CФk–†+уЩЬ®Њњ8.—Јм\—ЛДxЃµамК¬WЮe2Ђ®L{ж?,tе•/®јАZ°pеЌY&x@бКґЗ`юГBW^щbбК+_њ]iббpҐ€А8.—pеyџ®Бu№е/°њ]yЃµ`бКіLђЂВ•iЏA‡…®јтЕВ•X®ј1Лd (\™цґpXиК+_,\yе‹3]iббpҐ€А8.—ЈмКу>]ѓkюГВУѓйѕІ$№тО·1\™Пfre?«ЁWЙ•Cf9Qў[»…5Qгў^%WКRavҐ…цёТBлJY*М®<п»W‡…1¦=У}eIrеќ1ncё2џНдК~VQЇ’+‡Мr6рk·°&jјBФ«дJY*М®Ма·З•ІT]yЮw®Шw5З№/ЮЇVіkpќЯхЉq€Нћщ†ъ~ЈоћљO_№Ъo3tе†–eW™eaDЌ%JБ ^_ЩВ_ызћЯэч<ћ+‡МRу®ЊЬЧбјAQv®УWхЉх›?Г_є\9d–…?*J”‚AјѕІ…їцПќ†MУю{6-:ћ+‡МRSxяyё2r_‡уEЩ5ё¦|ѓWЊiЏБуDК7C›Яп”п{ЩуEџэџk›еђЩ6M…±¦ЊҐ`ЇЇlбЇэsПэч<ћ+#чu8oP t®ьаcЪcр<qБПРжчы:юwzЮ иіяsm“ьбђYFT %JБ ^_ЩВ_ызћ7(ъпy<Чyѓ€qИ»Жп?Чyѓўc>›Ы•X^бКґЗа•kГ•«э6ГNа©щётКЇЉpeдДqЮ Xpеќ1ОЖfШBґ…вЙъзю{ЇЇlбЗ•g$Wћ‘\№…ам:oP,ДxgЊЙШ®ј1ЛЩ \)K…Щ•bО®ЊЬ±=оjf¶^c—:Ѓз<шыЪgЯпїг\Ї\xb¬п3ЉQ0\№Ъo3мћљOямКZБ+WыЎ+‡МІ0МщКХ•‘ы"¶З]Н®БЛCФ+Ж!іmЉ§0P$”(ѓ°х»Ф	<зБЯXаэ\™цјrMаqе›X®ЊЬЧбьEЅК®Бu>_Ф+Ж!і,”ш(Q
†+Wыm†ќАSуqeЪcрК5ЃЗ•ClОзЏ‡№О_Ф«Ј…‡›!e€Ѕу‚чьN[ШЫ•7f™ЊЙАdЧщ‹z-ДXAЛ2Арsпљ¬ueджьEЅP\iбabёsэ]­ZЙ¦k¶ї-мдКИ}О_ФkБuюў^(1na99єЙс–ЖЫхwµfh%›6ь-¬Щю¶°·+пЊq6¶+пЊq‰БВѕ«h[peє,'“~с`WрєО«µнweдА8О_Ф+ѕ+oМ2хJ®ухЉcЪcPШzЌѓ°х»дК;cLЖмКИ}QШzЌ’kpеrШъ]№ґТгЁВX|W.eГЦпє6®\^Ыь\ѓkX!MтoеVЭДцxї…­У¶тd¶iС•kX!Mтoе\CЇќiсєmЯ}uоУїwГюЅv¦Едzнh’?ЭkзzнЪґи/lн;pј¶µSѕЇKќ2”¬xрЫ=zCС¶vЇќkиµ#МїощuЇkШ'ъзЮ°”блюjЕл_јоµsЅvLщѕ6,хyж}Дxµv–zГR'{xЧїazuЩЅv®ЎЧОTv®Б5tявХЧ'ѓЯВW»nмх/^№юћAIzЗиEKЉюЕklЏч—ШXp”мxKЧаЉнQя!: Уў°=Юпя)х•-ь®Ѓ®жч±=bЦ•Іі№]Yя&¶З··+УЅ]Yяж··4М®¬жй+№тYW™Ґ0Ђ]0ФЌЅ.rэ=ѓ’фЋ+Уѓ€улK®L{ЦT{$Eoprm)џЖцx‰ЌWЮеl ucЇяµ]yc–ЫXpeЪcр °=\Ѓqњяќг\yc–іЃВРхпу{яЮKpЩ(®ј3ЖmМ}Ю®L{¶‡+#0ЋупW™eaФЌm°2м1rЪЯfШ ґїяћЗsе›Ov»2r_ДцЁя0`{јЯюSк+[ш]ѓkКчµOЊCf)Њўю”иКіLFQµqт ,0а°іФW®ХОгµ”жЙХ5”‡МІ0°=о,RѕЇ}^#м/Ыгэ%6ZJіk1Юеl”ИаљF9Ж!¶ЊВ•ZF‘
WћWЕёйКt_ј]90Ћ¦”`о{яTtсОsҐ…2®ґPFбJЃqLЈмК!і,Њш®[P0}ѓ“kKщ4¶ЗыKl,ёr€Н'»¬Фссхї¬+уЩЬ®ј1Лm ®<0Ћ€Чыј>W±YЎШ ѓ•:єЁэ/лК|6·+oМr Гy<°­ФхҐEKivеЃqdpеЦ‚і+Уѓжь±QbЁ{э‹Ч’=х»тКg†rФЮадкJУўaCСхн“Љ–тй;џз\-L3(Е8d–…ЃІАpgмхПџм·”fW^`-8»тЖ,·Q^pegО®ј3ЖdlєтЖ,g`ЁаьПNїс:ымфЯ©нJQзД™бычЅ*ћpҐШ‚‚aCС[€FYpҐ,f2Япу*8~[Шв№тКgWЉt¤4wК ьпётЖ,·QfђЖ6·”OГЬчю2+1
	MVI	C,CR
	CALL	LST2
	MVI	B,24
..Z1:	PUSH	B
	LXI	H,DSPBUF
..L1:	PUSH	H
	CALL	REDTEX
..L2:	PUSH	PSW
	LDA	CHAR
	CPI	7FH
	JRNC	..N2
	CPI	20H
	JRNC	..N1
..N2:	MVI	A,"*"
	STA	CHARЉ..N1:	POP	PSW
	BIT	4,A	;DOUBLE WIDTH
	JRZ	..NODB	
	INR	H
	XTHL
	MVI	M,20H	;REPLACE 1ST CHAR
	INX	H	;WITH A SPACE
	XTHL
..NODB:	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A
	INX	H
	MOV	A,B	
	CPI	80
	JRC	..L1
	CALL	INCOL	;RETURNS ZERO IF BLANK 
	CALL	CHKLIN
 	CNZ	QIKLIN	;LINE
	LXI	H,CRLFS
	CALL	SNDSTR
	CALL	CONST
	JRZ	..M1
	CALL	CONIN
	POP	B
	CPI	ESC
	JRZ	ETX
	PUSH	B
..M1:	POP	B
	DJNZ	..Z1
ETX:	MVI	C,LF
	CALL	LST2
	JMP	RETVAL
;
CRLFS:	.BYTE	2,CR,LF
;
DUMPTX:	MVI	A,0C9H	;CODE FOR RETURN
	STA	GRFLIN	;DISABLE GRFLIN
	JMP	DUMPER
;
DUMPGR:	MVI	A,3AH
	STA	GRFLIN
	MVI	D,"7"
	CALL	ESCOUT
	MVI	A,239	;DUMP GRAPHICS ONLY
	STA	GRFY
	MVI	B,40
..L1:	PUSH	B
	CALL	GRFLIN
	CALL	SCRL6	
	POP	B
	DJNZ	..L1
	JMP	RETURN
;	
GRFLIN:	LDA	GRFY
	MOV	D,A
	XRA	A
	MOV	B,A
	MVI	C,DDSPY
	LXI	H,GRFBUF
..L2:	MVI	E,4
	PUSH	D
..L1:	MOV	A,D
	PUSH	B
	PUSH	H
	CALL	LINDSP
	POP	H
	POP	B
	OUT	SDSPY
	INP	A
	MOV	M,A
	INX	H
	DCR	D
	DCR	D
	DCR	E
	JRNZ	..L1
	INR	B
	MOV	A,B
	CPI	80	
	POP	D
	JRNZ	..L2
RETG:	MOV	A,D
	SUI	6
	STA	GRFY
	LXI	H,GRFBUF
	MVI	E,2
..L2:	MVI	B,160	
..L1:	MOV	A,M
	ANI	3FH
	JRNZ	PRNGRF
	INX	H
	DJNZ	..L1
	DCR	E
	JRNZ	..L2	
	RET
;
PRNGRF:	CALL	HIRES
	LXI	H,GRFBUF
	MVI	B,80
..L1:	LXI	D,BYTES
	PUSH	B
	LXI	B,4
	LDIR
	PUSH	H
	CALL	OUT4
	POP	H
	POP	B
	DJNZ	..L1
DON:	LXI	H,ENDGR
	JMP	SNDSTR
;
ENDGR:	.BYTE	3
	.BYTE	3,2,CR
;
OUT4:	CALL	MAKE
	LXI	H,PRNBYT
	MVI	B,4
.SD:	CALL	SND2
	MOV	A,M
	ANI	3FH
	CPI	3
	CZ	SND2
	INX	H
	DJNZ	.SD
	RET
;
SND2:	MOV	A,M
	ANI	3FH
	MOV	C,A
	CALL	LST2
	JMP	LST2
;
;
OUT42:	MVI	B,8	
	LXI	H,PRNBYT
L1:	MOV	A,M	
	INX	H
MOD2:	CALL	SIXHI	;MODIFIED
	MOV	C,A
	ANI	7FH
	CPI	3
	CZ	LST2
	CALL	LST2
	DJNZ	L1
	RET	
;
TWOHI:	RLC
	RLC
	ANI	3
	RET
;
FOURLO:	RLC
	RLC
	ANI	3CH	
	RET
;
SIXLL:	RRC
	RRC
SIXHI:	ANI	03FH	
NULL:	RET
;
TWOLO:	RLC
	RLC
	RLC
	RLC
	ANI	030H
	RET
;
ZROPRN:	LXI	H,PRNBYT
	PUSH	H
	SHLD	PRNPNT
	XRA	AЉ	MVI	B,8	
..L1:	MOV	M,A
	INX	H
	DJNZ	..L1
	POP	D
	LXI	H,BYTES
	RET
;
STLIN:	SHLD	MOD2+1
	CALL	REDLIN
	CALL	CHKLIN
	JNZ	SETLIN
	POP	H
	RET
;
TEX4L:	LXI	H,FOURLO
;
FIRST8:	CALL	STLIN
EL1:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE
	SDED	PRNPNT
	INX	H
	CALL	MAKE99
	CALL	OUT42
	POP	D
	POP	H
	INX	H
	INX	D
	POP	B
	DJNZ	EL1
	JMP	DON
;
TEX6L:	LXI	H,SIXLL
;
LAST8:	CALL	STLIN
LL:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE8
	SDED	PRNPNT
	LXI	H,BYTES+5
	CALL	MAKE88
	CALL	OUT42
	POP	D
	POP 	H
	INX	D
	INX	H
	POP	B
	DJNZ	LL
	JMP	DON
;
INCOL:	LHLD	COLЉ	INR	L
	MOV	A,L
	CPI	24
	JRNZ	..L2
	MVI	L,0
..L2:	XRA	A
	MOV	H,A
	SHLD	COL	
	RET
;
TEX6M:	LXI	H,SIXHI	
	JMPR	LAST8
;
TEX2L:	LXI	H,TWOLO
	JMPR	FIRST8
;
TEX6H:	LXI	H,SIXHI	
	JMPR	FIRST8
;
TEX4H:	LXI	H,FOURHI
	JMPR	LAST8
;
TEX2H:	LXI	H,TWOHI
	JMPR	LAST8
;
REDLIN:	XRA	A
	STA	COL+1	;ZERO COLUMN NUMBER
	LXI	H,DSPBUF
	LXI	D,ATTBUF
..L1:	PUSH	H
	PUSH	D
	CALL	REDTEX
	POP	D	;SAVE ATTRIBUTE
	XCHG
	MOV	M,A
	XCHG
	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A	
	INX	H
	INX	D
..L4:	MOV	A,B
	CPI	80	
	JRC	..L1
	RET
;
REDTEX:	LHLD	COL
	MOV	A,L
	ORI	0E0H
	MOV	E,A
	OUT	SDSPY
	MOV	B,H
	MVI	C,DDSPY
	INP	A
	STA	CHAR
	MOV	A,E	
	ANI	0DFH
	OUT	SDSPY
	ANI	1FH
	MOV	L,A
	INP	A
	RET
;
CHKLIN:	MVI	B,80		;CHECK FOR EMPTY LINE
	LXI	H,DSPBUF
..L3:	MOV	A,M
	CPI	20H
	RNZ	
	INX	H
	DJNZ	..L3	
	RET
;
SETLIN:	CALL	HIRES
	LXI	H,DSPBUF
	LXI	D,ATTBUF
	MVI	B,80
	RET
;			
FINDCR:	LXI	H,CHRTBL
	MOV	E,A
	MVI	D,0
	MVI	B,10
..L1:	DAD	D
	DJNZ	..L1
	LXI	B,10
	LXI	D,BYTES
	LDIR
	RET
;
CVRT20:	CALL	CVERT2
	JMP	PUTIN
;
CVRT21:	CALL	CVERT2
	JMP	IN3	
;
DOSIX:	MOV	A,M
	CALL	CVERT	
	CALL	PUTIN
	MVI	B,1	
	CALL	CVRT20
	MVI	B,2	
	CALL	CVRT20	
	MVI	B,3	
	CALL	CVRT20	
	INX	H	
	LDED	PRNPNT	
	MOV	A,M	
	CALL	CVERT	
	CALL	IN3	
	MVI	B,1	
	CALL	CVRT21	
	MVI	B,2
	CALL	CVRT21
	MVI	B,3
	CALL	CVRT21
	INX	H
	LDED	PRNPNT
	MOV	A,M
	CALL	CVERT
	CALL	IN2
	MVI	B,1	
	CALL	CVRT22
	MVI	B,2Љ	CALL	CVRT22
	MVI	B,3
CVRT22:	CALL	CVERT2
	JMP	IN2
;
MAKE8:	CALL	ZROPRN
	INX	H
	CALL	DOSIX
	LXI	H,BYTES+8
	JMPR	MAC2
;
MAKE88:	CALL	DOSIX
	LXI	H,BYTES+9
	JMPR	MAC2
;
MAKE:	CALL	ZROPRN	
MAKE99:	CALL 	DOSIX
	INX	H
MAC2:	LDED	PRNPNT
	MOV	A,M
	CALL	CVERT
	CALL	IN1
	MVI	B,1
	CALL	CVRT23
	MVI	B,2
	CALL	CVRT23
	MVI	B,3
CVRT23:	CALL	CVERT2
	JMP	IN1
;
GETCHR:	CALL	FINDCR
	POP	H
	XTHL
	MOV	A,M
	ANI	0FEH
	XTHL
	PUSH	H
	RZ	;FALL INTO ATTFIX IF NEEDED
;
	.PAGE
;###########################################
;PRINTER DEPENDANT CODE
;ATTFIX DEPENDS ON THE CHRGRF TABLE
;USED. THIS IS FOR CHRGRF.TAB
;			
ATTFIX:	MOV	C,A
	BIT	4,A
	CNZ	DUBFIX
	MOV	A,C
	BIT	3,A
	CNZ	BLDFAC
	MOV	A,C
	BIT	5,A	;UNDERLINE
	CNZ	UNDLIN
	MOV	A,C
	BIT	6,A
	JRZ	..L1
	BIT	7,A
	JRNZ	STRKTH
	CALL	SUPSCR	;SUPERSCRIPTЉ	JMPR	©pе‰#ГѓўіФEэ3(№2r_‡i 0ёє^аЗц€сЖ,g`8Їю|^яk»тЖ,·ЃвКґЗаA`{ё2r`з#Ю9®БхъШе‡МRА.О«?џЧE®їgP’ЮqeЪcр<Q_reдѕ€нсdЯ5ё†6б\Я>©haПK?џRKщ4¶ЗыKl,ґdЗs®5Вћegs»ІюН
Е]9d–В@КГ?;MҐ‘]_ъщtЩх Fѕb2ЛЩ(@БPоъТП§‘-ЋЕ^®1®rЊ7f№†у¶pеђYF})БпКіјЌ2К]_ъщёrИ,ЈЁ%†у¶hо"ЧЯ3(Iпё2н1x>Wжі№]ЃqњяќГpЮэОЙЗ•X
†є±ЧхҐџOгШям4mє2н1т}нгК+_®Мgs»2rвhО%)ѓPґэ®ґрр№тО·срu}йзSыЮІҐ+Уeѓ”O{^ъщ”\90Ћ1теКИ}О€яОaАцxїaю-e
Ч@єљуЗF)Ж¬CЭШлvљ6Ћ]_ъщ4Ћ®2KaФЌm°Ж[ЋкК!6+te>›Ы•‘г8FЩ•Cf)Њє±VЧ1К1™еl”Јєr{\yc–Ы(»ІюН
Е]yе‹В•з}Ча:сО‰1н1€ЌwL‹єrИ,#_+»2н1xїZН®L{¦-teЪc0€нбКИ}1зь]ѓлЊшпњУѓШxЗґЁ+‡МІ0тх±W¦=пW«Щ•iЏБ”Ў…®ЊЬЧбх±=К®БпЌсЖ,·1yOveэ›в`ј]9d–…Ѓн1ЮqeдѕxїZН®Бq~})ЖіЬЖ‚+#чuX_ъєћ'кK1Юе6P\лKЯВ/°ј*В•7f№Ќ2аКъwујї+oМreWЦїY_Jр»тКЇЉpеђYОF 
W™eaхП дКИ}с 2|®Ѓ®Ѓ3zэыьЮKpЩ8tЬиGD§|ЯЉ^@Gы_Ј џ·…k )ЧѓАц€qИ,ЫЈюГРхпу{яЖцxї—#'WЦї‰н‘/†®?џЧGD§|Я
WЮе6P\Yя&¶G‚џЎEn”ЮKp9№єЧѓАц(ЗxЃµамК¬W¦=НяLkbhуы]я>ЯBsяіУґqмъТП§іФ{	.]yе‹…+/°,\yc–Ы€пКъ7лK	~†>o‹ЋЯхҐџOн‰КЅ—аrbWЮе6КЂ+лЯ</БпК!іњЌ2 ]оъТП§чпЭя~F‹c±ЧЂ+‡ШДцИC›ЯпѓH·peЪcр 2|-r[§ќ/W^щbбК+_њ]™Пжfh+х;'WG†о_<Шз}р@WZx83фхµ…©ч\єR–
і+‡МІ0°=ь®йрfh+хЈч\Ц>oWћ82tявБ>пѓєR–
3ъЌъ:н‘–ўЕЅ{q–®2KaаЂ‚®[Pё2r_‡ЃнQv®ж¦5Е8d–…Q7¶БК°ЗИi›aѓРюЪR>®ј3ЖmМdАцx‰Ќ…–мx®Мgs»r€Н'»]9q4я3­®Мgs»2r`НяLkЩ•uмГЩХьПґ–cґPЖВ•"гhюgZЛ®ж¦u!Ж;cLЖнJe,\ygЊіq»2џНнКИ‰ЈщџiEqеЌYОаjюgZQbј3ЖВ]ygЊГH®[°`и{\ҐћKЯ•b®ј3ЖЩ(єnм№тО“1\9d–В(®”ќНнjюgZгЗhббvе†›Ы•ўО‰В•‘‹ж¦5ѕ+Е®ЬВrБ•WЮЈ0¶+пЊсГ•з}ЧаКе°х»riҐЗQ?6ncс]№”[їлЪё¶	зеµНЏ®Ў]Г
iZ®\ГЉiд4нEП;MБ«ПѕЫК“ыdр[ш*W®a…4-W®Бqю|~ЊхoОзЏ‡№тkБ«"\yFrеЙ•g$Wћ‘\yc–імВ•iЏAДYSК®јтЕ«"\yc–іМ…+#чu€8kК@Щ5ё"ОџЯ€±юНћщWЮеl¬qeдѕgM(»WДщX1Цї‰ес°бКіњЌЁ®ЊЬЧ!в¬)eЧаЉ8яgcэ›?Г_є\yc–іќ+#чu€8kК@Щ5ё"ОїаЏсЖ,g#Љ+#чu€8kК@Щ5ё"ОOщЋсЖ,gџ+#чu€8kК@Щ5Рq~УлЯ¬ЕИiкКіња®БqЦ”ЃrЊiЏБ
®)eWКОжveЪcр ®|ѕ+пЊqВ•ь—НЫ•7f™qЩ<»тО·с\™Џ%0…+#чEDКw†®Б±_9JьУѓЧNSWЮЈ0¶+egs»2н1xW>Я•wЖёбК~ЉЛжнКіL†ёlћ]yc–Ы 6ѕВ•‘ы:D¤|gи\П)Я1ЮеlаseдѕЏXSК®Бх<qБгЌYОFЧаzДљ2PЋ1н1XБ5e мКіЬ ®L{Д•Пwеќ1nCё2ѓџвІy»тЖ,“!.›gWЮг6ћ+у±жш…+#чuxRѕ3t®gѕr”ш1¦=Їќ¦®ј3FalWЮе6 ©peЪcр ®|ѕ+пЊqВ•ь—НЫ•7f™qЩ<»тЖ,·мTёЧ“тќaЊь·+7ґ„Tё2ѓявvҐ…—НЫ•wЖ8Ы•‘ы:u$єЧѓётщ1Юe2кeу¦+oМr6Ђ$®Ц•ьgWfр_Ь®<п»WDКw†1fр_Ь®ЬРRбКю‹ЫUФ‘bmZфЖ,·l  k3ѓявvеќ1ncvе†–ЂTётјп\+ё¦”cL{^;MйК;cЖvеќ1n#№rCK pе9Й•з$Wћ“\yNrеќ1>c»тјп\Їќ¦1Юc2fWnh	H…+пЊQЫ•wЖёЌЩ•ZRбК3’+ПH®<#№тЊдК|6…+Пы®Б•ЛaлwеТJЏЈюЁ@a,ѕ+—Іaлw]W.Їm~®Б5¬ђ&W®aES<+Ч°bT ‹ё¶рїsАлчЙа·р‘+Ч°ў)ћ•kX!M8®\ѓk=XT ЖZ/Бяоъ§®2Лzюъ§®m’?јАZ°`Ё{}ћЩЦяNuеЦ‚В•XО®јАZрЄЧ°Bљ±r«6-љЉ—¦=}Ґ4lљv-А/2rеVHУ"V®2ЛВш^пётО·q»2џНнКИ‰c=XT`»R¤ГЫ•‘гЪ4бz°ЁАvҐ…2®L{ЊfН ®a…4-bеV,6гхф•жјЏ W®a…4-bеZШ1ZHqЩ<3¤вҐiKщфф•\9ЫПЁЖve$Ћ©оq34М=}ҐѕО«~W±щ3ьҐ‹БJ=}Ґ4lљv–$Wжі№Dn§bCулљA(\9q„№BбКQС¦	§a§[t‡љA(ъЇ§ЇдКґЗ`Н ®0W(bј1ЛЩ€Оµ,*0Зh!ЕeуМ0ЫЯюЬiџSrеЙ•g$W¦;№тмs8\yc–Ы€"iд4m‘Р•ь—Ні+oМrЂ$iд4mрre?ЕeумJЃq¬‹
М®Б5¬ђ¦E¬\ГЉяlXЗюЇ§Ї”Іx\№†Тґ€•kpеЌYаК;cLЖpеђY
cъJ®[PётОgгv®a…4-bеV|ШаюЇ§Ї”Іx\№†Тґ€•kpе›€*Ќmve>›Ы•‘ЗTLУуo‘ЏЁЧаЉНЇa>чќІxµnDн”Е«®Б•wЖёЌдКtY®
†.їў‘8m`г+zўфПђ§Т—g±™Ш•‘г€Ё)ЂЎ{ўВЉ7±+oМr6ЂЌЇpEФ”cє,Јј‚ЎЛRСHњ6ђЉћ(э3д©…феY<MмКИЃqDФ”E™Ў{"ЙB!ПyЧШйх6o'vеЌYОђ
WDMY”cL—%ѕT04ЂЇh$N»ЊRфDгIїч91±+#ЖQSЭ%рФ|z<йOмКіњЌ2JбЉЁ)‹…Уe‰O¤ў‘8m ~Сk.~пs2bbWFЊ#ў¦,Pє'Jа©щф±жвOмКіњЌш®€љІ@‰1]–ш^БРА\4§¬)z"рк}NFLмКИЃqDФ”E|†о‰xj>^»тЖ,gc]5e?ЖtYв“
†vСHњv_С‰ЊЂЅПЙ€‰]90Ћ©¦?є'Jа©щґИ8±+oМr6Кш
Ча2ь'ЏNYј–џkpMЕ4эгl?Јі+#Ж1Уz†Nю“G§,ћkpњѕТµEЯYј–џkpе›јҐave>›Ы•‘ЗTLУѕжЯe §ЇФЧ®Б5¬ђ¦E¬\ГЄM‹–ЃћѕR_[ф?Ц±їНђ+Ч°Bљ±r®ј3Жm$WVР2є№ +#7S1Mыreє,_M®ЊЉiЪ—+‡МІ0®-ю<\ygЊПШ®ј1Ka ®[PётО·q»2r_‡0§}№Ч@пNю“G§bџќю;®Б5УґЇ‡Ш¬ЕИiКђцeя6оµ•ѕ'ћpe>›Ы•wЖёЌЩ•‘GУѕ\ѓkX!M‹X№†UwЪ—э{ШёЧVкZXйчИiъW®a…4-bе\™.ЛЁе‚aKяќ®ч№езКИI„9нЛ•йІЊ2у“тy]п=2N~®Њ\„9нЛ•ZB*ТѕмЯГЖ=WУѕbЊЬНy1eШBфП=ѓ’фЋkp+¤i+Ч°jУ„‹Еxќ2ь'ЏNYјК•kX!M‹X№ЧАbC1^O_йЪў§Їд\S1­Ч€сО·1»2]–Ђ$
WFЊcљЦk ёr€MЮТ0»2џНнКИ‰cљЦk,ё¦iЅF9ЖtoWЦї	Б[fWFол0Mл5в»¦iЅЖBЊІі№]Yяf-FNSWFол0Mл5К®Б5°ШPЊЧi_µGNУћѕ’kpMУz”Уe	HЇpeдА8¦)6¦%WКОжveэ›јҐavе›µ9M]™онКъ7k1rљє¦iЅFьoМr6ЂWё2н1€8kК@Щ•‘ыb*¦{Ь®Б5°ШPЊЧх}$xхф•\ѓkљbcZЉuє,I*Ш®ЊЗ=n1J®iЉЌi9Ж!6aћѕ’+уЩЬmҐ¶°±=ЮпЊЅ3vЙ•ЗTLпєс`[3МзuъgИуjrе›Шх_эF}®ј3ЖЩШЭmҐ†щ·…Ќи|:хњуп|ZШ:н|ЅіїНР•ClЉ:•†™Ў;џ¶^c—Z‹ЅгК|6gWЮгllW±)к%і+уЩњ]ygЊі±]9Д¦ЁW*%Wжі9»2rв(26¦%ЧаКіЬ ICїQ_ЧчЫгэѕљ[ЫЬ?7bЫпКъ7±=.(єҐ|:OыЫыхПэа§уй'ії±=ЮweдѕЉйэЏkpУRЊІі№]Yя&¶З…+‡ШmЉ§ѕ/і+УЅйК|6·+#q4з-ДФ•iЏБSя·+#чElЏTL]ѓkаыЬ-ЮШҐћhMЯ‚яХ‰]ѓл·ҐУe	H©peдА8¦b:џ©+oМrЂ$®¬sЏ±ї+‡МІ0ж7Ж‡®L{ЦBбКИ}¦bєЗн\чќсN§яЙЈS±ПNяќк\S1ќП4ЖtYТ\ё2r`УQҐбКіЬЖWfрі¦|Я®bіЪ|Мk\™Џe(\™БПљт}»тЖ,·ЃІаКъ7з3Mр»2r_‡©оq»Ч4ETiДxgЊі±]9Д&ўJc›]™Пжfh+5Мї-lDuеќ1ncveдДСњ·S†юЕѓ-2њь[д–Ќэm†®Б5‘ЏЁџ®ЧKvЏюgГ:ц·єWЦї™юHY0tїQ_ЛЖюЇnDнъЦ6ш`z®ЬР2*P04ў°©ил<ЙКдзКИЃqDФ”EWЮе6Т?cm3¤rm»"jК"jЊiЏADMYМ®ЊЬЧa*¦{Ьt®€љІ€cє,ЂВ•‘г€Ё)|®ј1Лm¤Ж”!э3ђSW¦=5e1»2]–йџQ]90Ћ©оq»тЖ,·‘юkыкђюИi]Ы—+#чu¦€*ЧаЉЁ)|1¦Л2>Pё2r`S1Эгvе›йЏ”Cъg #FgЈуйЛ•йІLяЊHбКИЃqDФ”Et®ј1Лm¤F„!э3ђ‘В•‘ы:DФ”ETЧаЉЁ)‹иbL—eъg\Х•‘г€Ё)‹нКіЬFъg\йџЃјЄ+#чu€Ё)‹Ё®БQS;ЖіЬFъgd†фП@fW¦=5e1»2r_‡©оq»WDMYМ1¦=·УWrе›йЏ”…G7ґ,K…+#чЕ-Дф•\ѓ«9o!¦1¦=·УWr®a…4-bеVLЕKУЮcџ»’+Ч°Bљ±r®©оqЗ8Љ!ёЗ-і+E’±pe-†а·4М®ј3Жm®Мgsё2r`±=.ЧаК!6чёь]Яk+хw‚їk‘Б!z~}^}Я•іэЊjlW¦8ћъчё]ѓ+ol±ЛЩ ¤µ5®-uєувП^[й;Г_ё2н1xДљ2Pveє,©peдДЫREVRS
..L1:	BIT	7,A
	CNZ	SUBSCR	;SUBSCRIPT
	JMPR	REVRS
STRKTH:	LXI	H,BYTES+2	;STRIKE THROUGH
	CALL	FF
	LXI	H,BYTES+6
	CALL	FF
REVRS:	MOV	A,C
	BIT	1,A	;REVERSE VIDEO
	RZ
;
REVID:	MVI	B,10
	LXI	H,BYTES
..L1:	MOV	A,M
	CMA
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
BLDFAC:	LXI	H,BYTES
	MVI	B,10
..L1:	MOV	A,M
	ANI	77H	
	RAL
	ORA	M
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
UNDLIN:	LXI	H,BYTES+9
	CALL	FF
	DCX	H
FF:	MVI	A,0F0H	
	ORA	M
	MOV	M,A
	RET
;
SUPSCR:	PUSH	D
	LXI	H,BYTES
	MVI	B,3	
..L1:	CALL	SHIFT
	DJNZ	..L1
	LXI	H,BYTES+8Љ	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+3	
	CALL	SHFLFT
	ORA	D
	MOV	M,A
	INX	H
	MVI	B,3
..L2:	CALL	SHIFT
	DJNZ	..L2
	LXI	H,BYTES+9
	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7
	CALL	SHFLFT
	ORA	D
	JMPR	SCRDON
;	
SHFLFT:	MOV	A,M
	RAL
	RAL
	RAL
	RAL
	ANI	0F0H
	RET
;
SHFRGT:	MOV	A,M
FOURHI:	RAR
	RAR
	RAR
	RAR
	ANI	0FH
	RET
;
SHIFT:	CALL	SHFLFT
	INX	H
	MOV	D,A
	CALL	SHFRGT
	ORA	D
	DCX	H
	MOV	M,A
	INX	H
	RET
;
SUBSCR:	PUSH	D
	LXI	H,BYTES+3
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+8
	CALL	SHFRGT
	ORA	D
	MOV	M,AЉ	MVI	B,3
	LXI	H,BYTES+3
..L1:	CALL	SHIFT1
	DJNZ	..L1
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+9
	ORA	D
	MOV	M,A
	MVI	B,3
	LXI	H,BYTES+7	
..L2:	CALL	SHIFT1
	DJNZ	..L2
	XRA	A
SCRDON:	MOV	M,A
	POP	D
	RET
;
SHIFT1:	CALL	SHFRGT
	MOV	D,A
	DCX	H
	CALL	SHFLFT
	INX	H
	ORA	D
	MOV	M,A
	DCX	H
	RET
;
DUBFIX:	PUSH	B
	PUSH	D
	PUSH	H
	LDA	DUBFLG
	ORA	A
	JRZ	HALF1
HALF2:	XRA	A
	STA	DUBFLG
	LXI	D,BYTES
	LXI	H,BYTES+4
	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+9
	LXI	D,BYTES+8
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1Љ	JMPR	HFDON
;
HALF1:	CMA	
	STA	DUBFLG
	LXI	D,BYTES+4
	LXI	H,BYTES
	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+8
	LXI	D,BYTES+9
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
HFDON:	ORA	C
	ORA	B
	MOV	M,A
	POP	H
	POP	D
	POP	B
	RET
;
STRCH:	MOV	A,M
	MOV	C,A
	ANI	44H
	RRC
	RRC
	MOV	B,A
	RLC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	88H
	RRC
	MOV	C,A
	RLC
	RET
;
STRCH1:	MOV	A,M
	MOV	C,A
	ANI	22H
	RLC
	RLC
	MOV	B,A
	RRC
	ORA	B
	MOV	B,AЉ	MOV	A,C
	ANI	11H
	RLC
	MOV	C,A
	RRC
	RET
;
SHFT:	ORA	C
	ORA	B
	XCHG
	MOV	M,A
	XCHG
	RET
;
;THE FOLLOWING CODE IS DEPENDANT ON THE
;ACTUAL ESCAPE CODE AND ARRANGEMENT OF
;BITS ON THE PRINT HEAD
;
SETSTR:	.BYTE	7
	.BYTE	LF,29,ESC,"%","9",12,LF
;
SETPRN:	LXI	H,SETSTR
SNDSTR:	MOV	B,M
	INX	H
SND1:	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	SND1
	RET
;
SCRL6:	LXI	H,SCRSTR
	JMP	SNDSTR
;
PUTIN:	RRC
	RRC
IN3:	RRC
	RRC
IN2:	RRC
	RRC
IN1:	XCHG
	ORA	M
	MOV	M,A
	INX	H
	XCHG
	RET
;
CVERT2:	MOV	A,M
..L1:	RLC
	DJNZ	..L1
CVERT:	ANI	88H
	RRC
	MOV	B,A
	RRC
	RRC
	RRC
	ORA	B
	ANI	0C0H
	RET
;
HIRES:	MVI	C,3
	JMP	LIST
;
RETSTR:	.BYTE	5	
	.BYTE	ESC,"%","9",0,30
;
RETURN:	LXI	H,RETSTR
	CALL	SNDSTR
	MVI	D,"6"
	CALL	ESCOUT
	JMP	RETVAL	;EXEC MODULE
;
;END OF PRINTER DEPENDANT CODE
;###########################################
;
;	PUT UP PRINTER NAME ON MENU
;
PRNPNT:	.BLKW	1
DUBFLG:	.BYTE	0					
CHAR:	.BLKB	1
COL:	.BLKW	1
GRFY:	.BYTE	239
BYTES:	.BLKB	10
PRNBYT:	.BLKB	8
;
	.LOC	BASE+1800H+5FFH	;CHARACTER GENERATOR TABLE START
;	
CHRTBL:	.BLKB	2560	;CHARACTER GENERATOR ROM IMAGE
;
LSTBYT	=	.
;
	.LOC	BASE+1800H-320
;
GRFBUF:	.BLKB	80
ATTBUF:	.BLKB	80
	.BLKB	80
DSPBUF:	.BLKB	80
;
;
	.END
ROMTOOLSDOC           ‚Jo>Ђ  SPLIT   EXE           iMr>ґ  BACKFMT COM           !p:ЩNОA  CCDRIVESCOM           !p:СN	  SC3     COM           ќ«„y>Ђг  SC3     HLP             s	–> д  SC3     OVL             s	і>ЂІ  SCRHERC DRV             s	К>   SCRIBM  DRV             s	Н>   SDI     COM             t	С>0С  SG1     OVL             s	м>   SG2     OVL             s	о> \  еееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееегrеЦ‚WEё2н1xЮы»2]–“е7Щ•Wѕ8»2rв€нq№rИ,г¶°–WЮг6n†.“kg©пбК-©pҐH2®ј3ЖmЬ ґїv–ъОр®Њњ8¦йwЩ•[X»pMУ=оrЊZRбКt_њ]9qLУ=оWF`выЬ®ЊЬЧ!¶Зељ¦{Ь1Љ$cбК!іњЌ2P^(:Э№цЩw‹]*®L{¦bzзкКHвыЬ®ЊGlЏЛ•iЏБу¶ш·+‡Мr6КеЁC§;Ч>ыовФeгШ·…uйК!і,ЊвФ2аКґЗ`*¦w®®Њњ8о±ПнКИIЬcџЫ5ё†Тґ€•kXЫгэѕљ[~дК5¬ђ¦E¬\ѓ+¶Зг›Ш®Мgs»2г¦Ш–]ѓkhaл5v©їЅ_o(ZмяZ~®Б•Clb{|{У•щlnWFNS1ЅяqҐмlnWЦїщн-і+лЯMlЏooЧаVHУ"V®aХ¦EҐ‘Ї«Фwющt-АЏ№r+¤i+ЧаљЉйэOЊЈ‚ч?	~уы}зџO{їгК;cЬFБр_э-еУqпdWжі9\90ЋizяSf°R/NЃ6~с`‹—О»ь®ј1Лm zўёћнп=ОЫўФхэ‰]™цcяT0tїQ_Чьќ%©пьу©®ґPЖВ5MпК1Љ$cбКZБыџїkp+¤i+Ч°jУўЕ†bј¶NыЫыusеVHУ"V®Б•ClЉ:Mр»2џНнКИ‰г|Юћ2ґЁУпqЮҐFoА•"nWЦї)к4БпКИЃqњПЫS†uљапEВi®bSФi*%W¦ЛC[©aюЌШц[hn)џ>o‹’+#ЖсЫ;ѓџЎыц;'ЧаКґЗ`…хпПРoФЧхБъZ‹Ѕ®°єr¶ї№ЖШЭVjq,цжЯyкКHТ™·`и_<Ш€mї…ж–тйу¶(х;'W™eaњ4ю<BїQ_ЧїПпrэ}^ЪГ•7f№ЌшўEќ¦RjфЋпКґЗ И'Х©+#чu8џ·§®Б5ё~{gрЗцLгH"14rЏСщпф·чЛапwN>Х•ClЉ:MҐДРќЖЫ§3ш[©]™Џ%ђЂ‚Ў[Фi*ҐО§ц$ peэ›ўNS)№Чщј=Ќq€НщLь®Мgs»2rвh®йp»ІюНщLь®ЊGы pеЌYncЌ+3шYSѕoW±Ym>ж5®МаgMщѕ]ѓkX!MЛ•kXсЙмпz°Ё@OґGНЦ'z.u=t•&жК5¬ђ¦еК5ёЪEЊWѕxU„+Ї|qvе•/
W^щbбКQ/Бяоъ§®|¶MкЪ&њПыЦ5ёrymуs®a…4бёr+љвY№†U›&|Ыљ–]и
О'ѓЯВWЙ•kXСПК5¬ђ&W®Б5¬ђ&њ|еVЭ5ѓP4¶ЗыЅЗ>wчК5¬ђ&њ|е\чШзЋq€Н=ої+у±Њ®L—e| peдА8оAЎ+‡МІ0цёы»тЖ,op®{DЂ-<Ь®2ЛВ(/ ®БuЏH9ЖґЗа©ЏWЮе6&/Ц“]Yя&¶Gє…л‘…‡МІ0цё+®L{ЦBбКИ}Ыгr®{DPbL—eь…В•‘“ёGp®bsЏ±ї+уЩЬ®ЊЗ="с]yc–іQЋRё2н1xДљ2Pvе†–®Њњ8о‰пКіЬ I…+лЯДцё pе›0O_Й•щlnWFNч€,Р5ёо‰гђYF9~| pеќ1nc0ф@Џ®ЊЬЧб‘Іk ]Г
iљhеVЭ)ЯЧ>ЇУќkџ}ч·чk„эEџ·G{їо•kX!M­\ѓk*¦w®1^`-8»2н1xДљ2Pvе•/О®МЗ(\™о‹·+E’±pеЃq®ґрpvеќ1ncveє/&WFЊc*¦w®®<п»Ч°Bљp\№†Uчў§ЇФ?чѓўіФУWљу>ўgP’ЮбК5¬ђ&W®Бu1}ҐпЊq6v»r€Нй+%шйСЗtYNgPђБJ=ѓ’фNKа®2ЛВЯє2ЗљA(єfЉћЯFП $ЅУ8†+-<ЬэF}Ѕ…ий+№ІюНй+%ш]9Љ!8}Ґ~WЮг6fWЮгmlWZ(cбКZБй+]р»тјп\Г
iВбК5¬є/°=}Ґ‰кДmбП=}Ґ9п#zҐwєW®a…4бpе\/°УRЊX®јАZpvеЌYnЈХ•њ™\9d–…1}Ґ”\yЃµ`бJa]9qјj1-•ЪJ}Ѓµ°РЬеЁFявБѕj1-•]ѓ+пЊ1›ЎЯЁЇпЊЅОCфф•jѓ—+oМr6 WЉ-83t1Ѕ'љѕТJсNTЋЉњѕRнџыkЃ,O<±+E’±pеђY
cъJ3(Е[^гК!Д!CЯ{^=}ҐЪцJТ;®БхЄЕґTЋсК…+Ї|qv®bsъJ	~†/±ялй+%ш‰cO_й‚Я•Ј‚УWєаwҐШ‚і+·L®L—e9Є+#'сЄЕґґаКіЬF9Є+‡МІ0¦Ї4ѓRјеЁ®W-¦Ґ…лЯњѕR‚Я•µ‚УWєаw®јтЕВ•CШC†ЮBфф•jяЬ3(IпётYWћч]M‹­+—ГЦпКҐ•GэЖв»r)¶~ЧµqетЪжзС\Г
iZДК5¬FNУ>o‹ю{ЇrеVHУ"V®Б5PКзЮїіФПгUЧаX®їзТЌЮщzg›Ўk`7Риэч<^яwnчПЗ5°»Ьи}Ю-ќ|w9M;цrм^hф>o‹–Nѕ;Э№цЩ·kа=—юkфЮBњWkяЬзmСТЙ·kp…ы{ЗёњKя±l QъЫыµtтЭp›бќ
{№r9—юcЩ ўєr9—юcЩ Цёr9—юcЩ в»r9—юcЩ P\№њKя±l ®\ОҐяёЧ<µЯЮ1.зТ,А†юц~-ќ|wћЪN…Ѕ\№њKя±l с]№њKя±l (®\ОҐяX6ЂW.зТ,@Щ•Л№фЛ ёr9—ю#а\бюbя—sй?.e†ыї–Nѕоo3ЬЈSa/W.зТ\0К®\ОҐяX6К®\ОҐяX6КeW.зТ,@t®\ОҐяX6 |®\ОҐяX6КЂ+—sй?®Б5O­Ш?Же\ъЏeЈјАРbяЧТЙwз©нTШЛ•Л№фЛF№мКе\ъЏeЈёr9—юcЩ ўsеr.эЗІаsеr.эЗІDqеr.эЗІDuеr.эGА5ёrymуsетlae,Gu®a…4MИ+Ч°jS<lУўуEя=ЏG¶iBW®a…4MИ+Ча:я=Џ—sй?ўD1 a¬‰b [2ЦD1рI®\ОҐяё&ЉЃ0ЦD1вЖљ(ЖаКе\ъЏkўeАXЕ рkў@|W.зТ\Е Њ5Q м:ГыП#Же®ЙVNnУўQЦLvеrЧd+'w—ЛАdW.wM¶rr%юrНdW.wM¶rrwy0Щ•Л]“­њЬЌ “]№Ь5ЩКЙЭQ`І+—»&[9№Л 0Щ•Л]“­њЬс`І+—»&[9№ггЂЙ®\ољlедЋ.* LvеrЧd+'—Ј[ ЂЙ®у1.wM¶rrgШ=Щu
п?Џ—»&[9№і$хdW.wM¶rr6M'»r№kІ•“[X8ќLW.wM¶rтьЮUћмКе®ЙVNћЯ»&»Ч°Bљ±r+ЦBСПгUrеVHУ"V®БuЏ»Bгr.эG 0 c0 Ј, ` ЂHш\№њKя Њшe_Чаъ3јЮ‰q9—ю#Рz<hюEg©kЎh»,OT@n}Ь®/-]ѓ+М?Ггr.эG 0 А   @2 Й $ђ¤РГ•Л№фА    0 А   \У°iгr.эG l с 0 А $ђ@2 ЂЎУ°iJW.зТДсЈea,  E5Ђ-А®у{WЊЛ№фЃX0 А  ђ@2 Й@Y`haбФ•Л№фЧД7 eБXХX ”g,¬qЅ­Ш1.зТ 0 А  ђ@2 Й $|Ўзч®r»r9—юcY2 А ¤g Ђ   @Ч^(9Же\ъЏА‚   ` ’H Ђ„/фьЮµаКе\ъЏeЙ @Ъ  ` Ђ ®угГ—sй?°` Ђ  Ђd ’ЃІАРуГ•Л№фЧД7 eБXХX ”g,¬q®a…4-W®aХЅЗоя:ымфЯйъ~яіaыЫыпy<®\Г
iZ®\ѓk*ОџGЊЛ№фг@ЈwэЉ}DЧч]№њKя КЌЮR>wнН®\ОҐя€`Xhф6џч¦ЌcЏНа6їкКе\ъЏ@PЅпэ‹Ж±щ€ѕNNЇVН}Б5¬ђ&yV®aХ=}Ґ”Ел6¬c›aя=ЏЧ!тхпУШ;Хf8qЇ\Г
i’gе\aофП0єVъ®БuъJ1.зТр@t° 0 А „  Ѕ=Чю{о!5Ьw§УpчИiкКе\ъЏЂ  еЩ КХ(oЈ…є^wГЭЇ¦ТпујZ@W.зТ\уЊ…І0PЊ…шЖВc!Є±°ЩЎ›Е:ъЕ!Nђq\;W.зТ\Аg,Dg,,(Ы@IЖВl <Eк=СДRl‘вЕ©ь\№њKя1К3в—ЌшF|#~|#ю#~T#~vиЕЛ='с$і+—sй?ЖЗgДЏО€їЌші?с…яс%vиВF¦г†Щ•Л№фЧ ЖљІ±fБXѓb¬‰o¬Yc¬‰j¬‰В}­нS?€!\№њKяq>cMtЖљmD™Ќ(Й€"Њ5’Da‡–•вpІ«Е‹Е“xГ5ё¦†Сµ°Тw®\ОҐяа3Ђи` ` Ђ @z®эчЬCjёоN§бо‘УФ•Л№ф   0 I2ўC1рЕ7ў[0рЎtиz5ЬwїљzHїПoрj]№њKя±ь|k б3 Ѓb 3ЉМЂмШs‡Еf±Ћ~q€&dЧО•Л№фЃ9Єlc!ЉЃ2Й ’±рЊ)фDOH±EЉ§тЈ+—sй?Ђ”`Б P ѕ¬1ЂЁ…:э3ђ‹—{NвIfW.зТр@t°`6Ђd В ћHЭЎУ?YШИtЬ0{фq9—юc0КeЈј`”QЊr|ЈјЖ(G5КQєC§тZЫ§~Cёr9—юcџQЋО(oЈ<еd”…Q–ЊrtЭЎУ?)+ЕбdW‹‹'с†kp„№kaҐЯщtъgёW.зТр@t° 0 А „  Ѕ=Чю{о!5Ьw§УpчИiкКе\ъЏЂ  еЩ р@2ЂЩ vwиz5ЬwїљzHїПoрj]№њKя0PКК‚Ѓ‚b Д7PЦ(Q”(ЭЎЃтJь5QЈёr9—ю#
>%:c!ЉЃ2Й@ЖВ3¤оРшў›фҐ<®\ОҐя0ў–ЌЁFT#j|#к#jT#j”оР‹g4yб_O>ёr9—юcT|FФиЊЁЫ€:Q“UQџUкЅюz8™IQMЂ:љ+—sй?FЊ(e#К‚Е€Я€ІЖ€Х€Ґ;фвылpе&Yди№r9—юc|F”иЊ(ЫX3k’±FВ€"u‡^Њµџ‹/пkѓoёЧАфП0ж®…•ѕkpеr.эG@JќHі  Ђ0 А $СЎзЪП=¤†»боtо9M]№њKяq0 А  ђ$(@TЈј` (є^wГЭЇ¦ТпујZ@W.зТТ3КeШ eА fЈХ :4P^@‰ї&jW.зТ>HСQ”ЩXHѕІ±рЊ©Cг‹nr0Р—тР•Л№фА К°` (Я Ц@T€ВќюИЕ3љјрЇ…'\№њKяАg СА6ЂЩ ’x ±C§rэхp2“ўљ u4W.зТ,F№l”Њ2ЉQЋo”ЧеЁF9JwифП@.n±їWn’EЋћ+—sй?–сеиЊт6КіQNFYшўешЭЎУ?№k?!_ЮЧ)Юp®ЃУWє¶иїзс\ѓлµЕџGЊЛ№ф¶±ђa,<cA";фЪиKy\№њKя1*`D-QЊЁ(FФшFФ5FФЁFФ(мР‹g4yб_O>ёr9—юcT|КҐl ,((
`D}JФоРлЇ)/  ЁЈєr9—югВlD)QЊ((F”шJ|vиxылpевУ5ёry¶°2–ЧаКеµНП5ё†Тґ€•kXх«i_Їл[Ыаѓй5цТП§яћЗл•kX!M‹X№ЧWУџGЊKD>‚Ч•-ь}ЌьыК~W.щ^X
	DCX	H	;REPLACE WITH ORIGINAL VALUE
	MOV	M,E
	MOV	C,E	;& DISPLAY
	CALL	VALDSP	
	MVI	C,8
	CALL	VALDSP
	DCR	B
	JMP	NGKEY
..L1:	JZ	KEY
	MOV	A,B
	CPI	12
	JZ	KEY
	MVI	C,0CH	;SKIP OVER SPACE,"/",OR ":"
	CALL	VALDSP
	INR	B
	MOV	A,B
	CPI	7
	JNZ	KEY
	MVI	C,0CH
	CALL	VALDSP
	JMP	KEY
;
NGKEY1:	POP	H
	JMP	NGKEY
;
ENDIT:	PUSH	H
	LXI	H,ALMBUF+2
	CALL	CHKMOS	;MAKE SURE RESCHEDULED ALARM
	JRNC	NGKEY1	;IS LEGAL
	INX	H
	INX	H
	CALL	CHKDAY
	JRNC	NGKEY1
	INX	H
	INX	H
	CALL	CHKHRS
	JRNC	NGKEY1
	INX	H
	INX	H
	CALL	CHKMIN
	JRNC	NGKEY1	;DO NOT EXIT UNLESS OK
	POP	H
	LXI	H,ALMBUF+1
	CALL	CVRT	;CONVERT MONTH BACK TO ONE BYTE
	MOV	M,A
	PUSH	H	;PUT NEW SETTING IN CURRENT ALARM
	CALL	FINDAL	
	POP	D
	XCHG
	MOV	A,M
	XCHG
	MOV	M,A
	INX	H
	INX	D
	LXI	B,6
	XCHG
	LDIR
	CALL	CHKYER
	CALL	REDMSG	; MAKE NEW MESSAGE IF DESIRED
	LXI	H,CHGMES
	CALL	VALMSG
..L2:	CALL	CONIN
	ANI	0DFH
	CPI	"Y"
	JRZ	..L1
	CPI	"N"
	JZ	ALARM1
	CPI	ESC
	JZ	ALARM1
	CALL	INVALD
	JMPR	..L2
..L1:	CALL	MAKMES
	JMP	ALARM1
;
	.PAGE	
;
;|------------------------------------|
;|   CREATE A NEW ALARM MSSG/COMMAND  |
;|------------------------------------|
;
MAKMES:	LHLD	TIMFLG
	MVI	M,0	; SET FLAG TO DISPLAY FLAG
ES1:	CALL	FINMSG	; FIND ADDRESS OF MSSG.
	PUSH	H
	CALL	FINDAL	; FIND ADDRESS OF DATE/TIME
	LXI	D,7
	DAD	D
	MVI	M,0	; RESET COMMAND FLAG
;
	LXI	H,COMMSG; "PRESS 'Y' TO ENTER COMMAND"
	CALL	VALMSG
	CALL	CONIN
	CPI	ESC
	JZ	ALARM1
	ANI	0DFH
;	
	CPI	"M"
	JRZ	..MSG
	CPI	"C"
	MVI	C,1
	JRZ	..COM
	CPI	"I"
	JRNZ	..MSG
	MOV	C,A
	CALL	VALDSP
	MVI	B,2
..L4:	CALL	CONIN
	ANI	0DFH
	MOV	C,A
	CALL	VALDSP
	CPI	"M"
	JRNZ	..MSG
	DJNZ	..L4
	MVI	C,2
;
..COM:	CALL	STRTYP
	LXI	H,ENTCOM
	JMPR	..GO
;
..MSG:	MVI	C,0
	CALL	STRTYP
	LXI	H,ENTMSG; "ENTER MESSAGE"
..GO:	CALL	VALMSG
	LXI	H,SPLIT2; PUT UP SPLIT CHARS.
	CALL	VALMSG
	LXI	H,POSMS2; POSITION CURSOR
	CALL	VALMSG
	CALL	DOSMAL	; SET TO SINGLE WIDTH CHARS.
;
	POP	H	; RETRIEVE ADDR. OF MSSG
	MVI	B,58	; SET CHARACTER COUNTER TO 58
	CALL	CLEARMS	; CLEAR MSSG. SPACE FOR THIS ALARM
;
;  --- BEGIN MESSG./COMMAND INPUT ---
;
..L1:	CALL	CONIN
	CPI	ESC	; IF CHAR. = ESC
	JRZ	..J2	;  THEN EXIT
;
..J1:	CPI	CR	; ELSE IF <> CR
	JRNZ	..L2	;  THEN ..L2
	MOV	A,B
	CPI	30	; ELSE IF ON 1ST LINE
	JRC	..J2	;  THEN GO TO 2ND LINE
	MVI	B,30	; ELSE QUIT
	SUB	B
	MOV	E,A
	MVI	D,0	
	DAD	D
	JMPR	..L3
;
..L2:	CPI	08	; IF CHAR. = BS
	JZ	BAK	;  THEN DO BACKSPACE
	CPI	SPC	; ELSE IF CHAR. < 20H
	JRC	..J5	;  THEN ERROR
;
	CPI	"a"	; MAKE CHARS. UPPER CASE
	JRC	..J3
	CPI	"z"+1
	JP	..J3
	ANI	0DFH
;
..J3:	MOV	M,A	; ELSE PUT CHAR. IN MEMORY
	MOV	C,A	; AND DISPLAY IT
	CALL	DOBIG	;  SET TO DOUBLE SIZE
	CALL	VALDSP	;   DISPLAY CHAR.
	CALL	DOSMAL	;  SET TO NORMAL SIZE 
	MOV	A,B	; CHECK CHAR. COUNTER
	CPI	30	; IF <> = 30
	JRNZ	..J4	;  THEN ..J4
;
..L3:	PUSH	H	; ELSE REPOSITION CURSOR
	PUSH	B	;  FOR LINE TWO OF INPUT
	LXI	H,MESLIN
	CALL	VALMSG
	POP	B
	POP	H
;
	LXI	D,4	; SKIP OVER CURSOR 
	DAD	D	;  POSITIONING CHARARACTERS
..J4:	INX	H	;  IN MESSAGE STORAGE
	DJNZ	..L1
	JMP	DOSMAL	; SET CHAR. TO SINGLE WIDTH
;
..J5:	CALL	INVALD	; -- ERROR --
	JMPR	..L1
;
..J2:	CALL	CLEARMS	; CLEAR ALARM MSSG. SPACE
	MVI	A,58	;  -- THIS MAKES NO FUCKING SENSE --
	SUB	B
	STA	LENCOM
	MOV	B,A	; SAVE MSSG. LENGTH
	CALL	FNDLEN	; FIND ADDRESS OF MSSG. LENGTH
	MOV	M,B	; MOVE MSSG. LENGTH TO MEMORY
	JMP	DOSMAL	; SET FOR SINGLE WWIDTH CHARS.
;
EL1	=	..L1
;
	.PAGE
;
;|----------------------------------------|
;|   GET NEW ALARM DATE & TIME FROM USER  |
;|----------------------------------------|
;
DAT:	PUSH	H
	LHLD	TIMFLG
	MVI	M,0
	LXI	H,MON	;MMDD	
	CALL	VALMSG
	POP	H
	MVI	B,8	
	MOV	A,B
	STA	LIMIT
;
DAT1:	CALL	CONIN	
	CALL	CLTOND
	CPI	ESC	;ESC TO ABORT ENTRY
	JRNZ	ELL1
	PUSH	H
;
ESCCAN:	POP	H	;RETURN ADDRESS
ESCCN1:	JMP	CANC3
;
ELL1:	CPI	08	;BACKSPACE
	JRNZ	DAT5	
	CALL	BAKSPC
	JRZ	ESCCN1
	JMPR	DAT1
;
DAT3:	CALL	INVALD
	JMPR	DAT1

DAT4:	DCX	H
	MOV	A,M
	CPI	30H
	INX	H
	JRZ	DAT3
	MOV	M,A
	DCX	H
	MVI	M,30H
	INX	H
	INX	H
	JMP	DATB
;
DAT5:	CPI	CR
	JRNZ	..Q1	
	BIT	0,B
	JRZ	DAT3
	JMPR	DAT4
..Q1:	CPI	30H
	JM	DAT3
	CPI	3AH
	JRNC	DAT3
	BIT	0,B
	CZ	CHK
	MOV	M,A
	INX	H
	MOV	C,A
	CALL	VALDSP
DATB:	MOV	A,B
	CPI	7
	JRNZ	DAT7	
	CALL	CHKMOS
	JRNC	..L1
	DCX	H
	CALL	CVRT
	JMPR	DAT6	
..L1:	CALL	BACKUP
	CALL	INVALD
	DCR	B
	JMPR	DAT1
;
DAT6:	PUSH	H
	LXI	H,DAY
	CALL	VALMSG
	POP	H
	JMPR	DAT10
;	
DAT7:	CPI	5
	JRNZ	DAT10
	CALL	CHKDAY
	JRC	DAT10	
	CALL	BACKUP
	CALL	INVALD
;
;
DAT10:	DCR	B
	MOV	A,B
	CPI	4
	JNZ	DAT1
;
;
DAT12:	PUSH	H
	LXI	H,HOURS
	CALL	VALMSG
	POP	H
	JMPR	TIM1+6
;
TIMXє	MVI	A,30H
	BIT	0,B
	JRNZ	..L1
	INX	H
	DCR	B
	JMPR	..L2
..L1:	DCШ	H
	MOЦ	A,M
	CPI	30H
	INX	H
	JRZ	TIM3
..L2:	MOV	M,A
	DCX	H
	MVI	M,30H
	INX	H
	INX	H
	JMP	TIMB
;
;
TIM1:	MOV	A,B
	CPI	5
	JNC	DAT1
	CALL	CONIN	
	CALL	CLTOND
	CPI	ESC	;ESC TO ABORT ENTRY
	JZ	ESCCAN
	CPI	8	;BACKSPACE	
	JNZ	TIM4	
TIM2:	CALL	BAKSPC
	JMPR	TIM1
;
TIM3:	CALL	INVALD
	JMPR	TIM1+6
;
TIM4:	CPI	ъщ0ф5тoмҐџЏ+—€|з1БРуИiЪвl„+—€|У8ж#1toџ6џ}6ХѕЯЅtе‘Џа<¦’=Џњ¦-Щ1\№Dд#XЯїл”Ўлы}п:m)џћGNУ–м®\"тu6‰Ў…­{ЇНg_…MХ•KD>‚Ож#1фѓ{ЇНg_…MХ•KD>‚ЧџПgиъ~яЬЧИїзcНЕwе‘ЏахЕ™2t}їоkдЯbџ©+—€|Пb†>o‹ыї–Nѕ;Ќњ¦ќ
{№r‰ИG0Э№^ђЎлы}я;=oPґtтЭйОµПѕ]№Dд#о\УНРхэNщѕ—=oPґtтЭйОµПѕ]№Dд#(Nъ7ЖРВћ—~'рФ|ъОШ»ь®\"т<O|{3фy[ф·чkйд»УИiЪ©°—+—€|ПgЯ}Юќо\ымЫ•KD>‚€уПѕqмќо\ымЫ•KD>‚а•АГР	<5џ/W.щ
LаaићљO‹ЊЂ®\"т<ц'р0tOН§Џ5Я•KD>‚йџ<вЌ:Ѓ§жУгIЯ•KD>‚P2їљ‰lѓх‰F"]№Dд#%у«‰Ў‘И†щ7Xџh$Т•KD>‚P2їљ‰lѓх‰F"]№Dд#Xд;Ѓ‡Ўxj>]ды№r‰ИGр<lH}цN}=,|-Ѕ'\№Dд#ЖyP0toџю№ќҐЮй[мхyf›Ў+—€|У8o@†Ncџю№ќҐ>W.щZX‡…ma}зч°р№r‰ИGPј1,dhсЖыЇ‡…П•KD>‚хэїg†®пчЯі+—€|У8ПќЖЫ§яћ]№Dд#(Юй0ґxгэЧ©Шg§яЋ+—€|-¬)C†¶°ѕу;ы,ыОвu†®\"т|2ыЪВъОпTмім;‹ЧY’\№Dд#ЉSmCЧ7^ъќЉ}–]mЬsе‘Џ`*N}џЎл/эNЕ>Л®п»r‰ИG°ѕ±яaиъЖKїS±ПІчяЗОа®\"т¬oєѕсТп=юІЗЫiЎ+—€|EЅ*]3E›|gя|\№Dд#XЯЯй0t}їwъ{}ћЩfиК%"AqТї1†цјф;Ѓ§жУwЖћ+—€|П«Ч>}^}їЇ}цэю;Х•KD>‚ucШuєnмхµПѕЯ§цDµTя»¬Ї3Ґ‰]№Dд#FM2toџ®йјЗ>ЇѕЯЧ>ы~яќкК%"Б“ЖµCџ—ц}ніпчЯ©=Q-ХяоллGibW.щ"О•%‰Ўщ€Fњ}u–$W.щ"О•!C#тЌ8ык]№Dд#XЯGT†®п7ўJc›{ў'vе‘Џ`Qъјъ~#Є4¶№'К’4±+—€|E®P0tН э3|-ќ|чПрхЯуx®\"тМ’”АГР	<5џО’дК%"Бx:Ѓ§жУєW.Їm~®Б5¬ђ¦иїr«nQЇTJЌЅфуйїзсєW®a…4Eя•kpMҐфзг‘Џа°0S†ѕ†а=їУR>-мyйwOНЗ•KD>‚)ЏTL:еЮ°!xПпґ”Oчд6MxІ+—€|џМю$ІaюЦ'‰tе‘ЏаЯй§)Cя|u–z§o±Чз™m†®\"тњwъiКРsю?ЯќҐЮй[мхyf›Ў+—€|чя©24|€Юя;ѓя№r‰ИGpЏџЉ)CпсЯЃыїNЕ>Л®п»r‰ИG°ЪёTL>DWч\№Dд#шчњЉ)CГ‡иїgW.щЋ'R1eиљҐЯЇ¦}ЅNЕ>KW.щZXS1ehл;їп,^gиК%"Aу‘R1ehуы}п:uе‘Џ щHiZfhуы-л»О®\"т4)MЪь~ЛzФЩ•KD>‚ж#Ґ)
C›ЯпRЯuvе‘Џ щHiџЎНпw©Gќ]№Dд#h>Rљ®ahуыЅ…8Л–тйtзЪзmбК%"Aу‘Т4*C›Яп-ДY¶”O§;ЧFыџ+—€|НGJУ(m~їЕю»Ґ|:Э№6вШя\№Dд#h~їBБРжч»fЉћKяХЮТ§Лхw†П•KD>‚хэ
C›Япrэ]3EПҐя\ѓG—Ч6?ЧаVHУ"V®aХ¦	K#_W©SѕпEя=ЏW№r+¤i+Ча¤|оэ—¦E]SѕпE[(eЧ@BО®Ѓ\™pvдК4б№ф_нџ;JФ5®Ѓ\™Рa6єЊ^zµҐ|ZЬЫ5ђ«ЂіСeфТ«-еУ~Ч@® ф#Њ.Ј#NяЬВЦ©k tЌ.Ј—^нџыј-є~ЧА-Дйџ»ю}~‹эwЛ¤wz"+5|O<1±kа\ъЇSбG–{"+5|O<1±k`КчЅЎиџ;JФ5®Ѓ ґїqШсvьµ+Ю®Ѓ©4,пёoЧАуR>В5p.эWе©/э|\лK?џ*П?;M]Нык…љб(цЯ=4яВ5ё¤	з–т№чo¤	gЧа*ЭяП#Же\ъЏQў®ТЅ…81.щJvМ д*Э	ю—€|гИІ+—sй?ЖЉxQёJ7нЏq9—ю#аКе\ъЏ®\ОҐяXФ_ЇпКе\ъЏ(Ђ+—sй?oMб\Т„sџ—ц°уЩя5Т„іkp=iьyДёњKяqaЎpеr.эЗ(®'ЃРю—sй?®Б5 M8чy[t>Ќ8цїFљpv®сзгr.эG”и
ЧѓШBњ—€|‹ъgPr=€ЊKD>‚EэХЖ5ІЛ®‘nгr.эЗш@oФВх @hЊЛ№фЧѓHҐгr.эGАх 
гr.эGАх ОK1.зТ,»r9—юг‚+—sй?хЧл»r9—юcyѓщZpеr.эG@’
Чађ&њ»>X_‹c±ЧхпЦFљpv®UФ?Џ—sй?в[(\№њKя1ѕk ґ?Же\ъЏЂkpHО]Ї—¬Tj¤	gЧаZЇфзгr.эGW.зТDqеr.эЗzюЪ•ЈЖ+
р»r9—юЈ(Ж_»…xЎp®iВ№л{УЖ±ПK{ШщмяiВЩ5ёЦйџGЊЛ№фP
W.зТ¤ВµNAh¬—sй? ґ?ЮB¬]|Ч:MҐл^ОҐя0А]ѓ+—Ч6?ЧаЉнqgгr.эGА•Л]“µњЊнс~›ЕЖВdЧ@єљПѕ
›jcыШ=ЏW{"н·{Шё'Ы|ubЧаzп:Ќq9—ю# IГ/^}}ѓх»Ю»Nb\ОҐя Cэ»ФєЮч®У—sй?’T0д#ЮqMа№л4Же<¦3Л?wсОsMCж—sй?’Tё¦RЉq9—ю#а\Cу~µnу«н\НщК5Же\ъЏЇ&c2ъd†–тiaПKїxj>}gм№^№Ъc\Оc:sЃЎЫВЖцxЯ5ёb{¤c\ОҐяшj2&G™lјљЊЙk39^|@бЉнqнгr.эЗW“19кdгХdL^ьЙЖ«Й7Щx5“сO6^MЖдЕf2йКе\ъЏЇ&cІlІЃµ0 ”(…сj2&ѓ“Ќ……‚!Ѓ§жУEѕџq¶lМЉ—]№Ь5YЛЙЭЯЮЇMыїощXsсб«µM‹byЂч›мКе®ЙZNnУ„§ЇФ¦	§|Я ґi›amУўЧ±рї3Щ•Л]“­њЬ¦Eз7F›ќм
уЇпЗёЬ5ЩКЙЭiд4mЧч'»"fнЏq9—юг«Й7Щx5“#“гЕ®€щџRЊЛ№фУ1†дКе®ЙVN>ЇѕЯщф†ҐћѕRяЬзэSљмљЇWsЊЛ№фУ1†дКе®ЙVNОЧ·ЦXOt&~я”Њ‰пsчњу7&І›a>oІ+¶Зx'Же\ъЏе]0t‘пЧ8voџЮй[м№r№kІ–“Ґэчм*Ю№«9Же®ЙZNоwN>ќa[§=ЩU‚wЊЛyLg–]№Ь5ЩКЙ±ЙtЕТRЊЛ№фУ1†/> pэпњ—»&[9ж¶N'»¦wNЊЛ]“­њ\Kхї{І+вќгrЧd+'7вШя&»ћwNЊЛ]“­њЬ}Ю“]Пxз,vёЬ5ЩКЙЭEѕЯdЧ:}зДёЬ5ЩКЙЭхЅйdЧаљЇЏ•c\ОҐяЋ1$W.wM¶rr:эs#ц№{ОщOvНЧЗb\ОҐяЋ1$єr№kІ•“Уйџ{ПщьЙ®Б•ЛaлwеТJЏЈ~lcс]№”[їлЪёrymууи®a…4-bеVДц±{Ї6Ћ=ѓ’фNеК5¬ђ¦E¬\ѓk °х»ФШ>vПгХЖ±gP’Ю©®Б5tГ'ыїнwн¬їлЯҐ¶°упёWQЇY1.з1ќ№а*к5ѓR¬—уОД·Р&щz%йќ–тй;cљ{XшЄлJь1.з1ќ№АР`}ўзRЧtт}2ш-|Хu.э”b\Оc:e@в‹КРШпwMз=ШucП5ёЮ›џ9Же<¦3¬Oф\j«xГ5з‚?Же<¦3ЛќЉ}vъпф•-ьпёљЏ”nгrУ™e†6џ}6ХNщѕ7®fсFЌq9ЏйМ†Ж^ъщt-тщ-ЮшЫХ,Ю1.з1ќ№АРШK?џљ[јс·«щLc\Оc:sЃЎ±—~>эОЙ§wJаЋэуq5џ;‹гrУ™e†Ж^ъщґ°зҐo3м+[шЯ©®ж#‹q9ЏйМ†–uКщч®ж#+ЗёњЗtжCc/э|ZЦхпуыК~Wу)ЕёњЗtжC—:е|„…ы?Wу)•c\Оc:sЃЎ±—~>]къчщ}eїkhшdїгGй№ф_н¬їлЯҐЮµwП#§i#дхJҐФ’=х»ЉzҐRЉq9ЏйМ2C[Ї±KќJiјN„яWљЭ@Ј7МзЮЈS±Џ+M‹†оrЈч«©Ї……fWљЭЌЮГВЧ8м
уІ…=ЛNаYєТґhиFiфNЕ>ЌГѕ 0/»'·iВ“]iZ4tЗoф®йд1ZІcфх °РмJУўЎ{MЈч°р5ыzPXhэуХ;эҐ+M‹†оЁЌЮ¦E'wOnУ„'·iВsюЛЮй/]iZ4tGiфЮя;ѓяхх °РмJУўЎ_Јw*цYv}їЇ……fWљЭС5z§bџeWчъzPXhvҐiСРЅЅбCфЯsнлAaЎЩ•¦ECчЬиЅЗ_цx[ґ…}=(,4»ТґhиNЌЮЦw~§bџe_
Н®4-єEЈч|¬№шрХЪ©ШgЩЧѓВBілф•ь1.з1ќYfhv–zъJµ-м”¤w\лыТ0ЗёњЗtf™ЎлыаХwЇҐ±Н®\Оc:іМРH“6МїxОѓ”¬O4Т¤®у™&шc\Оc:іМР)ѓрїУR>=џ·§-АіїНР5ё††Oц{ЎЬsйїЪ7XџwoЫВю…­ќЏxЗ5ё&р¤вДёњЗtf™ЎxОѓїS±ПNяќ®п»&рмяc\Оc:іМР	<зБЯыяcgрїNY<WД№¤aЋq9ЏйМ2C#ОѕШ z†F’T gIrMаIДёњЗtf™Ўxj> gh4 Iz–$ЧџЇќ~ЊЛyLg–ъз«іФ;}‹Ѕ>Пl3tќуЯйЗёњЗtf™Ўзьѕ;KЅУ·ШлуМ6CЧ{›wъ1.з1ќYfиaб«maпф-цъ<іНYvoc\Оc:іМР5Kї_MыzќЉ}vъпё¦вlqb\Оc:sЃЎS±ПNяќЮBњW«+M‹†6-Z §bџѕrµЯfШигIbWљmZt {" эзЛиф9яџп‰]З®П1.з1ќYfи±лпїзѕrµЯfиъч\c\Оc:і4Cя=чф•\я»Ї}b\Оc:sЎМРucЇЇ}цэю;µ‹wћлч°0Же<¦3ЛэЯ}еіO©лПg›_Kщф°рбР5ё†ћѕТњчЌнcч<^u®йЏ”EЊЛyLg–:eшO=}ҐNY<Чй+Н гrУ™У”dий+НyС3(IпёN_й‚±Ге<¦3ъКю·xиї¶ЪУWљAЙ5ё†ЫЦґll»зсЄkpuc/Же<¦3Л]7цzФїяkЫг}ЧъR‚?Же<¦3Л]_ъщtК ьпґ”O#жњїk…b‹гrУ™}eя;эsЧBСПг№V(ь‹.з1ќ№¶АР)ѓрїЕCKyсР5ѓPфЯуX[n/р»Bр®‹q9ЏйМ2CЧk§Ч?wЭШkЮТ0»"jЭШ‹q9ЏйМ2CЧk§Ч?wЭШkD•Ж6»Ћъч1.з1ќYfи Јtэы?WlЏю—уО\`иє±ЧхjЫг}Чяоъ§1.з1ќ№АРucЇлХv=XTАUФ«юiЊЛyLg.0tЭШлzµ…-lЅFЙ5O­4М1.з1ќYfh ої4z‘p
4zз©uэюТгrУ™e†ћѕТПр№ОзЏ‡-vёњЗtжЪCПЗљ‹_]јйс°7\xж7b\Оc:іМРуЈ6›ЗsЕтxШ€q9ЏйМ2CcyЂчлс°7\k1rљЖёњЗtf™ЎkaҐП‘УФжй+ЕёњЗtf™Ў±=Юo;CR
	JRZ	TIMX
..Q2:	CPI	30H	;KEY < 0 ?
	JM	TIM3
 	CPI	3AH	;> 9 ?
	JRNC	TIM3	
	BIT	0,B
	CZ	CHK
	MOV	M,A
	INX	H
	MOV	C,A
	CALL	VALDSP
TIMB:	MOV	A,B
	CPI	3
	JRNZ	TIM6
;
	CALL	CHKHRS
	JRC	TIM5	
	CALL	BACKUP
	CALL	INVALD
	DCR	B
	JMPR	TIM1
;
TIM5:	PUSH	H
	LXI	H,MIN
	CALL	VALMSG
	POP	H
	JMPR	TIM7
;
TIM6:	CPI	1
	JRNZ	TIM7
	CALL 	CHKMIN	;CHECK FOR VALID MINUTES
	JRC	TIM7	
	CALL	BACKUP
	CALL	INVALD
;	
TIM7:	DJNZ    TIM1
;
TIM8:	PUSH	H
	LXI	H,ESCAPE
	CALL	VALMSG
	POP	H
	CALL	CONIN
	ANI	0DFH
	CPI	ESC
	JZ 	CANC3
	CPI	8
	JRZ	..J1
;
	CPI	"S"
	JRZ	CHKYER
	JMPR	TIM8
;
..J1:	MVI	B,3
	DCX	H
	DCX	H
	PUSH	H
	LXI	H,CLRLIN
	CALL	VALMSG
	POP	H
	JMP	TIM5
;
CHKYER:	CALL	FINDAL
	PUSH	H
	POP	X
	LDA	PRSDAT+6
	MOV	C,A
	LXI	H,PRSDAT+3
	MOV	A,0(X)
	ANI	0FH
	MOV	B,M
	CMP	B
	JRZ	..J3
	JRNC	..OK
	JRC	..NOK
..J3:	DCX	H
	MOV	A,1(X)
	ANI	0FH
	MOV	B,M
	CMP	B
	JRZ	..J4
	JRNC	..OK
	JRC	..NOK
..J4:	DCX	H
	MOV	A,2(X)
	ANI	0FH
	MOV	B,M
	CMP	B
	JRZ	..OK
	JRNC	..OK
..NOK:	INR	C
..OK:	MOV	8(X),C
	RET
;
	.PAGE
;
;|----------------------|
;|			|
;|   MISC. ROUTINES	|
;|			|
;|----------------------|
;
;|-------------------------------------------|
;|   FILL AN ALARM MSSG/COMMAND WITH SPACES  |
;|-------------------------------------------|
;
CLEARMS:PUSH	B	;INSERT SPACES IN MEMORY
	PUSH	H	;NUMBER OF BYTES IN B
..L1:	MOV	A,M	;LOCATION IN HL
	CPI	ESC
	JRNZ	..L2
	LXI	D,4
	DAD	D
..L2:	MVI	M,SPC
	INX	H
	DJNZ	..L1
	POP	H
	POP	B
	RET
;
STRTYP:	CALL	FINDAL
	LXI	D,7
	DAD	D
	MOV	M,C	; SET ALARM TYPE
	RET
;
BAK:	MOV	A,B
	CPI	58	
	JZ	ES1
	CPI	29
	MVI	M,SPC	;ERASE CHAR.
	JRZ	BAKLIN	;BACKUP TO LINE ONE
	CALL	DOBIG
	CALL	BACKUP
	CALL	DOSMAL
	JMP	EL1
;
BAKLIN:	PUSH	H
	CALL	CLTOND
	LXI	H,LINUP
	CALL	VALMSG	;BACKUP TO LINE ONE AND ERASE
	MVI	C,SPC	;LAST CHARACTER
	CALL	DOBIG
	CALL	VALDSP
	MVI	C,8
	CALL	VALDSP
	CALL	DOSMAL
	POP	H
	XRA	A	;CLEAR CARRY
	LXI	D,5
	DSBC	D
	INR	B
	JMP	EL1
;
REDMSG:	LHLD	TIMFLG
	MVI	M,0
	LXI	H,POSMSG
	CALL	VALMSG	;POSITION CURSOR FOR MESSAGE
	CALL	FINMSG	;FIND CURRENT ALARM MESSAGE
	CALL	VALMSG
	CALL	DOSMAL	;AND DISPLAY
	LXI	H,SPLIT2
	JMP	VALMSG
;	
SHWALM:	LXI	H,SPLIT	
	CALL	VALMSG	; ELSE POSITION CURSOR FOR MESSAGE
	CALL	DOBIG	; SET TO DOUBLE WIDTH
	CALL	FINMSG	;GET MESSAGE AND DISPLAY
	CALL	VALMSG	
	CALL	GETTYP	; STORE ALARM TYPE IN DSPTYP
	CALL	DOSMAL
	LXI	H,RESCMS; PUT UP RESCHEDULE MSSG.
	JMP	VALMSG				
;
NG:	CALL	INVALD	
;
GETNUM:	LXI	H,WCHAM2
	CALL	VALMSG
	CALL	CONIN
	CPI	ESC	;GET A VALID ALARM NUMBER (1-6)
	JZ	ALARM1
	CPI	31H
	JM	..NG
	CPI	37H
	JRNC	..NG
	ANI	0FH
	STA	ALMNUM
	RET
;
..NG:	LHLD	TIMFLG
	MVI	M,0FFH
	CALL	INVALD
	LXI	H,REPICK
	CALL	VALMSG
	JMPR	GETNUM
;
CHK:	PUSH	B
	RRCR	B
	MOV	C,B	;CHECK FIRST INPUTTED DIGIT
	DCR	C	;OF MONTH,DAY,HOUR,OR MINUTE
	MVI	B,0
	PUSH	H	;FOR GREATER THAN LEGAL VALUE
	LXI	H,MAXTBL
	DAD	B	
	MOV	B,M
	POP	H
	CMP	B
	POP	B
	RC		;RETURN IF VALUE IS LESS THAN MAX
	DCR	B
	MVI	M,30H	;OTHERWISE MAKE THE FIRST DIGIT
	INX	H	;A ZERO AND THE INPUTTED DIGIT	
	RET		;BECOMES THE VALUE
;
;|----------------------------------|
;|  STORE ALARM TYPE (ASCII CHAR.)  |
;|    IN DSPTYP FOR DISPLAY	    |
;|----------------------------------|
GETTYP:	LDA	ALMTYP
	LXI	H,MSSG
	ORA	A
	JRZ	..J1
	CPI	1
	LXI	H,COMM
	JRZ	..J1
	LXI	H,IMM
..J1:	LXI	D,DSPTYP
	LXI	B,3
	LDIR
	RET
;
;|--------------------------------------|
;|  WRITE OUT ALARMS TO EXEC. MODULE	|
;|   BEFORE EXITING ALARM MODULE	|
;|--------------------------------------|
;			;WRITE ALARMS & MSSGS.
WRTVAL:	LHLD	SAVAUS
	SHLD	AUS
	LXI	H,BASE+800H	; HL = R/W ADDRESS
	LXI	B,401H	; WRITE 1 A.U. AT A.U. # 4
	MVI	A,2	; A = 2 = WRITE
	CALL	RWVAL1	;  WRITE DATA
	SUI	9	; IF = 9 THEN ERROR
	RET
;
DOSMAL:	PUSH	H	; SET CHAR. SIZE TO SINGLE WIDTH
	PUSH	B
	LXI	H,SML
	JMPR	DO
;
DOBIG:	PUSH	H	; SET CHAR. SIZE TO DOUBLE WIDTH
	PUSH	B
	LXI	H,BIG
DO:	CALL	VALMSG
	POP	B
	POP	H
	RET
;
CVRT:	MOV	C,M
	DCX	H
	MOV	A,M
	ANI	0FH	;CONVERT MONTH FROM 2 BYTES
	MOV	A,C	;INTO ONE
	JRZ	..L2	
	ADI	10
..L2:	MOV	M,A
	INX	H
	RET
;
;|----------------------------------------|
;|  DETERMINE WHICH ALARMS ARE AVAILABLE  |
;|----------------------------------------|
;
AVAL:	LXI	H,AVL1	
	CALL	FINDAV
	LXI	H,AVL6
	MVI	B,6
..L1:	MOV	A,B
	ORI	30H
	MOV	C,A
	MOV	A,M
	CPI	SPC
	JRZ	..L2
	MVI	C,SPC
..L2:	MOV	M,C
	DCX	H
	DCX	H
	DJNZ	..L1
	RET
;
;|----------------------------------------------|
;|   FIND WHICH ALARMS ARE AVAILABLE (NOT SET)	|
;|----------------------------------------------|
;
FINDAV:	MVI	B,12
	CALL	CLEARMS
	MVI	B,1	;FIND WHICH ALARMS ARE AVALIABLE
	LXI	D,ALM1
..L2:	XCHG
	MOV	A,M	;PUT NUMBER IN MEMORY IF IN USE
	XCHG
	CPI	0FFH
	MVI	A,SPC
	JRZ	..L1
	MOV	A,B
	ORI	30H
..L1:	MOV	M,A
	INX	H
	INX	H
	PUSH	H
	XCHG
	LXI	D,9	
	DAD	D
	XCHG
	POP	H
	INR	B
	MOV	A,B
	CPI	7
	JRC	..L2
	RET
;
;|----------------------------------------|
;|  FIND ADDRESS WHERE LENGTH OF CURRENT  |
;|    COMMAND LINE IS STORED		  |
;|-----------------------ЫЯТШfЧ
ЕџGЊЛyLg–Ч0tН эч<^Kщ4XЯйџб«®ШщЉq9ЏйМ2Cyќт}o(ZК§±=ЮoaлґmvЕцHрЗёњЗtf™ЎqШYкЅ—“kяЬзmС6¶Зы-lќ¶Н®Б5Р|цUШTЫЗоyјк\НGV^€q9ЏйМєљO©јгrУ™®хY9Же<¦3ЛЦ'ЪВ–м}2ш-|®хYЊЛyLg–]/+›нЏq9ЏйМІлeeу_€q9ЏйМІkp”Fѕ®RcыШ=ЏW]ѓkаЈ±}мћЗ«-ќ|wсОлџыЇ}ѓхчyч¶°wн_ј’kа>ЇaF,ыцќ>oмo±ЧW®цЫkЯ`эупTlh~KЧаzя“аЏq9ЏйМ†ѕуП§їЅЯq=Ї‚гЗёњЗtf™ЎqШYк№ф_нџЫь~K'Я=I”Ёk\Eќ¦[Дz9ЏйМ2C[§ќт}o(\'AЌ†µ\ЊЛyLg–zФhЁPEГЯлрр7~Фr®“ F[wТ—уО,34*4\№ћ5*TСрчZлбNк:	j4№u“ЖёњЗtжCЈBГ•лIPЈЎBЛ­CГ?©л$ЁСpсрЗёњЗtf™ЎQЎбКх$ЁСPЎЉ†їqсрЛE[зєютЎВnЊЛyLgў^k=ЬIzэhаµјррPчъxлрZ^xтE[‡ЧтЎBГЃ+.Ъ"гб_?Же<¦3Л®ёx“®…;iЊЛyLg–oТ^k=ЬIх$Иoќ+.Ю¤rл&Ќq9ЏйМ†ЖЕГ›ґеЦЎбџґQO2ЃјрЦ№ввMЉ‹‡?Же<¦3ЛЌ‹‡7iгвб—‹¶®QO2ЃјрЦ№®Џ+·о¤1.з1ќYfихЈбКхZлбNЪЁ'™@^xл\ЧЗ•“[7iЊЛyLg.0фъСpеZnюIх$Иoќлъёrёxшc\Оc:іМРлGГ•k\<ьrСЦ5кI&ђЮ:W\јIЧЗ•‹q9ЏйМ2CгвбMЪёлЇk\<ьёлЛзє>®~№—уО,3фъСpеїЬz‹ЊЧтЎBГЃлъёrС['гrУ™e†^?®\GoЭzrrxЁ[>Th8ри[Wnэµb\Оc:іМРлGГ•лхЧк‰pЧ[oв–\сЦЙ‡
1.з1ќYfhјuлў­лux‹‹¶Nn=Ф8p]‡+*4ДёњЗtf™ЎЧбЎ­Хёxшеў­kщPЎбАuЪZСгrУ™e†.чzтх:<ґµ:ЪврЦЎЙ­µkфЦЙ­эврb\Оc:іМРС[·ћ^G[Ю:4№хўЎn№µ_ћ«ёч'Же<¦3:]w‹{чвјZ]…=3(ЕёњЗtfyCЧtцOE{^ъщ”zџ·]ПKрЗёњЗtf™ЎM>пџR§ВпєДёњЗt¦ЁУjгдБпB‡ЮcдґїН°±—~>Х5U€q9ЏйLaПѓ_ћшmZ4t*^љ6цТП§єоЃ•c\Оc:SФiµqта‹wБ5U¬гrУ™Вћї<с]ѓkа/^Г'ы]ЫяоЪ7XЧїKmaяВЦОGјг\Eќ¦RЉq9ЏйМ2C[§LҐ4ћ+®гrУ™e†Ж•C“›·W\№rЊЛyLg–WMnЬ.»вК-ДёњЗtf™ЎqеРд&БнWьёrhr1.з1ќYfhьkЏЄСдWMnЬ–[o<ЧхqеРдb\Оc:іМРлгЎ­ХhrЌ+‡&7	nЛ­7ћл:\94№—уО,34.~№hлM®qеРд&Бm№х&АsEЌ+‡&гrУ™e†ЖaG“ЇЧB“Cky­ЅnЈЙ5®љЬ$ё-·Юx®зUЮ1.з1ќYfhЮу;ќҐ>Ї‚гч\ъЇцNЬc”ъј-\ѓkЭШkЊЛyLgў,0ф#§эm†BыkKщ4¶ЗыKl,ё&рњ—b\Оc:3~›дCKщфЩPд»wJЇVЧа*к4БгrУ™e†¶NуХЯЮ/ѓїSбЗ5Oн\ъ1.з1ќYfиъуЩжЧR>ќFNSЧљ Ё1.з1ќYfаdЧъR-1.з1ќYfаdЧЫВгrУ™e†жdЧЫВZb\Оc:іМАЙ®Е©1.з1ќYfаdЧвФ2гrУ™eNv®лгКЙkщb\Оc:s}\9Ьх&CЇW®е5‰|тб­s­Pl0Же<¦3Л®Љіoўsй\C›eэ;M{џ·]ѓ+—#'¦tЕ‹2G
ЧаКе<¦3Ј–]±=кџЖёњЗtfЩ•ЛyLgўDuµрЧ?Ќq9ЏйМІ+—уОD‰ОUФлї;Же<¦3Л®\Оc:sp}PЬgJt.]ѓ+—
WщoZЊЕ{vяpoBIOS25.HEX .         
 	  Пя№я Оя НяєяМя »я  јяЗяѕяКяИя ЅяЛя ЖяЙятяхя Еяoя  ья   ыя   ъя   Ся!    " шя# & $ ) % * ( - + ' , ±япяеяцячяжяяюря«яЈяЇя­яфя°яІящяґяіяёя¶яяяЮяM›f1Ла,?KeсЈiі\Wі¬,;+НтІиs&л,g9њEЏ3Yg±gЕY*+КўЛ™¬%7m~¤гLЦZІьЏ&]zЅк(Ху Еёf¶f¶Ю8б§љ¦НЏtЋм?rеЌУЅфRєT‰Т—Ц+™z_Ф\ZаoB’M›й”3ЩҐCоSINэЭшbк>‚зF}3ЎаZz5эaљ6?ТIdѓsІѓ-яOќЎ5]Бµt5.»О™¬5zҐЯґщ‘Ћt&‡хЋ-,}ЅpXїЎўZџЖ—ёЪcЌ'q+›6?ТщdЧZhьАХZhРбjIёZCCЗР ‡‹Яґщ‘Ћp&»Цkikгjэ,}ДёZ#}bЬСtK‹Т¦НЏtlЌ^ёљ`ЌХЭљѕ`K?Ќ^ёљ°ҐҐF/vУжG:кL6®F¶фjфВх?д©jфАs,рЉ{ЂKM›йЩйЯц‰3b†Rpq_°Fф]ЌО»z»ЕjЭ¦НЏtаL6X}·VНїн–Nъ,ъpXColњQґM›i™мZЦf\-SM$\MW°ҐKЈл[-ќц5m~¤5ОdkфВaэЖ®ЋаЪаЌф7ЮўПYb5ТЯУ(mЪьH«ИVЉќЫ„Ї±=ќQгdЧ АІўkЩљђњF›6?ТzОd]ќЮч@є\с|ш.W<„Gaѓ|фА.фР¦НЏґ$ЩССЃ€№ЯKіѕ№U@ГТЦ;тУ;ЈЋЮзЮґщ‘9“х^ЏXљхН–ц‘џЮй(ќћ#UУжGZ‚мЎ’ЕЎЂJOM(0·TІ4ЃЅrВљЖSM›iugІгпҐ5{@Нv ЦWіDМE,Нъжм¦НЏґ”м%@ГТЦ;кѓТІѓхО-—]ВЦш’мhЪЬРZgЪсЌLц”бLЦ3юvь¦НЏ‚ќЙZЛ	«µ2Xi­хf­х°Ц^kэXkI]‡lЪь(шИЦк]‹'єV—СµzЏ®ҐЋ®Ґ"єЦ^t-ї=MM›—3ЩZъў;“ҐБаWБўРGw¦}ІiуЈаDОde`pь`ниЅР‡њЙN†Ї?ыГVgІЗ™мM›{‚Ґ3Y—­ЧґщQ°$[K8BKЕћVЭћVk­оµ– =­w°ЦНvzM›“3YE&k[?ћ3Yk-•«ZќwµфvµМСµћlЪЬ"Xђ-+єЦ§-—¦е.›6їМcѓќiy:бЩЂ}Rю‰s9¶is§а®цFюАiУжGБКОdЏ–3Yk9“Ґ‡њЙN†Ї?ыГVgІI›6?
Ю±З™¬ЛFХ5tБuОdЌ®aЋЮяђWC8bndУжGБ`ы3H#э=Ќ7лЈYСµDЧєЧ0А5џС95m~эЖ®uщњЙѕL¶Зћі5бй‹‡чYг§Ь>б‘љ6?Љ>loGпијr=9чЅЮ^њЮРw1ЗиЇiуЈиilpЅЅ8ЅЎыµжљПи“&эЋ5Џ]—nнSњnУжGСЫGzёZ8†
F9ё®YѓktАµ€­¦НЏўя±5юмiPDч‘3Щкиs_‚4ТЯ+vІ5І7m~ќШ¦	VQ«UгLЦs®аџ]гgПYЄОXЪ*M›Eз±зњЙъ¬'\і¦Oџ>}‰»Єа*6R­ '4m~Ѕі­в‹љн`©@`#m)T0jЦаAMpmQУжGСcњЙѕHpёЦSѓЦJКЁЃQѓЖV4m~}Щ™мЧћkh‚kЦав%pНxxxf\,®iуЈPЏЅ\і	\ФРЇБэU&;jЦав%рњШ¦НЏBЏн=pЯсИ№°Ж¦РсmсvрЬ&pЯсЅJ‰љ6?
­±±CE%нбрФМQѓ>21jЦаТAУжGЎ‰н<0Ј	\C\јЬяЎяCћГЃяF5m~*З.йлh®x	<·
о;ѕ›Ы kl
[Г_4m~ъЩП-А}‡&cАэk‚C‹—А5«аба™ћљ6?
coЂ‹apН\Њо_R(Ј.Ю^йroЪь(”Щ–iЏ1bД€#оЖРЫ‡AаbHpяcЛЗM›…кШµѕxыv9“ЅС]ЊЖъЉ‘АкюХЅ¦НЏBѓнX-F«Ш>·|ЬW}5uЬWE­gµiуЈPЊ}д©uХАµжљаљПиr"Љ`бИdoУжGf»x;zяг{Е0Ц3¶рє,5ОXЗ‚QЈnЪь(bЖ¦	V±r=ґWьЅb¬ЁµРЋ¤‘юdУжGЕОdп‘†Љ=Ќ7л•мыCglC‘°7:ЎµЅ7m~сЖ™lТЋ8
-–о_“КU­•Бschс\ъPїisG&[І3ЩТWј
N(Ю їЇE"Bј¦НЏ"HШШЎ ђLп«иlYј]ы‡
¬i<ЦЁШ›ЈФґщQџ­ТHЇ8њѕУЬvtпXгa­/IЌЗ{Sы›6?ЉиВЦ;cT`-ЖЙsQ ЌфчЉCаЇф©LWўЮґщQdІП.ЮЋћюКх\<V=tЊ]Џ=–ц§•Ц‰№iуЈ€v‘gҐ_iъs!Aw–ц‰3B#эЅ9ђVъ{ўљ6?ЉхЩ5рз•dяљишююэjґгЧ„АЇЩВЇY.Щґ№{ВЖ_йЄ‰БяјтЈ&_«^¬ьM›ЕЦіk¶гя^Љ?Ј&ѕvgІЧ™мѕ‘*$~qач¦НЏbSШ`¬oи&Ў6]M~m	нйЖИдљ(|”Ь¦НЏbеі‡CБ_ы›хН„‚‡’DЧ«]bl1зLЦ=љ6?ЉэaП„‚µСcяц?д_л?·„дWл4¦ЧґщQ¬x6ѕЖ:]Eqь№}`нй+M©Ё-­9‚2ц№7m~ЛбL¶4Н­ўя?u†о©ЁТ`Љ­5ХlGйЇQІiуЈX}цџ=ф9gІћЩVaiJ¤с&ђоЎbnїVnУжG±ОdЯ‘_НvфZOM,XѓeмK/ґK9tЁMIы—ЯM›ЕвЩCћЪDQЫчMyЧ\\ЮЅ®®Z;j™~УжG‡=}ыЮѕї+ЌфеИЋљJ«OЈ4 7д8гнiЯkЪь(0Пю«dйУґVпЫУPДoG‡\ЧlGgЁ°,nЪь(PaОXKstиJ5–<д:CЄия‹(„
ЛГYhУжGЃчl¬Ґ9:tҐ«rќ!UфЎbгW'pќОҐ¦НЏ2l`_<}xСЎ+ПCw–ю“ЦC3Е«и+AsС›6?
Рі·ЈЏGЅ&ЌТАРќЖ›Ађ5K:М­ўk4m~aяУxPN±ћъ™l±„…ОmGя‹5Ґ‡ЮґщQ ?[;ц(МЁ9‚ОmGя«эc\ў¤Т©h0vЯФґщQ@Г®uЄЩЋ_:·„tЁыП…сk-ЏоUЊЏТ5m~Шgk€[©8їяЎ»љншsKшµюлX­'ђzoЪь(Ђ°+ЖЙµю5±а№QЯL(ё8 ®ЩЋ^1ц›mЪьh}ПЦ‡дљ‹ВЧ`«±=ц(дЭ*ъ
]џЖ›M›­'мЂћТНUҐ3ћ“Љ9gІћ	k•@ТPДog7m~ґNПF‡$ЧlG?вРЋЉ]цJЧђґцф‡RзЯґщСъ…}$_±Л^йJ¬=эЎzGп»мГaҐk(Ґе¦НЏЦяЩCеЉЎ$ЋJ‹]цбp8¬tU•¬27m~ґ¦°/“Mгb—}яюэ•®Ў“C“ЋlЌ›Ѕ1ъ"5m~ґжgGaThМнЎGЗЁР±7Fя"
VЎQ·7”РґщСє‡ЌVЎҐbЅ7ёХ4»Ёb©аю‡pывй4m~ґЋgл›ѕ
ццсFч0+xъ+xN*ёћЉ¦НЏЦ6ъКЅё=Е.{ҐkЁ¤цф‡fЉҐ‚ы?ЄmЪьhПП.vЩ-----------------|
;
FNDLEN:	LXI	H,LEN1
	LDA	ALMNUM
..L2:	DCR	A
	RZ	
	INX	H
	JMPR	..L2
;
;|----------------------------------------|
;|  FIND THE ADDRESS OF THE MSSG/COMMAND  |
;|   THAT CORRESPONDS TO AALMNUM	  |
;|----------------------------------------|
;
FINMSG:	LXI	H,MESS1
	LXI	D,MESLEN
	JMPR	FIND
;
;|-----------------------------------------|
;|  FIND THE ADDRESS OF THE DATE AND TIME  |
;|    THAT CORRESPONDS TO ALMNUM	   |
;|-----------------------------------------|
;
FINDAL:	LXI	H,ALM1
	LXI	D,9	;FIND THE DATE AND TIME
FIND:	LDA	ALMNUM	;FOR THE CURRENT ALARM
	DCR	A
	RZ
	MOV	B,A
..L1:	DAD	D
	DJNZ	..L1
	RET
;
;|-----------------------------------|
;|  FIND THE ALARM WHICH IS NEXT UP  |
;|-----------------------------------|
;
FNDNXT:	LXI	H,ALM1
	LXI	D,ALM2	;FIND THE NEXT EARLIEST ALARM
	CALL	CMPH
	LXI	D,ALM3
	CALL	CMPH
	LXI	D,ALM4
	CALL	CMPH
	LXI	D,ALM5
	CALL	CMPH
	LXI	D,ALM6
	CALL	CMPH
	PUSH	H
	LXI	D,ALM1
	XRA	A
	DSBC	D
	MVI	A,1
	JRZ	FINIS
	INR	A
	LXI	D,9
..L1:	DSBC	D
	JRZ	FINIS
	INR	A
	JMPR	..L1
FINIS:	POP	X
	STA	ALMNUM
	MOV	B,8(X)
	LDA	PRSDAT+6
	CMP	B
	RNZ
	PUSH	X
	POP	H
	JMP	SETALM
;
;|----------------------------------|
;|   CHECK A CHAR. FOR VALID VALUE  |
;|----------------------------------|
;
CHKMOS:	MVI	A,13
	MVI	D,9
	JMPR	CHKGEN
;
CHKHRS:	MVI	A,24
	JMPR	CHKGN1	
;
CHKMIN:	MVI	A,60
;
CHKGN1:	MVI	D,0
CHKGEN:	STA 	CHKCHG+1
	MOV	A,D	
	STA	CHKCG1+2
	PUSH	B
	DCX	H	;CHECK HOURS,MINUTES,OR MONTHS
	MOV	A,M	;FOR VALID INPUT
	DCX	H
	MOV 	B,M
	INX	H
	INX	H
	CALL	ASCBIN
	POP	B
CHKCG1:	ORA	A
	JRZ	NOGOOD	; OFFSET MODIFIABLE
	JM	NOGOOD
CHKCHG:	CPI	00	; VALUE MODIFIABLE
	STA	MONTH
	RC
;
NOGOOD:	XRA	A	
	RAL
	RET
;
	.PAGE
;
;|----------------------------------------|
;|  READ CMOS RAM TO GET CURRENT ALARM #  |
;|----------------------------------------|
;
REDNUM:	LXI	H,NUM	
	CALL	VALMSG
	CALL	CONIN	
	ANI	0FH
	STA	ALMNUM
	RET
;
;|-------------------------------------|
;|  READ CMOS RAM TO GET ALAR100 REM ***********************************************************************
110 REM *                                                                     *
120 REM * Name: PORTS                                                         *
130 REM * Rev.: 1.0                                                           *
140 REM * Date: June 10, 1982                                                 *
150 REM *                                                                     *
160 REM * Desc: Serial Port Parameter Setup Utility                           *
170 REM *                                                                     *
180 REM *                                                                     *
190 REM ***********************************************************************
200 ESC=27
210 WIDTH 100
220 HIGH$ = CHR$(ESC) + "U" + CHR$(34)
230 NORM$ = CHR$(ESC) + "U "
240 ULINE$ = CHR$(ESC) + "U" + "("
250 GRAPH A
260 PRINT CHR$(ESC);"S1";"         ATTACHE";CHR$(ESC);"S0";CHR$(ESC);"U0";"tm  ";CHR$(ESC);"U ";"SERIAL PORT SETUP UTILITY"
270 PRINT "                   COPYRIGHT 1982  OTRONA CORP., BOULDER, CO"
280 GRAPH L(6,1): PRINT ULINE$;"Serial Port Function";NORM$
290 GRAPH L(6,31): PRINT "[default]"
300 GRAPH L(6,50): PRINT ULINE$;"Function Options";NORM$
320 GRAPH L(8,1): PRINT "Port Selection:                                    "
330 GRAPH L(8,33): PRINT "[ C ]        Options:  (C)omm, (P)rinter"
340 GRAPH L(8,17): INPUT A$
350 IF LEN (A$) = 0 THEN PORT% = 241: GOTO 390
360 IF A$ <> "C" AND A$ <> "c" AND A$ <> "P" AND A$ <> "p" THEN 320
370 IF A$ = "C" OR A$ = "c" THEN PORT% = 241
380 IF A$ = "P" OR A$ = "p" THEN PORT% = 243
390 OUT PORT%,0
400 OUT PORT%,0 : OUT PORT%,216
410 GRAPH L(10,1): PRINT "Number of Stop Bits:                              "
420 GRAPH L(10,33): PRINT "[ 1 ]        Options:  1, 1.5, 2"
430 GRAPH L(10,22): INPUT A$
440 IF LEN (A$) = 0 THEN CTRL% = 4: GOTO 500
450 STBITS = VAL (A$)
460 IF STBITS <> 1 AND STBITS <> 1.5 AND STBITS <> 2 THEN GOTO 410
470 IF STBITS = 1 THEN CTRL% = 4 : GOTO 500
480 IF STBITS = 1.5 THEN CTRL% = 8 : GOTO 500
490 IF STBITS = 2 THEN CTRL% = 12: GOTO 500
500 GRAPH L(12,1): PRINT "Parity Useage:                                    "
510 GRAPH L(12,33): PRINT "[ N ]        Options:  (N)one, (E)ven, (O)dd"
520 GRAPH L(12,16): INPUT A$
530 IF LEN (A$) = 0 THEN GOTO 580
540 IF A$ <> "N" AND A$ <> "n" AND A$ <> "E" AND A$ <> "e" AND A$ <> "O" AND A$ <> "o" THEN GOTO 500
550 IF A$ = "N" OR A$ = "n" THEN GOTO 580
560 IF A$ = "E" OR A$ = "e" THEN CTRL%=CTRL%+3 : GOTO 580
570 IF A$ = "O" OR A$ = "o" THEN CTRL%=CTRL%+1 : GOTO 580
580 OUT PORT%,4 : OUT PORT%,CTRL%+64
590 OUT PORT%,1 : OUT PORT%,96
600 GRAPH L(14,1): PRINT "Number of Data Bits:                              "
610 GRAPH L(14,33): PRINT "[ 8 ]        Options:  7, 8"
620 GRAPH L(14,22): INPUT A$
630 IF LEN (A$) = 0 THEN CTRL% = 192: GOTO 680
640 IF A$ <> "7" AND A$ <> "8" THEN 600
650 BITS% = VAL (A$)
660 IF BITS% = 7 THEN CTRL% = 64 : GOTO 680
670 IFчпЯ_й:®Є=GЎўЈVNВNУґщСЮ…}Zk«Ё=GЎўЈЋјµз(\tЬСюЪs.ЬґщС^=;:nҐO©Pб5k<¬Ѕ­‡uZн_hпb*~УжG{)lќ‡µЖГъ“’ЖгЅф>щыыыkИЪыґТ°›6?Ъ“ПVYЖѓео©фOРzXгХ*PQЊ(€вюvљ6?ЪыaѓУЗ№єЏ|мљюАQ ЪNQаZAQаЪN]›6?ЪПЋ«ш[У?ЮT­Б€‚ЁўА>ђЧПnЪьhЏГЮHзT«®ЭЉopХоЏЧкЏЧоЏ7m~ґ§ПЏ7©@mьк®[F&ыХ5ь‚СхЕЫ§с_пM›нEШ;ЕІѓыЧ‘єҐЅ‹/°Ч‡ь‹яwЎЪ«хЅmЪьhПЦєЩщbҐґІЁJ;“vЉ¬y(оkНKM›н8l°ЖЫFЌмаЅ8=Є†_0nгчО`t]6m~ґ3П>й+юЦ.яђпТЏ” ЧQ»^мЖ+Q»$›6?Ъ©°W$ЉяЃ7ѕшЉMІњtoјЗPQь¬ТW©iуЈќчl%FНаZs‚Љв_аюХµ¬Q»_KЈ°µ ¦НЏvdШQ»?Vў°*†?Ѓ‹9УГyT.IЁшўRУжG;фllr–^YHїшЬ­в¬i<©шX»ьа¦НЏvDШCѕyуjЃ®`уNсpяcуЧђЭ5_ЂеЧкhЪьh§?›nУH[ЛјѓuЊэFЪZж¬yњґш?pъјM›нhШЕџАќЖх‹їcпЏзПЪџv4ўцs
ЮФґщСО>ы}KџЖЧХZоQ»QШ9NБK±Gcгб¦НЏvц;Gw?ц–яИTZу	,ЎсiGЛ»ѓЮґщСЦ=л?ѕ+о kOм?з‚Фґ‡®u·ѓµPfmЪьhkВNb	л®L·	kU~iцVщЧ&мсшЁш'рlУжG[йЩ#н™O`ЌO;ow4°KџVµоv°GcQM›mЅ°!ж„‚Ё©аV0ъСцЉ!ч
мЅт‹}*›6?ЪъПћяИсEИrС¶^ЩШ7W‡пяpТ>сцх¦НЏ¶(м©'чв©шbе‡–o§ЦUу:ёЦ{4ІЦWуzlУжG[ьlр°,рЊ|а™H`FЌ$р°ьа)А3!БGwM›mх°µћЈ ZGНл`­›F-BгПєЦЭNmяM›mЕs&{ъ?BТшґZ«їжЯцЈЭZъGшцю№Р­¦НЏ¶6њЙ>[;щ|цясђЋў4:пўkЭн€ФґщС&?[CoчїЦsФ…ЖээsЗPџҐ}їцж€щ‰¦НЏ6]ШµWG,‹?ЃУ/ю	ЬiHЖ¦nУм}їO5џћ›6?ЪTПќ(юNїш?p'е»ќСЪЈ:I7Н:“ќКM›mJaЄщЦтояk—И7iRmBWЊy§шЏFУжG›діБэЏП;ЊЩБZСчЉKЊґg>Ѓ5*љ6?ЪфГюґstWь	њ~сOаN:У7i°ЬЇсЯЋ–w‡СґщС&сlм’ЦЭЋhя¦ш8эвяАВC~¬ыЕoЪьh‡}tЎµяиЁш8эвяАВC8IйkРЫдhЪьh“>»Ц|дРРї¤u·Ј1}ЕЁЦЄuіSkqсdУжG›"мZУ^­я®ЦэhЈцдСЉZїЈ}ь–Ћкљ6?Ъ„g‡Ф€·t§‘Й^ТшoGЛ»Sщ5АZшM›нsШw;µА‘ЏQC>BНiЃ5нЎ-Џ|§бiЪьhЯ<ынN-Pу|ЛЁщЦто|rњ~саN=5m~ґЇВ?ЮWьёУђуxЯ§љO`	ЌO;?jѓC›6?Ъ—Й¶k]Z7;µАR±`0PѕЫ‘ш"дX~-ч¦НЏцЙ°wѕ9®щ	\k©uіуEИсЬOа$§юћъџ§iуЈ}фl­_›ѕP9^Yдяю+эышї?чьwе]џяW4m~ґO„}дэbҐ+БТћ»Ѓґш[уЦєЫ)ю^№p4m~ґЇ?;э/B–‡<µзољаЈе/°Ч‡ц…ѓпv
M›нУ°±ПcKэKZчv0w;йwъTvХ|іhЪьhЯ>{Ґiъµд#ЏцВљюв-энюяhф‹љLvУжGыцяа#ЦвяБ]Њэj}Z7;µЧ»‚Ф·Oг‚¶iуЈ•чм{z”v4&нщ­щ¬сvGлЮNсл`–M›­њ°±Ћ/Ж5 |FНлаЈХљLцтQЃЎэЭђ/Ґ¦НЏV¦g—ЦИюВ0VЄkdЃkЌ#у+sІА]ю/ЈiуЈ•/мЪіЦНО†±R]#?ёц2Щ„ыbeaN~p—<M›­ьПюїшupяcKЌ—¶kЭнTЊэ4Tl?В«ы	ЩґщСJ
»ЦI‹k«bмTлw9—ЙЮЩWЎ,д
-±ЫУЌ6m~ґ’џ­С‡ѕТЂ,П яы|¶ДЦ5§РЪK2љ6?ZЩГЦєЩ)>…¦я…1]лng®X{’Ы‡»Б+›6?ZП»ю№ѕШђШ^oh©цЮQPн¬8°Љ•XѓЄiуЈ•v9ШТNУ[Мtѓk=5}АG{sSxw5ЯM›нчіс4кцЏs' _ф?д«45uдќіА»L¶ДыўiуЈэ¶FЭю±iо э»хї
FGpmAE<K—ч¦НЏцЧі{б°Ю±їҐ“F/Ц/N]Г\ЬЬВђСґщСюОdЯvKі>ЌЗых”О —ЙtъФЯю•¦’ЊІiуЈэтЩc?}ё#—F/\Ц{ъWYѕ№~ґчРґщСюvъэ%я–РшґувG)цhмcјOџЖuhУжGыЕі—фв_Є=к<цњґП»ІM	оhRъ‚›6?ЪПaя–РшґувGяcOнQЕысфi\_Т‹ымiЪьhї>ыqяcOнQЕыз]Щ5юЫiяЂTKЬЌ3Yџ ¦НЏцGШ»	ъ6¤рb7ЮќЎпфґolHбЕn<q†є7m~ґПЮxBЕHµДЭ8“ќRні7“ЭIiC
/vгќw¶iуЈ%‡Ѕ«}cC
/vг	нNGы?CЄЯяRэ`™Р·iуЈҐyц>}е%Ѕ=нЛЪ·{3YЗ»№c€}ъјШЌ>_›6?ZЄ°7xфњц6ћрb7z©(юо
ѕЫJЮ—ТW‰¦НЏ–ЮіW~ТйУJяф±юCW*Aѓчя:iч?CУљ6?Z’akяџµыџAµЅЭ?ќъki:Zэ¤ ЅiуЈ%zvъїуїя~чћьZжќ=­»ќђcннн…Я›6?Za?њґз~џP1ч.™М°tљъя­Ѕ_уЯqУжGKэЩаљ/БµЧkюЧ&Ф|ЧъЋњ5џБsїWjЪьhIГ[љяџ:CUМ}ѓпиЃЏ,зиЃпѕБѕ{ПM›-нs&лЌnь–5њ‚kYFнЦЮЏВО9“µV"ї¦НЏ–ц–hс'pъЕяЃ…•Тя±тPЉ=ы#›6?ZqПЦ§µ_пјP±oо:ДМ#pнTНK+Ћ¬ыж(љ6?Z1aџЂy®ќ^уТ
†ЖчЉЅ}? Хы4>ЇiЪьhEzцЮЏ§Q»ГЏАЕяАЪетMЯ§A}EнXг;~УжG+^Ш+вцвэЂ\KмУшјbпЗУ=-к+жЋ ,_B4m~ґв?ыя©3TEФоЧ
Л/vоbѓ§У]…е3х¦НЏVPШї{±\ќЖи*Ље§_,X8”°ќ1,<©iуЈьмЌЧеoј	%o/ћYN„я·ыSм.ёiуЈ=мZћљя—kЃяk2ЩЛSяOMэПЁAаkЫ‡ХM›­€gЛkp,ЧDkTlЇ	.–¬qі}X>°ч¦НЏVlШЛ^cџ†kыћFЕцљ p±ьаф‹Ґ ч?DІiуЈe?»Tёhє*bYгчeIЛ]—З b~яCЮqУжGЛ6ЈЃ_Ф@аЧ гЕ•Ц р‹AшG‹вHM›-ЧіѓБ+ќЖчЉЈѓW:y5~_Ц@,kHZЦиzўiуЈецтTЕп_]ВЇЙd/Чц©щ№ЉЇвMM›-ЛgгЋ‚‹ЎшэCаЏ}ѓчЅШЌO}6ѕPQBhУжGЛ?lpBqXЦ)tЯr±`Ќ›нQ»ЕБа•.EУжGЛвЩ!]CЖFКdя9ьї'язСn>Јя_N_EwУжGЛ¶FJЫµЪнЖJяљ`°Љв p§±cЯїiуЈe}vЪйщ¦я_LэпTЬiИПIюЫїRь¦НЏ–#м
e™–+юgЁ(Ћ^й2фҐrwя/O№iуЈe<[»зЊюї^©
/\<Xй¤ћѓАя‚еяS)5m~ґЭaяSQ,?Xеy0ЦО«=э±Gы®ц‚%аДФґщСцy¶Jф"t•~†a$s
Ж#cЏЉ<*—ъй©ЁЯґщСц
ыЗJhO†Ўв‡їїяКЈф‹ѓБ+чwп©(~ЅiуЈнпЩя¶Чѓ5ЊнQ»ГІА)mЇщ·]Јb{ъ^YM›m—ac7>iЧїс…Љ9а‰Їщ§TЛoјЩґщСvz¶|ащАЇdЃUЛЮH]
рЊаЌTтѓ!›6?Ъ.ВV1,јoF>°†ЉнГ‘АыfдkЁШѕ7#kSУжGЫыіБ3тЃ5^Ъ^\#?XCЕцЅY`тц}#›6?Ъ®a3jдЂ7Ю”ќJ5юЫѕ]ѓ°}ЈXx#MщiУжGЫч9“эґ+4юЫѕЏQ,јсfЇИ·=MкЇЮ‚gДoЪьh;В~
ћ“ѕ“\dЮ®=эѓvВђG»b&ЅХM›­Юі“XЭ>уvuFЦЄцјЪ«!OнхйUњцфI6m~ґ:aЧNyj§Ч¤ї*-…цRн3ТаOэ†Fх‡lЪьh5=[xjFxXјсъSpяoКЮЌЧЯ‚OltmЪьhх…эєьа«ЌWтѓg¤Б/mЧs?
пНИЮ›!mЪьhх?[X…еСI[џҐџѕПQ»>lcг‹3tгў¦НЏV)мП*Зплќ·.]yx_пјV1Ь	<У%§wnЪьh•џ·W'ШOЮ#шoI»¦xЋь·¤jЪьhµ‡]УxоjcЯF
CГXМy@Еј`н	cПM›­Жі§¦4д,5tБ5фѓkdЂktАѓЮав^в7m~ґєaѓkБЕ=ЃkИБsЏ<ЊюБ3,‚UhЁ\=mЪьhГПFХ‰‡LцйЕнmьЮ%]E-P#Њ®a,Љ‡љ6?Ъё°ыЧр‚з,Arµ@эа№ъcћ…oь®iуЈЌzці†ЉЅ3єF§…ЗBгПBгЗBѓЮBCѕEЪ¦НЏ6RШиЕ$ѓ±sC3oЦэY±CGШвІ?vДЉ¦НЏ6діЛWZћЌ•lє"|млeTЙ`­€EИтsУжG?мыЖжвр@CNKѕEЕ\_рШя/цЂmЪьhC<[©фИїb|ч·Ґ
<Ќ'q8<Ќи»8­N‹Ю›6?Ъа°+жФа±я_¬ЎTzд_1ѕя·Ґ
<	њё¦НЏ6фЩ8<фЭ№}x‚цpZ‹ЉсTqр0ҐаsУжG™lgІПp&[”bэЖNsќрxы4ѕДнНP
Цф®iуЈ<{§хЯўblЎБЃГљ•JЏ,*Ж†®є¦НЏv¶R…NгЗBKo·blЎС‡5+•YjФ4m~ґ;По‡л_©BгNѓЮB«уо\э±ПbN~ђ†Њ¦НЏv+l9-жНdїxъ†?ЃпЖгы4опGЗ†bЕ6m~ґыћ=W¬Бі;@яbЛcOн8ACЕЮфґ*Д4m~ґ+ГЮ»хшЉ]*ц¦§=CL]Њ1ц~tlahСґщС.=›Г;ЦP±7wэ»…-Џ=µг{УУтkЪьhW„­ЎbП7piЁШ›ћц±§БіЁjxѓkиkoЪьh·?;X/nO…F?Ь-Ю‘џоЙ?БТћK‡'ЭґщС®†3Щ•ъЯ•Яђю_Lmp©XyрччџQлЇбkЪьh3ЩПюіЧяg­?{–fЌ^8<KwЌ^8=-?М\ЧйM›н"l<K?}–®я§ОР;«}BпЊQaй™;iЯэЯґщСвћ}СяР%}ыјjЌ4‹Ѕ}ЮµFљЕћЮиycЈiуЈЕ„­BЯ>ЇZгХboџw­сj±§7zЮPЎсiЫґщС"=ыGїЁ]6aыFџћн*4>ньиµлГ>§ЧґщСв…Ѕ}ЈЧvZйпwЂWъжкKqG‹wtZЬ|ЫґщСв?{®~’wўрЋо48psхЯYjфГНХ—ѕ{_VУжG
Ї<ћnИ)}r‚ҐЅЭBKОB;t¦^УжG~ОdљГвkЙYМХ/hр,ЉХа#‹№ъ•4x&љ6?Zф°Е}БҐЮrH3Xua=©,NяlyмсЮ4m~ґ€gЏ5Tм%ТR±‡bФРФрЧиЂСпМћћљ6?ZlШ1°†,ШТ®хhlА:]А–®O°№M›Б~6<‡„^ь~°–=ѕCЅз№U|KлсКна¦НЏа»oЯсх©«3Тњ“}ўшэаюkmuсЫmЎiу BITS% = 8 THEN CTRL% = 192
680 OUT PORT%,3 : OUT PORT%,CTRL%+1
690 OUT PORT%,5 : OUT PORT%,CTRL%/2+138
700 GRAPH L(20,1): PRINT "More changes:                                     "
710 GRAPH L(20,33): PRINT "[ N ]        Options: N, Y"
720 GRAPH L(20,15): INPUT A$
730 IF LEN (A$) = 0 THEN SYSTEM
740 IF A$ <> "Y" AND A$ <>"y" THEN GOTO 700
750 RUN
s: N, Y"
720 GRAPH L(20UUENCODEEXE           ЊЉ/q?`9  GWBASIC EXE            Iy?Р: USQ     EXE           ч№Ў? >  PKUNZIP1EXE           @	o©?и[  ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее100 REM ***********************************************************************
110 REM *                                                                     *
120 REM * Name: TIME                                                          *
130 REM * Rev.: 1.0                                                           *
140 REM * Date: May 14, 1982                                                  *
150 REM *                                                                     *
160 REM * Desc: Access and display system time:  example program              *
170 REM *                                                                     *
180 REM *                                                                     *
190 REM ***********************************************************************
200 PRINT CHR$(27);">"
210 SEC$ = INKEY$
220 TSEC$ = INKEY$
230 MIN$ = INKEY$
240 TMIN$ = INKEY$
250 HRS$ = INKEY$
260 THRS$ = INKEY$
270 TIME$ = THRS$ + HRS$ + ":" + TMIN$ + MIN$ + ":" + TSEC$ + SEC$
280 PRINT CHR$(26)
290 PRINT "The current time is: ";TIME$
300 SYSTEM
RS$ + HRS$ + ":" + TMIN$ + MIN$ + ":" + TSEC$ + SEC$
280 PA;B;яяD;E;F;G;H;I;J;K;L;M;N;O;P;Q;R;S;T;яяяяW;X;Y;Z;[;\;];^;_;`;g;b;c;d;e;f;яяh;i;j;k;l;m;o;„;p;q;r;s;t;u;v;w;x;y;z;{;|;};~;;Ђ;Ѓ;‚;ѓ;…;‘;‡;Лx€;‰;Љ;‹;Њ;Ќ;Ћ;Џ;ђ;яяoL“;”;•;–;—;;™;љ;›;њ;г@X<с; ;Ў;ў;Ј;¤;Ґ;¦;§;Ё;©;Є;«;¬;­;®;Ї;°;±;І;і;ґ;µ;¶;·;ё;№;є;»;ј;Ѕ;ѕ;ї;А;Б;В;Г;Д;Е;Ж;З;И;Й;К;Л;М;Н;О;П;Р;С;Т;У;Ф;Х;Ц;Ч;Ш;Щ;Ъ;яяµ?Э;Ю;Я;а;б;в;г;яяе;ж;яяи;й;к;яям;н;о;п;р;яят;у;ф;х;ц;ч;ш;щ;яяяяь;э; <  яяееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;** TIME AND DATE SETTING PROGRAM **
	.LOC 	100H
	.PABS
	.PHEX
CONIN	=	6
CONOUT	=	9
DPIOB	=	0FAH
DPIOA	=	0F8H
SPIOA	=	0F9H
SPIOB	=	0FBH
J	=	4AH
K	=	4BH
U	=	55H
CR	=	0DH
LF	=	0AH
RVLF	=	0BH
ESC	=	1BH 
DSKFLG	=	0DA82H
TIMFLG	=	0DAADH
;
	JMP	START
;
DAYTBL:	.BYTE	32,29,32,31,32,31,32,32,31,32,31,32
;
BAKSEQ:	.BYTE	CR,RVLF+80H
SIGNON: .BYTE	ESC,5CH,ESC,"S","1"
	.ASCII	'    ATTACHE'
	.BYTE	ESC,"S","0",ESC,U,30H,"t","m",ESC,U,20H
	.ASCII	' DATE AND TIME UTILITY VERSION 1.8'	
	.BYTE	LF,CR
	.ASCII	'             COPYRIGHT 1982 OTRONA CORP., BOULDER, CO'
	.BYTE	CR,LF,LF,LF,ESC,U,24H
	.ASCII	'OPTIONS:'
	.BYTE	ESC,U,20H,CR,LF,LF
	.ASCII	' SET TIME    '
	.BYTE	ESC,U,24H,"T",ESC,U,20H,CR,LF
	.ASCII	' SET DATE    '
	.BYTE	ESC,U,24H,"D",ESC,U,20H,CR,LF
	.ASCII	' EXIT OPT    '
	.BYTE	ESC,U,24H,"E","S","C",ESC,U,20H,CR,LF
	.ASCII	' 0R PROG.'
OPTON:	.BYTE	ESC,"=",2BH,20H,ESC,"J"
	.ASCIS	' OPTION      '
;
HOURS:	.BYTE	ESC,"=",2DH,20H
	.ASCII	'ENTER TIME :'	
	.BYTE	CR,LF,LF	
	.ASCIS	'HRS (00-23): '	
;
MIN:	.BYTE	ESC,"=",30H,20H
	.ASCIS	'MIN (00-59): '
;
YRS:	.BYTE	ESC,"=",2DH,20H
	.ASCII	'ENTER DATE :'	
	.BYTE	CR,LF,LF
	.ASCIS	'YRS (00-99): '
;
MON:	.BYTE	ESC,"=",30H,20H
	.ASCIS	'MOS (01-12): '
;
DAY:	.BYTE	ESC,"=",31H,20H
	.ASCIS	'DAY (01-31): '
;
WEK:	.BYTE	ESC,"=",32H,20H
	.ASCII	'WEEK  (1-7): '
	.BYTE	ESC,"=",33H,20H	
	.ASCII	' DAY'	
	.BYTE	ESC,"=",32H,0ADH
;			
ESCAPE:	.BYTE	CR,LF,LF,LF
	.ASCII	'PRESS RETURN TO'
	.BYTE	CR,LF
	.ASCII	'ENTER, ESCAPE TO'
	.BYTE	CR,LF
	.ASCIS 	'CANCEL ENTRY   '
STATUS:	.BYTE	ESC,"=",24H,38H,ESC,U,26H
	.ASCII	'             CURRENT STATUS             '
	.BYTE	ESC,U,22H,ESC,"=",25H,38H
	.ASCII	'   HRS. MINS.   YRS MOS DAYS DAY OF WEEK'
	.BYTE	ESC,U,0A0H
NOTIME:	.BYTE	ESC,U,22H,ESC,"=",26H,38H	
	.ASCII	'  TIME NOT SET  '
	.BYTE	ESC,U,0A0H
NODATE:	.BYTE	ESC,U,22H,ESC,"=",26H,48H
	.ASCII	'      DATE NOT SET      '
	.BYTE	ESC,U,0A0H
CURTM1:	.BYTE	ESC,U,22H,ESC,"=",26H,38H
CURTIM:	.ASCII	'                '
	.BYTE	ESC,U,0#ёћ3Y«хiРВzsгL¶ѕZ«p‚ҐЅ‘жДv=GmЯ¦НЏаОdџТ‘–Ґ]лТШЂЗ)оМЌђ°–gѓQ#eУжG°|ц{зsщњЙѕZЧ\Т77†j\Dп_§‹Ґ¦НЏа6OГЂгъ2ќюЋµЗMЏwз-cп5m~‹gч?vЭ!ЎыО™мЌоZ_Н§BC?<]oЪьж°5ТЯУxіЦP№Єµ2XC?<зЎ‘юћЖ›u§¦НЏ`}ц‘ЁЪt5q №® ­фчj=GћZ^­№жіrУжGp„Ќ^л«aЂq>gІonХє€>gЏkbАµ.С›6?‚смљ(°ѕ}“p{ыjќjаZsНgtџ3ЩW,№iу#њГЋk\DЯУл_нґ}.
\Oiыќ3Щtв(Т\iУжGёy6ъ§ю‹Я2х?цhOќi§’мИcIїiу#\…3YKK1bDКdЗќЩf”тЯxѓI„;ЎТ3ъю‹’M›бЮіUФфгщыыы[љ5€q8KчЈ™љ°ҐЯKM›бdШGЧkФ`KЛЈK5=А–GKя#KУ‘_Џ¦НЏpфм=°ҐW„ch¬qџЈ@^рпђЭZЛ8сљ6?В‰p&ыaЮgh¬qџЈ@^p-УQ…ҐйИcйЇЄhЪьЧџЌ«54ЦёПQ /шwИћЋО~чkЌuяM›б4lЬз(ђ\ЛєсЕКАЖСAйќЅ–
”tУжGё}цFєЌ/Tl|±2°сE-{г‹O+~чї8ЩґщaЇ,†a<ЁHґТxяУJГЯЯЯїЏЉЌ_ќВM›aоЩа:`_<}xsэгэнИїЮШiJCР^tpM›a&lня+Bч ч?d9L)XCРћҐEt°їбEУжGфlнµQаZ 
|^ЊґS\&[BћHІЬ?ґiу#М{hЮШз±З’	ыwм±ґbIЗЛ+,ЕXј¦НЏ0я9“=–NXЪ±ЗТK{,ЏґЉБэхЮґщ†ВѕфEHСБ<мхІyо$юГIыДЯЈ›b=p]УжG~vяџ†Ь±тЉь±їczВ¬h‰‡ъ„EЊoЉЯ5m~„йa3‚ыІФ0‚Џо1jфАGHXмшЉQГHСґщ&ћ\¬ФиЃ-ЅД8-A(,0®W¬оџўiу#М†­гB*¦Nї&ё;эb~БЭйЛо2Х~nЪьеg5TБZ.$FUp±р eсPш«Z"иљ6?B]Ш«XиШQФ°ћsAjЪ;’‹>ѕ©хЈЯґщЄћ…+fCћЈpµг	рС«ф‹ЙБэJДnЪь•В®јRzм_{§AЊ:ЄАЋЗЋZwb–№iу#”|цХё\+|›<*ЊU;ХљЏўcЈ¦љ6?Bэ°ЗNµзЈЁZCѓuдХи©XtрКѓVпHB›6?B‰gkфЋ4М"xъ‹аЇэЌ“уЦюї*юЄҐaСґщЉГЦи…ГCХс4мэШ‚ЮPНЬфпJcъЯsУжG(}цђGҐyҐСiИ/F&¤ЈУйѕ›іw¤`™ђnљ6?BEШгіЖээѕ“7sЁw¤Ўя‹ю+¦
о_g…УжG(<SL?ёя!FopэабPрЧюЖ–µXЌє¦НЏђцџЅ©й3Ўав#hяCГ5GРс¤вниX“№iу#¤yцшF#D¬v	еъл№0~­“Ж:цИ]C[ь§iу#¤
{;:¤єf;z±ёя!ЈўF<¶Ёх‹В—›6?BzПfGбpzq{їwЈo¤(ж™ЊM§Чґщ’{ЋepI»tо“­ЃѕZ;WC2xЋOCРћ–мM›!Сі(lљўэЕ,ѓы_ІјЇС·Т3д^ФьkЪьI„M\¬о(Д\rСЏ#нъ4zбф Л}§«)љ6?BкП™мф©‹1NEъЕRБШуњRYР^iЌTр0kҐ¦НЏђ4lр§я§fXБ*цй«=‹›
Ю‡2'X:“-vљ6?BЪgOїгЮи§W,<М
¶ Гћ‹ьjПs¬в7m~„„°Б5RБ3¬аЅЌnt>џҐППздsщ<ЕM›бЭs&«ззsт№|џПзLVЗб±ъ¬>wџ‰¦НЏр&њЙ>“ПмLцY}о>іПВgтщы,нъЋч3M›бҐgїOxџь~тыгчПп›ЮwzЯуѕo<ЧпoМЇiу#јцё®®»®2Щi¶їсё®^чx\™lwЏЗ%ЛЭЛM›бэgЏлjКЭгљJеоqҐўrчёDЙrw]‰љІ·iу#<
»{њђvМ'$™$;UТ$Ri§L¶H«=MzйЌlЪьЏџэЬ/Mzй=чq&»Жгѓ3YѓмtфќЙJђ¶iу#јОdГИd;“ПЙ™¬В0lrъcHFmУжGxсмЏЗ™¬В0j^Ч<9®ќзq&K` Ў¦НЏр6мѓЌu&Џ3YГ <`gІрxёљ6?‚фs&K`5/ЌkћЧОKОd“Х&і3Y[ю¦НЏ /lм8“Хл>Лгыoз’§&Н9<4b¦ёtz­шM›AЦіУҐI•2Щ/Йф%‘8х¤)Т&<ї{укҐ—Й–TM›A¦°ЯфДгЯїюxр7YќЙjШ€q&«Ђ(Jbѕ6m~)џMuKO)ЄW7ч.№жWµОњЙ>ЏЛЙПІя¦НЏ 8“эMfw«Гkњ/“=W—оќјtвшъйЕЎSУжGђвЩ'LfgІ6vњЙкu“ХЭ\®«©LvЄWтЅ¦НЏ 9мъE%жW­HЛ“#K&щd&ыK’BІмReИ•Ъґщ¤>[выЯџ_?эчеПdУџ_ъbвjЃоLVГ^nЪь2ВFЊ3Y|–7.Э;іqv?й	R1їъ(Эl¤¦НЏ смЃ3Щзq9щYъ›,МоV‡Ч8_&{®.Э;ЧґщѕГѕtвшъйЙKГЈіiyrdЙ$џМdIх¶7m~„?П®«©L¶е–њюпПЇџ*	ЮвЫґb«п–ОVпM›бWШК[‘¶B·¶¶цoa·ь6™7y7ќШt±inУKM›бїgmzi“ 1[b¶ДlэЪD·IјMўoboкi“@УжGш2l}›TlRlЉґйn'Д¦€M{›цmZ±ic“ySQУжGшфlЬ&ИM+–Р79н3н3ц]н;±ofЯмѕzыN4m~„/В~»пnGоѕ/цнШЧЅOkъ>ЯКб•Й+У4m~„ЯџэЮJ9+е®дґІя•к•Є+ч­ьТЖО·S8“=uM›бk8“Н·ыfьнc(аKТ™,9ЏЩИdУ89“]Њ¦НOвпs&»г)Г™,уЙtIУ{i<?™ґ°ЃС¦НќрЎ6`_ЇиУґщИc_Ї=вzЙлЇ_|]Цх·Ч•¬эЅЙd{ь’мM›ЃЋн$R¤7ЏЗ)“}/Ґ7§y“Dъ‰^J›Ю«Wc§¦НЏ@5цxьdBТчR¤7ЏЗ©§чДx<§JH‘вЅТ¦НЏ@‰нґI¤JчR	i_ЌЗгз7I¤})Ѕ7гс8Mzўљ6?Й±“&ЏЩгqЄ¤	©R§Mxiь*ЅHЧ_WюХґщиі3Щa~“Ю«ф^'ј§KыД8хфћї”0~“ћpУжG 1цKoB8М	П/%‘ђцUсxиН€ф^zуДиРыЭM›ЃнйЮ¤§IHxit(‰й§MxЈп8Йt/ҐKКІis¤cЏУ{у&бН8!н8eІЕ«ФЗт5m~Љ±;;€У&ЊS&[јТюк‰W/Ґ§1~яM/йЏЕkЪьґlїI/ќ¦с8QB
}гс«фТУо0§z3~)alnЪь$„З~?Э›г4		‘жToЖ/%ЊУҐIxйEУжОґY(+ИdеY I•2Щ/Йф%‘8х¤)Т&<ї{укҐ—Й–TM›A¦°ЯфДгЯїюxр7YќЙjШ€q&«vя_CCP.HEX /         јя	  
 Пя»я     ОяМяНяєяЗя№я ѕяЖяЛяИя КяЅя хяЙя тяoяЕя ьяыя        Ся"   ! #   ъя$ ' & , % ) * . + ( - щя±яЫяняЬяїяяюЮяЈяЯягя­я°яЇяеяІяія«я¶яґякяёяяяТяг7Ё?ШП МБп7~ѓ6шБ:Л <ХАаyэ<ХАаЛ МA:xЄЃяЊ_Эљ…j 6“›љЅаp8‡Гбp8‡ГAЋ_ЭљХ
,[obЮйл®Ѕt.‡л2їk»¶нz«ЮµЧµЊ_ЭљeЁ†s­^qL_sЪљ«§/[кpTѓияЗЇnНZЉК™с«[і~T–5~ukЦVTѓLіPМЃЗЋЊ_ЭљuQL 3ФdҐsMАрz–	Nмz–‰#v=+іuькЦ¬Ј@x5KzKЩQ7™Ў&K:v’cА|eькЦ¬ Ж0Ѓ0I±дBрb±¬уМ…)ЭaJм—с«[іЁ@J¤‹eAєc±,H{,–Х¦ДшІ яїє5лЎ¶Е0Ѓ(;Т+цVVw{7Т3цЦїЗЇnН„Yђюc±,Hп&РтДГВ¶LЭєuџ7~uk¦Јкц–—R~s, ЧЋјs, чЙЯФ'»тПgkькЦLS ЧО))eзЬ?УЋј”ІMЂ¬В¬о“”0%+§њс«[3'Єбэ3н”’b4O5,Э')б»Yсыgvcgy+ЄЃькЦМ_QEё<к]NЉэЂ›Но“”ђ'+зю™vдҐґЊ_Эљ©Ё†egfyCіВ“¬0ћ™svfX3cкЩa5ЊЊ_ЭљyИыdBpєсg…@и7У;kэn[ЛО)зъшХ­™Х0sKhИЬ3vJжЮЮР,wХ¬\J€	”­>~ukf€BР!&Pv.¤oиVTТ'†	xџ’вeькЦLA5ЬRvФ~ај°0«ы$%”—eG^J¬0«Ы5›6~ukжSАHргпS$ћ—Эж†ММЇfщС“µe–с«[у7ЄбGЋ{юІsЬуЛ5YТn1јь&цBMVИ5~uk~WаjVX3cкЩ}КЋ>qражЏ>1FџМ}В9~ukю…jи}b'ъДJф‰%ъД$љЫ§миGР[O1~ukю©@~ќя#|ељ ЮaJ8o~™2П3HсЈљ%еЬс«[уoTГpЅьRЬхdI‘оSvЋЮь”…µЫъ<±“s‘џsькЦьЄ@;тRцЋЭ?яVу‡”Ќ6ьРРђ?§ЬьnOигW·ж?Ё†~взж·Я^м”ь{·aЖЇжщs‚ьm±уlЏ_Эљї(ђЯН~fјЬьшaO\вrу·…†ь9rу»=Йїє5?QэДyуЫo/Ж’п6Мx4hИџуђї-ЖЧ{ькЦьў@~7ыq№щсГЬмG5њсзщҐё«fIЈQ¦Њ_ЭљЌj0Ь¶<±ЗНЖгим­eз®jx§;ЦњѕЪб{ькЦмV`®y'Цњ¶zюkN_s‰cVC[sънюСЁ§ЅыЊ_ЭљmЁ†Щ`Я'ш‰оH
~¬>Eвлe·№aЖ-Щ}fЏ_ЭљЅxв€П•Ѕo®f|Ѕl$VіП3ЗОІ>%%і”с«[іTГ}ыхлЧO~јщВћ™aС,уSRТыКЏg./%sькЦм­@Xe;«мшХlлSRВ«Y!‘™uЁЙrїє5ыўљ„љ¬Рnf·ў†ФМђИ4——NЙџеoькЦмЈЁ†7їќ‡”Ігgж„.ЩЮймщъъцЭвцWГ·жшХ­ЩA5”»wґ_оdоan#G%зМпgыwІјЃ¬тЖЇnН¦rС|Щ±іі¦Ї№z-ЗљУ§Ї7Х°ІcggсЌ_ЭљэP—¬зXяє+kб”ьvRКЋгжчЋ¤ QЂгW·FЎА–'ЋіЁГ:nю№·К/€гжЯЉЌmwькЦЁЈШ
Ьь
Ььк<ёщЧгРhо–'Ћ8ояЏ_Э5т»ЃqіиЦ\ь°-нnmсеС\oE5ФoЖЇnЌNTГyуoЙ=П<L±уђRvФи-/ҐH4VeзaчшХ­С_Ѓ”ІЈFoy)EўvдҐД
іВ)щГ№ўЮ‘¬с«[ЈЉjёе‰#®/ЉЕ~{nqХhАКНJдdЇїє5zИй’kG$Oюл™а„«D{уаеІwйTГс«[ЈХђS~Ш›сTCЇfe†Df:якрz–‰ќръњгW·FЈ@VЊ+П2±^П
ЏgбGoW‰КїЯ“нгW·FХР7ъъН'°шЫQЬp•Ёьы=qд@rMNЖЇnЌ>бх,¬­O:$ч	nњ7ПЉсF_‡oЏ_ЭљЫЁ†сМx—ЬPVVмj”У?%њ’я	J|y.ъrькЦ\W`znxvVh7У;Лf\=ЫmЛ“yгкЩnояїє5wЎЄf…sE»Г”P^–ҐКЙЋйџІzeЕб:Їќс«[s§ю–шµ„SтЗqу‡sEC"+змЬрj–чхс«[s7ЄблыЯу~ќA0H
CURDT1:	.BYTE	ESC,U,22H,ESC,"=",26H,48H
CURDAT:	.ASCII	'                        '
	.BYTE	ESC,U,0A0H
BADKEY:	.BYTE	ESC,"["	
	.ASCII	'  INVALID ENTRY'
	.BYTE	ESC,"]"+80H
TIMBAK:	.BYTE	ESC,"=",30H,2EH,ESC,"J"+80H
DATBAK:	.BYTE	ESC,"=",33H,24H,ESC,"J",ESC,"=",32H,2DH,ESC,"K"+80H
;******************************************
;*                                        *
;*               TIMESET                  *
;*					  *
;******************************************
;
;
START:	DI
	LXI	SP,2000H
	LHLD 	1
	LXI	D,7FH
	DAD	D
	SHLD	INV1+1
	SHLD	INV2+1
	XRA	A
	STA	OKIFLG
	MVI	B,0
	MVI	A,7
	CALL	W58174
	MVI	B,0FH
	XRA	A
	CALL	W58174
	MVI	B,4	
..L1:	PUSH	B
	MVI	B,0FH	
	CALL	R58174
	CPI	0FH
	POP	B
	JRNZ	..NSCK
	DJNZ	..L1
	CALL	OKISET	
..NSCK:	EI
	LXI	H,SIGNON	
	CALL	MESSG	;CLEAR SCREEN AND
	LXI	H,STATUS
	CALL	MESSG
START2:	CALL	DSPTIM
	LXI	H,OPTON
	CALL	MESSG
;
ESS:	CALL	COIN	
	CPI	1BH	;CTRL C TO EXIT	PROGRAM
	JZ	DONE
	ANI	0DFH
	CPI	"T"	;T TO SET TIME
	JRZ	TIM
	CPI	"D"	;D TO SET DATE
	JZ	DAT
	JMPR	  ESS
;
DONE:	LDA	TIMFLG
	ORA	A
	JRZ	START2
	JMP	0
;
TIM:	MOV	C,A
	CALL	COUT	
	LXI	H,HOURS
	CALL	MESSG
	MVI	B,4
	MOV	A,B
	STA 	LIMIT
	LXI	H,HRS10
;
TIM1:	CALL	COIN	
	CALL	CLTOND
	CPI	1BH	;ESC TO ABORT ENTRY
	JRZ	START2
	CPI	8	;BACKSPACE	
	JRNZ	TIM4	
TIM2:	CALL	BAKSPC
	JRNZ	TIM1
	JMPR	START2
;
TIM3:	CALL	INVALD
	JMPR	TIM1
;
TIM4:	CPI	30H	;KEY < 0 ?
	JM	TIM3
 	CPI	3AH	;> 9 ?
	JRNC	TIM3	
;
	MOV	M,A
	INX	H
	MOV	C,A
	CALL	COUT
	MOV	A,B
	CPI	3
	JRNZ	TIM6
;
	CALL	CHKHRS
	JRC	TIM5	
	CALL	BACKUP
	CALL	INVALD
	DCR	B
	JMPR	TIM1
;
TIM5:	PUSH	H
	LXI	H,MIN
	CALL	MESSG
	POP	H
	JMPR	TIM7
;
TIM6:	CPI	1
	JRNZ	TIM7
	CALL 	CHKMIN	;CHECK FOR VALID MINUTES
	JRC	TIM7	
	CALL	BACKUP
	CALL	INVALD
	DCR	B
	JMPR	TIM1
;
TIM7:	DJNZ    TIM1
	PUSH	H
	LXI	H,ESCAPE
	CALL	MESSG
	POP	H
	CALL	COIN
	CALL	CLTOND
	CPI	1BH
	JZ	START2
	CPI	8
	JRNZ	TIM8	
	PUSH	H
	LXI	H,TIMBAK
	CALL	MESSG
	POP	H
	DCX	H
	INR	B
	JMP	TIM1
;
TIM8:	CALL	SETIME
	JMP	START2
; ***************************
DAT:	MOV	C,A
	CALL	COUT
	LXI	H,YRS	;YYMMDDW
	CALL	MESSG
	MVI	B,8
	MOV	A,B
	STA	LIMIT
	LXI	H,HRS10
;
DAT1:	CALL	COIN	
	CALL	CLTOND
	CPI	1BH	;ESC TO ABORT ENTRY
	JZ	START2
	CPI	08	;BACKSPACE
	JRNZ	DAT4	
;
DAT2:	CALL	BAKSPC
	JRNZ	DAT1
	JMP	START2
;
DAT3:	CALL	INVALD
	JMPR	DAT1
;
DAT4:	CPI	30H	;KEY < 0 ?
	JM	DAT3	
	CPI	3AH	;> 9 ?
	JRNC	DAT3	
;
	MOV	M,A
	INX	H
	MOV	C,A
	CALL    COUT
	MOV  	A,B
 	CPI     7
	JRNZ	DAT5
;
	CALL	LEAP
	PUSH	H
	LXI	H,MON
	CALL	MESSG
	POP	H
;
DAT5:	CPI	5
	JRNZ	DAT7	
	CALL	CHKMOS
	JRC	DAT6	
	CALL	BACKUP
	CALL	INVALD
	DCR	B
	JMPR	DAT1
;
DAT6:	PUSH	H
	LXI	H,DAY
	CALL	MESSG
	POP	H
	JMPR	DAT10
;
DAT7:	CPI	3
	JRNZ	DAT9
	CALL	CHKDAY
	JRC	DAT8
	CALL	BACKUP
	CALL	INVALD
	DCR	B
	JMPR	DAT1
;
DAT8:	PUSH	H
	LXI	H,WEK
	CALL	MESSG
	POP	H
	JMPR	DAT10
;
DAT9: 	CPI	2
     	JRNZ    DAT10	;CHECK FOR VALID DAY OF WEEK
	DCX	H
	PUSH	D
	MOV	D,M
	LDA 	OKIFLG
	ORA	A
	JRZ	..DT9S
	DCR	M
..DT9S:	INX	H
	MOV	A,D
	POP	D
	CPI	31H
	JM	DAT11
	CPI	38H
	JRNC	DAT11
;
DAT10:	DCR	B
	MOV	A,B
	CPI	1
	JNZ	DAT1
	PUSH	H
	LXI	H,ESCAPE
	CALL	MESSG
	POP	H
	CALL	COIN
	CALL	CLTOND
	CPI	1BH
	JZ 	START2
	CPI	08H
	JRNZ	DAT12	
	PUSH	H
	LXI	H,DATBAK
	CALL	MESSG
	POP	H
	DCX	H
	INR	B
	JMP	DAT1
;
DAT12:	CALL	SETDAT
	JMP	START2
;
DAT11:	MVI	C,8
	CALL	COUT
	MVI	C,20H
	CALL	COUT
	MVI	C,8
	CALL	COUT
	INR	B
	DCX	H
	CALL	INVALD
	JMPR	DAT10
;
;***************************
;
CHKMOS:	MVI	A,13
	MVI	D,9
	JMPR	CHKGEN
;
CHKHRS:	MVI	A,24
	JMPR	CHKGN1	
;
CHKMIN:	MVI	A,60
;
CHKGN1:	MVI	D,0
CHKGEN:	STA 	CHKCHG+1
	MOV	A,D	
	STA	CHKCG1+2
	PUSH	B
	DCX	H	;CHECK HOURS,MINUTES,OR MONTHS
	MOV	A,M	;FOR VALID INPUT
	DCX	H
	MOV 	B,M
	INX	H
	INX	H
	CALL	ASCBIN
	POP	B
CHKCG1:	ORA	A
	JRZ	NOGOOD	;MODIFIABLE
	JM	NOGOOD
CHKCHG:	CPI	00	;MODIFIABLE 
	STA	MONTH
	RC
;
NOGOOD:	XRA	A	
	RAL
	RET
;
CHKDAY:	PUSH	B
	DCX	H
	MOV	A,M
	DCX	H
	MOV	B,M
	INX	H
	INX	H	;CHECK INPUTTED DAY
	PUSH	H
	CALL	ASCBIN	;FOR MAX
	ORA	A
	JRZ	..J1
	PUSH	PSW
	LXI	H,DAYTBL-1
	LDA	MONTH
	MOV	E,A
	MVI	D,0
	DAD	D
	MOV	B,M
	POP	PSW
	CMP	B
..J1:	POP	H
	POP	B
	RC
	JMPR	NOGOOD
;
;
LEAP:	PUSH	B
	DCX	H
	MOV	A,M
	DCX	H	;CHECK FOR LEAP YEAR
	MOV	B,M					
	INX	H
	INX	H	;ADJUST DAYTBL FOR 
	CALL	ASCBIN	;29 DAYS IN FEB.
..L1:	SUI	4
	JP	..L1	;IF NECESSARY
	ADI	4
	MOV	B,A
	MVI	A,29
	JRNZ	..J1
	INR	A
..J1:	STA	DAYTBL+1
	MOV	A,B
	STA	LEPFLG
	POP	B
	RET
;
;******************************
;
OKISET:	LXI	H,05FFH	
	SHLD	CHG2+1
	MVI	A,0C9H	;ADJUST FOR OKI CHIP
	STA	CHG1
	MVI	A,0ACH
	STA	W58174+14
	MVI	A,0A8H
	STA	R58174+15
	STA	OKIFLG
	LXI	H,0C05H	
	SHLD	CHG3+1
 	RET
;
;**********************************
;
RD5101:	CALL	SU5101
	MVI	A,0FH
	CALL	RWPORT
	MOV	A,D
	OUT	DPIOA
	MVI	C,DPIOB
	MOV	A,E
	ORI	0B4H
	JMPR	RCOMON
;
WR5101:	CALL	SU5101
	XRA	A
	CALL	RWPORT
	MOV	A,D
	OUT	DPIOA
	MVI	C,DPIOB
	MOV	A,E
	ORI	0B0H
	JMPR	WCOMON
;
SU5101:	CALL	PACK
	MOV	D,A
	MOV	A,C
	ANІе‰‚Gw®МрI–tь чјЅmIЏ_Эљ«
x+Єa8oю-OъдиџjІВxf\я”Ш^№њгW·жTCcЋю)!ovшяСnюрiц›б”ьqЬьбдшХ­№EЃ№ўЭa
g(/‹вfжј’{ћ№0ехяьlЌ_ЭљKTCїЭЁ†ЅSfОл\/2ЅХ°ЇМђљЩ¦„XЙшХ­№ў@&[:юJnЊ+·;L	yІ,qt;'<»мс«[sPd…њ™1эS–¬з6±zЩљ@8%7їќњс«[sZЃ”7Г№ўЎЬ¬шѕ9ЮaJ7™‚ї.ЏъQЗЇnН1TГ,)бzщџsме<™/ѕ-GЉ›»jV8%<kькЦњҐА¶њЧk{?¤l);gЮњўсm9з™‡)ЎЬЛс«[s~TГ¬њџ9ЭaJЙЊйџКЙЋйџю4†»lькЦњ­@~ґzNxvVLя”хЇ»І¦cН©лN›k>э}ькЦњ‹jэ¤AЗН?џќHКGnю°gfLoJшf¦њс«[sЋv")Oс¬;)eзиM1љЛK	эf†…ЏгW·жХ0+¦7Ґ›Jџ'Ћ8n~Оp®(Ы[-%\€Ъїє5‡
„DVО_RјQ[¦”ђљЩ¦„пfЕС)ТІЗЇnНyЁ†ЭЉjШ·ИЪј¶s}wJL:GЪЯќю‘с«[S @4њ’Яы!Eжу0Е¤юИ/ЅЕњL9ПьйшХ­)Ћj(LйћјГьЮбтЁ74kKЩ9&)O9kЌ_Эљb
¤ёЕ)шЃnm`K{Щ9лҐ`№µЕ–Ґl-sькЦ”‰jh®Ё†бХ¬ђ33м“ў¶х))ЎЯМ°0лпс«[S~bкЩбяGcёщСы¤„ggЕфOYѕz-ЗКzРс«[SХpхZАІхГяЏ†SтЫ‰¤рwx?¤”?Ћ›япс«[S®1хlTѓЛ—/_ашХ­)ХРбp8Уж\ЋjPЉЌ_ЭљEеsЋ_Эљ"ЁМ8~54е)ЄБmsькЦХАнюСЁ§cЭЙЅЙ™Й)IйDЉыІ<)»Oїє5iшуzЈp_3П®;^ћхкјуМјж^пЅюЊ_ЭљЄ!ЇМ}џш%Vс^;™Ї oЯ)nучі,OЉ\Ш‘с«[“Ґ O4rF"н<x<\aдYдiD:|ЩRОшХ­ЙЏjHUЈ®IЅЎћI=…ҐrSTщ©к›Ф'gЌ_ЭљlЁXј8јЭјvoЮ&ЇяјNЮХјkу.тB’с«[“‹jHќЖ‹•‡•wЇwNЄ!e&O`9ЁrЅ9±с«[“Ј@¬¬Д[:ХРКJј™jЂ2SХАтэo›cMїгW·¦ўnЯоXп‡ГЋГЧтїяецПЯцъЯv_УющзЙшХ­	шзo{щZяяьУ1ЭЯzѕd†№ЎќеyщW›з/2~ukтPt9©†¤…йђzCт¶Ш”ДpyВWОїє5„©†мRЯ\/ј_з>ЈOpўOpЈO СyЗЇnХр‰#Ч$Їмшљa€џG~t4ДеyТ_кїє54B\ћ'°TзељCтLР№vpтКЋяfО;~uk8QC·0ќ"<йL;`^ЩYx<й}Ѕ‘ј'ы№Џ_Эю
Dm=q6·”Эч	4ѕoh3ч	N`?ђ»/}ькЦPQГ^!э"|2%\ѕ~яВzы>БЌ/!ЕшХ­бU \ЪAтдЗЋЯ?МOB€#Dx РrжшХ­aA5дЃё…KГ07ґѓдyЈд! Ћpi+чхшХ­a!`ё4„аД–†8O|Ea™л…a:FЗЇnХ0ґѓд™ЈдщY–·ДM&~ SfшJ"я~ТйЌс«[Г§А0'y‚““Ћ<ЃЖыЏl-;G^€iЙїє5ТЁ†ж8y±ЌИ“эвюG¶–ќ#/Ь‚й%vnд	¦—с«[#®@Ьv$SfћgЋ’{>iД—Fdzѓy}ЖЇnЌ,TCфэч–ЋЙџґЖз‹HЫAЙуFтЉРҐГwЖЇnЌLl†g…±%‘'=г‰„ҐCйtш¤=~юИ~гW·F6ЄafX:LKЛМЬZvЋћ€ЫМL™б~Ўt:6ЯшХ­U`kD¦њјІs^‡ЮHЮэНqтВіBoњ<›(гW·FЄaьЮHмuи¶7V¦МхВэBйф–'°­сВ€ќс«[#EЃ'иTетИҐ7 `liвcиј°злс«[#D5д‰Ўуцµд"–ь<1„'ДПSvОmЮ°dькЦ€(Єбе‰ЎумАЂ:ПмО•ІёVЊ†nеЌ_Эљ‡j 4_3/ЧCзЎїє5Ї•хшХ­y†ЄЅЈгW·ж-E5,Й·щK‘‹ЂС>{·№Е&тм,П[/мВуЯс«[у~TГќ2ЈSЬжпж^ЊЧННЅL^77чІyЭЬ¤ёsЏ_Эљ· xЅЛе…@Гхть”В+Е;НБЧЛу“_tькЦј‹jИ»гНjxнЇмњЛ<ы“чКО[yОуS&ЇышХ­yGЃЅЭццS6пЮn{з†ѕybҐд…~xКЋzг&їє5/Ё†±uтьИб…АC9„»L^w	Ї·LЮ%nлчі}ькЦ<*P6п·щы)“w‹Ы_ЯѕЧ¶ЮC'O¦џ4п.yгW·ж=TГ;зЫзfni/1Yy2э¤yытаыЮ№х†/їє•Ђ„i·Ш;yТ™њ2Ґш‰рц]ХђaЫO™zЖЇn%Хђw›Ыv¶џІy·№mOп{mЅ­ч¬н‡а•жїє•0xЧЉyуxЗx—Шг-»_“XЫzяхфЊ_ЭJLTC;вј`ОQvпШ4B‘лgY^WCTГѕёvHгшХ­ДЇ oЩ9»‰_ьrq§ёН_JnhB¬‡§пЋ_ЭJ(ЄЎ»LЮ\?2y7ЛКµгх#“ЧЇ1~AёЛж•9~u+q°“Е»ћ1ЮУeюП]&o®џeyЭР7ЧПІ%гW·Х0Їи+Е»}sГ#Дs1^)[МҐyCХс«[‰(p~ВN&пщНЕysГ#„NЮ'р8…8o=;)гW·‚j(Ж«Ѕ·;Тј{з"`t§м~яЮмчїbkькVв) рS.пyъ»ЃсG"Ј~cмL;ЛуЦу9~u+»QЅС@€ЕNп[жя¶–хп\?‡јv–з­К!ЉЋ_ЭКv6еGзzт.q[€Вv?дхеu“в§Ї®с«[ЩХp›ЫцЬp
»в}·ф&јсRmќј°…нькVцTАL5ґuть”ЛkG.ЇОяѕrэ,Лл† }‘с«[ЩХpKnш_¶э@nш_цы{зъ‘Г+ЕO1Ю]ояdькV¶*а¶П•Ьp?6µm»—m№»Ьщї}nюќyПЏ$>~u+ы тJс“р†wІ‰МрmВO!Ї?Юѕi$ЗdькVvQ ‹]$оЗ&B;wпЬр†
ШtXФtькV6Qуb<мPА‹зy—жЌ‰±ЅЛе]в¶юЇ”с«[Щў ЏџryҐш)НQДЦЛу–Г»Е­H`Йх~п·с«[йЁЮs—Г›л'К+ЕЏ^7w9јбќlz_zм	8~u+Ѕ`Ы‘Г+??¦nМёѓn.—·м 3Ње…\ЙшХ­tC5d§cWШыКЏm™oо}сррдп·ЮVЭєuлЦ]жшХ­фҐ@йх¶вббЙЯom?есвnБnЖзOПеmТ{Ќ_ЭJяQе’.ЌЧ3ю/ъЮ№бv5ЂjШ7ТНЈkЌ_ЭJЯ
pЪa5јe»bgК\‚hЕf.q[їМ}\q гW·Т/ЄЎџьј›·w®rНРҐЭТ±=й~туB`ЎвїгW·ТЏn«ТOyјцn([K;ћъЙб•в§<ЮmnЫЩгW·ТѓjћОуSЊЧ~›э@ш„y/Д¤‡oІЯ<oqькV:0Чжy}ц¦Й{жЪ<Ї_	§°MdqШYэОшХ­ф‡jW$РЬ¶рчhFу5у ир/фPГ†Њ_ЭJѓ­YvёxcијМ7нdтъ[{Яѓх^Ь–ї_zѕс«[iЋjkтћ9Ї7•w·џeyојјбvx:рїє•f
„фрMvОэi~xyҐфy"УКоЗfУеЊ_ЭJ›Ё†ч§…SШvЁјлбц-ЫХя>Oм№vЩъtќїє•ц+Ря¤Џ+фютп·џЦЉ›№$lРТqыimпЊ_ЭJSTC7,°•ї9јтГМЧМужвЭТ›8oпЬрЙ<гW·Т®l“чbијp.6	Ѕiб›мhё;њВж?~u+­ Ъ/„Ў‡щЩЎэґVЩуо[аЉ pf.їє•B›ф~t	-Нц“џw—;ч№ЎїEkЛд\ѕКћгW·ТХ0ґIпG—РШйXљЦЫю‹.НОЭ· ћ^eькVЪSЂжЌj ґ88с~–ебJ	§°УбzyЏ_ЭКХЁ†a,/–џОЕ† Ў7НПІј-]Qыо®ькV.WаMv4\‹iґ !љ+ґџуНABoљЫшХ­\Х0|“… -H€ж
н§Её xЎ7-|sъшХ­\Sv4<?±еM™б¶?Лт ОpЅјp+ыпс«[№6Є!Ыъ.сЖъ®_ъх®†·ИЦ-\& ЏЙшХ­\Є —‰ВПІјn< пЮ№[ЬКп%иіw›[џЅ»\Њ_ЭКuPЅдћgѕfћ№^s)јa;яЛ–_@рxЖЇnе*
„ЮґрMvЭЁ†б6®?Лтp!;¬†W2~u+QЛОеЪRvџ8ЧЮeЗҐ№¶ґ‰чгЊ=rбЊ_ЭК%
„wqI	пв’Т§Hјg›[џ"с~њ`›ёОшХ­њЁв!Zт®Ь>ExzsоЌ†Ў^)ё[ЪMДЖЇnеlЮ3§уЖ\ЮkжЩМзbыY–'Уы„Ч}™пс«[9Х0‚Ѕiб›liчeyQ)Юx@_Hчy{»™Ћ_ЭК№Хђсхszѓ@ЯЅC;|¤Е¶ІП3§у†Ззїє•уG5д
ЯdGэ,ЛC#Ё†w‹Eю~{зЁq®m'“·”с«[9·ЮtЮузЁpЖN8СpTГkk‹ьx9ез„а=їє•уў†ЮґрMvь„УЌЧ’S~ОРgш&;§ь7гW·r8cзq†уp…ҐзЕРy!f^l+ЫmО™=~u+gPyMЮ3§с†ҐvДxЅҐy‹рИПщD…“6~u+'зб<П\ЊЧОљyeЗ_бч&B]DО+њбяЖЇnе|Ё†z€ђќП‹С‰fћ	Ъњ“Ч0§сrЏ_ЭК
„s±э,ЛЧf‡ҐvДxџ(иyбЮDxЦшХ­ьХPвїрMsn^4ЄЃІs¬р_%њRжшХ­ьMbUC†еС6ЛЉ/еoЏЎуЬeтJсі,н2~u+я‰jШЁ®VГ[¶nЮњсяЕЮыГ=ьЁ†Ч2~u+я_Qп6·нёќ5уК2C=„N^Ј1^
яфпгW·тWTГМ}ЌЖx)ьeъ)—wоjиЦл№†(`ы‘НлsькVюWQ^eтf†мјtX4ПЏL^`'‹wн3‹ТЗЇnе_PЭвчр—v—Йт°Cv^:3,љ—¶#Жл]жшХ­ьЈЂ4o:яЅmAаЁјЃ¬7ГяІеЯoпЧOдЋ_ЭК_Pч‹Ьv8yџ г wH'Вy8ЅЧМЫRv6~u+я§АюFs1^ыЃќ8Пњ“7УПІ<)ЮЮ@ЯsЖЇnеnTГ-тпчж–Юn[zЛЯoЅ-эъхл'?ЮЪЇЭ~сњ5~u+·+аtБЧВннЁ†}чцFЂѕыЮ?ѕ6·7иЫяшХ­ЬХpлэеЯ/g?оLОр8;нііfћ%G·wdькVо©Ё†ъоц† }7ВЩ\vЦМіДчгNgє`!mгW·roTГ]ЬЎ/NL;kжYrtq§П‹Ўуd†яeЛїє•[°?ђNoљЇ™ЫК†јВёS›3„°Ћ_ЭК}P№я\)}—ај п<щЪл™ Єkїє•»(°O~<ЕЪЮ пЭєuл~S±ц›Т›ТeКlькVnўи\zУь,ЛлцъКЬо¶Эm{ш&;ЗцшХ­ЬўЁ†Ў†SШХПд––9ЯѕчwЫzЕm—+<шзїє•ЉjЂєНЛ†—ЭЎэґ,nй\?ЛтєХ0<“Ы»Ьс«[©­Ђ7Рw·Ы†ЫЮ№~Огµі<oЅP!SJ8o^yгW·RХP:Y;oіХПyј‹k…(lчуxct;ьyЯїє•єр^ћW$єwМ›jтћ9…ЧПІј-тч3љузеїє•ъЈ>iЎпIµі<ПњЏw‹№ЂW~БЮбљT;«уюькVкVАПІјтпќkвCзyЈp?дu?Џч<уеyђс«[©ХР[QЭKу†<м75ЬОgScі№ВЩФ.гW·RЏ±г\@К–'цrвФрьД–'цІ¶іГЩФОшХ­Ф јР›“ЛцГЛлѕ,/њMн§ЕдІГјс«[©T`65јB‹бРВЩФX	g8›{Вng‡[ЖЇnҐ>TГЩФI	30H
	RRC
	RRC
	RRC
	RRC
	MOV	E,A
	RET
;
R58174:	CALL	PACK
	MOV	D,A
	MVI	A,0FH
	CALL	RWPORT
	MOV	A,D
	OUT	DPIOB
	MVI	C,DPIOB
	MVI	A,0ACH
;
RCOMON:	OUTP	A
	ANI	0DFH
	OUTP	A
	IN	DPIOA	
	MOV	B,A
	JMPR	DSLC
;
W58174:	CALL	PACK
	MOV	D,A
	XRA	A
	CALL	RWPORT
	MOV	A,D
	OUT	DPIOA
	MVI	C,DPIOB
	MVI	A,0A8H
	JMPR	WCOMON
;
RWPORT:	MVI	C,SPIOA	
	MVI	B,0CFH
	DI
	OUTP	B
	OUTP	A
	RET
;
WCOMON:	OUTP	A
	ANI	0DFH
	OUTP	A
DSLC:	MVI	A,0A0H
	OUTP	A
	MOV	A,B
	ANI	0FH
	RET
;
PACK:	MOV	C,B
	ANI	0FH	;PACK LOW NIBBLE OF B AND A
	MOV	D,A	;INTO ONE BYTE
	MOV	A,B
	SLAR	A
	SLAR	A
	SLAR	A
	SLAR	A
	ORA	D
	RET
;
;*********************************
;
;
ASCBIN:	ANI	0FH
	MOV	C,A
	XRA	A
	RAL
	MOV	A,B	;CONVERT ASCII IN
	ANI	0FH	;B AND A TO BINARY
	MOV	B,A
	RAL
	RAL
	RAL
	ADD	B
	ADD	B
	MOV	B,A
	MOV	A,C
	ADD	B
	RET
;
SETIME:	MVI	A,0EH
	MVI	B,3	;SET FLAG IN CMOS RAM
	CALL	WR5101
	EI
	LDA	OKIFLG
	ORA	A	;SKIP THIS PART FOR
	JRNZ	..J1	;OKI CHIP
	XRA	A
	MVI	B,0EH
	CALL	W58174
	EI
	JMPR	CHG2
..J1:	MVI	C,4
	LDA	HRS10
	CPI	1	;SET UP FOR AM/PM
	JM	..J2	;12/24 HOUR FORMAT
	CPI	2
	JRZ	..J4
	LDA	HRS
	CPI	3
	JM	..J2
..J4:	MVI	C,0CH
..J2:	LDA	HRS10
	ORA	C
	STA	HRS10
	LXI	H,0	;SET SECONDS TO 0
	SHLD	SEC10
CHG2:	LXI	B,0701H
LOOP2:	LXI	H,HRS10
..L1:	PUSH	B
	PUSH	H
	MOV	A,M
	CALL	W58174	;WRITE TIME TO CHIP
	EI
	POP	H
	POP	B
	DCR	B
	INX	H
	MOV	A,B				
	CMP	C
	JRNZ	..L1
	CALL 	DSPTIM
CHG1:	MVI	A,1	;RETURN HERE IF OKI
	MVI	B,0EH
	CALL	W58174
	EI	
	CALL	DSPTIM
	RET
;
SETDAT:	MVI 	A,05H
	MVI	B,4	;SET FLAG IN CMOS RAM
	CALL	WR5101
	LXI	H,HRS10	
	MOV	A,M	;WRITE YEAR TO CMOS RAM
	MVI	B,0DH
	CALL	WR5101
	EI
	LXI	H,HRS
	MVI	B,0CH	
	MOV	A,M
	CALL	WR5101
	EI
	LDA	OKIFLG
	ORA	A	;SKIP THIS PART
	JRZ 	..J1	;FOR NATIONAL CHIP
	LDA	LEPFLG
	ORA	A
	JRNZ	CHG3	
	LDA	SEC10
	ORI	4	;SET LEAP BIT IF LEAP YEAR
	STA	SEC10
	JMPR	CHG3	
;
..J1:	LDA	LEPFLG
	ANI	7
	INR	A	
	MOV	B,A
	MVI	A,10H
..L1:	RAR
	DJNZ	..L1
	STA	HRS10	;REARRANGE FORMAT FOR NATIONAL CHIP
	LHLD	MINS10
	SHLD	HRS
	LDA	OKIBYT
	STA	MINS
;
	XRA	A	;WRITE DATE TO CHIP
	MVI	B,0E0H
	CALL	W58174
	EI
CHG3:	LXI	B,0D07H
	JMP	LOOP2
;
MESSG:	MOV	C,M
	BIT	7,C
	RES	7,C	;OUTPUT ASCII UNTIL
	INX	H	;BIT 7=1
	JNZ	COUT
	CALL	COUT
	JMPR	MESSG
;
BAKSPC:	LDA	LIMIT
	CMP	B
	RZ
	INR	B
	DCX	H
	PUSH	H
	PUSH	B
	BIT	0,B
	JRZ	S1
	LXI	H,BAKSEQ
	CALL	MESSG
	MVI	B,15	
..L1:	MVI	C,0CH
	CALL	COUT
	DJNZ	..L1
S1:	MVI	C,8
	CALL	COUT
	MVI	C,1BH	
	CALL	COUT
	MVI	C,4AH
	CALL	COUT
	XRA	A
	INR	A		
	POP	B
	POP	H
	RET
;
BACKUP:	PUSH	H
	LXI	H,BAKTWO
	CALL	MESSG
	POP	H
	DCX	H
	DCX	H
	INR	B
	INR	B
	RET
BAKTWO:	.BYTE	08H,20H,08H,08H,20H,88H
;	
CLTOND:	PUSH	PSW
	PUSH	B
	MVI	C,ESC	;CLEAR TO END
	CALL	COUT	;OF SCREEN
	MVI	C,"K"
	CALL	COUT
	POP	B
	POP	PSW
	RET
;
INVALD:	PUSH	H
	PUSH	B
	MVI	A,0FFH
INV1:	STA	DSKFLG
	LXI	H,BADKEY
	CALL	MESSG
	XRA	A
	RLC
INV2:	STA	DSKFLG
	POP	B
	POP	H
	RET	
;
DSPTIM:	XRA	A
	STA	BOTH
	MVI	B,3	
	CALL	RD5101
	CPI	0EH	
 	EI		;CHECK FLAGS IN CMOS RAM
	JRZ	..D1
..D2:	LXI	H,NOTIME
	CALL	MESSG
	JMP	..J1
..D1:	MVI	C,ESC
	CALL	COUT
	MVI	C,'>'
	CALL	COUT
	LXI 	H,HRS10
	MVI 	B,6
..L1:	CALL	COIN	
	CPI	"?"	
	JRZ	..D2
	MOV	M,A
	INX	H	;DISPLAY TIME
	DJNZ	..L1
	LXI	H,SECS		
	MOV	A,M
	CPI	30H
	JRNZ	..L2
	MVI	A,20H
..L2:	STA 	CURTIM+4
	DCX	H
	MOV	A,M
	STA	CURTIM+5
	DCX	H
	MOV	A,M
	STA	CURTIM+9
	DCX	H	
	MOV	A,M
	STA	BOTH
	STA	CURTIM+10
	LXI	H,CURTM1
	CALL	MESSG
..J1:	MVI	B,4
	CALL	RD5101
	EI
	CPI	5
	JRNZ	NODAT
	MVI	C,ESC
	CALL	COUT
	MVI	C,':'
	CALL	COUT
	LXI	H,HRS10
	MVI	B,7	;AND DISPLAY
..L4:	CALL	COIN
	CPI	"?"	
	JRZ	NODAT
	MOV	M,A	
	INX	H
	DJNZ	..L4
	LXI	H,OKIBYT
	MOV	A,M
	CPI	30H
	JRNZ	..L5
	ANI	20H
..L5:	STA	CURDAT+1
	DCX	H
	MOV	A,M
	STA	CURDAT+2
	DCX	H
	MOV	A,M
	STA	CURDAT+5
	DCX	H
	MOV	A,M
	STA	CURDAT+6
	DCX	H
	MOV	A,M	
	STA	CURDAT+9
	DCX	H
	MOV	A,M
	STA	CURDAT+10
	DCX	H
	MOV	A,M
	STA	CURDAT+18
	LXI	H,CURDT1
	CALL	MESSG
	LDA	BOTH
	ORA	A
	RZ
	MVI	A,0FFH
	STA	TIMFLG
	RET
NODAT:	LXI	H,NODATE
	JMP	MESSG
;
COUT:	PUSH	H
	LHLD	1
	LXI	D,CONOUT
	DAD	D
	LXI	D,.+5
	PUSH	D
	PCHL
	POP	H
	RET
;
COIN:	PUSH	H
	LHLD	1
	LXI	D,CONIN
	DAD	D
	LXI	D,.+5
	PUSH	D
	PCHL
	POP	H
	RET
;
OKIFLG:	.BLKB	1
LEPFLG:	.BLKB	1
MONTH:	.BLKB	1
HRS10:	.BLKB	1
HRS:	.BLKB	1
MINS10:	.BLKB	1
MINS:	.BLKB	1
SEC10:	.BLKB	1
SECS:	.BLKB	1
OKIBYT:	.BLKB	1
LIMIT:	.BLKB	1
BOTH:	.BLKB	1
	.XSYM
	.END
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее/Оp65мџ+†CуsoМ/Їќеy±яЋ_ЭКE5м<)оҐyc<l?есЖьтъ9дЌщеgSЖЇnеuTГР
W‡ж§^ч5уrнрз}т^Ь
ЇќХyгW·тљ1tћьэМWзе†і©±kЬбljм†;њM•7~u+пD5ЊС№э,ЛЫф7ЯЋ??зсћ5чж±щьтJqЯ:~u+пЇАyј›Зю·sьЯо‡ј№v(јeзЬжхі,П~`eькV^E5ґ#а-;з6пЮvшxНщу†kRэаеЅлgН<“с«[yЇ›kе†і©&psN^bs'0ю№2QFКшХ­јХа(ЄAЛ7~u+o•Ї=~u+Ї 2гWCyџўЬѕЗЇFх¶ASтAјЃ¬7ГяІеЯoпЧOдЋ_ЭК_Pч‹Ьv8yџ г wH'Вy8ЅЧМЫRv6~u+я§АюFs1^ыЃќ8Пњ“7УПІ<)ЮЮ@ЯsЖЇnеnTГ-тпvя„ЮFORMAT.ASM A         
 	  ця    хятя          ¬я¶я  ія Уяѕя«я »яЯя єя ­яјя°яІя  ·я! ЇяПя±я" Оя# $ СяДя% & Ѕя' №я) ( §яЕя+ * oяµя©я¦яґяёяНя, Єя- Шя. 0 / ѓяҐя2 1 Мя3 4 ФячяЁя5 ТяКяЗя7 6 ВяЭя9 8 ЛяИяЖяъя< : ; = > Йяьяыя@ ? йя’яБяАяЧяЦявяшяеяРяфяяюЩNvG}ѕЫЙов‰*O’_5†яrQд’ФЃдyYI<zКxў»уNvO·#ю¦ЈИ%©©ЇЏD;ћЁЮy'»‹'ЄџЂ¦‰ѕ’Qд2.P›ЋA_п§n<СЭy'»Ј>	Янd;Y|IwtМЛЪЌ> 5Tў¦Tx'‹'evІ;к“рЭN¶“нёU};оТШN<СхЌ3ўќl'‹'е-юл§ПЇ·“н0~эЛ7¬ьг$Я0пhЊpС7L!н„яr\фЪ	/'¶јo†J©@;,ЙЖ|ГJ;ъ1ЯрЎўќl'3©яЉ@тј¬d'Ы№$5б~'M^КнёaЯ”—*ЛнёЎ|мёaЯЎ0~эkЗЎ‡?Ф‚я—рб,2~эkЗыEiЗЎ‡?Ф‚$бГYdьв‚ґг†Zр±г†}‡ў1ВЕ‡vІЮq-dЗ\VЧ“Оw-BаЋПтєwЯџЏ“Оw-”p§пПо—Єѓn©ВЗN¶г†}‡юЛqqЗЎ‡?Ф‚Г9бГYяеvЬ°пPЋЉvjpШсC-XlщCшpГЛ‰-їг‡Z°Шт
бcЗµ`±е•„Џ7м•чуїvІіЪљ‰~/ї#µ(	о†}Ј$' нХЦLф{щіЪљяЧЋлхѓ€vМА7KІ±џп­±џvМА·~lЗз{kм§“ОЏfґcV[3г‚ґcV[іHЬс™ йЧ}ј#wІ-%—ё1Y]wД–WВэRux9±еwL:?ћ”u-Tvв‰ЋХЦюЛнёaЯЁh)ЙЛпшLЂфлѕc'ЫyЭЗ;wГ~<QEҐжлїv^чёYmНDї—Яйыwаfµ53юЇЧлнЃoZ—¶}–ч–Z”dЗ|і$ЫсщЮыiЗ|лЗv|ѕ·Ж~Ъ1Яґ‹¶гуЅ5цУЋПHчэ;vІќ,>Ѓ*№ эKїќlG$	вfµµhЦdRЫЋIз»–ошҐЈ“ьънД“rM:Яµ;&ќoµ;&ќoVЋ“Оw(pЗ¤у­Л±г†}Ј"’”Ф¶#йщҐqБCЏ~З¤у]Eґ#¶ьЃыҐкрrbЛпp`риw<ъќxў‚‡¬Жќxў‚‡vнДhV[sш/·#¶7<OКЄ;fµ5‡ЦUЬтнp`uЗ¬®;с¤ЊYmНбїЬЋ№¬®;>Л{‹зcЗхъ†ўџеЅЕvмё…к$ї~;LєошҐк$ї~;>Я[KЙеЋF;с¤¬СaЗЂ«1оp`риwв‰оLЂґ¤з—ЮПnLVЧ±её_Є/'¶ьЋ[ЁIJj>vМeuЭсYЮ;рчГ±“нХЦь~РpЗ¤у]ЛwьRu’_їЊv8pШсї¤ГЋҐ~ZВЋVwЇщ7аАаСпшLЂґ¤з—ЮЙv?ёYmНп}мtѕk9аЋ_ЄNтл·cАЃСЋ;XЭ1бЧvьtІРvь/йєtKхАНА·и,RSGJE.#еc?RSпш,Ї{^уЧОNжэN<СIќвN¶“нэ^7біBv¬юdЎ…нXкgЎ…нш_СЋПЧЅ¤іЪљ¤џ	ђ&ъЅьN¶ZWqЛ‡›tѕYQЪйыvа&ќoµ@РNЯ7оpѕоЭчM±гА¤ЩЋПтєwЯ·cЗR§ќlзэ !о†}Ј"’”Ф¶cТщVЛwъѕёя%Mvь/МhЗ¤уM
Ьсї0Јя3Ъсї0Ј‡уuпѕoЗЋҐN;ЩОыAёцЌЉHRRЫЋIз[-ЬйыvаюfґcТщ&еШсї0Јя3Ъсї0Ј‡уuпѕoЗЋҐN;Щk2©wГѕQIJjЫ1й|«еЂ;}ЯЬ¤уM
Ьсї0Ј“О7)pЗыEiЗЎ‡‡уuпѕoЗЋҐN;Щг‚„ыLЂбN¶Гшїpџ	0ЬЙvВ9ЬgwІЌэ„»aЯЁHэj’;fµ5э^~ЗнЃа¤ЙK№KќvІќмЋъt‹»ќмО©ЄM?ыn'»Ј>Эвn'Ы‘ъХ$qчj7iлЗКMБНўЂHўќlзэьЕ/ЬЅЪMЪъ±BБPСЏ
%Tn7wЬЧЗю7-ћЁЦ”*Cљ¶г^н&mэXЎPBE	ўў+Ё(AT„
AEщЂЉ~¬PP ўЂИ;олcя›Г№(rIjЉ‚фЫOЭШСт}~ЕЈ§¤нёW»IT`E;С}}мУвi]щу(Еѓ
ҐўDћ$їjd\‚ѕD•ZРІDЖi;оХnТ†XQЃXСЋыъШя¦ЃV™Ћ‚Kд’Ф”t€бї\ьWтwtTqЪЋ{µ›ґa@Vґгѕ>цїi"—¤¦Hя[‹ЄЋґчх±яM\ 6Я:”ё@m:}Ѕџє%0RЉЁv“ЋOіДе»э$+ЛСvЂд$ЬЅЪMЪъ±rуЖНў DEQСЏ•›з›Юq_ыП4‘KRSјНmh;ЩЋ–’ј<о^н&mPЃнёЇЏэgZ’ЭXух_с¶сVЭИeјnMЫ©щъ/ЬЅЪMЪ°ўЪq_ыП4‘KRS¬OHЛюЛЕЫЖ[u#—сє5m'ЫЙbt§К_Х¦_¬W€Є@µ|;™w’&/еpчjЛСыШIтл‡»W[Nх±#’”Ф†»W»IXЋў(°Аў|QмД]Їv“6,°(ЉўА‹РўШ‰оХnТ†Ґў(°АBY;сDЧ«Э¤гIX`RXЁЕЋ{µ›ґaЃ…ў(
,°АЉЉbЗЅЪrЄw^Є,‡ЗШ«-§ъШЙvЬcЇKvв‰®ЧWШ№Ѕ“rnєtKхАНА·и,RSGJE.#еc?RSпш,Ї{^уЧОNжэN<СIќвN¶“нэ^7біBv¬юdЎ…нXкgЎ…нш_СЋПЧЅ¤іЪљ¤џ	ђ&ъЅьN¶Zнs€1*  "N "K* T ~·>( >P2я "Q "Є"Ц"e!aН!CННMжЯюКSюКSНJН‘Ї2‚Ъ>	НP!R!hННMжЯюY(ДюКSюКSюNКSжН9>
2Љ> !‹х>я2‚ЪсхЕХеНPЕНБЇНP·(жа(р:Љ=2ЉКcбСБсТЇ2‚Ъ:Њ·(Н>
2ЉбСЛєБс·Н+>
2ЉбСБzЛъ<ю( ксЙNЛyЛ№#ВJНJтНю щЙ!‹
4#6 ###чЙ!‹
#6###шЙ!‹
6 #6  хЙГ  Г  Г  !^Нн{€ЙU \S1     ATTACHES0U0tmU  DISK FORMAT UTILITY VERSION 1.8
             COPYRIGHT 1982, OTRONA CORP., BOULDER, CO


PLACE UNFORMATTED DISK IN DRIVE B:
FORMAT WILL BE DOUBLE SIDED, DOUBLE DENSITY, 10 512 BYTE SECTORS/TRACK=( JFORMAT >ѕ
TRY AGAIN ? (Y OR N©
FORMAT ANOTHER DISK ? (Y OR N©НP                	    
ЖНЫ Н“ G@НЫ ±°ГQ!
Н· ВЬyН“ GЂГѕ!Н· ВфНЫ Н“ ±ГQ!Н· ВНvяVvFORMAT.HEX (        Пя	  
 НяЛя  Оя Мя Кя   Зяјя єя ѕя№я »яoяЖяЅя хяЙяЕятяИя  ья  ъяыяСя        ! " & % $ ' шя# ія±я¶яґяяюёя«яЈяЮя­яЇяњяІя°яяяеях¤5‚jTUSb=©я­¦’:UTЅЪч‚Є¦ѓъ‚Ъ}AU#ЄЁЄZµчuхT-/ЁE+Ньо]еpшю»џя•6КЅыюWЪ 7”zЄ–їЛїГчЯMь+•B”.fяо’oЗш”ҐќI=UЛЯѕ zю•v_[П_{ОЇwЮ{игцўЯCK®§jщѕ q}—YЗXЮ#dЯ±,!ы~№бZо(хT-зк.ї„ШfлРеrиьнMї—ЯЮ™ЯCчР=UЛ_…и»М:Ж’Т<Л{„м;–%#dЯ± Њђ}/·®§jщ+/и2ЭтотРжротэь}щоьoщz™јcv‰s=UЛЯАЊm¶qcЋФYrиь=rих=6ДЎу7QМ‹ПхT-З]жrs|пЦmпжю–Х;6оІv€m¶CЧSµьХьwас&Љywиw—‡6‡wYЅ‹AHw™(CROХт7^Р&w—‡6‡wYЅc•0H=b1ы%ДeEВҐћЄеыьйFё‡Fё—Ј_Юџ‡ЮЗrнG9¤—Йыs“zЄ–o_PCГЭупv»чQТЛдэщБЭуЧнvп#ПЈћЄе»щТЛдэщЎзЯЭуїыюWоc9ъ‚:ъ‚єs=UЛw^РЈ/ЁЮ,чРЗ]ґBЯC.Й_’cIvЇп§®§jщћщч}›H`С`д’мю’Мѕ‚Y/Йф}Z®§jщж:ДЗЊ†Ж&ь4 1 )эњ‘йlHDЩхT-Я’їЧҐщъБч}Яч}Яч}ЯG#жS¦ROХтM.и4$pВпmЩЬцрiD¬ЏFLз]ЬхT-ЯѓFМДЂ 3нбЈЇтX4ТП,®§jщ.4
fД446‘@>-іA|HHCжЊTжzЄ–пИїwё~АЊ†Ж&ьT 10|йCР1¶¬§jщЅ4ТП†„ рр!и	c }:QІ!)ФSµь6я~oЯпмmыpКТПFў€йlЗDєЊzЄ–Яё ±hђ%­НюМ€ihlВпBКхC"ќТ's=UЛпд‰вwфН)}ДґЏдГ5fД446Ўd=UЛoе‚ц±(€	02нCР2Дпи›Sъ€i%Ho=UЛo&кн}A™пЉпЉr_Pъѕ рЭ]OХюъB=Ьy_Pтѕ „Ыs=U“єХ%TVЅя хяЙяЕятяИя  ья  ъяыяСя       нs-1Ђ* e " "®"Ъ"X*  " "!(Нщ!ЬНщНжЯюКН!я"/Н–Г{Ї2‚Ъ*/Нщ!йНщНжЯюY(ЖюКюNКл!НщНжЯюY(«юКюNКл>!ЂG>
21x х>я2‚ЪсхЕХеНЕНБЇН·(жа(р:1=21КVбСБсТЇ2‚Ъ>
21бСБ$${ю
  zю(сісЙNЛyЛ№#ВM TYPE    |
;|  0=NORMAL MSSG.,1=COMMAND LINE,2=   |
;|  COMAND LINE WITH IMMEDIATE EXECUTE |
;|-------------------------------------|
;
CHKCOM:	CALL	FINDAL	; FIND ADDRESS OF TABLE
	LXI	D,7
	DAD	D	; GET ADDRESS OF TYPE BYTE
	MOV	A,M	; GET IT
	STA	ALMTYP	; STORE IT
	RET
;
;|-----------------------------------|
;|  SET SCREEN ATTRIBUTES TO HILITE  |
;|-----------------------------------|
;
CLRATT:	LXI	H,ATTCLR
	JMP	VALMSG
;
;|----------------------------------------|
;|  FIND IF NEED TO SKIP BACK EXTRA SPACE |
;|   IN RESCHEDULE. I.E. " ","/", OR ":". |
;|----------------------------------------|
;
LOOK:	MOV	A,B
	CPI	9
	RZ
	CPI	6
	RZ	
	CPI	3
	RET
;
;|---------------------------|
;|   ----- NOT SURE  ------- |
;|---------------------------|
;
CNVALM:	LXI	D,ALMBUF
	MOV	A,M	;CONVERT MONTH FROM 1 BYTE INTO 2
	CPI	3AH
	XCHG
	MVI	M,30H
	JRC	..L1
	MVI	M,31H
	SUI	10	
..L1:	INX	H	;READ DATE & TIME INTO BUFFER
	MOV	M,A	;FOR RESCHEDULE
	INX	H
	INX	D
	LXI	B,6
	XCHG
	LDIR
	XCHG
	RET
;
	.PAGE
;
DAYCHK:	DCX	H	;CHECK MONTH SO
	DCX	H
	CALL	CHKMOS	;WE KNOW HOW MANY DAYS ARE OK
	INX	H
	INX	H
;
CHKDAY:	PUSH	B
	DCX	H
	MOV	A,M
	DCX	H
	MOV	B,M
	INX	H
	INX	H	;CHECK INPUTTED DAY
	PUSH	H
	CALL	ASCBIN	;FOR MAX
	ORA	A
	JRZ	..J1
	PUSH	PSW
	LXI	H,DAYTBL-1
	LDA	MONTH
	MOV	E,A
	MVI	D,0
	DAD	D
	MOV	B,M
	POP	PSW
	CMP	B
..J1:	POP	H
	POP	B
	RC
	JMP	NOGOOD
;
CHKMAX:	MOV	A,B	;CHECK MONTH,DAY,HOURS,OR
	CPI	12	;MINUTES FOR LEGAL VALUE
	JZ	CHKMIN
	CPI	9
	JZ	CHKHRS
	CPI	6
	JZ	DAYCHK
	CPI	3	
	JZ	CHKMOS
	XRA	A	;NO NEED TO CHECK
	STC
	RET
;
INVALD:	PUSH	H
	PUSH	B
	LXI	H,BADKEY
	CALL	SOUND
	EI
	POP	B
	POP	H
	RET	
;
BACKUP:	DCX	H
	INR	B
	JMPR	S1
;
	
BAKSPC:	LDA	LIMIT
	CMP	B
	RZ
	INR	B
	DCX	H
	BIT	0,B
	JRZ	..S1
	INR	B
	MOV	A,B
	CPI	8
	JRZ	..L2
	DCX	H
..L2:	PUSH	H
	PUSH	B
	MVI	B,15
..L1:	MVI	C,8
	CALL	VALDSP
	DJNZ	..L1
	JMPR	..S2
..S1:	PUSH	H
	PUSH	B
..S2:	MVI	C,8
	CALL	VALDSP
	CALL	CLTOND
	XRA	A
	INR	A		
	POP	B
	POP	H
	RET
;
S1	=	..S1	
;	
;
ASCBIN:	ANI	0FH
	MOV	C,A
	XRA	A
	RAL
	MOV	A,B
	ANI	0FH
	MOV	B,A
	RAL
	RAL
	RAL
	ADD	B
	ADD	B
	MOV	B,A
	MOV	A,C
	ADD	B
	RET
;
CLTOND:	PUSH	PSW
	PUSH	B
	MVI	C,ESC	;CLEAR TO END
	CALL	VALDSP	;OF SCREEN
	MVI	C,"K"
	CALL	VALDSP
	CALL	HILITE
	POP	B
	POP	PSW
	RET
;
WRTMOS:	MVI	C,ESC
	CALL	VALDSP	;SET UP TO WRITE A VALUE TO
	MVI	C,"@"	;CMOS RAM AT ADDRESS IN D
	CALL	VALDSP
	MOV	C,D
	JMP	VALDSP
;
SETALM:	CALL	FINDAL
	MVI	D,0FH	;NEXT ALARM IM CMOS RAM
	MVI	B,7	
..L1:	PUSH	B
	CALL	WRTMOS	;WRITE THE NEXT ALARM UP IN
	MOV	A,M	;CMOS RAM
	ANI	0FH
	MOV	C,A
	CALL	VALDSP
	INX	H
	INR	D
	POP	B
	DJNZ	..L1
	CALL	WRTMOS
	LDA	ALMNUM
	MOV	C,A
    	CALL	VALDSP
	INR	D
	CALL	WRTMOS
	MOV	C,M
	JMP	VALDSP
;
CMPH:	PUSH	H
	PUSH	D
	POP	Y
	POP	X
	MOV	A,8(X)
	MOV	B,8(Y)	
	CMP	B
	JRZ	..J0
	JRNC	..J1
	RET
;
..J0:	PUSH	H
	PUSH	D
	MVI	B,7
..L1:	MOV	A,M	;COMPARE DATE & TIME OF
	XCHG		;ALARMS IN DE & HL
	CMP	M	;RETURN WITH EARLIEST IN HL
	XCHG
	JRNZ	..L2
;
	INX	H
	INX	D
	DJNZ	..L1
;
..L2:	POP	D
	POP	H
	RC
..J1:	XCHG
	RET
;
DSPTM1:	MVI	C,HOM
	CALL	VALDSP	
	MVI	C,LF
	CALL	VALDSP	
DSPTIM:	CALL	FINDAL
	MOV	A,M	;MONTH
	CPI	3AH	;<9 ?
	MVI	C,SPC	;BLANK LEADING ZERO
	JRC	NOONE
	MVI	C,31H
NOONE:	CALL	VALDSP
	MOV	A,M
	CPI	3AH
	JRC	..L1
	SUI	10
..L1:	MOV	C,A
	CALL	VALDSP
	MVI	C,"/"	;INSERT "/" BETWEEN MONTH & DAY
	CALL	VALDSP
	INX	H
	MVI	B,2
..L2:	MOV	C,M
	CALL	VALDSP
	INX	H
	DJNZ	..L2
	MVI	B,2
..U1:	MVI	C,SPC	;TWO SPACES BETWEEN DATE & TIME
	CALL	VALDSP
	DJNZ	..U1
	MVI	B,2
..L4:	MOV	C,M
	BIT	0,B	;BLANK LEADING ZERO
	JRNZ	..Z1
	MOV	A,C
	CPI	30H
	JRNZ	..Z1
	MVI	C,SPC
..Z1:	CALL	VALDSP
	INX	H
	DJNZ	..L4
	MVI	C,":"	;INSERT ":" BETWEEN HOURS & MINUTES
	CALL	VALDSP
	MVI	B,2
..L5:	MOV	C,M
	CALL	VALDSP
	INX	H
	DJNZ	..L5
	RET
;
;|--------------------|
;|  GET PRESENT DATE  |
;|--------------------|
;
GETDAT:	MVI	C,ESC
	CALL	VALDSP
	MVI	C,":"
	CALL	VALDSP
	LXI	H,PRSDAT
	MVI	B,7
..L1:	CALL	CONIN
	CPI	"?"
	JRNZ	..J1
	LXI	H,PRSDAT+3
	JMPR	..J2
..J1:	ANI	0FH
	MOV	M,A
	INX	H
	DJNZ	..L1
;
	LXI	H,PRSDAT+4
	MOV	A,M
	ORA	A
	JRZ	..J3
	MVI	A,10
..J3:	DCX	H
	ADD	M
..J2:	MOV	M,A
	RET
;
	.XLIST
	.IFN	LSTATB,[
	.LIST
]
	.PAGE
;
;|---------------------------------------|
;|	   BUFFERS AND TABLES		 |
;|---------------------------------------|
;
;
REPICK:	.BYTE	HOM,LF,ESC,"U",21H
	.ASCII	"INVALID ALARM NUMBER"
;
WCHAM2:	.BYTE	HOM,ESC,"U",HLBOLD
	.ASCII	'ENTER ALARM NUMBER: '	
	.BYTE	SPC,SPC,BS,BS,ESC,"d",ESC,"U",HL+80H
;
ESCAPE:	.BYTE	ESC,"=",37H,3DH,ESC,"K","("	
	.BYTE	ESC,"U",HLBOLD,"S",ESC,"U",HL
	.ASCII	")ET OR PRESS "	
	.BYTE	ESC,"U",HLBOLD,"E","S","C",ESC,"U",HL
	.ASCII	" TO EXIT"
CURS:	.BYTE	ESC,"c",ESC,"=",37H,79+0A0H	
;
SETADR:	.BYTE	22,28,22,37,23,27,23,43	
SETLEN:	.BYTE	6,12,12,8
;
SETMSG:	.BYTE	HOM,ESC,"J",ESC,"U",HLBOLD,ESC,"S","1",ESC,"c"		
  	.ASCII	" ALARM MENU "	
	.BYTE	ESC,"S","0",ESC,"T",SPC+1,"\","\",ESC,"T",SPC
	.BYTE	ESC,'=',54,28+20H,ESC,'S','1'
	.ASCII	'НтНю щЙГ  Г  Г  !%Нщн{-ЙU \S1   ATTACHES0U0tmU  SYSTEM SAVING UTILITY VERS. 1.3
           COPYRIGHT 1982, OTRONA CORP., BOULDER, CO


SYSTEM WILL BE COPIED FROM 780H IN RAM TO DRIVE B: SYSTEM TRACKS=( JSAVE >ѕ
TRY AGAIN ? (Y OR N©
WRITE ERROR ON DRIVE В
SAVE ANOTHER SYSTEM їю Вw!PН  ВyН“ ЙНхН} сцАЙ* w#" ЙНЊюК@ю.К@Н< К!¦EН· В~ГP
!ОН· В’НPНЊ ГQ!жН· ВЄНPН} НQxГQ!кН· ВЖНЫ Н“ G@НЫ ±°ГQ!
Н· ВЬyН“ GЂГѕ!Н· ВфНЫ Н“ ±ГQ!Н· ВНvявSYSDUP.ASM E         
 	  ця    тяхя          ¶я¬я ­яѕя єя јяіяЯя  »яЇя«я·я Ія°я!   " Уя$ # % СяЅя±яОя& ' Дя( ПяёяЕя©я) Єя§яoя* + ¦яµя, №яШяґя- . Ёя/ НяМяѓя1 0 2 Ґя4 3 КяВяФя5 8 6 ъя7 9 чяЗяТяЭя: Ия; = < ? > Ця@ ЙяьяЧяХяB ыяD C ЛяA Аяйя’яБяфяЖяеяЬяяюпяЈяўяшя¤як¬z®ь„r>«ћ‡У*/­[шЗ/	щҐ&ЛHФ+s88ч¬zN‡ЉЅ\В?~€ѕ}r€NОgХуp:р€И…”ZbфMЃ*— Kэџ<†SЧуYх\щ	е|VќUГ—)»нEК#TК•ЎgХpкrV=W~B9џUgЭ‹[KРJты2$ZЛKsPЉз¤±'_N]*сlюR—9}xJты2€K±ЫH8ЎVЙ¬ы+О_кѓ‡;лМпЛЩГџUgЭ‹VэYч‚p6њєц™&G<ПfХY5њG—Ш«џ|ґюікlўх«Нй.f­) НйCПкч4fNwББfхWД2fО`^7eh6›дНЙњ>›EКэжфYДf№чЙbNЈgoiЪњ>›-?™УQЕfХYХ¤Ѕ:€K±ЫИ¬:ыЏ_чяB[тҐbЦ|ю~Щ’bЦ™eнhЦ|ЦPїЇ ±Yл¦­gэYЦЦп+P"«AїЇHI’ЮYgрYГЁ±Yл¦­gэYЦЋe,B‰fэYЦЋeЌНъі¬ЛШJd5иЇ€elЦ™eнhЦ|Ц0СъХіЦM[Пъі¬ќи«Q"«!СъХ)IТ;л>kx6kЭґх¬?ЛЪ‰%І­) R’¤wVќuџь«i=лФr6)яcікм-ё3шМ ё”9лФr6)яcіN-g'ъкY·ъ™Ч16л$ћЛOіоt»ЂOОљ П	тљН:µњќ( gќБgoiєНъі¬ќЂK>6лФrцХI~Ц|fђ{џ,Х¬?ЛЪ	ёдcіN-gse$љuџјҐйjЦџeн\т±Y§–іЇN‚DіОа3ѓ‰Со¬?ЛЪ	ёдcіОаsПxҐ9"ф¬3ш¬aдlЦ|f0	"їњныьhЬ`bШ¬	EЬ ™56лWѓЦіNйНє#ЁясSдОєs»ЭчяшСіе^zqѓ·№НЖ2v†ыЛfэ±ЊН:і¬Г	х\т±ЩpкљZО&еlЦ|f°ЬK>6лФr6)яcі}_"<њєL-g'ъкY·ъ™Ч16л$ћгЗш¬;·Ы·h@М:‰зтУ¬;Э.а“іNв9^ЗgЭйvџњu‡€лѕ/См?~Љ\Ь|бtЂБ†µWП:µњMКяШlЯяwj9;СWПєХПјЋ±Y'с?Жgѓ;·Ы·h@М:‰зтУ¬;Э.а“іNв9^ЗgЭйvџњu‡€лѕяС¬:«†T—тХеПЄіW'AxЬynр–¦gMђзщYgр™Б$И#Ш¬;D\_ndVќеК$H„› Пrп“eЦyN0љuџL‚<‚НєCДхе&AfХЩ«“ n‚<7xKУі&Иs‚С¬3шМ`D~9«О^n7ЎH8Ё`›5AћЊшYЩB°јЇьYЉёБjЦy®`4k‚<kИПљ ПFі—Kл‚[ џY|о¬	тЬ ‹±ЩXЖ"Ь_6лЇ€elЦ‚
‹Пќµ >ішЬЩpк*ЂП\…Щpк*ЂП¬g-ЂПМfCpj9[їЇЅ9В-ЂПВ	хjЦ©еlќЏиѓьY*\НјНmЦ©еlэѕbЦф6·Ywn·o'т¬[эМћНєs»}s4л¬›е}еПZ§л6л/›е}еПєУнr/ЅіTН†кTлY*\…0kA…ЕзО†SЧЧ—Kл2{;nр6·ЩXЖРёїlЦ_ЛШ¬	тЬ`ДПъЛfy_щібtА‚
іY*¬g-Ёp5лW_іYїъљНљPД–Y'ссіоЬєЫ·ѓћх«Їх¬	т\ ?{;hЬЇѕ.і&qѓzЦI<џНєs»ГйАеR¤ЬY*‚ЕзОєCДхеТєМЄі—K‘rq*,>w6њєЮ"Г¬:«О’т?†›PД	’YWOLіѕеLі~5h6лNЭнD9лФrvўЂњu‡€kRюЗfХYќЏиѓ|ЬyNрl¶пs„› Пд“fі}џСёu§оvЯgф¬uєNіоЬєЫ}џЈYЯ"gХЩD‰»C„y«!СљrVќMфХё;D·­_=«Окчё;D·фыЉYu¶ЂOвОа3ѓ·ь&п¬SЛЩ¤ьЏН:Ў-щR1л[д¬:«ћ+?ьЬік№e«rщцщ¬z®ьtруYuц–ЯдЕЭWGYU*”@ѕсlVќэ«iЌ»ЇЋІ8ЄдHFѓgћElЦ}ый=ЗГ©Л&eK¬Д=лѕ:КвЁbђгЊБ3ћБЁbђѓѓБ3ћAT‡a°Н`T1ИББ љgіоЫOп9юсЛB‚D~©ЙGл И—џ<¤ЬЯ‡ЁWч¬ык(‹yН ЯШ¬ыцУ{Бсp:TўвxЖd€­•—Ц-$zECEЃ¬Л…!Сш¬ык(Kа5ѓ|cђoтЌНєo?ЅяЗ/	Ь—sЁJHTјўCмRф}H	’}RB…ЗgЕҐDHЬ}u”%8Є<Уў•1€жЊ*УШ¬ыцУыЋk@д—љ,б ЌПЄіе^т1Ь}u”ЕјfђolЦ}ый}Зе=††µW‡ѓҐЋЃЮPџЅҐй†»ЇЋІolЦ}ый}Зoi:”{йґъ>¤„џеЮ'K…»ЇЋІolЦ}ый}З№чЙКЅфZ}RBџЅҐй
w_e1ЯШ¬ыцУыЋЯТt(чТhф}H	U|6Q"ЪЕЭWGYМ76лѕэфѕгUУ!Q"Ъ-сЩ†µWго«Ј,жѓјfіоЫOп;®‘_jІ„VSЙКJЅЎ>$>«ОЄ!iчµ*—Z­CДbеюYХі	ёдcёы*+ёЋfе}его«¬ЁНКBѕTао«¬а:љu_eEеНП~Щ’w_eEеh6ёП4•2ћН&AБpчUVT>г•ж€РіIщ%оѕКЉКgјТzVќuю#™§®}©хмaќ5е}еПZ§нsЈ1* e "S "й""Ѓ*  "P "M!cН4!Н4НOжЯюКUНL!3" Нї!I" НИ!`" НС!v"  <Ђ!ЂCл~лнЎв¤(хЇ2‚Ъ* Н4!Н4НOжЯюY(ќюКUюNКUл!‚Н4НOжЯюY(‚юКUюNКUл> !Ђ>!Ђ>!ЂCG>
2ўx х>я2‚ЪсхЕХеНRЕНBБЇНR·(жа(р:ў=2ўКбСБсТЇ2‚Ъ>
2ўбСБ$${ю
  zю(сісЙNЛyЛ№#ВLНLтНю щЙГ  Г  Г  !`Н4н{ЈЙU \S1   ATTACHES0U0tmU  SYSTEM DUPLICATION UTILITY VERS. 1.8
           COPYRIGHT 1982, OTRONA CORP., BOULDER, CO


SYSTEM WILL BE COPIED FROM DRIVE A: TO DRIVE B:=( JDUPLICATE >ѕ
TRY AGAIN ? (Y OR N©
READ ERROR ON DRIVE Б
WRITE ERROR ON DRIVE В
READ ERROR ON DRIVE В
BAD COMPARЕ
DUPLICATE ANOTHER ? (Y OR N©Н} НQxГQ!кН· ВЖНЫ Н“ G@НЫ ±°ГQ!
Н· ВЬyН“ GЂГѕ!Н· ВфНЫ Н“ ±ГQ!Н· ВНvяЛnSYSDUP.HEX '        Пя	  
 НяОяЛяКя   Мя Зя єя јя ѕя№я  Жя»я  тяхяЙяЕяЅяoя Ия ья  ыяСя    !  $   & % " # ±я ґяіяёя¶яяюпя«яЈяЮя­я°яЇяеяІяяяшя]їіНЭ/»Юas_»~§ЏН]о|»Ъ<ћnlкІ“Іy?ЭШLvјГЋ6O7ІТх9дxє±ф>J<Р§ЛсЩьPцДЌt[~({©г«лsИщmМќn‡ЛсП~({~ЏК¦ѕЌЊ]џCЋxєНвn:xOMп¦Yп•йZ’VfоЇл¦!]џCКПv»ьСtRѓкa—?љnrЩv”®П!Gцt[юhZг0цЩГ.4@юЅ!g¬dїV‚hYЧзђc/яТЛ…‡ҐN©a±..еЏ¦ѓ·эh:x7ЌЪх9дPO·¬чКt­k”Eйєђґ2sЧЕХКМY‰!~4}йъrщѓwУ¬чКt­k”E\’VfоєёZ™№!+‰єлsИСћnДЧoИї‡а±оЇГђщ>Цгл0дЊЪє>‡Z~оcЅ„‹{yv ы±Ћ:±j‹u©ЁУFПэ®П!G}єmz|·iљѕJmz|'{ёІuK}”вGирјлsИ}щ‹­мл± СPС.5,Ц%ЦKёш± С`–Хх9дцУ­№Oкzс ЦЏ¶/u=,Џ
HMqµdЇZУх9дщеhf»›f»!Х_ЏgMгu]ыU5ХвйF‹Иє>‡Ьуtw[<Э0ІЯMпҐчI‰GSHfК‘LC2w}№3щ}Я'†C‚Aб ™€#™‰п™i$3ѕ?1ЄЁ®П!·<ЭN9Ф>9йцlTbHЕКеOє%ХpФ^w}№•ьюdњс„—р
№~с}Яч}Яч}џБЪх9дNћnYзЈЖTЬS†~ THШНgЋY№џБZ“®П!w“<чrуiЦ6¦Ы»щЦл———‰QCҐє>‡Ьлй–CнПћЉЌН§9>ѓuNЕ!}fcVjџ\ЄлsИ]еSMЖс‰(юђХ'ЗT“q|:
’РI¦є>‡<рtЛBNє=ѓrьXЙє~ЋGщчW¬®П!ЛпGх-Ј|Ц±ПUФЛCђ>g<fы¬%лътаУ-—OЋ©&гш/іS9>g<fы¬\л]џC#їOЋ©&гшН/cAъњсuміrщ¤Ях9д±єSMЖс›_h‚ф¬ФsbЬжељњt{6Ґє>‡<D~*1дшлђВыQ}Л(џuмsµVЧзOыЭЫќt·»я Зя єя јя ѕя№я  Жя»я  тяхяЙяЕяЅяoя Ия ья  ыяСя    !  $  TO CREATE A SYSTEM FROM THE BIOS25.HEX AND CCP.HEX THE FOLLOWING

STEPS MUST BE TAKEN:


	1.  LOAD THE SYSTEM INTO MEMORY WSET'	
	.BYTE	ESC,'=',54,37+20H
	.ASCII	'REVIEW'	
	.BYTE	ESC,'=',55,27+20H
	.ASCII	'CANCEL'
	.BYTE	ESC,'=',55,43+20H
	.ASCII	'EXIT'
	.BYTE	ESC,'S','0',ESC,'=',55,24+20H
	.BYTE	ESC,"T",SPC+1,"\","\",ESC,"T",SPC
	.BYTE	ESC,"=",36H,84,ESC,"T",1,"\","\",ESC,"=",37H,84,"\","\"
	.BYTE	ESC,"T",0,ESC,"=",36H,91	;NORMAL CHAR SET
	.BYTE  	ESC,"U",2EH
	.ASCII	'ALARMS IN USE'
	.BYTE	ESC,"=",37H,87,ESC,"U",HLBOLD,ESC,"S",31H
USD1:	.BYTE	SPC,SPC	;THE ALARMS USED ARE FILLED IN BY 
USD2:	.BYTE	SPC,SPC	;THE PROGRAM
USD3:	.BYTE	SPC,SPC
USD4:	.BYTE	SPC,SPC
USD5:	.BYTE	SPC,SPC
USD6:	.BYTE	SPC,SPC
	.BYTE	ESC,"S",30H+80H
;
ALMAVL:	.BYTE	HOM,ESC,"J",ESC,"=",36H,68,ESC,"U",HLBOLD
	.ASCII	'ALARMS AVAILABLE:'
	.BYTE	ESC,"U",HLBOLD,SPC,ESC,"S",31H
AVL1:	.BYTE 	SPC,SPC	
AVL2:	.BYTE 	SPC,SPC
AVL3:	.BYTE 	SPC,SPC
AVL4:	.BYTE 	SPC,SPC
AVL5:	.BYTE 	SPC,SPC
AVL6:	.BYTE 	SPC,SPC
	.BYTE	ESC,"S","0",ESC,"=",37H,68,ESC,"U",HL
	.ASCII	"PRESS "	
	.BYTE	ESC,"U",HLBOLD
	.ASCII	"ESC"
	.BYTE	ESC,"U",HL
	.ASCIS	" TO EXIT"	
;
;
;SCREEN DUMP MENU
;
DMPLEN:	.BYTE	10,9,13,13,4
DMPADR:	.BYTE	22,30,22,45,22,62,23,36,23,56
;
DUMPMN:	.BYTE	HOM,ESC,"J",ESC,"=",22+20H,24+20H
	.BYTE	ESC,"U",HLBOLD,ESC,"S","0",ESC,"T",SPC+1,"\","\",ESC,"T",SPC
	.BYTE	ESC,'=',54,30+20H
	.ASCII	'QUICK TEXT'
	.BYTE	ESC,'=',54,45+20H
	.ASCII	'TEXT ONLY'
	.BYTE	ESC,'=',54,62+20H
	.ASCII	'GRAPHICS ONLY'
	.BYTE	CR,LF,ESC,"U",HLBOLD,ESC,"S","1"
	.ASCII	" PRINT MENU "
	.BYTE	ESC,"U",HLBOLD,ESC,"S","0",ESC,"T",SPC+1,"\","\",ESC,"T",SPC
	.BYTE	ESC,'=',55,36+20H
	.ASCII	'ENTIRE SCREEN'	
	.BYTE	ESC,'=',55,56+20H
	.ASCII	'EXIT'
	.BYTE	ESC,"c"+80H
;
RETST:	.BYTE	ESC,'Z',ESC,'J'+80H
;
PRSDAT:	.BLKB	7
ALMNUM:	.BLKB	1
LIMIT:	.BLKB	1
MONTH:	.BLKB	1
VALKEY:	.BLKB	1
ALMTYP:	.BLKB	1
LENCOM:	.BLKB	1
;
	.LOC	BEGIN+1800H-320	
CMNSPC	=	.
;
	.END

MSHERC  COM            `©ѕ  QBASIC  EXE            `©ВќЩ GORILLA BAS            `©>Іr  4201    CPI            `©MxN  ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее
        .XLIST


DJNZ    MACRO   X
        .Z80
        DB      10H             ;DJNZ opcode.
        DB      X-$-1
        .8080
        ENDM

LDED    MACRO   X
        .Z80
        LD      DE,(X)
        .8080
        ENDM

SDED    MACRO   X
        .Z80
        LD      (X),DE
        .8080
        ENDM

LDIR    MACRO
        DB      0EDH,0B0H
        ENDM

LDRR    MACRO
        DB      0EDH,0B8H
        ENDM

JMPR    MACRO   X
        .Z80
        JR      X
        .8080
        ENDM
JRC     MACRO   X
        .Z80
        JR      C,X
        .8080
        ENDM
JRNC    MACRO   X
        .Z80
        JR      NC,X
        .8080
        ENDM
JRNZ    MACRO   X
        .Z80
        JR      NZ,X
        .8080
        ENDM
JRZ     MACRO   X
        .Z80
        JR      Z,X
        .8080
        ENDM

        .LIST
FC      EXE            `©њЪH  FIND    EXE            `©¦b  GRAFTABLCOM            `©Є8  GRAPHICSCOM            `©ІЮL  ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееITH DDT.COM

A>DDT 
DDT VERS XX

-IBIOS25.HEX
-R4580
NEXT   PC
XXXX      
-ICCP.HEX
-R4580
NEXT  PC
XXXX
-G0
A>

	2.  NEXT SAVE THE SYSTEM ON THE SYSTEM TRACKS OF THE A DRIVE

A>SAVSYS
-------------------------------------------------------------------------------
                                                                                                                                Ё†a,/–џОЕ† Ў7НПІј-]Qыо®ькV.WаMv4\‹iґ !љ+ґџуНABoљЫшХ­\Х0|“… -H€ж
н§Её xЎ7-|sъшХ­\Sv4<?±еM™б¶?Лт ОpЅјp+ыпс«[№6Є!Ыъ.сЖъ®_ъх®†·ИЦ-\& ЏЙшХ­\Є —‰ВПІјn< пЮ№[ЬКп%иіw›[џЅ»\Њ_ЭКuPЅдћgѕfћ№^s)јa;яЛ–_@рxЖЇnе*
„ЮґрMvЭЁ†б6®?Лтp!;¬†W2~u+QЛОеЪRvџ8ЧЮeЗҐ№¶ґ‰чгЊ=rбЊ_ЭК%
„wqI	пв’Т§Hјg›[џ"с~њ`›ёОшХ­њЁв!Zт®Ь>ExzsоЌ†Ў^)ё[ЪMДЖЇnеlЮ3§уЖ\ЮkжЩМзbыY–'Уы„Ч}™пс«[9Х0‚Ѕiб›liчeyQ)Юx@_Hчy{»™Ћ_ЭК№Хђсхszѓ@ЯЅC;|¤Е¶ІП3§у†Ззїє•уG5д
ЯdGэ,ЛC#Ё†w‹Eю~{зЁq®m'“·”с«[9·ЮtЮузЁpЖN8СpTГkk‹ьx9ез„а=їє•уў†ЮґрMvь„УЌЧ’S~ОРgш&;§ь7гW·r8cзq†уp…ҐзЕРy!f^l+ЫmО™=~u+gPyMЮ3§с†ҐvДxЅҐy‹рИПщD…“6~u+'зб<П\ЊЧОљyeЗ_бч&B]DО+њбяЖЇnе|Ё†z€ђќП‹С‰fћ	Ъњ“Ч0§сrЏ_ЭК
„s±э,ЛЧf‡ҐvДxџ(иyбЮDxЦшХ­ьХPвїрMsn^4ЄЃІs¬р_%њRжшХ­ьMbUC†еС6ЛЉ/еoЏЎуЬeтJсі,н2~u+я‰jШЁ®VГ[¶nЮњсяЕЮыГ=ьЁ†Ч2~u+я_Qп6·нёќ5уК2C=„N^Ј1^
яфпгW·тWTГМ}ЌЖx)ьeъ)—wоjиЦл№†(`ы‘НлsькVюWQ^eтf†мјtX4ПЏL^`'‹wн3‹ТЗЇnе_PЭвчр—v—Йт°Cv^:3,љ—¶#Жл]жшХ­ьЈЂ4o:яЅmAаЁјЃ¬7ГяІеЯoпЧOдЋ_ЭК_Pч‹Ьv8yџ г wH'Вy8ЅЧМЫRv6~u+я§АюFs1^ыЃќ8Пњ“7УПІ<)ЮЮ@ЯsЖЇnеnTГ-тпчж–Юn[zЛЯoЅ-эъхл'?ЮЪЇЭ~сњ5~u+·+аtБЧВннЁ†}чцFЂѕыЮ?ѕ6·7иЫяшХ­ЬХpлэеЯ/g?оLОр8;нііfћ%G·wdькVо©Ё†ъоц† }7ВЩ\vЦМіДчгNgє`!mгW·roTГ]ЬЎ/NL;kжYrtq§П‹Ўуd†яeЛїє•[°?ђNoљЇ™ЫК†јВёS›3„°Ћ_ЭК}P№я\)}—ај п<щЪл™ Єkїє•»(°O~<ЕЪЮ пЭєuл~S±ц›Т›ТeКlькVnўи\zУь,ЛлцъКЬо¶Эm{ш&;ЗцшХ­ЬўЁ†Ў†SШХПд––9ЯѕчwЫzЕm—+<шзїє•ЉjЂєНЛ†—ЭЎэґ,nй\?ЛтєХ0<“Ы»Ьс«[©­Ђ7Рw·Ы†ЫЮ№~Огµі<oЅP!SJ8o^yгW·RХP:Y;oіХПyј‹k…(lчуxct;ьyЯїє•єр^ћW$єwМ›jтћ9…ЧПІј-тч3љузеїє•ъЈ>iЎпIµі<ПњЏw‹№ЂW~БЮбљT;«уюькVкVАПІјтпќkвCзyЈp?дu?Џч<уеyђс«100 REM ***********************************************************************
110 REM *                                                                     *
120 REM * Name: BOXES                                                         *
130 REM * Rev.: 1.0                                                           *
140 REM * Date: May 14, 1982                                                  *
150 REM *                                                                     *
160 REM * Desc: Fast action block graphics demonstration                      *
170 REM *                                                                     *
180 REM *                                                                     *
190 REM ***********************************************************************
200 PRINT CHR$(27);">";
210 RAND$=INKEY$+INKEY$+INKEY$+INKEY$:A$=INKEY$+INKEY$
220 SEED = VAL(RAND$)
230 RANDOMIZE SEED
240 FOR K = 1 TO 20
250 GRAPH
260 INCR = ABS ( INT (10 * RND) )
270 IF INCR < 2 THEN 260
280 X = ABS ( INT (160 * RND) )
290 X1 = 319 - X
300 Y = ABS ( INT (120 * RND) )
310 Y1 = 239 - Y
320 GOTO 340
330 GRAPH L(1,20):PRINT"SEED:";SEED;" INCR:";INCR;" (";X;",";Y;") (";X1;",";Y1;")"
340 ST = INT ((230-Y)/INCR)
350 F1 = INT ((310-X)/INCR)
360 IF F1 < ST THEN ST = F1
370 FOR J = 1 TO 2
380 IF J = 2 THEN GRAPH C: INCR = - INCR
390 FOR I = 1 TO ST
400 PLOT B(X,Y) (X1,Y1)
410 X=X+INCR:Y=Y+INCR:X1=X1-INCR:Y1=Y1-INCR
420 NEXT I
430 A$ = INKEY$: IF LEN (A$) = 0 THEN 450
440 IF ASC (A$) = 24 THEN SYSTEM
450 NEXT J
460 NEXT K
470 GOTO 200
420 NEXT I
430 A$ = INKEY$: IF LEN (A$) = 0 THEN 450
440 IF ASC (A$A8B8C8D8E8F8G8H8I8J8K8L8M8N8O8P8Q8R8S8T8U8V8W8X8Y8Z8[8\8]8^8_8`8a8b8c8d8e8f8g8h8i8j8k8l8m8n8o8p8q8r8s8t8u8v8w8x8y8z8{8|8}8~88Ђ8Ѓ8‚8ѓ8„8…8†8‡8€8‰8Љ8‹8Њ8Ќ8Ћ8Џ8ђ8‘8яя“8”8@:яяяя8™8љ8›8њ8ќ8ћ8џ8 8Ў8ў8Ј8¤8Ґ8¦8§8Ё8©8Є8«8¬8­8®8Ї8°8±8І8і8ґ8µ8¶8·8ё8№8є8»8ј8Ѕ8ѕ8ї8А8Б8В8Г8Д8Е8Ж8З8И8Й8К8Л8М8Н8О8П8Р8С8Т8У8Ф8Х8Ц8Ч8Ш8Щ8Ъ8Ы8Ь8Э8яяЫ;а8б8в8г8д8е8ж8з8и8й8к8л8м8яяо8Q:р8с8т8у8яяяяц8ч8ш8яяяяы8ь8э8ю8я8 9;************************************************
;*                                              *
;*           GRAPHIC PRINTING ROUTINE           *
;*                 C.ITOH 8510A                 *
;************************************************
;
	.PABS
	.PHEX
	.XSYM
BASE	=	2000H
;
	.LOC	BASE+1800H
;
	JMP	DUMPS
;
HOM	=	1EH
HL	=	22H
HLBOLD	=	26H
SPC	=	20H
ESC	=	1BH
CR	=	0DH
LF	=	0AH
SPRTR	=	0F3H
DPRTR	=	0F2H
SDSPY	=	0EEH
DDSPY	=	0FEH
CONIN	=	BASE+9
CONOUT	=	BASE+6
VALDSP	=	BASE+6
DUMPMN	=	BASE+64H
LINOFS	=	BASE+6DH
LINDSP	=	BASE+21H
VALMSG	=	BASE+24H
RETVAL	=	BASE+0CH
BADKEY	=	BASE+37H
SOUND	=	BASE+1EH
GETDMP	=	BASE+6FH
CONST	=	BASE+7BH
;
GRLINS:	.BYTE	30	;30 FOR 8 BIT / 40 FOR 6 BIT
;
DUMPMS:	.BYTE	HOM,ESC,"S","1",ESC,"U",HLBOLD
NAME:	.ASCII	"   C.ITOH   "
	.BYTE	ESC,"S","0",ESC,"c"+80H
;
SCRSTR:	.BYTE	2,CR,LF		;SCROLL 8/6 BITS-10 BYTES ALLOCATED
	.BLKB	7
GRFSTR:	.BYTE	8,ESC,'Q',ESC,'S',30H,36H,34H,30H	;GRAPHICS MODE
	.BLKB	1
SETSTR:	.BYTE	6,ESC,'T',31H,36ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееH,ESC,'N'	;SET-UP PRINTER
	.BLKB	3
RETSTR:	.BYTE	3,ESC,'A',LF		
	.BLKB	6
ENDGR:	.BYTE	1,CR
	.BLKB	8
;
DUMPS:	MVI	A,239
	STA	GRFY
	XRA	A
	STA	DUBFLG
	MOV	H,A
	LDA	LINOFS
	MOV	L,A
	SHLD	COL
;
DUMPS1:	LHLD	DUMPMN
	CALL	VALMSG
	LXI	H,DUMPMS
	CALL	VALMSG
	CALL	GETDMP
	CPI	LF
	JRNZ	NLF
	MOV	C,A
	CALL	LST2
	JMPR	DUMPS1
NLF:	CPI	ESC
	JZ	RETVAL
	ORA	A
	JZ	QIKTEX
	CPI	4
	JZ	RETVAL
	PUSH	PSW
	CALL	SETPRN
	POP	PSW
	DCR	A
	JZ	DUMPTX
	DCR	A
	JZ	DUMPGR	;DUMPAL NEXT
	JMP	DUMPAL
;
ESCOUT:	MVI	C,ESC
	CALL	CONOUT
	MOV	C,D
	JMP	CONOUT
;
LST2:	MVI	A,10H
	OUT	SPRTR
	IN	SPRTR
	ANI	24H
	CPI	24H
	JRNZ	LST2
	MOV	A,C
	OUT	DPRTR
	RET
;
QIKLIN:	MVI	B,80
	LXI	H,DSPBUF
	JMP	L1
;
QIKTEX:	LXI	H,NULL
	SHLD	MOD2+1
	MVI	C,CR
	CALL	LST2
	MVI	B,24
..Z1:	PUSH	B
	LXI	H,DSPBUF
..L1:	PUSH	H
	CALL	REDTEX
..L2:	PUSH	PSW
	LDA	CHAR
	CPI	7FH
	JRNC	..N2
	CPI	20H
	JRNC	..N1
..N2:	MVI	A,"*"
	STA	CHARЉ..N1:	POP	PSW
	BIT	4,A	;DOUBLE WIDTH
	JRZ	..NODB	
	INR	H
	XTHL
	MVI	M,20H	;REPLACE 1ST CHAR
	INX	H	;WITH A SPACE
	XTHL
..NODB:	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A
	INX	H
	MOV	A,B	
	CPI	80
	JRC	..L1
	CALL	INCOL	
	CALL	CHKLIN
 	CNZ	QIKLIN
	LXI	H,CRLFS
	CALL	SNDSTR
	CALL	CONST
	JRZ	..M1
	CALL	CONIN
	POP	B
	CPI	ESC
	JRZ	ETX
	PUSH	B
..M1:	POP	B
	DJNZ	..Z1
ETX:	MVI	C,LF
	CALL	LST2
	JMP	RETVAL
;
CRLFS:	.BYTE	2,CR,LF
;
DUMPTX:	MVI	A,0C9H	;CODE FOR RETURN
	STA	GRFLIN	;DISABLE GRFLIN
	JMP	DUMPER
;
DUMPGR:	MVI	A,3AH
	STA	GRFLIN
	MVI	D,"7"
	CALL	ESCOUT
	MVI	A,239	;DUMP GRAPHICS ONLY
	STA	GRFY
	LDA	GRLINS	;# LINES DEPENDS ON # BITS
	MOV	B,A
..L1:	PUSH	B
	CALL	GRFLIN
	CALL	SCRLL	
	POP	B
	DJNZ	..L1
	JMP	RETURN
;	
GRFLIN:	LDA	GRFY
	MOV	D,A
	XRA	A
	MOV	B,A
	MVI	C,DDSPY
	LXI	H,GRFBUF
..L2:	MVI	E,4
..L1:	MOV	A,D
	PUSH	H
	PUSH	B
	CALL	LINDSP
	POP	B
	POP	H
	OUT	SDSPY
	INP	A
	MOV	M,A
	INX	H
	DCR	D
	DCR	D
	DCR	E
	JRNZ	..L1
	INR	B
	MOV	A,B
	CPI	80	
	JRZ	RETG
	MOV	A,D
	ADI	8
	MOV	D,AЉ	JMPR	..L2
RETG:	MOV	A,D
	STA	GRFY
	LXI	H,GRFBUF
	MVI	E,2
..L2:	MVI	B,160	
..L1:	MOV	A,M
	ORA	A
	JRNZ	PRNGRF
	INX	H
	DJNZ	..L1
	DCR	E
	JRNZ	..L2	
	RET
;
PRNGRF:	CALL	HIRES
	LXI	H,GRFBUF
	MVI	B,80
..L1:	LXI	D,BYTES
	PUSH	B
	LXI	B,4
	LDIR
	PUSH	H
	CALL	OUT4
	POP	H
	POP	B
	DJNZ	..L1
DON:	LXI	H,ENDGR
	JMP	SNDSTR
;
STLIN:	SHLD	MOD2+1	
	CALL	REDLIN
	CALL	CHKLIN
	JNZ	SETLIN
	POP	H	;RETURN ADDRESS
	RET
;
FIRST8:	CALL	STLIN
EL1:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE
	SDED	PRNPNT
	INX	H
	CALL	MAKE99
	CALL	OUT42
	POP	D
	POP	H
	INX	H
	INX	D
	POP	B
	DJNZ	EL1
	JMP	DON
;
LAST8:	CALL	STLIN
LL:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE8
	SDED	PRNPNT
	LXI	H,BYTES+5
	CALL	MAKE88
	CALL	OUT42
	POP	D
	POP 	H
	INX	D
	INX	H
	POP	B
	DJNZ	LL
	JMP	DON
;
OUT4:	PUSH	D
	CALL	MAKE
	LXI	H,PRNBYT
	MVI	B,4
..L1:	MOV	C,M
	CALL	LST2
	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	..L1
	POP	D
	RET
;
OUT42:	MVI	B,8	
	LXI	H,PRNBYT
L1:	MOV	A,M	
MOD2:	CALL	NULL	;MODIFIED
	MOV	C,A
	CALL	LST2
	INX	H
	DJNZ	L1
NULL:	RET	
;
ZROPRN:	LXI	H,PRNBYT
	PUSH	H
	SHLD	PRNPNT
	XRA	AЉ	MVI	B,8	
..L1:	MOV	M,A
	INX	H
	DJNZ	..L1
	POP	D
	LXI	H,BYTES
	RET
;
REDLIN:	XRA	A
	STA	COL+1
	LXI	H,DSPBUF
	LXI	D,ATTBUF
..L1:	PUSH	H
	PUSH	D
	CALL	REDTEX
	POP	D	;SAVE ATTRIBUTE
	XCHG
	MOV	M,A
	XCHG
	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A	
	INX	H
	INX	D
..L4:	MOV	A,B
	CPI	80	
	JRC	..L1
	RET
;
REDTEX:	LHLD	COL
	MOV	A,L
	ORI	0E0H
	MOV	E,A
	OUT	SDSPY
	MOV	B,H
	MVI	C,DDSPY
	INP	A
	STA	CHAR
	MOV	A,E	
	ANI	0DFH
	OUT	SDSPY
	ANI	1FH
	MOV	L,A
	INP	A
	RET
;
INCOL:	LHLD	COLЉ	INR	L
	MOV	A,L
	CPI	24
	JRNZ	..L2
	MVI	L,0
..L2:	XRA	A
	MOV	H,A
	SHLD	COL	
	RET	
;
CHKLIN:	MVI	B,80		;CHECK FOR EMPTY LINE
	LXI	H,DSPBUF
..L3:	MOV	A,M
	CPI	20H
	RNZ	
	INX	H
	DJNZ	..L3	
	RET
;
SETLIN:	CALL	HIRES
	LXI	H,DSPBUF
	LXI	D,ATTBUF
	MVI	B,80
	RET
;
FINDCR:	LXI	H,CHRTBL
	MOV	E,A
	MVI	D,0
	MVI	B,10
..L1:	DAD	D
	DJNZ	..L1
	LXI	B,10
	LXI	D,BYTES
	LDIR
	RET
;
DOSIX:	MOV	A,M
	CALL	CVERT	
	CALL	PUTIN
	MVI	B,1	
	CALL	CVRT20
	MVI	B,2	
	CALL	CVRT20	
	MVI	B,3	
	CALL	CVRT20	
	INX	H	
	LDED	PRNPNT	
	MOV	A,M	
	CALL	CVERT	
	CALL	IN3	
	MVI	B,1	
	CALL	CVRT21	
	MVI	B,2
	CALL	CVRT21
	MVI	B,3
	CALL	CVRT21
	INX	H
	LDED	PRNPNT
	MOV	A,M
	CALL	CVERT
	CALL	IN2
	MVI	B,1	
	CALL	CVRT22
	MVI	B,2Љ	CALL	CVRT22
	MVI	B,3
	JMP	CVRT22
;
MAKE8:	CALL	ZROPRN
	LXI	D,PRNBYT
	LXI	H,BYTES+1
	CALL	DOSIX
	LXI	H,BYTES+8
	LDED	PRNPNT
	JMP	MAC2
;
MAKE88:	CALL	DOSIX
	LXI	H,BYTES+9
	LDED	PRNPNT
	JMP	MAC2
;
MAKE:	CALL	ZROPRN	
	LXI	D,PRNBYT
	LXI	H,BYTES	
MAKE99:	CALL 	DOSIX
	INX	H
	LDED	PRNPNT
MAC2:	MOV	A,M
	CALL	CVERT
	CALL	IN1
	MVI	B,1
	CALL	CVRT23
	MVI	B,2
	CALL	CVRT23
	MVI	B,3
	JMP	CVRT23
;
CVRT20:	CALL	CVERT2
	JMP	PUTIN
;
CVRT21:	CALL	CVERT2
	JMP	IN3	
;
CVRT22:	CALL	CVERT2
	JMP	IN2
;
CVRT23:	CALL	CVERT2
	JMP	IN1
;
SETPRN:	LXI	H,SETSTR
SNDSTR:	MOV	B,M
	INX	H
SND1:	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	SND1
	RET
;
SCRLLееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее:	CALL	CONST
	JRZ	..L1
	CALL	CONIN
	CPI	ESC
	JZ	RETURN
..L1:	LXI	H,SCRSTR
	JMP	SNDSTR
;	
HIRES:	LXI	H,GRFSTR
	JMP	SNDSTR	
;
RETURN:	LXI	H,RETSTR
	CALL	SNDSTR
	MVI	D,'6'
	CALL	ESCOUT
	JMP	RETVAL
;
GETCHR:	CALL	FINDCR
	POP	H
	XTHL
	MOV	A,M
	ANI	0FEH
	XTHL
	PUSH	H
	RZ		;FALL INTO ATTFIX IF NEEDED
;
	.PAGE
;
;THIS CODE IS FOR CHRGRF.TAB
;
ATTFIX:	MOV	C,A
	BIT	4,A
	CNZ	DUBFIX
	MOV	A,C
	BIT	3,A
	CNZ	BLDFAC
	MOV	A,C
	BIT	5,A	;UNDERLINE
	CNZ	UNDLIN
	MOV	A,C
	BIT	6,A
	JRZ	..L1
	BIT	7,A
	JRNZ	STRKTH
	CALL	SUPSCR	;SUPERSCRIPT
	JMPR	REVRS
..L1:	BIT	7,A
	CNZ	SUBSCR	;SUBSCRIPT
	JMPR	REVRS
STRKTH:	LXI	H,BYTES+2	;STRIKE THROUGH
	CALL	FF
	LXI	H,BYTES+6Љ	CALL	FF
REVRS:	MOV	A,C
	BIT	1,A	;REVERSE VIDEO
	RZ
REVID:	MVI	B,10
	LXI	H,BYTES
..L1:	MOV	A,M
	CMA
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
BLDFAC:	LXI	H,BYTES
	MVI	B,10
..L1:	MOV	A,M
	ANI	77H	
	RAL
	ORA	M
	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
UNDLIN:	LXI	H,BYTES+9
	CALL	FF
	DCX	H
FF:	MVI	A,0F0H	
	ORA	M
	MOV	M,A
	RET
;
SUPSCR:	PUSH	D
	LXI	H,BYTES
	MVI	B,3	
..L1:	CALL	SHIFT
	DJNZ	..L1
	LXI	H,BYTES+8
	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+3	
	CALL	SHFLFTЉ	ORA	D
	MOV	M,A
	INX	H
	MVI	B,3
..L2:	CALL	SHIFT
	DJNZ	..L2
	LXI	H,BYTES+9
	CALL	SHFRGT
	MOV	D,A
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7
	CALL	SHFLFT
	ORA	D
	JMPR	SCRDON
;	
SHFLFT:	MOV	A,M
FOURHI:	RAL
	RAL
	RAL
	RAL
	ANI	0F0H
	RET
;
SHFRGT:	MOV	A,M
FOURLO:	RAR
	RAR
	RAR
	RAR
	ANI	0FH
	RET
;
SHIFT:	CALL	SHFLFT
	INX	H
	MOV	D,A
	CALL	SHFRGT
	ORA	D
	DCX	H
	MOV	M,A
	INX	H
	RET
;
SUBSCR:	PUSH	D
	LXI	H,BYTES+3
	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+8
	CALL	SHFRGT
	ORA	D
	MOV	M,A
	MVI	B,3
	LXI	H,BYTES+3
..L1:	CALL	SHIFT1
	DJNZ	..L1
	XRA	A
	MOV	M,A
	LXI	H,BYTES+7Љ	CALL	SHFLFT
	MOV	D,A
	LXI	H,BYTES+9
	ORA	D
	MOV	M,A
	MVI	B,3
	LXI	H,BYTES+7	
..L2:	CALL	SHIFT1
	DJNZ	..L2
	XRA	A
SCRDON:	MOV	M,A
	POP	D
	RET
;
SHIFT1:	CALL	SHFRGT
	MOV	D,A
	DCX	H
	CALL	SHFLFT
	INX	H
	ORA	D
	MOV	M,A
	DCX	H
	RET
;
DUBFIX:	PUSH	B
	PUSH	D
	PUSH	H
	LDA	DUBFLG
	ORA	A
	JRZ	HALF1
HALF2:	XRA	A
	STA	DUBFLG
	LXI	D,BYTES
	LXI	H,BYTES+4
	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+9
	LXI	D,BYTES+8
	CALL	STRCH
	CALL	SHFT
	CALL	STRCH1
	JMPR	HFDON
;
HALF1:	CMA	
	STA	DUBFLG
	LXI	D,BYTES+4
	LXI	H,BYTESЉ	MVI	B,4	
..L1:	PUSH	B
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
	ORA	C
	ORA	B
	MOV	M,A
	INX	H
	INX	D
	POP	B
	DJNZ	..L1
	LXI	H,BYTES+8
	LXI	D,BYTES+9
	CALL	STRCH1
	CALL	SHFT
	CALL	STRCH
HFDON:	ORA	C
	ORA	B
	MOV	M,A
	POP	H
	POP	D
	POP	B
	RET
;
STRCH:	MOV	A,M
	MOV	C,A
	ANI	44H
	RRC
	RRC
	MOV	B,A
	RLC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	88H
	RRC
	MOV	C,A
	RLC
	RET
;
STRCH1:	MOV	A,M
	MOV	C,A
	ANI	22H
	RLC
	RLC
	MOV	B,A
	RRC
	ORA	B
	MOV	B,A
	MOV	A,C
	ANI	11H
	RLC
	MOV	C,A
	RRC
	RETЉ;
SHFT:	ORA	C
	ORA	B
	XCHG
	MOV	M,A
	XCHG
	RET
;
.PAGE
;{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{
;{                                          {
;{          THIS CODE IS DEPENDANT          {
;{             ON THE # OF BITS             {
;{                                          {
;}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}
;
;
DUMPAL:	MVI	D,"7"
	CALL	ESCOUT	
	MVI	A,3AH	;CODE FOR LDA
	STA	GRFLIN	;RESTORE GRFLIN CODE
DUMPER:	MVI	B,6	
..L3:	PUSH	B	;THE CODE HERE IA FOR
	CALL	GRFLIN	;A PRINTER WITH AN 8 BIT HEAD
	CALL	TEX8	;AND BIT 0 ON THE TOP
	CALL	SCRLL
	CALL	TEX2H
	CALL	INCOL
	CALL	GRFLIN
	CALL	TEX6M	
	CALL	SCRLL
	CALL	TEX4H	
	CALL	INCOL
	CALL	GRFLIN
	CALL	TEX4L	
	CALL	SCRLL	
	CALL	TEX6H	Љ	CALL	INCOL
	CALL	GRFLIN
	CALL	TEX2L
	CALL	SCRLL	
	CALL	TEX8H
	CALL	INCOL
	CALL	GRFLIN
	CALL	SCRLL
	POP	B
	DJNZ	..L3
	JMP	RETURN
;
TEX8:	LXI	H,NULL
F88:	JMP	FIRST8
;
TEX8H:	LXI	H,NULL
L88:	JMP	LAST8
;
TEX6M:	LXI	H,SIXLO
	JMPR	F88
;
TEX4L:	LXI	H,FOURHI	;REVERSED FOR BIT 0
	JMPR	F88		;ON TOP
;
TEX2L:	LXI	H,TWOLO
	JMPR	F88
;
TEX6H:	LXI	H,SIXHI
	JMPR	L88
;
TEX4H:	LXI	H,FOURLO
	JMPR	L88
;
TEX2H:	LXI	H,TWOHI
	JMPR	L88
;
	.PAGE
;
;[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[
;[                                        [
;[         THIS CODE IS DEPENDANT         [
;[           ON THE ORIENTATION           [
;[                                        [
;[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[
;
;
PUTIN:	RRC	;THIS CODE IS DEPENDANT
	RRC	;ON THE LAYOUT OF THE HEAD
IN3:	RRC	;THIS CODE IS FOR A HEAD
	RRC	;WITH BIT 0 ON THE TOP
IN2:	RRC
	RRC
IN1:	XCHG
	ORA	M
	MOV	M,A
	INX	H
	XCHG
	RET
;
CVERT2:	MOV	A,M
..L1:	RLC
	DJNZ	..L1
CVERT:	ANI	88H
	RRC
	MOV	B,A
	RRCЉ	RRC
	RRC
	ORA	B
	ANI	0C0H
	RET
;
SIXHI:	RRC
	RRC
	ANI	03FH
	RET
;
TWOHI:	RLC
	RLC
	ANI	3
	RET
;
SIXLO:	RLC
	RLC
	ANI	0FCH
	RET
;
TWOLO:	RRC
	RRC
	ANI	0C0H
	RET
;
	.PAGE
;
PRNPNT:	.BLKW	1
DUBFLG:	.BYTE	0					
CHAR:	.BLKB	1
COL:	.BLKW	1
GRFY:	.BYTE	239
BYTES:	.BLKB	4
TEXBYT:	.BLKB	6
PRNBYT:	.BLKB	8
;
	.LOC	BASE+1800H+05FFH	;CHARACTER GENERATORееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее TABLE START 

CHRTBL:	.BLKB	2560	;CHARACTER GENERATOR ROM IMAGE
;
	.LOC	BASE+1800H-320
;
GRFBUF:	.BLKB	80
	.BLKB	80
ATTBUF:	.BLKB	80
DSPBUF:	.BLKB	80
;
	.END
TAX90                "ЉyЂ'    TAX91                (Љyw(    TELIX                —Ќyg)    TEMP                 Ћy•8    UNPROT               Ћy–8    UTIL                 ЋyЮ8    CPM     BAT           $cб(   XFER                 TЋyA    NKEY$
3330 DAY$ = INKEY$
3335 TDAY$ = INKEY$
3340 MO$ = INKEY$
3345 TMO$ = INKEY$
3350 YR$ = INKEY$
3355 TYR$ = INKEY$
3360 DATE$ = TMO$ + MO$ + "/" + TDAY$ + DAY$ + "/" + TYR$ + YR$
3365 IF WKDAY$ = "1" THEN DAYNAME$ = "Sunday"
3370 IF WKDAY$ = "2" THEN DAYNAME$ = "Monday"
3375 IF WKDAY$ = "3" THEN DAYNAME$ = "Tuesday"
3380 IF WKDAY$ = "4" THEN DAYNAME$ = "Wednesday"
3385 IF WKDAY$ = "5" THEN DAYNAME$ = "Thursday"
3390 IF WKDAY$ = "6" THEN DAYNAME$ = "Friday"
3395 IF WKDAY$ = "7" THEN DAYNAME!  9"1MН 22!Ђ F#К/~юAЪюQТЦA2!@ "ы!с "ч>2 Н Їµх:_:»Д сК»Н ##~==2яе! )=Вj"эб#~2 ##^#V#л"щл^#Vл#"ы)))))л*э+:яO|ж~Вџ/Oя*щ	:я=Кё)Г°"ч!\ 6 #6?#ВГГС\ Н ·ъ6*к#"кЂ жѓ_! ~юЂКПG: /O/ЂЎжG+++~жрЂw*оO 	"о*рw#В!"р*м#"мГП*м"	*	|·g}o"	ґКв|/g}/o#л*м"! ""л*	))T])A	л*))ХT])С	ѕЪ­В‘#Вѓ*#"л*|єЪ<В©}»Ъ<лГb>ђ/Oя	л	Nwy#Вє*	|/W}/_*"Їґъ‘µК‘Гe:ЖA2џ*мл!©Нм*клХ!ёНмСНђ*ыл!ЅНм*олХ!ФНеСНђ*чл!ЫНеья *м	яЪ4y2тo& )T]))"у*рP>яw#ВP	Н !M"х!т5ъУ*хН)юя|ДL НL*ул*хН)юя|ДL НL*ул*хН)юя|ДL НL*ул*хН)НL
НL*х "х>яѕВd:_:»Д *щЙНм6K#ЙzіКелНOНUG бНPНQzНzж»И0ѓw#ЙЇ)Џ'Т$#ВЙ~юяИНX НLНX НL~НbKНL еХЕН БСбЙ^#НLВXЙd Нt
НtЖ0_ГLяђТvЂхyєК€Ж0ГЉ> _НLсЙ{/_z/WЙ
DISK:    FILES:       ENTRIES:    (    LEFT)   SPACE USED:      (      LEFT)

$      M              UB 2800
11335 X = 120 + OFFSET : GOSUB 2800
11340 P$ = "0"
11350 X = 135 + OFFSET : Y = 210 + OFFSET : GOSUB 2800
11355 P$ = "1"
11360 X = 145 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11365 NEXT
11370 REM "R" COMPLETED
11400 REM "O"
11410 FOR OFFSET = 0 TO 1
11420 P$ = "0"
11430 X = 170 + OFFSET : Y = 220 + OFFSET : GOSUB 2800
11440 P$ = "1"
11450 X = 195 + OFFSET : GOSUB 2800
11460 Y = 200 + OFFSET : GOSUB 2800
11470 X = 170 + OFFSET : GOSUB 2800
11480 Y = 220 + OFFSET : GOSUB 2800
11490 NEXT
11495 REM "O" COMPLETED
11500 REM "N"
11510 FOR OFFSET = 0 TO 1
11520 P$ = "0"
11530 X = 220 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11540 P$ = "1"
11550 Y = 220 + OFFSET : GOSUB 2800
11560 X = 245 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11570 Y = 220 + OFFSET : GOSUB 2800
11580 NEXT
11590 REM "N" COMPLETED
11600 REM "A"
11605 FOR OFFSET = 0 TO 1
11610 P$ = "0"
11615 X = 270 + OFFSET : Y = 200 + OFFSET : GOSUB 2800
11620 P$ = "1"
11625 Y = 220 + OFFSET : GOSUB 2800
11630 X = 295 + OF100 REM ***********************************************************************
110 REM *                                                                     *
120 REM * Name: DATE                                                          *
130 REM * Rev.: 1.0                                                           *
140 REM * Date: May 14, 1982                                                  *
150 REM *                                                                     *
160 REM * Desc: Access and display system date:  example program              *
170 REM *                                                                     *
180 REM *                                                                     *
190 REM ***********************************************************************
200 PRINT CHR$(27);":"
210 WKDAY$ = INKEY$
220 DAY$ = INKEY$
230 TDAY$ = INKEY$
240 MO$ = INKEY$
250 TMO$ = INKEY$
260 YR$ = INKEY$
270 TYR$ = INKEY$
280 DATE$ = TMO$ + MO$ + "/" + TDAY$ + DAY$ + "/" + TYR$ + YR$
290 IF WKDAY$ = "1" THEN DAYNAME$ = "Sunday"
300 IF WKDAY$ = "2" THEN DAYNAME$ = "Monday"
310 IF WKDAY$ = "3" THEN DAYNAME$ = "Tuesday"
320 IF WKDAY$ = "4" THEN DAYNAME$ = "Wednesday"
330 IF WKDAY$ = "5" THEN DAYNAME$ = "Thursday"
340 IF WKDAY$ = "6" THEN DAYNAME$ = "Friday"
350 IF WKDAY$ = "7" THEN DAYNAME$ = "Saturday"
360 PRINT CHR$(26)
370 PRINT "The current date is: ";DATE$
380 PRINT: PRINT
390 PRINT "The current day is: ";DAYNAME$
400 PRINT: PRINT
410 SYSTEM
RINT "The current dat
13225 PRINT
13230 PRINT "Q";
13235 FOR I=1 TO 20:PRINT CHR$(64);:NEXT I
13240 PRINT "W";
13245 FOR I=1 TO 6:PRINT CHR$(64);:NEXT I
13250 PRINT"E":PRINT "\                    \      \"
13255 PRINT "A";:FOR I=1 TO 4:PRINT CHR$(64);:NEXT I
13260 PRINT "W";:FOR I=1 TO 15:PRINT CHR$(64);:NEXT I
13265 PRINT "S";:FOR I=1 TO 6:PRINT CHR$(64);:NEXT I:PRINT "D"
13270 FOR J=1 TO 3
13275 PRINT "U";:FOR I=1 TO 4:PRINT CHR$(95);:NEXT I
13280 PRINT"[";:FOR I=1 TO 15:PRINT CHR$(95);:NEXT I
13285 PRINT "[";:FORееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;************************************************
;*                                              *
;*           GRAPHIC PRINTING ROUTINE           *
;*                    EPSON                     *
;************************************************
;
	.PABS
	.PHEX
	.XSYM
BASE	=	2000H
;
	.LOC	BASE+1800H
;
	JMP	DUMPS
;
HOM	=	1EH
HL	=	22H
HLBOLD	=	26H
SPC	=	20H
ESC	=	1BH
CR	=	0DH
LF	=	0AH
SPRTR	=	0F3H
DPRTR	=	0F2H
SDSPY	=	0EEH
DDSPY	=	0FEH
CONIN	=	BASE+9
CONOUT	=	BASE+6
VALDSP	=	BASE+6
DUMPMN	=	BASE+64H
LINOFS	=	BASE+6DH
LINDSP	=	BASE+21H
VALMSG	=	BASE+24H
RETVAL	=	BASE+0CH
BADKEY	=	BASE+37H
SOUND	=	BASE+1EH
GETDMP	=	BASE+6FH
CONST	=	BASE+7BH
;
DUMPS:	LHLD	1
	MVI	A,239
	STA	GRFY
	XRA	A
	STA	DUBFLG
	MOV	H,A
	LDA	LINOFS
	MOV	L,A
	SHLD	COL
;
DUMPS1:	LHLD	DUMPMN
	CALL	VALMSG
	LXI	H,DUMPMS
	CALL	VALMSG
	CALL	GETDMP
	CPI	LF
	JRNZ	NLF
	MOV	C,A
	CALL	LIST
	JMPR	DUMPS1
NLF:	CPI	ESC
	JZ	RETVAL
	ORA	A
	JZ	QIKTEX
	CPI	4
	JZ	RETVAL
	PUSH	PSW
	CALL	SETPRN
	POP	PSW
	DCR	A
	JZ	DUMPTX
	DCR	A
	JZ	DUMPGR	;DUMPAL NEXT
;
DUMPAL:	MVI	D,"7"
	CALL	ESCOUT	
	MVI	A,3AH	;CODE FOR LDA
	STA	GRFLIN	;RESTORE GRFLIN CODE
DUMPER:	MVI	B,6	
..L3:	PUSH	B
	CALL	GRFLIN
	CALL	TEX8
	CALL	SCRLL
	CALL	TEX2H
	CALL	GRFLIN
	CALL	TEX6M	
	CALL	SCRLL
	CALL	TEX4H	
	CALL	GRFLIN
	CALL	TEX4L	
	CALL	SCRLL	
	CALL	TEX6H	Љ	CALL	GRFLIN
	CALL	TEX2L
	CALL	SCRLL	
	CALL	TEX8H
	CALL	GRFLIN
	CALL	SCRLL
	POP	B
	DJNZ	..L3
	MVI	C,LF
	CALL	LIST	
	JMP	RETURN
;
ESCOUT:	MVI	C,ESC
	CALL	CONOUT
	MOV	C,D
	JMP	CONOUT
;
LIST:	PUSH	B
	CALL	CONST
	JRZ	..L1
	CALL	CONIN
	CPI	ESC
	POP	B
	JZ	RETURN
	PUSH	B
..L1:	POP	B
LST2:	MVI	A,10H
	OUT	SPRTR
	IN	SPRTR
	ANI	24H
	CPI	24H
	JRNZ	LST2
	MOV	A,C
	OUT	DPRTR
	RET
;
QIKLIN:	MVI	B,80
	LXI	H,DSPBUF
	JMP	L1
;
QIKTEX:	LXI	H,NULL
	SHLD	MOD2+1
	MVI	C,CR
	CALL	LST2
	MVI	B,24
..Z1:	PUSH	B
	LXI	H,DSPBUF
..L1:	PUSH	H
	CALL	REDTEX
..L2:	PUSH	PSW
	LDA	CHAR
	CPI	7FH
	JRNC	..N2
	CPI	20H
	JRNC	..N1
..N2:	MVI	A,"*"
	STA	CHARЉ..N1:	POP	PSW
	BIT	4,A	;DOUBLE WIDTH
	JRZ	..NODB	
	INR	H
	XTHL
	MVI	M,20H	;REPLACE 1ST CHAR
	INX	H	;WITH A SPACE
	XTHL
..NODB:	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A
	INX	H
	MOV	A,B	
	CPI	80
	JRC	..L1
	CALL	INCOL	;RETURNS ZERO IF BLANK 
	CALL	CHKLIN
 	CNZ	QIKLIN	;LINE
	MVI	C,CR
	CALL	LST2	
	MVI	C,LF
	CALL	LST2
	CALL	CONST
	JRZ	..M1
	CALL	CONIN
	POP	B
	CPI	ESC
	JRZ	ETX
	PUSH	B
..M1:	POP	B
	DJNZ	..Z1
ETX:	MVI	C,LF
	CALL	LST2
	JMP	RETVAL
;
DUMPTX:	MVI	A,0C9H	;CODE FOR RETURN
	STA	GRFLIN	;DISABLE GRFLIN
	JMP	DUMPER
;
DUMPGR:	MVI	A,3AH
	STA	GRFLIN
	MVI	D,"7"
	CALL	ESCOUT
	MVI	A,239	;DUMP GRAPHICS ONLY
	STA	GRFY
	MVI	B,30
..L1:	PUSH	B
	CALL	GRFLIN
	CALL	SCRLL	
	POP	B
	DJNZ	..L1
	JMP	RETURN
;	
GRFLIN:	LDA	GRFY
	MOV	D,A
	XRA	A
	MOV	B,A
	MVI	C,DDSPY
	LXI	H,GRFBUF
..L2:	MVI	E,4
..L1:	MOV	A,D
	PUSH	H
	PUSH	B
	CALL	LINDSP
	POP	B
	POP	H
	OUT	SDSPY
	INP	A
	MOV	M,A
	INX	H
	DCR	D
	DCR	D
	DCR	E
	JRNZ	..L1
	INR	B
	MOV	A,B
	CPI	80	
	JRZ	RETG
	MOV	A,D
	ADI	8
	MOV	D,AЉ	JMPR	..L2
RETG:	MOV	A,D
	STA	GRFY
	LXI	H,GRFBUF
	MVI	E,2
..L2:	MVI	B,160	
..L1:	MOV	A,M
	ORA	A
	JRNZ	PRNGRF
	INX	H
	DJNZ	..L1
	DCR	E
	JRNZ	..L2	
	RET
;
PRNGRF:	CALL	HIRES
	LXI	H,GRFBUF
	MVI	B,80
..L1:	LXI	D,BYTES
	PUSH	B
	LXI	B,4
	LDIR
	PUSH	H
	CALL	OUT4
	POP	H
	POP	B
	DJNZ	..L1
	MVI	C,CR
	JMP	LIST
;
OUT4:	PUSH	D
	CALL	MAKE
	LXI	H,PRNBYT
	MVI	B,4
..L1:	MOV	C,M
	CALL	LST2
	MOV	C,M
	CALL	LST2
	INX	H
	DJNZ	..L1
	POP	D
	RET
;
OUT42:	MVI	B,8	
	LXI	H,PRNBYT
L1:	MOV	A,M	
MOD2:	CALL	NULL	;MODIFIED
	MOV	C,A
	CALL	LST2
	INX	H
	DJNZ	L1
	RET	
;
NULL:	RET
;
SIXHI:	RAL
	RAL
	ANI	0FCH
	RET
;
;
TWOHI:	RRC
	RRC
	ANI	0C0H
	RET
;
SIXLO:	RAR
	RAR
	ANI	3FH
	RET
;
;
TWOLO:	RLC
	RLC
	ANI	3
	RET
;
ZROPRN:	LXI	H,PRNBYT
	SHLD	PRNPNT
	XRA	AЉ	MVI	B,8	
..L1:	MOV	M,A
	INX	H
	DJNZ	..L1
	RET
;
ESCOD:	MVI	C,1BH
	CALL	LST2
	MOV	C,B
	JMP	LST2
;
TEX8:	LXI	H,NULL
;
FIRST8:	SHLD	MOD2+1
	CALL	REDLIN
	CALL	CHKLIN
	RZ
	CALL	SETLIN
EL1:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE
	SDED	PRNPNT
	INX	H
	CALL	MAKE99
	CALL	OUT42
	POP	D
	POP	H
	INX	H
	INX	D
	POP	B
	DJNZ	EL1
	MVI	C,CR
	JMP	LIST
;
TEX8H:	LXI	H,NULL
;
LAST8:	SHLD	MOD2+1
	CALL	CHKLIN
	JZ	INCOL
	CALL	SETLIN
LL:	PUSH	B
	MOV	A,M
	PUSH	H
	PUSH	D
	CALL	GETCHR
	CALL	MAKE8
	SDED	PRNPNT
	LXI	H,BYTES+5
	CALL	MAKE88
	CALL	OUT42
	POP	D
	POP 	H
	INX	D
	INX	H
	POP	B
	DJNZ	LL
	MVI	C,CR
	CALL	LIST
	JMP	INCOL
;
;
TEX6M:	LXI	H,SIXLO
	JMPR	FIRST8
;
TEX4L:	LXI	H,FOURLO
	JMPR	FIRST8
;
TEX2L:	LXI	H,TWOLO
	JMPR	FIRST8
;
;
TEX6H:	LXI	H,SIXHI
	JMPR	LAST8
;
TEX4H:	LXI	H,FOURHI
	JMPR	LAST8
;
TEX2H:	LXI	H,TWOHI
	JMPR	LAST8
;
REDLIN:	LXI	H,DSPBUF
	LXI	D,ATTBUF
..L1:	PUSH	H
	PUSH	D
	CALL	REDTEX
	POP	D	;SAVE ATTRIBUTE
	XCHG
	MOV	M,A
	XCHG
	INR	H
	SHLD	COL
	MOV	B,H
	POP	H
	LDA	CHAR
	MOV	M,A	
	INX	H
	INX	D
..L4:	MOV	A,B
	CPI	80	
	JRC	..L1
	RET
;
REDTEX:	LHLD	COL
	MOV	A,L
	ORI	0E0H
	MOV	E,A
	OUTееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее